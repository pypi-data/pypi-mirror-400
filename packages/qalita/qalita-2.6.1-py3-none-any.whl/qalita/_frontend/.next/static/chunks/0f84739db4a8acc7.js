(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},10887,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(22016);function r(){return"/api"}async function n(){let e=await fetch(`${r()}/worker/status`);if(!e.ok){let s=await e.text();throw Error(`Failed to get worker status: ${e.status} - ${s.substring(0,100)}`)}let s=e.headers.get("content-type")||"";if(!s.includes("application/json")){let t=await e.text();throw Error(`Expected JSON but got ${s}: ${t.substring(0,100)}`)}return e.json()}async function i(){return(await fetch(`${r()}/worker/start`,{method:"POST"})).json()}async function l(){return(await fetch(`${r()}/worker/stop`,{method:"POST"})).json()}async function c(){await fetch(`${r()}/validate`,{method:"POST"})}async function o(){await fetch(`${r()}/push`,{method:"POST"})}async function d(e){let s=new FormData;s.append("pack_dir",e);let t=await fetch(`${r()}/pack/push`,{method:"POST",body:s});if(!t.ok){let e=await t.text();throw Error(`Failed to push pack: ${t.status} - ${e.substring(0,100)}`)}return t.json()}function h(){let[e,a]=(0,t.useState)(!1),[r,c]=(0,t.useState)(!0);(0,t.useEffect)(()=>{o();let e=setInterval(o,2e3);return()=>clearInterval(e)},[]);let o=async()=>{try{let e=await n();a(e.running||!1),c(!1)}catch(e){console.error("Failed to get worker status:",e),c(!1)}},d=async()=>{try{e?await l():await i(),await o()}catch(e){console.error("Failed to toggle worker:",e)}};return r?(0,s.jsx)("span",{className:"muted -mt-[13px]",children:"(loading...)"}):(0,s.jsxs)("div",{className:"flex gap-5 items-center",children:[(0,s.jsx)("div",{id:"agent_switch",className:`-mt-[11px] relative w-[46px] h-[26px] rounded-full cursor-pointer inline-block transition-colors duration-150 ${e?"bg-green-600":"bg-gray-200"}`,onClick:d,children:(0,s.jsx)("div",{id:"agent_knob",className:`absolute top-[3px] w-5 h-5 bg-white rounded-[35%] shadow-sm transition-all duration-150 ${e?"left-[23px]":"left-[3px]"}`})}),(0,s.jsxs)("span",{className:"muted -mt-[13px]",children:["(",e?"running":"stopped",")"]})]})}var u=e.i(57688);function m({isOpen:e,onClose:t,onConfirm:a,title:r,message:n,itemName:i}){return e?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[1000]",onClick:t,children:(0,s.jsxs)("div",{className:"card min-w-[400px] max-w-[90%] bg-white p-6",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("h2",{className:"mt-0",children:r}),(0,s.jsx)("p",{children:n}),i&&(0,s.jsx)("p",{className:"font-bold text-danger",children:i}),(0,s.jsxs)("div",{className:"actions mt-5 justify-end",children:[(0,s.jsx)("button",{className:"btn secondary",onClick:t,type:"button",children:"Cancel"}),(0,s.jsx)("button",{className:"btn danger",onClick:a,type:"button",children:"Delete"})]})]})}):null}let x={file:"file.svg",csv:"csv.svg",excel:"excel.svg",folder:"folder.svg",postgresql:"postgresql.svg",mysql:"mysql.svg",oracle:"oracle.svg",mssql:"mssql.svg",sqlite:"sqlite.svg",mongodb:"mongodb.svg",s3:"s3.svg",gcs:"gcs.png",azure_blob:"azure_blob.svg",hdfs:"hdfs.svg"};function p({sources:e,platformUrl:r}){let[n,i]=(0,t.useState)({isOpen:!1,sourceName:null}),l=async()=>{if(n.sourceName)try{await fetch(`/api/sources/delete/${encodeURIComponent(n.sourceName)}`,{method:"POST"}),window.location.reload()}catch(e){console.error("Failed to delete source:",e)}finally{i({isOpen:!1,sourceName:null})}};return(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Name"}),(0,s.jsx)("th",{children:"Type"}),(0,s.jsx)("th",{children:"Visibility"}),(0,s.jsx)("th",{children:"Check"}),(0,s.jsx)("th",{})]})}),(0,s.jsx)("tbody",{children:e.map(e=>{let t=x[e.type]||"folder.svg",n=(e.visibility||"").toLowerCase(),l=(e.validate||"").toLowerCase();return(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{children:[e.id&&r?(0,s.jsx)("a",{href:`${r}/home/data-engineering/sources/${e.id}`,target:"_blank",rel:"noopener noreferrer",children:e.name}):e.name,e.description&&(0,s.jsx)("div",{className:"subtle",children:e.description})]}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(u.default,{src:`/sources-logos/${t}`,alt:e.type,width:20,height:20,className:"h-5 max-w-[30px] rounded"}),(0,s.jsx)("span",{children:e.type})]})}),(0,s.jsxs)("td",{children:["private"===n&&(0,s.jsxs)("span",{title:"private",className:"badge badge-private",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{x:"3",y:"9",width:"14",height:"8",rx:"2",stroke:"#374151",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M6 9V7a4 4 0 1 1 8 0v2",stroke:"#374151",strokeWidth:"2",fill:"none"})]}),"Private"]}),"internal"===n&&(0,s.jsxs)("span",{title:"internal",className:"badge badge-internal",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{x:"3",y:"6",width:"14",height:"10",rx:"2",stroke:"#0ea5e9",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M7 6V4h6v2",stroke:"#0ea5e9",strokeWidth:"2"})]}),"Internal"]}),"public"===n&&(0,s.jsxs)("span",{title:"public",className:"badge badge-public",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("circle",{cx:"10",cy:"10",r:"8",stroke:"#16a34a",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M2 10h16M10 2a12 12 0 0 1 0 16M10 2a12 12 0 0 0 0 16",stroke:"#16a34a",strokeWidth:"2"})]}),"Public"]}),!["private","internal","public"].includes(n)&&(0,s.jsx)("span",{className:"muted",children:e.visibility})]}),(0,s.jsxs)("td",{children:["valid"===l&&(0,s.jsxs)("span",{title:"valid",className:"badge badge-valid",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("circle",{cx:"10",cy:"10",r:"9",stroke:"#059669",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M6 10.5l2.5 2.5L14 7.5",stroke:"#059669",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Reachable"]}),"invalid"===l&&(0,s.jsxs)("span",{title:"invalid",className:"badge badge-invalid",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("circle",{cx:"10",cy:"10",r:"9",stroke:"#b91c1c",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M7 7l6 6M13 7l-6 6",stroke:"#b91c1c",strokeWidth:"2",strokeLinecap:"round"})]}),"Unreachable"]}),!["valid","invalid"].includes(l)&&(0,s.jsx)("span",{className:"muted",children:e.validate||""})]}),(0,s.jsx)("td",{className:"muted"}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:"actions",children:[e.id?(0,s.jsx)(a.default,{className:"btn secondary",href:`/sources/edit/${encodeURIComponent(e.id)}`,children:"Edit"}):(0,s.jsx)("span",{className:"btn secondary opacity-50 cursor-not-allowed",title:"Source ID not available",children:"Edit"}),(0,s.jsx)("button",{className:"btn danger",type:"button",onClick:()=>{i({isOpen:!0,sourceName:e.name})},children:"Delete"})]})})]},e.name)})})]}),(0,s.jsx)(m,{isOpen:n.isOpen,onClose:()=>{i({isOpen:!1,sourceName:null})},onConfirm:l,title:"Delete Source",message:"Are you sure you want to delete this source? This action cannot be undone.",itemName:n.sourceName||void 0})]})}function g({initialData:e}){let[r,n]=(0,t.useState)(null),i=async()=>{try{await c(),n({message:"Validation completed",level:"info"}),setTimeout(()=>window.location.reload(),1e3)}catch(e){n({message:"Validation failed",level:"error"})}},l=async()=>{try{await o(),n({message:"Push completed",level:"info"}),setTimeout(()=>window.location.reload(),1e3)}catch(e){n({message:"Push failed",level:"error"})}},u=async e=>{e.preventDefault();let s=new FormData(e.currentTarget).get("pack_dir");if(!s)return void n({message:"Please select a pack folder",level:"error"});try{let e=await d(s);n({message:e.message||(e.ok?"Pack pushed successfully":"Pack push failed"),level:e.level||(e.ok?"info":"error")}),e.ok&&setTimeout(()=>window.location.reload(),1e3)}catch(e){n({message:`Pack push failed: ${e instanceof Error?e.message:"Unknown error"}`,level:"error"})}};return(0,s.jsxs)("div",{className:"container mt-3",children:[r&&(0,s.jsx)("div",{className:`alert ${"error"===r.level?"alert-error":"alert-info"} mb-3`,children:r.message}),(0,s.jsxs)("div",{className:"grid",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-start gap-3 mb-3",children:[(0,s.jsx)("h2",{className:"m-0",children:"Sources"}),(0,s.jsxs)("div",{className:"actions",children:[(0,s.jsx)(a.default,{className:"btn",href:"/sources/add",children:"Add source"}),(0,s.jsx)("form",{className:"inline",onSubmit:e=>{e.preventDefault(),i()},children:(0,s.jsx)("button",{className:"btn secondary",type:"submit",children:"Validate"})}),(0,s.jsx)("form",{className:"inline",onSubmit:e=>{e.preventDefault(),l()},children:(0,s.jsx)("button",{className:"btn secondary",type:"submit",children:"Push"})})]})]}),(0,s.jsx)(p,{sources:e.sources,platformUrl:e.platform_url})]}),(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,s.jsx)("h2",{children:"Agent"}),(0,s.jsx)(h,{})]}),(0,s.jsx)("div",{className:"card mb-6",children:e.agent_conf?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-[160px_1fr] gap-y-2 gap-x-3",children:[(0,s.jsx)("div",{className:"muted",children:"Name"}),(0,s.jsx)("div",{"data-agent-name":!0,children:e.platform_url?(0,s.jsx)("a",{href:`${e.platform_url}/home/data-engineering/agents/?agent=${e.agent_conf.name||""}`,target:"_blank",rel:"noopener noreferrer",children:e.agent_conf.name||""}):e.agent_conf.name||""}),(0,s.jsx)("div",{className:"muted",children:"Mode"}),(0,s.jsx)("div",{"data-agent-mode":!0,children:e.agent_conf.mode||""}),(0,s.jsx)("div",{className:"muted",children:"Backend URL"}),(0,s.jsx)("div",{"data-agent-url":!0,children:(0,s.jsx)("a",{href:e.agent_conf.url||"",target:"_blank",rel:"noopener noreferrer",children:e.agent_conf.url||""})}),(0,s.jsx)("div",{className:"muted",children:"Agent ID"}),(0,s.jsx)("div",{"data-agent-id":!0,children:e.agent_conf.agent_id||""})]}),(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsx)("div",{className:"muted mb-1.5",children:"Agent Runs"}),e.agent_runs_page&&e.agent_runs_page.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("ul",{className:"m-0 pl-[18px]",children:e.agent_runs_page.map(e=>(0,s.jsxs)("li",{children:[(0,s.jsx)("span",{className:"muted",children:e.when})," —"," ",(0,s.jsx)("code",{children:(0,s.jsx)("a",{href:`/api/worker/run/${e.name}`,onClick:async s=>{s.preventDefault();try{await fetch(`/api/worker/run/${e.name}`)}catch(e){console.error("Failed to open agent run:",e)}},className:"cursor-pointer",children:e.name})})]},e.name))}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,s.jsxs)("div",{className:"muted",children:["Showing ",e.runs_start,"–",e.runs_end," of ",e.runs_total]}),(0,s.jsxs)("div",{className:"actions flex gap-2",children:[e.runs_has_prev?(0,s.jsx)(a.default,{className:"btn secondary",href:`/?runs_page=${e.runs_page-1}&runs_per_page=${e.runs_per_page}`,children:"Prev"}):(0,s.jsx)("button",{className:"btn secondary",disabled:!0,children:"Prev"}),e.runs_has_next?(0,s.jsx)(a.default,{className:"btn secondary",href:`/?runs_page=${e.runs_page+1}&runs_per_page=${e.runs_per_page}`,children:"Next"}):(0,s.jsx)("button",{className:"btn secondary",disabled:!0,children:"Next"})]})]})]}):(0,s.jsx)("div",{className:"muted",children:"No runs found."})]})]}):(0,s.jsx)("div",{className:"muted",children:'No agent configuration found. Use "qalita agent login" to configure.'})}),e.platform_url&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{children:"Pack"}),(0,s.jsx)("div",{className:"card mb-6",children:(0,s.jsxs)("form",{onSubmit:u,children:[(0,s.jsx)("label",{className:"mt-0",htmlFor:"pack_dir",children:"Pack folder"}),(0,s.jsxs)("div",{className:"grid grid-cols-[1fr_auto] gap-2 items-center",children:[(0,s.jsx)("input",{id:"pack_dir",name:"pack_dir",type:"text",placeholder:"/path/to/your_pack"}),(0,s.jsx)("button",{type:"button",className:"btn secondary mt-1.5",id:"browse_pack",onClick:async()=>{try{let e=await fetch("/api/sources/pick-folder"),s=await e.json();if(s.path){let e=document.getElementById("pack_dir");e&&(e.value=s.path)}}catch(e){console.error("Failed to pick folder:",e)}},children:"Browse…"})]}),(0,s.jsx)("div",{className:"actions mt-3",children:(0,s.jsx)("button",{className:"btn",type:"submit",children:"Push Pack"})})]})})]})]})]})]})}e.s(["default",()=>g],10887)}]);