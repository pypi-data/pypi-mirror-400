[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[project]
name = "table-diff"
version = "0.2.3"
authors = [
  { name="parker-research" },
]
description = "Tool to compare tables"
readme = "README.md"
license = "MIT"
requires-python = ">=3.10"
classifiers = [
  "Programming Language :: Python :: 3",
  "License :: OSI Approved :: MIT License",
  "Operating System :: OS Independent",
]

dependencies = [
  "loguru",
  "polars==1.31.0",
  "ordered_set",
  "typed-argparse<1",
  "duckdb",
  "pyarrow", # Dependency of duckdb.
  "jinja2>=3.1.6",
  "minify-html>=0.18.1",
]

[dependency-groups]
dev = [
  "ruff",
  "pyright",
  "pytest>=8.4.2",
  # Build tools:
  "twine",
  "hatchling",
  "build",
]

# Split PDF out as an optional install configuration as it requires extra build steps on Windows.
pdf = [
  "pymupdf>=1.26.7",
]

[project.urls]
Homepage = "https://gitlab.com/parker-research/table-diff"
Repository = "https://gitlab.com/parker-research/table-diff"
Issues = "https://gitlab.com/parker-research/table-diff/-/issues"

[project.scripts]
table_diff = "table_diff.cli:main"
table_diff_cli = "table_diff.cli:main"

[tool.ruff.lint]
preview = true  # Required for extra features (e.g., CPY001 rule).

select = [
  "ALL", # Select the main default rule set.
]
extend-select = [
  "CPY001", # Require a copyright header.
]

ignore = [
  "TD002", "TD003", "FIX002", "COM812",
  "S101", # Allow `assert` globally.
  "D203", # Fix warning.
  "D213", # Fix warning.
  "ISC001", # Fix warning.
]

[tool.ruff]
line-length = 99

[tool.ruff.lint.per-file-ignores]
# Source: https://github.com/astral-sh/ruff/issues/4368
"tests/**/*.py" = [
  "S101", # asserts allowed in tests...
  "ARG", # Unused function args -> fixtures nevertheless are functionally relevant...
  "FBT", # Don't care about booleans as positional arguments in tests, e.g. via @pytest.mark.parametrize()
  "PLR2004", # Magic value used in comparison, ...
  "S311", # Standard pseudo-random generators are not suitable for cryptographic purposes
]

[tool.pyright]
typeCheckingMode = "strict"
