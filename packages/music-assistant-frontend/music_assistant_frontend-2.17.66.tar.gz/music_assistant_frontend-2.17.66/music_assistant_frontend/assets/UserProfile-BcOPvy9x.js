import{C as we}from"./Container-DCgapsRo.js";import{d as P,b as w,e as d,ad as J,u as e,h as E,D as V,E as t,A as Ce,r as S,c as D,w as j,H as a,I as F,$ as v,a1 as r,f as h,O as M,aV as Se,F as K,aL as Ue,aW as re,M as ve,aX as _e,aG as ue,aY as Ve,aZ as Ie,a_ as Fe,o as Ne}from"./lucide-C2DU1LFb.js";import{_ as N}from"./index-_We2Vr5Z.js";import{u as ee,c as Te,t as Pe,_ as z,a as x,b as A,d as ze,e as ae,f as W,g as X,h as xe,i as fe,p as Be,j as ie}from"./profile-C_VtnoaA.js";import{c as O}from"./utils-CDN07tui.js";import{i as T}from"./vuetify-CDJMkNb9.js";import{_ as te,a as se,b as le,c as ne,d as B,e as De,f as Le,g as je}from"./index-vt6UORr-.js";import{p as Ae,e as Re}from"./reka-ui-GpbaI08z.js";import{v as Ee}from"./vueuse-DIaEWNCo.js";import{c as R,J as Me,_ as oe,s as G}from"./index-GGmWIGQT.js";import{u as q}from"./vue-i18n-DySrp6mW.js";import{_ as de,a as ce,b as me}from"./AvatarImage.vue_vue_type_script_setup_true_lang-DBokkkla.js";import"./index-kQIztB-E.js";import"./qrcode-DSFhiIp2.js";import"./marked-C0Rlrcoy.js";import"./color-BTziYnFN.js";import"./vue-router-BgJK_hRC.js";/* empty css            */import"./swiper-Jy9GbtzK.js";const Y=P({__name:"CardDescription",props:{class:{}},setup(C){const c=C;return(l,k)=>(d(),w("p",{"data-slot":"card-description",class:J(e(O)("text-muted-foreground text-sm",c.class))},[E(l.$slots,"default")],2))}}),pe=P({__name:"CardFooter",props:{class:{}},setup(C){const c=C;return(l,k)=>(d(),w("div",{"data-slot":"card-footer",class:J(e(O)("flex items-center px-6 [.border-t]:pt-6",c.class))},[E(l.$slots,"default")],2))}}),Z=P({__name:"CardHeader",props:{class:{}},setup(C){const c=C;return(l,k)=>(d(),w("div",{"data-slot":"card-header",class:J(e(O)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",c.class))},[E(l.$slots,"default")],2))}}),Q=P({__name:"CardTitle",props:{class:{}},setup(C){const c=C;return(l,k)=>(d(),w("h3",{"data-slot":"card-title",class:J(e(O)("leading-none font-semibold",c.class))},[E(l.$slots,"default")],2))}}),he=P({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(C){const c=C,l=Ee(c,"class"),k=Ae(l);return(i,f)=>(d(),V(e(Re),Ce({"data-slot":"dialog-description"},e(k),{class:e(O)("text-muted-foreground text-sm",c.class)}),{default:t(()=>[E(i.$slots,"default")]),_:3},16,["class"]))}}),Oe={key:0,class:"py-4"},qe={key:1,class:"py-4"},He={class:"text-sm text-muted-foreground mb-4"},Ge=P({__name:"CreateTokenDialog",props:{modelValue:{type:Boolean},userId:{}},emits:["update:modelValue","created"],setup(C,{emit:c}){const{t:l}=q(),k=C,i=c,f=S(!1),p=S(""),m=S(""),b=ee({defaultValues:{tokenName:""},validators:{onSubmit:Te(l)},onSubmit:async({value:g})=>{f.value=!0;try{const U=await R.createToken(g.tokenName,k.userId);U?(T.success(l("auth.token_created")),p.value=U,m.value=g.tokenName,i("created")):T.error(l("auth.token_create_failed"))}catch(U){T.error(U.message||l("auth.token_create_failed"))}finally{f.value=!1}}});function y(g){return g.state.meta.isTouched&&!g.state.meta.isValid}const $=D(()=>{const g=m.value||"";return g.trim().length>0&&g.length<=100&&!f.value}),u=()=>{b.reset(),p.value="",m.value="",requestAnimationFrame(()=>{i("update:modelValue",!1)})},s=async()=>{if(!p.value)return;await Me(p.value)?T.success(l("auth.token_copied")):T.error(l("auth.token_copy_failed"))};return j(()=>k.modelValue,g=>{g||(b.reset(),p.value=""),m.value=""}),(g,U)=>(d(),V(e(te),{open:C.modelValue,"onUpdate:open":U[1]||(U[1]=I=>i("update:modelValue",I))},{default:t(()=>[a(e(se),{class:"sm:max-w-md"},{default:t(()=>[a(e(le),null,{default:t(()=>[a(e(ne),null,{default:t(()=>[v(r(p.value?m.value:g.$t("auth.create_token")),1)]),_:1}),p.value?F("",!0):(d(),V(e(he),{key:0},{default:t(()=>[v(r(g.$t("auth.token_name_hint")),1)]),_:1}))]),_:1}),p.value?(d(),w("div",qe,[h("p",He,r(g.$t("auth.copy_new_token_hint")),1),a(e(De),null,{default:t(()=>[a(e(Le),{"model-value":p.value,readonly:"",class:"font-mono text-sm"},null,8,["model-value"]),a(e(je),{align:"inline-end"},{default:t(()=>[a(e(ze),{size:"icon-sm",variant:"ghost",onClick:s},{default:t(()=>[a(e(Se),{size:16})]),_:1})]),_:1})]),_:1})])):(d(),w("div",Oe,[h("form",{id:"form-create-token",onSubmit:U[0]||(U[0]=M((...I)=>e(b).handleSubmit&&e(b).handleSubmit(...I),["prevent"]))},[a(e(b).Field,{name:"tokenName",validators:{onChange:e(Pe)(e(l))}},{default:t(({field:I})=>[a(e(z),{"data-invalid":y(I)},{default:t(()=>[a(e(x),{for:I.name},{default:t(()=>[v(r(g.$t("auth.token_name")),1)]),_:1},8,["for"]),a(e(B),{id:I.name,name:I.name,"model-value":m.value,"aria-invalid":y(I),placeholder:g.$t("auth.token_name_hint"),autofocus:"",autocomplete:"off",onBlur:I.handleBlur,onInput:H=>{m.value=H.target.value,I.handleChange(H.target.value)}},null,8,["id","name","model-value","aria-invalid","placeholder","onBlur","onInput"]),y(I)?(d(),V(e(A),{key:0,errors:I.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1},8,["validators"])],32)])),a(e(ae),null,{default:t(()=>[p.value?(d(),V(e(N),{key:1,variant:"default",onClick:u},{default:t(()=>[v(r(g.$t("close")),1)]),_:1})):(d(),w(K,{key:0},[a(e(N),{variant:"outline",onClick:u},{default:t(()=>[v(r(g.$t("cancel")),1)]),_:1}),a(e(N),{type:"submit",form:"form-create-token",disabled:!$.value,loading:f.value},{default:t(()=>[v(r(g.$t("create")),1)]),_:1},8,["disabled","loading"])],64))]),_:1})]),_:1})]),_:1},8,["open"]))}}),Je={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Ke={key:0,class:"empty-state"},We={class:"flex size-16 items-center justify-center rounded-full bg-muted mb-3"},Xe={class:"text-muted-foreground font-medium"},Ye={class:"text-sm text-muted-foreground mt-1"},Ze={key:1,class:"space-y-2"},Qe={class:"flex size-10 items-center justify-center rounded-full bg-muted"},ea={class:"flex-1 min-w-0"},aa={class:"font-medium truncate"},ta={class:"text-sm text-muted-foreground flex flex-wrap gap-2"},sa={key:0},la={key:1},na=P({__name:"LongLivedTokensList",props:{tokens:{}},emits:["revoke","created"],setup(C,{emit:c}){const{t:l}=q(),k=c,i=S(!1),f=m=>new Date(m).toLocaleString(),p=()=>{k("created")};return(m,b)=>(d(),V(e(X),null,{default:t(()=>[a(e(Z),null,{default:t(()=>[h("div",Je,[h("div",null,[a(e(Q),null,{default:t(()=>[v(r(m.$t("auth.long_lived_tokens")),1)]),_:1}),a(e(Y),null,{default:t(()=>[v(r(m.$t("auth.api_tokens_description")),1)]),_:1})]),a(e(N),{onClick:b[0]||(b[0]=y=>i.value=!0)},{default:t(()=>[a(e(Ue),{size:16}),v(" "+r(m.$t("auth.create_token")),1)]),_:1})])]),_:1}),a(e(W),null,{default:t(()=>[C.tokens.length===0?(d(),w("div",Ke,[h("div",We,[a(e(re),{size:32,class:"text-muted-foreground"})]),h("p",Xe,r(m.$t("auth.no_tokens")),1),h("p",Ye,r(m.$t("auth.create_token_hint")),1)])):(d(),w("div",Ze,[(d(!0),w(K,null,ve(C.tokens,y=>(d(),w("div",{key:y.token_id,class:"flex items-center gap-4 rounded-lg border p-4 hover:bg-accent/50 transition-colors"},[h("div",Qe,[a(e(re),{size:20,class:"text-muted-foreground"})]),h("div",ea,[h("div",aa,r(y.name),1),h("div",ta,[h("span",null,r(m.$t("created"))+": "+r(f(y.created_at)),1),y.last_used_at?(d(),w("span",sa,"•")):F("",!0),y.last_used_at?(d(),w("span",la,r(m.$t("last_used"))+": "+r(f(y.last_used_at)),1)):F("",!0)])]),a(e(N),{variant:"ghost",size:"icon",class:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:M($=>k("revoke",y),["stop"])},{default:t(()=>[a(e(_e),{size:16})]),_:1},8,["onClick"])]))),128))]))]),_:1}),a(Ge,{modelValue:i.value,"onUpdate:modelValue":b[1]||(b[1]=y=>i.value=y),onCreated:p},null,8,["modelValue"])]),_:1}))}}),oa=oe(na,[["__scopeId","data-v-7459f4e1"]]),ra={key:0,class:"mb-4 rounded-lg border border-blue-500/20 bg-blue-500/10 p-4 text-sm text-blue-600 dark:text-blue-400"},ua=P({__name:"PasswordSettings",setup(C){const{t:c}=q(),l=S(!1),k=S(""),i=S(""),f=ee({defaultValues:{newPassword:"",confirmPassword:""},validators:{onSubmit:xe(c)},onSubmit:async({value:$})=>{l.value=!0;try{await R.changePassword($.newPassword)?(T.success(c("auth.password_changed")),f.reset(),k.value="",i.value=""):T.error(c("auth.password_change_failed"))}catch(u){T.error(u.message||c("auth.password_change_failed"))}finally{l.value=!1}}}),p=D(()=>{const $=k.value||f.state.values.newPassword||"",u=i.value||f.state.values.confirmPassword||"";return $===u&&u.length>0});function m($){return $.state.meta.isTouched&&!$.state.meta.isValid}const b=($,u)=>{const s=$.target.value;k.value=s,u.handleChange(s)},y=($,u)=>{const s=$.target.value;i.value=s,u.handleChange(s)};return($,u)=>(d(),V(e(X),null,{default:t(()=>[a(e(Z),null,{default:t(()=>[a(e(Q),null,{default:t(()=>[v(r($.$t("auth.change_password")),1)]),_:1}),a(e(Y),null,{default:t(()=>[v(r($.$t("auth.update_your_password")),1)]),_:1})]),_:1}),a(e(W),null,{default:t(()=>[e(G).isIngressSession?(d(),w("div",ra,r($.$t("auth.ingress_password_note")),1)):F("",!0),h("form",{id:"form-password-settings",onSubmit:u[0]||(u[0]=M((...s)=>e(f).handleSubmit&&e(f).handleSubmit(...s),["prevent"]))},[a(e(fe),null,{default:t(()=>[a(e(f).Field,{name:"newPassword"},{default:t(({field:s})=>[a(e(z),{"data-invalid":m(s)},{default:t(()=>[a(e(x),{for:s.name},{default:t(()=>[v(r($.$t("auth.new_password")),1)]),_:1},8,["for"]),a(e(B),{id:s.name,name:s.name,"model-value":s.state.value,type:"password","aria-invalid":m(s),autocomplete:"new-password",onBlur:s.handleBlur,onInput:g=>b(g,s)},null,8,["id","name","model-value","aria-invalid","onBlur","onInput"]),m(s)?(d(),V(e(A),{key:0,errors:s.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(f).Field,{name:"confirmPassword"},{default:t(({field:s})=>[a(e(z),{"data-invalid":m(s)},{default:t(()=>[a(e(x),{for:s.name},{default:t(()=>[v(r($.$t("auth.confirm_password")),1)]),_:1},8,["for"]),a(e(B),{id:s.name,name:s.name,"model-value":s.state.value,type:"password","aria-invalid":m(s),autocomplete:"new-password",onBlur:s.handleBlur,onInput:g=>y(g,s)},null,8,["id","name","model-value","aria-invalid","onBlur","onInput"]),m(s)?(d(),V(e(A),{key:0,errors:s.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1})]),_:1})],32)]),_:1}),a(e(pe),null,{default:t(()=>[a(e(N),{type:"submit",form:"form-password-settings",disabled:!p.value||l.value,loading:l.value},{default:t(()=>[v(r($.$t("auth.update_password")||"Update password"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1}))}}),ia={class:"flex flex-col sm:flex-row gap-6 mb-6"},da={class:"flex flex-col items-center gap-3"},ca={class:"relative"},ma={class:"flex-1 space-y-4"},va={class:"flex flex-col items-center gap-4 py-4"},_a=P({__name:"ProfileSettings",setup(C){const{t:c}=q(),l=D(()=>G.currentUser),k=D(()=>G.isIngressSession),i=S(!1),f=S(""),p=S(!1),m=S(!1),b=S(""),y=S(""),$=S(""),u=S(""),s=ee({defaultValues:{username:l.value?.username||"",displayName:l.value?.display_name||"",avatarUrl:l.value?.avatar_url||"",role:l.value?c(`auth.${l.value.role}_role`):""},validators:{onSubmit:Be(c)},onSubmit:async({value:n})=>{if(l.value){m.value=!0;try{const _={};if(n.username!==l.value.username&&(_.username=n.username),n.displayName!==(l.value.display_name||"")&&(_.displayName=n.displayName),n.avatarUrl!==(l.value.avatar_url||"")&&(_.avatarUrl=n.avatarUrl),Object.keys(_).length===0)return;const o=await R.updateUser(l.value.user_id,_);o&&(G.currentUser=o,_.username&&(y.value=o.username||""),_.displayName!==void 0&&($.value=o.display_name||""),_.avatarUrl!==void 0&&(u.value=o.avatar_url||"",s.setFieldValue("avatarUrl",o.avatar_url||""),p.value=!1),T.success(c("auth.profile_updated")))}catch(_){T.error(_.message||c("error_generic"))}finally{m.value=!1}}}}),g=D(()=>{if(!l.value)return!1;const n=y.value||s.state.values.username||"",_=$.value||s.state.values.displayName||"",o=u.value||s.state.values.avatarUrl||"",L=l.value.username||"",ye=l.value.display_name||"",be=l.value.avatar_url||"";return n!==L||_!==ye||o!==be});function U(n){return n.state.meta.isTouched&&!n.state.meta.isValid}const I=(n,_)=>{const o=n.target.value;y.value=o,_.handleChange(o)},H=(n,_)=>{const o=n.target.value;$.value=o,_.handleChange(o)},ge=()=>{if(l.value){const n=l.value.avatar_url||"";y.value=l.value.username||"",$.value=l.value.display_name||"",u.value=n,b.value=n,s.setFieldValue("username",l.value.username),s.setFieldValue("displayName",l.value.display_name||""),s.setFieldValue("avatarUrl",n),s.setFieldValue("role",c(`auth.${l.value.role}_role`))}},ke=()=>{u.value=b.value,s.setFieldValue("avatarUrl",b.value),f.value=b.value,i.value=!1,p.value=!1},$e=()=>{const n=f.value;u.value=n,n!==s.state.values.avatarUrl&&s.setFieldValue("avatarUrl",n),i.value=!1,p.value=!1};return j(()=>l.value?.avatar_url,n=>{n!==void 0&&(u.value=n||"",s.setFieldValue("avatarUrl",n||""),i.value||(f.value=n||""))},{immediate:!0}),j(i,n=>{n&&(b.value=l.value?.avatar_url||u.value||s.state.values.avatarUrl||"",f.value=u.value||s.state.values.avatarUrl||l.value?.avatar_url||"",p.value=!1)}),j(l,n=>{if(n){const _=n.username||"",o=n.display_name||"";y.value=_,$.value=o,s.setFieldValue("username",_),s.setFieldValue("displayName",o),s.setFieldValue("role",c(`auth.${n.role}_role`))}},{immediate:!0}),j(f,n=>{i.value&&(u.value=n,s.setFieldValue("avatarUrl",n))}),(n,_)=>(d(),w(K,null,[a(e(X),null,{default:t(()=>[a(e(Z),null,{default:t(()=>[a(e(Q),null,{default:t(()=>[v(r(n.$t("auth.account_settings")),1)]),_:1}),a(e(Y),null,{default:t(()=>[v(r(n.$t("auth.manage_your_profile_info")),1)]),_:1})]),_:1}),a(e(W),null,{default:t(()=>[h("form",{id:"form-profile-settings",onSubmit:_[2]||(_[2]=M((...o)=>e(s).handleSubmit&&e(s).handleSubmit(...o),["prevent"]))},[a(e(fe),null,{default:t(()=>[h("div",ia,[h("div",da,[h("div",ca,[a(e(de),{class:"size-32"},{default:t(()=>[u.value||e(s).state.values.avatarUrl||l.value?.avatar_url?(d(),V(e(ce),{key:u.value||e(s).state.values.avatarUrl||l.value?.avatar_url||"",src:u.value||e(s).state.values.avatarUrl||l.value?.avatar_url||"",onError:_[0]||(_[0]=o=>p.value=!0)},null,8,["src"])):F("",!0),a(e(me),{class:"bg-muted"},{default:t(()=>[a(e(ue),{size:48,class:"text-muted-foreground"})]),_:1})]),_:1}),k.value?F("",!0):(d(),V(e(N),{key:0,type:"button",variant:"outline",size:"icon",class:"absolute bottom-0 right-0 size-8 rounded-full border-2 border-background bg-background shadow-md hover:bg-accent",onClick:_[1]||(_[1]=o=>i.value=!0)},{default:t(()=>[a(e(Ve),{size:14})]),_:1}))])]),h("div",ma,[a(e(s).Field,{name:"username"},{default:t(({field:o})=>[a(e(z),{"data-invalid":U(o)},{default:t(()=>[a(e(x),{for:o.name},{default:t(()=>[v(r(n.$t("auth.username")),1)]),_:1},8,["for"]),a(e(B),{id:o.name,name:o.name,"model-value":o.state.value,"aria-invalid":U(o),disabled:k.value,autocomplete:"username",onBlur:o.handleBlur,onInput:L=>I(L,o)},null,8,["id","name","model-value","aria-invalid","disabled","onBlur","onInput"]),U(o)?(d(),V(e(A),{key:0,errors:o.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(s).Field,{name:"displayName"},{default:t(({field:o})=>[a(e(z),{"data-invalid":U(o)},{default:t(()=>[a(e(x),{for:o.name},{default:t(()=>[v(r(n.$t("auth.display_name")),1)]),_:1},8,["for"]),a(e(B),{id:o.name,name:o.name,"model-value":o.state.value,"aria-invalid":U(o),disabled:k.value,autocomplete:"name",onBlur:o.handleBlur,onInput:L=>H(L,o)},null,8,["id","name","model-value","aria-invalid","disabled","onBlur","onInput"]),a(e(ie),null,{default:t(()=>[v(r(n.$t("optional")),1)]),_:1}),U(o)?(d(),V(e(A),{key:0,errors:o.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(s).Field,{name:"role"},{default:t(({field:o})=>[a(e(z),null,{default:t(()=>[a(e(x),{for:o.name},{default:t(()=>[v(r(n.$t("auth.role")),1)]),_:1},8,["for"]),a(e(B),{id:o.name,name:o.name,"model-value":o.state.value,readonly:"",disabled:"",class:"bg-muted"},null,8,["id","name","model-value"])]),_:2},1024)]),_:1})])])]),_:1})],32)]),_:1}),a(e(pe),null,{default:t(()=>[a(e(z),{orientation:"horizontal"},{default:t(()=>[g.value?(d(),V(e(N),{key:0,type:"button",variant:"outline",onClick:ge},{default:t(()=>[v(r(n.$t("cancel")),1)]),_:1})):F("",!0),a(e(N),{type:"submit",form:"form-profile-settings",disabled:!g.value||m.value,loading:m.value},{default:t(()=>[v(r(n.$t("auth.save_changes")||"Save changes"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1}),a(e(te),{open:i.value,"onUpdate:open":_[5]||(_[5]=o=>i.value=o)},{default:t(()=>[a(e(se),{class:"sm:max-w-md"},{default:t(()=>[a(e(le),null,{default:t(()=>[a(e(ne),null,{default:t(()=>[v(r(n.$t("auth.change_avatar")),1)]),_:1}),a(e(he),null,{default:t(()=>[v(r(n.$t("auth.avatar_url_hint")),1)]),_:1})]),_:1}),h("div",va,[a(e(de),{class:"size-36"},{default:t(()=>[f.value?(d(),V(e(ce),{key:0,src:f.value,onError:_[3]||(_[3]=o=>p.value=!0)},null,8,["src"])):F("",!0),a(e(me),{class:"bg-muted"},{default:t(()=>[a(e(ue),{size:72,class:"text-muted-foreground"})]),_:1})]),_:1}),a(e(z),{class:"w-full"},{default:t(()=>[a(e(x),null,{default:t(()=>[v(r(n.$t("auth.avatar_url")),1)]),_:1}),a(e(B),{modelValue:f.value,"onUpdate:modelValue":_[4]||(_[4]=o=>f.value=o),placeholder:n.$t("auth.avatar_url_hint")},null,8,["modelValue","placeholder"]),a(e(ie),null,{default:t(()=>[v(r(n.$t("auth.avatar_url_hint")),1)]),_:1})]),_:1})]),a(e(ae),null,{default:t(()=>[a(e(N),{variant:"outline",onClick:ke},{default:t(()=>[v(r(n.$t("cancel")),1)]),_:1}),a(e(N),{onClick:$e},{default:t(()=>[v(r(n.$t("auth.save_changes")||"Save changes"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}}),fa={key:0,class:"empty-state"},pa={class:"flex size-16 items-center justify-center rounded-full bg-muted mb-3"},ha={class:"text-muted-foreground"},ga={key:1,class:"space-y-2"},ka={class:"flex size-10 items-center justify-center rounded-full bg-muted"},$a={class:"flex-1 min-w-0"},ya={class:"font-medium truncate"},ba={class:"text-sm text-muted-foreground flex flex-wrap gap-2"},wa={key:0},Ca={key:1},Sa=P({__name:"SessionTokensList",props:{tokens:{}},emits:["revoke"],setup(C,{emit:c}){const l=c,k=i=>new Date(i).toLocaleString();return(i,f)=>(d(),V(e(X),null,{default:t(()=>[a(e(Z),null,{default:t(()=>[a(e(Q),null,{default:t(()=>[v(r(i.$t("auth.active_sessions")),1)]),_:1}),a(e(Y),null,{default:t(()=>[v(r(i.$t("auth.manage_active_sessions")),1)]),_:1})]),_:1}),a(e(W),null,{default:t(()=>[C.tokens.length===0?(d(),w("div",fa,[h("div",pa,[a(e(Ie),{size:32,class:"text-muted-foreground"})]),h("p",ha,r(i.$t("no_content")),1)])):(d(),w("div",ga,[(d(!0),w(K,null,ve(C.tokens,p=>(d(),w("div",{key:p.token_id,class:"flex items-center gap-4 rounded-lg border p-4 hover:bg-accent/50 transition-colors"},[h("div",ka,[a(e(Fe),{size:20,class:"text-muted-foreground"})]),h("div",$a,[h("div",ya,r(p.name),1),h("div",ba,[h("span",null,r(i.$t("created"))+": "+r(k(p.created_at)),1),p.last_used_at?(d(),w("span",wa,"•")):F("",!0),p.last_used_at?(d(),w("span",Ca,r(i.$t("last_used"))+": "+r(k(p.last_used_at)),1)):F("",!0)])]),a(e(N),{variant:"ghost",size:"icon",class:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:M(m=>l("revoke",p),["stop"])},{default:t(()=>[a(e(_e),{size:16})]),_:1},8,["onClick"])]))),128))]))]),_:1})]),_:1}))}}),Ua=oe(Sa,[["__scopeId","data-v-628ad67c"]]),Va={class:"user-profile"},Ia={class:"profile-content space-y-6"},Fa={class:"py-4"},Na={class:"text-sm text-muted-foreground mb-4"},Ta={class:"rounded-md bg-destructive/10 p-4"},Pa={class:"font-medium"},za=P({__name:"UserProfile",setup(C){const{t:c}=q(),l=S([]),k=S(!1),i=S(null),f=S(!1),p=D(()=>l.value.filter(u=>!u.is_long_lived)),m=D(()=>l.value.filter(u=>u.is_long_lived)),b=async()=>{try{l.value=await R.getUserTokens()}catch(u){console.error("Failed to load tokens:",u)}},y=u=>{i.value=u,k.value=!0},$=async()=>{if(i.value){f.value=!0;try{if(await R.revokeToken(i.value.token_id)){await b();const s=!i.value.is_long_lived;T.success(c(s?"auth.session_revoked":"auth.token_revoked"))}else{const s=!i.value.is_long_lived;T.error(c(s?"auth.session_revoke_failed":"auth.token_revoke_failed"))}}catch(u){console.error("Failed to revoke token:",u);const s=!i.value?.is_long_lived;T.error(c(s?"auth.session_revoke_failed":"auth.token_revoke_failed"))}finally{k.value=!1,i.value=null,f.value=!1}}};return Ne(()=>{b()}),(u,s)=>(d(),w("div",Va,[a(we,{variant:"comfortable",class:"profile-container"},{default:t(()=>[h("div",Ia,[a(_a),a(ua),a(Ua,{tokens:p.value,onRevoke:y},null,8,["tokens"]),a(oa,{tokens:m.value,onRevoke:y,onCreated:b},null,8,["tokens"])])]),_:1}),a(e(te),{open:k.value,"onUpdate:open":s[1]||(s[1]=g=>k.value=g)},{default:t(()=>[a(e(se),{class:"sm:max-w-md"},{default:t(()=>[a(e(le),null,{default:t(()=>[a(e(ne),null,{default:t(()=>[v(r(i.value?.is_long_lived?u.$t("auth.revoke_token"):u.$t("auth.revoke_session")),1)]),_:1})]),_:1}),h("div",Fa,[h("p",Na,r(i.value?.is_long_lived?u.$t("auth.revoke_token_confirm"):u.$t("auth.revoke_session_confirm")),1),h("div",Ta,[h("p",Pa,r(i.value?.name),1)])]),a(e(ae),null,{default:t(()=>[a(e(N),{variant:"outline",onClick:s[0]||(s[0]=g=>k.value=!1)},{default:t(()=>[v(r(u.$t("cancel")),1)]),_:1}),a(e(N),{variant:"destructive",loading:f.value,onClick:$},{default:t(()=>[v(r(u.$t("auth.revoke")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["open"])]))}}),Qa=oe(za,[["__scopeId","data-v-3e668037"]]);export{Qa as default};
