# План исправления технического долга

**Версия:** 0.3.0 → 0.4.0
**Создан:** 2025-01-07
**Статус:** В работе

## Прогресс

- [x] Фаза 1: Быстрые исправления (4 задачи)
- [x] Фаза 2: Улучшение типизации и конфигурации (4 задачи)
- [x] Фаза 3: Расширение API (3 задачи)
- [x] Фаза 4: Расширение моделей (1 задача)
- [ ] Фаза 5: Тестирование (2 задачи)

---

## Фаза 1: Быстрые исправления

| # | Задача | Файл | Статус |
|---|--------|------|--------|
| 5 | Добавить `py.typed` маркер | `src/mm_async/py.typed` | ✅ |
| 14 | Создать CHANGELOG.md | корень | ✅ |
| 15 | Создать CONTRIBUTING.md | корень | ✅ |
| 12 | Добавить dev-зависимости | `pyproject.toml` | ✅ |

---

## Фаза 2: Улучшение типизации и конфигурации

| # | Задача | Файл | Статус |
|---|--------|------|--------|
| 6-7 | Вынести magic numbers в константы | `constants.py`, `retry.py`, `client.py` | ✅ |
| 9 | Унифицировать сообщения исключений | `client.py` | ✅ |
| 3 | Типизировать HTTP-методы | `client.py` | ⏭️ (отложено) |

---

## Фаза 3: Расширение API

| # | Задача | Файл | Статус |
|---|--------|------|--------|
| 8 | Добавить PATCH метод | `client.py` | ✅ |
| 4 | Добавить загрузку файлов | `client.py` | ✅ |
| 2 | Добавить пагинацию | `api/*.py` | ✅ |

---

## Фаза 4: Расширение моделей

| # | Задача | Файл | Статус |
|---|--------|------|--------|
| 1 | Дополнить Pydantic модели | `models.py` | ✅ |

**Поля для добавления:**
- `User`: `auth_data`, `auth_service`, `mfa_active`, `props`, `notify_props`
- `Team`: `create_at`, `update_at`, `delete_at`, `scheme_id`
- `Channel`: `create_at`, `update_at`, `total_msg_count`, `last_post_at`, `creator_id`
- `Post`: `props`, `metadata`, `type`, `hashtags`, `file_ids`, `has_reactions`

---

## Фаза 5: Тестирование

| # | Задача | Файл | Статус |
|---|--------|------|--------|
| 10 | Тесты edge cases | `tests/` | ⬜ |
| 11 | Интеграционные тесты | `tests/integration/` | ⬜ |

**Edge cases:**
- Network partition recovery
- Partial response handling
- Concurrent request handling
- Connection pool exhaustion
- Malformed JSON responses

---

## Не включено в план

| # | Задача | Причина |
|---|--------|---------|
| 13 | Upper bounds зависимостей | Может усложнить совместимость |
