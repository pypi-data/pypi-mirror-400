Metadata-Version: 2.4
Name: mcp-melotts
Version: 1.0.0
Summary: MCP server for text-to-speech using MeloTTS - generates audio from text
Project-URL: Homepage, https://github.com/aardpro/mcp-melotts
Project-URL: Repository, https://github.com/aardpro/mcp-melotts
Project-URL: Issues, https://github.com/aardpro/mcp-melotts/issues
Author-email: aardpro <chileehong@outlook.com>
License-Expression: MIT
License-File: LICENSE
Keywords: audio,mcp,melo,melotts,text-to-speech,tts
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.10
Requires-Dist: mcp>=1.0.0
Requires-Dist: melo
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Requires-Dist: ruff>=0.1.0; extra == 'dev'
Description-Content-Type: text/markdown

# MCP MeloTTS è¯­éŸ³ç”Ÿæˆå™¨ (MCP MeloTTS Audio Generator)

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ª [Model Context Protocol (MCP)](https://modelcontextprotocol.io/) æœåŠ¡å™¨ï¼Œä¸º AI åŠ©æ‰‹æä¾›å°†æ–‡æœ¬ç”Ÿæˆè¯­éŸ³éŸ³é¢‘çš„èƒ½åŠ›ï¼ŒåŸºäº MeloTTSã€‚

æ”¯æŒè‡ªåŠ¨å°†é•¿æ–‡æœ¬æŒ‰æ ‡ç‚¹ä¸é•¿åº¦åˆ†å‰²ä¸ºä¸è¶…è¿‡ 100 å­—çš„å°æ®µï¼Œé€æ®µç”Ÿæˆ WAV æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ ffmpeg æ— æŸæ‹¼æ¥ä¸ºå®Œæ•´éŸ³é¢‘ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- æ–‡æœ¬è½¬è¯­éŸ³ï¼šä½¿ç”¨ MeloTTS å°†æ–‡æœ¬ç”Ÿæˆé«˜è´¨é‡è¯­éŸ³
- è‡ªåŠ¨åˆ†æ®µï¼šé•¿æ–‡æœ¬è‡ªåŠ¨åˆ†æ®µï¼Œé¿å…ä¸€æ¬¡è¿‡é•¿å¯¼è‡´å¤±è´¥
- æ— æŸæ‹¼æ¥ï¼šä½¿ç”¨ ffmpeg å°†åˆ†æ®µ WAV æ‹¼æ¥ä¸ºå®Œæ•´æ–‡ä»¶
- å¯é…ç½®è¯­é€Ÿã€è¯­è¨€ã€è®¾å¤‡ä¸è¯´è¯äºº
- è·¨å¹³å°ï¼šWindowsã€Linuxã€macOS

## ğŸš€ å®‰è£…

### ä½¿ç”¨ uvx (æ¨è)

```bash
docker run -d -p 127.0.0.1:9900:8888 kisaragi29/melotts:latest
uvx mcp-melotts@latest
```

### ä½¿ç”¨ pip

```bash
pip install mcp-melotts@latest
```

### ä»æºç å®‰è£…

```bash
git clone https://github.com/aardpro/mcp-melotts.git
cd mcp-melotts
pip install -e .
```

## âš™ï¸ é…ç½®

### é…ç½®

#### å‰ç½®æ¡ä»¶
å¼€å‘ç”µè„‘å·²å®‰è£…å¹¶å¯ç”¨ï¼š
- ffmpegï¼ˆç”¨äºæ‹¼æ¥éŸ³é¢‘ï¼‰
- MeloTTSï¼ˆå¯é€šè¿‡æœ¬åœ° Python åŒ… melo.api æˆ– Docker Gradio æœåŠ¡ï¼‰

#### å¯åŠ¨å‰æ£€æŸ¥
å¯ç”¨ MCP æ—¶ä¼šè‡ªåŠ¨æ£€æŸ¥ä»¥ä¸‹æ¡ä»¶ï¼š
- æœ¬æœº 9900 ç«¯å£æ˜¯å¦å¯åŠ¨äº† MeloTTS HTTP æœåŠ¡ï¼ˆç”¨äº HTTP æ¨¡å¼ï¼‰
- ç³»ç»Ÿæ˜¯å¦å¯è°ƒç”¨ ffmpegï¼ˆç”¨äºæ— æŸæ‹¼æ¥ï¼‰
ä»»ä¸€ä¸æ»¡è¶³å°†æŠ›å‡ºé”™è¯¯å¹¶ç»ˆæ­¢å¯åŠ¨

#### é…ç½®æ–‡ä»¶
å†…ç½®é…ç½®æ–‡ä»¶ä½äº src/main/config.jsonï¼Œå¯è®¾ç½®ï¼š
- defaultLanguageï¼šé»˜è®¤è¯­è¨€ä»£ç ï¼ˆZH/EN/JP/ESï¼‰
- defaultSpeedï¼šé»˜è®¤è¯­é€Ÿ
- defaultDeviceï¼šé»˜è®¤è®¾å¤‡ï¼ˆcpu æˆ– cuda:0ï¼‰
- defaultSpeakerï¼šé»˜è®¤è¯´è¯äººæ ‡ç­¾
- chunkSizeLimitï¼šåˆ†æ®µé•¿åº¦ä¸Šé™ï¼ˆæ¨è 100ï¼‰

### MCP å®¢æˆ·ç«¯é…ç½®

å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°ä½ çš„ MCP å®¢æˆ·ç«¯é…ç½®ä¸­ï¼ˆä¾‹å¦‚ Claude Desktop, Cursorï¼‰ï¼š

#### é€‰é¡¹ 1: ä½¿ç”¨ uvx 

```json
{
  "mcpServers": {
    "McpMeloTTS": {
      "command": "uvx",
      "args": ["mcp-melotts"]
    }
  }
}
```

#### é€‰é¡¹ 2: ä½¿ç”¨ pip

```json
{
  "mcpServers": {
    "McpMeloTTS": {
      "command": "mcp-melotts"
    }
  }
}
```

#### é€‰é¡¹ 3: Windows ç³»ç»Ÿ 

```json
{
  "mcpServers": {
    "McpMeloTTS": {
      "command": "cmd",
      "args": [
        "/c",
        "chcp 65001 >nul && uvx mcp-melotts"
      ]
    }
  }
}
```

#### é€‰é¡¹ 4: Linux/macOSï¼š

```json
{
  "mcpServers": {
    "McpMeloTTS": {
      "command": "python",
      "args": ["-m", "main"]
    }
  }
}
```

## ğŸ› ï¸ å¯ç”¨å·¥å…·

### `mcp_melotts_generate_audio`

å°†æ–‡æœ¬ç”Ÿæˆè¯­éŸ³æ–‡ä»¶ã€‚é€‚ç”¨äºâ€œæ ¹æ®æ–‡æœ¬ç”ŸæˆéŸ³é¢‘æ–‡ä»¶â€ç­‰è¯·æ±‚ã€‚æ”¯æŒè‡ªåŠ¨åˆ†æ®µä¸ ffmpeg æ— æŸæ‹¼æ¥ï¼Œæ”¯æŒä¸¤ç§è°ƒç”¨æ¨¡å¼ï¼šæœ¬åœ° melo.api ä¸ Docker Gradio HTTP æ¥å£ã€‚

**å‚æ•°:**
- `text` (string, å¿…å¡«): è¦è½¬æ¢ä¸ºè¯­éŸ³çš„æ–‡æœ¬
- `language` (string, å¯é€‰): è¯­è¨€ä»£ç ï¼ˆé»˜è®¤ ZHï¼‰
- `speaker` (string, å¯é€‰): è¯´è¯äººæ ‡ç­¾ï¼ˆé»˜è®¤ ZHï¼‰
- `speed` (number, å¯é€‰): è¯­é€Ÿï¼ˆé»˜è®¤ 1.0ï¼‰
- `device` (string, å¯é€‰): cpu æˆ– cuda:0ï¼ˆé»˜è®¤ cpuï¼‰
- `split_sentences` (boolean, å¯é€‰): æ˜¯å¦è‡ªåŠ¨åˆ†æ®µï¼ˆé»˜è®¤ trueï¼‰
- `output_dir` (string, å¿…å¡«): è¾“å‡ºç›®å½•
- `target_filename` (string, å¯é€‰): æœ€ç»ˆè¾“å‡ºæ–‡ä»¶åï¼Œé»˜è®¤æ—¶é—´æˆ³å‘½å
- `use_http_api` (boolean, å¯é€‰): æ˜¯å¦ä½¿ç”¨ Docker Gradio HTTP æ¥å£ï¼ˆé»˜è®¤ falseï¼‰
- `api_base_url` (string, å¯é€‰): HTTP æ¥å£åŸºç¡€åœ°å€ï¼ˆå¦‚ http://localhost:9900ï¼‰
- `fn_index` (number, å¯é€‰): Gradio å‡½æ•°ç´¢å¼•ï¼ˆé»˜è®¤ 1ï¼‰
- `session_hash` (string, å¯é€‰): Gradio ä¼šè¯å“ˆå¸Œï¼ˆä¸æä¾›åˆ™è‡ªåŠ¨ç”Ÿæˆï¼‰

**è°ƒç”¨ç¤ºä¾‹ï¼ˆæœ¬åœ° melo.api æ¨¡å¼ï¼‰:**

```json
{
  "name": "mcp_melotts_generate_audio",
  "arguments": {
    "text": "æˆ‘æœ€è¿‘åœ¨å­¦ä¹ machine learningï¼Œå¸Œæœ›èƒ½å¤Ÿåœ¨æœªæ¥çš„artificial intelligenceé¢†åŸŸæœ‰æ‰€å»ºæ ‘ã€‚",
    "language": "ZH",
    "speaker": "ZH",
    "speed": 1.0,
    "output_dir": "./audio"
  }
}
```

**è°ƒç”¨ç¤ºä¾‹ï¼ˆDocker Gradio HTTP æ¨¡å¼ï¼‰:**
```json
{
  "name": "mcp_melotts_generate_audio",
  "arguments": {
    "text": "è¯·å°†ä»¥ä¸‹å†…å®¹æœ—è¯»ä¸ºéŸ³é¢‘â€¦â€¦",
    "language": "ZH",
    "speed": 1.0,
    "output_dir": "./audio",
    "use_http_api": true,
    "api_base_url": "http://localhost:9900",
    "fn_index": 1
  }
}
```

> è¯´æ˜ï¼šHTTP æ¨¡å¼éœ€è¦å…ˆè¿è¡Œ Docker å®¹å™¨å¹¶å¼€æ”¾ 9900 ç«¯å£ï¼Œè„šæœ¬ä¼šé€šè¿‡ /queue/join ä¸ /queue/data ç›‘å¬ç”Ÿæˆè¿›åº¦å¹¶ä¸‹è½½éŸ³é¢‘ã€‚

## âš¡ å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒè¿è¡Œ
```bash
python -m venv .venv
.venv/Scripts/python.exe -m pip install -U pip
.venv/Scripts/pip.exe install -r requirements.txt
.venv/Scripts/python.exe -m main
```

### ä¸€é”®å¯åŠ¨ï¼ˆWindowsï¼‰
åŒå‡»æˆ–æ‰§è¡Œé¡¹ç›®æ ¹ç›®å½•çš„ start_server.batï¼Œå®ƒä¼šè‡ªåŠ¨åˆ›å»º .venvã€å®‰è£…ä¾èµ–å¹¶åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å¯åŠ¨ MCPã€‚

### ç”ŸæˆéŸ³é¢‘çš„æµ‹è¯•è„šæœ¬
```bash
.venv/Scripts/python.exe test-generate-audio.py --input test-text.txt --output-dir output --use-http-api --api-base-url http://localhost:9900
```
æ‰“å°çš„è·¯å¾„å³ç”Ÿæˆçš„ wav æ–‡ä»¶ï¼ˆå¦‚ output/1767514828_93829.wavï¼‰ã€‚


## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

é…ç½®å®Œæˆåï¼Œä½ å¯ä»¥ç›´æ¥è®© AI åŠ©æ‰‹ï¼š
- "å°†è¿™æ®µä¸­æ–‡ç”ŸæˆéŸ³é¢‘æ–‡ä»¶"
- "ç”¨æ—¥è¯­æœ—è¯»ä¸‹é¢è¿™æ®µæ–‡å­—ï¼Œè¯­é€Ÿç¨æ…¢"
- "æŠŠé•¿æ–‡æ‹†åˆ†ç”Ÿæˆè¯­éŸ³å¹¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶"

## ğŸ’» å¼€å‘

### è®¾ç½®å¼€å‘ç¯å¢ƒ

```bash
git clone https://github.com/aardpro/mcp-melotts.git
cd mcp-melotts
pip install -e ".[dev]"
```

### è¿è¡Œæµ‹è¯•

```bash
pytest
```

### æ„å»ºåŒ…

build && upload
```bash
rm -rf dist && pip install build && python -m build && pip install twine && twine upload dist/*
```

```bash
pip install build
python -m build
```

### å‘å¸ƒåˆ° PyPI

```bash
pip install twine
twine upload dist/*
```

## ä¿®æ”¹åçš„å‘å¸ƒæ­¥éª¤

å½“å¯¹é¡¹ç›®è¿›è¡Œä¿®æ”¹åï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å‘å¸ƒæ›´æ–°ç‰ˆæœ¬ï¼š

1. åœ¨ `pyproject.toml` ä¸­å¢åŠ ç‰ˆæœ¬å·
2. å®‰è£…æ„å»ºä¾èµ–ï¼š
   ```bash
   pip install build twine
   ```
3. æ„å»ºåŒ…ï¼š
   ```bash
   python -m build
   ```
4. æœ¬åœ°æµ‹è¯•æ„å»ºçš„åŒ…ï¼ˆå¯é€‰ä½†æ¨èï¼‰ï¼š
   ```bash
   pip install dist/mcp_melotts-*.whl
   ```
5. ä¸Šä¼ åˆ° PyPIï¼š
   ```bash
   twine upload dist/*
   ```

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
mcp-melotts/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ __main__.py
â”‚       â””â”€â”€ server.py
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ README.md
â””â”€â”€ LICENSE
```

## â“ å¸¸è§é—®é¢˜

### é…ç½®é—®é¢˜

è¯·ç¡®ä¿å·²å®‰è£… ffmpeg ä¸ MeloTTSï¼Œå¹¶èƒ½åœ¨ Python ä¸­å¯¼å…¥ melo.apiã€‚

### éŸ³é¢‘ç”Ÿæˆå¤±è´¥

å¦‚æœéŸ³é¢‘ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ˜¯å¦å·²æ­£ç¡®å®‰è£… MeloTTSï¼ˆPython åŒ… meloï¼‰
2. æ˜¯å¦å·²æ­£ç¡®è®¾ç½®è¯­è¨€ä¸è¯´è¯äººæ ‡ç­¾
3. ffmpeg æ˜¯å¦åœ¨ç³»ç»Ÿ PATH ä¸­å¯ç”¨

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼
