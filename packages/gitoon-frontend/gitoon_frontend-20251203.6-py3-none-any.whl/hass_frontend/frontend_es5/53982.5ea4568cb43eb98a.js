/*! For license information please see 53982.5ea4568cb43eb98a.js.LICENSE.txt */
"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["53982"],{29781:function(e,t,n){n.d(t,{$:function(){return D}});var a,r,i,s=n(44734),o=n(43080),c=n(69683),l=n(6454),h=n(25460),u=(n(69085),n(40445)),d=n(96592),p=n(77845),f=n(72153),_=n(12451),g=n(12130),v=n(84730),y=n(96196),m=n(94333),b=g.QQ?{passive:!0}:void 0,w=function(e){function t(){var e;return(0,s.A)(this,t),(e=(0,c.A)(this,t,arguments)).centerTitle=!1,e.handleTargetScroll=function(){e.mdcFoundation.handleTargetScroll()},e.handleNavigationClick=function(){e.mdcFoundation.handleNavigationClick()},e}return(0,l.A)(t,e),(0,o.A)(t,[{key:"scrollTarget",get:function(){return this._scrollTarget||window},set:function(e){this.unregisterScrollListener();var t=this.scrollTarget;this._scrollTarget=e,this.updateRootPosition(),this.requestUpdate("scrollTarget",t),this.registerScrollListener()}},{key:"updateRootPosition",value:function(){if(this.mdcRoot){var e=this.scrollTarget===window;this.mdcRoot.style.position=e?"":"absolute"}}},{key:"render",value:function(){var e=(0,y.qy)(a||(a=(0,f.A)(['<span class="mdc-top-app-bar__title"><slot name="title"></slot></span>'])));return this.centerTitle&&(e=(0,y.qy)(r||(r=(0,f.A)(['<section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-center">',"</section>"])),e)),(0,y.qy)(i||(i=(0,f.A)([' <header class="mdc-top-app-bar ','"> <div class="mdc-top-app-bar__row"> <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start" id="navigation"> <slot name="navigationIcon" @click="','"></slot> '," </section> ",' <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" id="actions" role="toolbar"> <slot name="actionItems"></slot> </section> </div> </header> <div class="','"> <slot></slot> </div> '])),(0,m.H)(this.barClasses()),this.handleNavigationClick,this.centerTitle?null:e,this.centerTitle?e:null,(0,m.H)(this.contentClasses()))}},{key:"createAdapter",value:function(){var e=this;return Object.assign(Object.assign({},(0,_.i)(this.mdcRoot)),{setStyle:function(t,n){return e.mdcRoot.style.setProperty(t,n)},getTopAppBarHeight:function(){return e.mdcRoot.clientHeight},notifyNavigationIconClicked:function(){e.dispatchEvent(new Event(v.P$.NAVIGATION_EVENT,{bubbles:!0,cancelable:!0}))},getViewportScrollY:function(){return e.scrollTarget instanceof Window?e.scrollTarget.pageYOffset:e.scrollTarget.scrollTop},getTotalActionItems:function(){return e._actionItemsSlot.assignedNodes({flatten:!0}).length}})}},{key:"registerListeners",value:function(){this.registerScrollListener()}},{key:"unregisterListeners",value:function(){this.unregisterScrollListener()}},{key:"registerScrollListener",value:function(){this.scrollTarget.addEventListener("scroll",this.handleTargetScroll,b)}},{key:"unregisterScrollListener",value:function(){this.scrollTarget.removeEventListener("scroll",this.handleTargetScroll)}},{key:"firstUpdated",value:function(){(0,h.A)(t,"firstUpdated",this,3)([]),this.updateRootPosition(),this.registerListeners()}},{key:"disconnectedCallback",value:function(){(0,h.A)(t,"disconnectedCallback",this,3)([]),this.unregisterListeners()}}])}(_.O);(0,u.__decorate)([(0,p.P)(".mdc-top-app-bar")],w.prototype,"mdcRoot",void 0),(0,u.__decorate)([(0,p.P)('slot[name="actionItems"]')],w.prototype,"_actionItemsSlot",void 0),(0,u.__decorate)([(0,p.MZ)({type:Boolean})],w.prototype,"centerTitle",void 0),(0,u.__decorate)([(0,p.MZ)({type:Object})],w.prototype,"scrollTarget",null);var k=function(e){function t(){var e;return(0,s.A)(this,t),(e=(0,c.A)(this,t,arguments)).mdcFoundationClass=d.A,e.prominent=!1,e.dense=!1,e.handleResize=function(){e.mdcFoundation.handleWindowResize()},e}return(0,l.A)(t,e),(0,o.A)(t,[{key:"barClasses",value:function(){return{"mdc-top-app-bar--dense":this.dense,"mdc-top-app-bar--prominent":this.prominent,"center-title":this.centerTitle}}},{key:"contentClasses",value:function(){return{"mdc-top-app-bar--fixed-adjust":!this.dense&&!this.prominent,"mdc-top-app-bar--dense-fixed-adjust":this.dense&&!this.prominent,"mdc-top-app-bar--prominent-fixed-adjust":!this.dense&&this.prominent,"mdc-top-app-bar--dense-prominent-fixed-adjust":this.dense&&this.prominent}}},{key:"registerListeners",value:function(){(0,h.A)(t,"registerListeners",this,3)([]),window.addEventListener("resize",this.handleResize,b)}},{key:"unregisterListeners",value:function(){(0,h.A)(t,"unregisterListeners",this,3)([]),window.removeEventListener("resize",this.handleResize)}}])}(w);(0,u.__decorate)([(0,p.MZ)({type:Boolean,reflect:!0})],k.prototype,"prominent",void 0),(0,u.__decorate)([(0,p.MZ)({type:Boolean,reflect:!0})],k.prototype,"dense",void 0);var A=n(23665),D=function(e){function t(){var e;return(0,s.A)(this,t),(e=(0,c.A)(this,t,arguments)).mdcFoundationClass=A.A,e}return(0,l.A)(t,e),(0,o.A)(t,[{key:"barClasses",value:function(){return Object.assign(Object.assign({},(0,h.A)(t,"barClasses",this,3)([])),{"mdc-top-app-bar--fixed":!0})}},{key:"registerListeners",value:function(){this.scrollTarget.addEventListener("scroll",this.handleTargetScroll,b)}},{key:"unregisterListeners",value:function(){this.scrollTarget.removeEventListener("scroll",this.handleTargetScroll)}}])}(k)},27330:function(e,t,n){var a,r=n(72153),i=n(43080),s=n(44734),o=n(69683),c=n(6454),l=(n(28706),n(40445)),h=n(29781),u=n(71467),d=n(96196),p=n(77845),f=function(e){function t(){var e;(0,s.A)(this,t);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=(0,o.A)(this,t,[].concat(a))).narrow=!1,e}return(0,c.A)(t,e),(0,i.A)(t)}(h.$);f.styles=[u.R,(0,d.AH)(a||(a=(0,r.A)(["header{padding-top:var(--safe-area-inset-top)}.mdc-top-app-bar__row{height:var(--header-height);border-bottom:var(--app-header-border-bottom)}.mdc-top-app-bar--fixed-adjust{padding-top:calc(var(--header-height,0px) + var(--safe-area-inset-top,0px));padding-bottom:var(--safe-area-inset-bottom);padding-right:var(--safe-area-inset-right)}:host([narrow]) .mdc-top-app-bar--fixed-adjust{padding-left:var(--safe-area-inset-left)}.mdc-top-app-bar{--mdc-typography-headline6-font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,var(--mdc-theme-on-primary,#fff));background-color:var(--app-header-background-color,var(--mdc-theme-primary));padding-top:var(--safe-area-inset-top);padding-right:var(--safe-area-inset-right)}:host([narrow]) .mdc-top-app-bar{padding-left:var(--safe-area-inset-left)}.mdc-top-app-bar__title{font-size:var(--ha-font-size-xl);padding-inline-start:24px;padding-inline-end:initial}"])))],(0,l.__decorate)([(0,p.MZ)({type:Boolean,reflect:!0})],f.prototype,"narrow",void 0),f=(0,l.__decorate)([(0,p.EM)("ha-top-app-bar-fixed")],f)},4203:function(e,t,n){n.a(e,async function(e,a){try{n.r(t),n.d(t,{DEFAULT_ENERGY_COLLECTION_KEY:function(){return T}});var r,i,s,o,c=n(72153),l=n(78261),h=n(61397),u=n(50264),d=n(44734),p=n(43080),f=n(69683),_=n(6454),g=n(25460),v=(n(28706),n(2008),n(23418),n(74423),n(23792),n(62062),n(44114),n(26910),n(13609),n(18111),n(22489),n(7588),n(61701),n(13579),n(2892),n(69085),n(5506),n(26099),n(16034),n(3362),n(38781),n(31415),n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698),n(21699),n(47764),n(23500),n(62953),n(3296),n(27208),n(48408),n(14603),n(47566),n(98721),n(40445)),y=n(96196),m=n(77845),b=n(91926),w=(n(38962),n(90248),n(2054),n(27330),n(38114)),k=n(14503),A=n(33668),D=n(73887),C=n(29994),x=n(53019),E=(n(87778),e([D,C,x,w]));[D,C,x,w]=E.then?(await E)():E;var T="energy_dashboard",z={energy_sources:[],device_consumption:[],device_consumption_water:[]},O={path:"overview",strategy:{type:"energy-overview",collection_key:T}},L={path:"electricity",strategy:{type:"energy",collection_key:T}},S={path:"water",strategy:{type:"water",collection_key:T}},R={path:"gas",strategy:{type:"gas",collection_key:T}},M={path:"now",strategy:{type:"power",collection_key:"energy_dashboard_now"}},P={type:"panel",path:"setup",cards:[{type:"custom:energy-setup-wizard-card"}]},j=function(e){function t(){var e;(0,d.A)(this,t);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=(0,f.A)(this,t,[].concat(a))).narrow=!1,e._fetchEnergyPrefs=(0,u.A)((0,h.A)().m(function t(){var n,a;return(0,h.A)().w(function(t){for(;;)switch(t.p=t.n){case 0:return n=(0,w.tb)(e.hass,{key:T}),t.p=1,t.n=2,n.refresh();case 2:t.n=5;break;case 3:if(t.p=3,"not_found"!==(a=t.v).code){t.n=4;break}return t.a(2,void 0);case 4:throw a;case 5:return t.a(2,n.prefs)}},t,null,[[1,3]])})),e._dumpCSV=(0,u.A)((0,h.A)().m(function t(){var n,a,r,i,s,o,c,u,d,p,f,_,g,v,y,m,b,k,D,C,x,E,T,z,O,L,S,R,M,P,j,N,U,q,I,Z,F,H,B;return(0,h.A)().w(function(t){for(;;)switch(t.n){case 0:if((n=(0,w.tb)(e.hass,{key:"energy_dashboard"})).prefs&&n.state.stats){t.n=1;break}return t.a(2);case 1:a=n.state.gasUnit,r="kWh",i=n.prefs.energy_sources,s=n.prefs.device_consumption,o=n.prefs.device_consumption_water,c=n.state.stats,u=new Set,Object.values(c).forEach(function(e){e.forEach(function(e){u.add(e.start)})}),d=Array.from(u).sort(),p="entity_id,type,unit,"+d.map(function(e){return new Date(e).toISOString()}).join(",")+"\n",(f=[])[0]=p,_=function(e,t,n,a){var r=0,i=[];i.push(e),i.push(t),i.push(n.normalize("NFKD")),d.forEach(function(e){var t;r<a.length&&a[r].start===e?(i.push((null!==(t=a[r].change)&&void 0!==t?t:"").toString()),r++):i.push("")}),f.push(i.join(",")+"\n")},g=function(e,t,n){c[e]&&_(e,t,n,c[e])},v=e.hass.config.currency,y=function(e,t,n,a,r){t.length&&(t.forEach(function(t){return g(t,e,n)}),a&&r&&r.forEach(function(e){return g(e,a,v)}))},m=[],b=[],k=[],D=[],i.filter(function(e){return"grid"===e.type}).forEach(function(e){e.flow_from.forEach(function(e){var t=e.stat_energy_from;m.push(t);var a=e.stat_cost||n.state.info.cost_sensors[t];a&&k.push(a)}),e.flow_to.forEach(function(e){var t=e.stat_energy_to;b.push(t);var a=e.stat_compensation||n.state.info.cost_sensors[t];a&&D.push(a)})}),y("grid_consumption",m,r,"grid_consumption_cost",k),y("grid_return",b,r,"grid_return_compensation",D),C=[],x=[],i.filter(function(e){return"battery"===e.type}).forEach(function(e){C.push(e.stat_energy_to),x.push(e.stat_energy_from)}),y("battery_in",C,r),y("battery_out",x,r),E=[],i.filter(function(e){return"solar"===e.type}).forEach(function(e){E.push(e.stat_energy_from)}),y("solar_production",E,r),T=[],z=[],i.filter(function(e){return"gas"===e.type}).forEach(function(e){var t=e.stat_energy_from;T.push(t);var a=e.stat_cost||n.state.info.cost_sensors[t];a&&z.push(a)}),y("gas_consumption",T,a,"gas_consumption_cost",z),O=[],L=[],i.filter(function(e){return"water"===e.type}).forEach(function(e){var t=e.stat_energy_from;O.push(t);var a=e.stat_cost||n.state.info.cost_sensors[t];a&&L.push(a)}),y("water_consumption",O,n.state.waterUnit,"water_consumption_cost",L),S=[],s.forEach(function(e){S.push(e.stat_consumption)}),y("device_consumption",S,r),o&&(R=[],o.forEach(function(e){R.push(e.stat_consumption)}),y("device_consumption_water",R,n.state.waterUnit)),M=(0,w.gv)(n.state),P=M.summedData,M.compareSummedData,j=(0,w.DR)(P,void 0),N=j.consumption,j.compareConsumption,U=function(e,t,n){var a=[];Object.entries(n).forEach(function(e){var t=(0,l.A)(e,2),n=t[0],r=t[1];a.push({start:Number(n),end:NaN,change:r})}),_("",e,t,a)},q=!!E.length,I=!!C.length,Z=!!b.length,(F=!!m.length)&&(U("calculated_consumed_grid",r,N.used_grid),I&&U("calculated_grid_to_battery",r,N.grid_to_battery)),Z&&I&&U("calculated_battery_to_grid",r,N.battery_to_grid),I&&U("calculated_consumed_battery",r,N.used_battery),q&&(U("calculated_consumed_solar",r,N.used_solar),I&&U("calculated_solar_to_battery",r,N.solar_to_battery),Z&&U("calculated_solar_to_grid",r,N.solar_to_grid)),(F?1:0)+(q?1:0)+(I?1:0)>1&&U("calculated_total_consumption",r,N.used_total),H=new Blob(f,{type:"text/csv"}),B=window.URL.createObjectURL(H),(0,A.R)(B,"energy.csv");case 2:return t.a(2)}},t)})),e}return(0,_.A)(t,e),(0,p.A)(t,[{key:"_extraActionItems",get:function(){return[{icon:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z",labelKey:"ui.panel.energy.download_data",action:this._dumpCSV}]}},{key:"willUpdate",value:function(e){if((0,g.A)(t,"willUpdate",this,3)([e]),!this.hasUpdated)return this.hass.loadFragmentTranslation("lovelace"),void this._loadConfig();if(e.has("hass")){var n=e.get("hass");n&&n.localize!==this.hass.localize&&this._setLovelace()}}},{key:"_loadConfig",value:(m=(0,u.A)((0,h.A)().m(function e(){var t,n,a,r,i,s;return(0,h.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,this._error=void 0,e.n=1,this._fetchEnergyPrefs();case 1:n=e.v,this._prefs=n||z,e.n=3;break;case 2:e.p=2,s=e.v,console.error("Failed to load prefs:",s),this._prefs=z,this._error=s.message||"Unknown error";case 3:return e.n=4,this._setLovelace();case 4:a=(null===(t=this._lovelace.config)||void 0===t?void 0:t.views)||[],r=a.map(function(e){return e.path}),(i=this.route.path.split("/")[1])&&r.includes(i)?this.route=Object.assign({},this.route):(0,b.o)("".concat(this.route.prefix,"/").concat(r[0]));case 5:return e.a(2)}},e,this,[[0,2]])})),function(){return m.apply(this,arguments)})},{key:"_setLovelace",value:(v=(0,u.A)((0,h.A)().m(function e(){var t,n=this;return(0,h.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._generateLovelaceConfig();case 1:t=e.v,this._lovelace={config:t,rawConfig:t,editMode:!1,urlPath:"energy",mode:"generated",locale:this.hass.locale,enableFullEditMode:function(){},saveConfig:function(){var e=(0,u.A)((0,h.A)().m(function e(){return(0,h.A)().w(function(e){for(;;)if(0===e.n)return e.a(2,void 0)},e)}));return function(){return e.apply(this,arguments)}}(),deleteConfig:function(){var e=(0,u.A)((0,h.A)().m(function e(){return(0,h.A)().w(function(e){for(;;)if(0===e.n)return e.a(2,void 0)},e)}));return function(){return e.apply(this,arguments)}}(),setEditMode:function(){return n._navigateConfig()},showToast:function(){}};case 2:return e.a(2)}},e,this)})),function(){return v.apply(this,arguments)})},{key:"render",value:function(){return this._error?(0,y.qy)(r||(r=(0,c.A)([' <div class="centered"> <ha-alert alert-type="error"> An error occurred loading energy preferences: '," </ha-alert> </div> "])),this._error):this._prefs?this._lovelace?(0,y.qy)(s||(s=(0,c.A)([' <hui-root .hass="','" .narrow="','" .lovelace="','" .route="','" .panel="','" .extraActionItems="','" @reload-energy-panel="','"></hui-root> '])),this.hass,this.narrow,this._lovelace,this.route,this.panel,this._extraActionItems,this._reloadConfig):y.s6:(0,y.qy)(i||(i=(0,c.A)([' <div class="centered"> <ha-spinner size="large"></ha-spinner> </div> '])))}},{key:"_generateLovelaceConfig",value:(a=(0,u.A)((0,h.A)().m(function e(){var t,a,r,i,s,o,c,l=this;return(0,h.A)().w(function(e){for(;;)switch(e.n){case 0:if(this._prefs&&(0!==this._prefs.device_consumption.length||0!==this._prefs.energy_sources.length)){e.n=2;break}return e.n=1,Promise.all([n.e("71380"),n.e("86236")]).then(n.bind(n,97431));case 1:return e.a(2,{views:[P]});case 2:return a=this._prefs.energy_sources.some(function(e){return["grid","solar","battery"].includes(e.type)}),r=this._prefs.energy_sources.some(function(e){var t;return"solar"===e.type&&e.stat_rate||"battery"===e.type&&e.stat_rate||"grid"===e.type&&(null===(t=e.power)||void 0===t?void 0:t.length)})||this._prefs.device_consumption.some(function(e){return e.stat_rate}),i=this._prefs.energy_sources.some(function(e){return"water"===e.type})||(null===(t=this._prefs.device_consumption_water)||void 0===t?void 0:t.length)>0,s=this._prefs.energy_sources.some(function(e){return"gas"===e.type}),o=this._prefs.device_consumption.length>0,c=[],(a||o)&&c.push(L),s&&c.push(R),i&&c.push(S),r&&c.push(M),c.length>1&&c.unshift(O),e.a(2,{views:c.map(function(e){return Object.assign(Object.assign({},e),{},{title:e.title||l.hass.localize("ui.panel.energy.title.".concat(e.path))})})})}},e,this)})),function(){return a.apply(this,arguments)})},{key:"_navigateConfig",value:function(e){null==e||e.stopPropagation(),(0,b.o)("/config/energy?historyBack=1")}},{key:"_reloadConfig",value:function(){this._loadConfig()}}],[{key:"styles",get:function(){return[k.RF,(0,y.AH)(o||(o=(0,c.A)([":host{--ha-view-sections-column-max-width:100%;-ms-user-select:none;-webkit-user-select:none;-moz-user-select:none}.toolbar{height:var(--header-height);display:flex;flex:1;align-items:center;font-size:var(--ha-font-size-xl);padding:0px 12px;font-weight:var(--ha-font-weight-normal);box-sizing:border-box}:host([narrow]) .toolbar{padding:0 4px}.main-title{margin:var(--margin-title);line-height:var(--ha-line-height-normal);flex-grow:1}.centered{width:100%;height:100%;display:flex;align-items:center;justify-content:center}"])))]}}]);var a,v,m}(y.WF);(0,v.__decorate)([(0,m.MZ)({attribute:!1})],j.prototype,"hass",void 0),(0,v.__decorate)([(0,m.MZ)({type:Boolean,reflect:!0})],j.prototype,"narrow",void 0),(0,v.__decorate)([(0,m.MZ)({attribute:!1})],j.prototype,"panel",void 0),(0,v.__decorate)([(0,m.wk)()],j.prototype,"_lovelace",void 0),(0,v.__decorate)([(0,m.MZ)({attribute:!1})],j.prototype,"route",void 0),(0,v.__decorate)([(0,m.wk)()],j.prototype,"_prefs",void 0),(0,v.__decorate)([(0,m.wk)()],j.prototype,"_error",void 0),j=(0,v.__decorate)([(0,m.EM)("ha-panel-energy")],j),a()}catch(N){a(N)}})},73887:function(e,t,n){n.a(e,async function(e,t){try{var a,r,i,s,o=n(78261),c=n(72153),l=n(61397),h=n(50264),u=n(44734),d=n(43080),p=n(69683),f=n(6454),_=n(25460),g=n(69235),v=(n(28706),n(26099),n(40445)),y=n(6946),m=n(78016),b=n(31810),w=n(49134),k=n(35932),A=n(73983),D=n(52640),C=n(69137),x=n(55144),E=n(40600),T=n(96196),z=n(77845),O=n(22786),L=n(91069),S=n(380),R=n(72487),M=n(9899),P=(n(13416),n(18350)),j=(n(58349),n(15397)),N=(n(3059),n(45100),n(38114)),U=n(54706),q=n(46223),I=e([g,P,j,R,S,q,L,N]);[g,P,j,R,S,q,L,N]=I.then?(await I)():I;var Z=["today","yesterday","this_week","this_month","this_quarter","this_year","now-7d","now-30d","now-12m"],F=function(e){function t(){var e;(0,u.A)(this,t);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=(0,p.A)(this,t,[].concat(a))).allowCompare=!0,e._ranges={},e._compare=!1,e._simpleRange=(0,O.A)(function(e,t,n,a){if(0===(0,y.c)(t,e))return"day";if((0,L.xo)(e,m.e,n,a)&&(0,L.xo)(t,b.c,n,a)){if(0===(0,L.EO)(t,e,w.W,n,a))return"month";if(2===(0,L.EO)(t,e,w.W,n,a)&&e.getMonth()%3==0)return"quarter"}return(0,L.xo)(e,m.e,n,a)&&(0,L.xo)(t,b.c,n,a)&&11===(0,L.EO)(t,e,w.W,n,a)?"year":"other"}),e}return(0,f.A)(t,e),(0,d.A)(t,[{key:"hassSubscribe",value:function(){var e=this;return[(0,N.tb)(this.hass,{key:this.collectionKey}).subscribe(function(t){return e._updateDates(t)})]}},{key:"_measure",value:function(){this.narrow=this.offsetWidth<450}},{key:"_attachObserver",value:(n=(0,h.A)((0,l.A)().m(function e(){var t=this;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:this._resizeObserver||(this._resizeObserver=new ResizeObserver((0,M.s)(function(){return t._measure()},250,!1))),this._resizeObserver.observe(this);case 1:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"firstUpdated",value:function(){this._attachObserver()}},{key:"connectedCallback",value:function(){var e=this;(0,_.A)(t,"connectedCallback",this,3)([]),this.updateComplete.then(function(){return e._attachObserver()})}},{key:"disconnectedCallback",value:function(){(0,_.A)(t,"disconnectedCallback",this,3)([]),this._resizeObserver&&this._resizeObserver.disconnect()}},{key:"willUpdate",value:function(e){var n,a,r=this;(0,_.A)(t,"willUpdate",this,3)([e]),this.hasUpdated||this._measure(),(!this.hasUpdated||e.has("hass")&&(null===(n=this.hass)||void 0===n?void 0:n.localize)!==(null===(a=e.get("hass"))||void 0===a?void 0:a.localize))&&(this._ranges={},Z.forEach(function(e){r._ranges[r.hass.localize("ui.components.date-range-picker.ranges.".concat(e))]=(0,q.b)(r.hass,e)}))}},{key:"render",value:function(){if(!this.hass||!this._startDate)return T.s6;var e=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config);return(0,T.qy)(a||(a=(0,c.A)([' <div class="row"> <div class="label"> ',' </div> <div class="time-handle"> <ha-icon-button-prev .label="','" @click="','"></ha-icon-button-prev> <ha-icon-button-next .label="','" @click="','"></ha-icon-button-next> <ha-date-range-picker .hass="','" .startDate="','" .endDate="','" .ranges="','" @value-changed="','" @preset-selected="','" minimal header-position></ha-date-range-picker> </div> ',' <ha-button-menu> <ha-icon-button slot="trigger" .label="','" .path="','"></ha-icon-button> ',' <slot name="overflow-menu"></slot> </ha-button-menu> </div> '])),"day"===e?this.narrow?(0,R.kz)(this._startDate,this.hass.locale,this.hass.config):(0,R.Yq)(this._startDate,this.hass.locale,this.hass.config):"month"===e?(0,R.fr)(this._startDate,this.hass.locale,this.hass.config):"year"===e?(0,R.Pm)(this._startDate,this.hass.locale,this.hass.config):"".concat((0,R.sl)(this._startDate,this.hass.locale,this.hass.config)," â€“ ").concat((0,R.sl)(this._endDate||new Date,this.hass.locale,this.hass.config)),this.hass.localize("ui.panel.lovelace.components.energy_period_selector.previous"),this._pickPrevious,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.next"),this._pickNext,this.hass,this._startDate,this._endDate||new Date,this._ranges,this._dateRangeChanged,this._presetSelected,this.narrow?T.s6:(0,T.qy)(r||(r=(0,c.A)(['<ha-button appearance="filled" size="small" @click="','"> '," </ha-button>"])),this._pickNow,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.now")),this.hass.localize("ui.common.menu"),"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",this.allowCompare?(0,T.qy)(i||(i=(0,c.A)(['<ha-check-list-item left @request-selected="','" .selected="','"> '," </ha-check-list-item>"])),this._toggleCompare,this._compare,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.compare")):T.s6)}},{key:"_updateCollectionPeriod",value:function(){var e=(0,N.tb)(this.hass,{key:this.collectionKey});e.setPeriod(this._startDate,this._endDate),e.refresh()}},{key:"_dateRangeChanged",value:function(e){this._startDate=(0,L.ol)(e.detail.value.startDate,k.o,this.hass.locale,this.hass.config),this._endDate=(0,L.ol)(e.detail.value.endDate,A.D,this.hass.locale,this.hass.config),this._updateCollectionPeriod()}},{key:"_presetSelected",value:function(e){localStorage.setItem("energy-default-period-_".concat(this.collectionKey||"energy"),Z[e.detail.index])}},{key:"_pickNow",value:function(){if(this._startDate){var e=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config),t=new Date;if("month"===e){var n=(0,q.b)(this.hass,"this_month"),a=(0,o.A)(n,2);this._startDate=a[0],this._endDate=a[1]}else if("quarter"===e){var r=(0,q.b)(this.hass,"this_quarter"),i=(0,o.A)(r,2);this._startDate=i[0],this._endDate=i[1]}else if("year"===e){var s=(0,q.b)(this.hass,"this_year"),c=(0,o.A)(s,2);this._startDate=c[0],this._endDate=c[1]}else{var l=(0,S.P)(this.hass.locale),h=(0,L.ol)(this._endDate,D.k,this.hass.locale,this.hass.config,{weekStartsOn:l}),u=(0,L.ol)(this._endDate,C.$,this.hass.locale,this.hass.config,{weekStartsOn:l});if(this._startDate.getTime()===h.getTime()&&this._endDate.getTime()===u.getTime()){var d=(0,q.b)(this.hass,"this_week"),p=(0,o.A)(d,2);this._startDate=p[0],this._endDate=p[1]}else{var f=(0,L.EO)(this._endDate,this._startDate,y.c,this.hass.locale,this.hass.config);this._startDate=(0,L.ol)((0,L.ol)(t,x.e,this.hass.locale,this.hass.config,f),k.o,this.hass.locale,this.hass.config,{weekStartsOn:l}),this._endDate=(0,L.ol)(t,A.D,this.hass.locale,this.hass.config,{weekStartsOn:l})}}this._updateCollectionPeriod()}}},{key:"_pickPrevious",value:function(){this._shift(!1)}},{key:"_pickNext",value:function(){this._shift(!0)}},{key:"_shift",value:function(e){if(this._startDate){var t=(0,L.eE)(this._startDate,this._endDate,e,this.hass.locale,this.hass.config),n=t.start,a=t.end;this._startDate=n,this._endDate=a,this._updateCollectionPeriod()}}},{key:"_updateDates",value:function(e){this._compare=void 0!==e.startCompare,this._startDate=e.start,this._endDate=e.end||(0,E.o)()}},{key:"_toggleCompare",value:function(e){if("interaction"===e.detail.source){this._compare=e.detail.selected;var t=(0,N.tb)(this.hass,{key:this.collectionKey});t.setCompare(this._compare?N.lh.PREVIOUS:N.lh.NONE),t.refresh()}}}]);var n}((0,U.E)(T.WF));F.styles=(0,T.AH)(s||(s=(0,c.A)([".row{display:flex;align-items:center}:host .time-handle{display:flex;justify-content:flex-end;align-items:center}:host([narrow]) .time-handle{margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}.label{display:flex;align-items:center;justify-content:flex-end;font-size:var(--ha-font-size-xl);margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}:host([narrow]) .label{margin-left:unset;margin-inline-start:unset;margin-inline-end:initial}ha-button{margin-left:8px;margin-inline-start:8px;margin-inline-end:initial;flex-shrink:0;--ha-button-theme-color:currentColor}"]))),(0,v.__decorate)([(0,z.MZ)({attribute:!1})],F.prototype,"hass",void 0),(0,v.__decorate)([(0,z.MZ)({attribute:"collection-key"})],F.prototype,"collectionKey",void 0),(0,v.__decorate)([(0,z.MZ)({type:Boolean,reflect:!0})],F.prototype,"narrow",void 0),(0,v.__decorate)([(0,z.MZ)({type:Boolean,attribute:"allow-compare"})],F.prototype,"allowCompare",void 0),(0,v.__decorate)([(0,z.wk)()],F.prototype,"_startDate",void 0),(0,v.__decorate)([(0,z.wk)()],F.prototype,"_endDate",void 0),(0,v.__decorate)([(0,z.wk)()],F.prototype,"_ranges",void 0),(0,v.__decorate)([(0,z.wk)()],F.prototype,"_compare",void 0),F=(0,v.__decorate)([(0,z.EM)("hui-energy-period-selector")],F),t()}catch(H){t(H)}})},33668:function(e,t,n){n.d(t,{h:function(){return i},R:function(){return r}});var a=n(37177),r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=document.createElement("a");n.target="_blank",n.href=e,n.download=t,n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click")),document.body.removeChild(n)},i=function(e){var t;return!function(e){return!!e.auth.external&&a.n}(e)||!(null===(t=e.auth.external)||void 0===t||!t.config.downloadFileSupported)}},37177:function(e,t,n){n.d(t,{n:function(){return a}});n(27495),n(90906);var a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},50778:function(e,t,n){var a=n(46518),r=n(77240);a({target:"String",proto:!0,forced:n(23061)("link")},{link:function(e){return r(this,"a","href",e)}})},56434:function(e,t,n){n.d(t,{e:function(){return r}});var a=n(81977);function r(e,t,n){return(0,a.P)(e,12*t,n)}},40600:function(e,t,n){n.d(t,{o:function(){return r}});var a=n(73983);function r(e){return(0,a.D)(Date.now(),e)}}}]);
//# sourceMappingURL=53982.5ea4568cb43eb98a.js.map