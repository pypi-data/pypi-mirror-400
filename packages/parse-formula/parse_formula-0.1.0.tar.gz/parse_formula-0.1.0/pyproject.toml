[build-system]
requires = ["uv_build>=0.9.22,<0.10.0"]
build-backend = "uv_build"

[project]
name = "parse-formula"
version = "0.1.0"
description = "Chemical formula parser for Python"
readme = "README.md"
license = "MIT"
authors = [
  { name = "Takumasa Nakamura", email = "n.takumasa@gmail.com" },
]
requires-python = ">=3.8"
classifiers = [
  "Operating System :: OS Independent",
  "Programming Language :: Python",
  "Programming Language :: Python :: 3.8",
  "Programming Language :: Python :: 3.9",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12",
  "Programming Language :: Python :: 3.13",
  "Programming Language :: Python :: 3.14",
  "Programming Language :: Python :: Implementation :: CPython",
  "Topic :: Scientific/Engineering :: Chemistry",
  "Topic :: Scientific/Engineering :: Physics",
]
urls.Source = "https://github.com/n-takumasa/py-parse-formula"

dependencies = [
  "importlib-resources>=5.0 ; python_full_version < '3.9'",
  "lark>=1.3.1",
]

[dependency-groups]
dev = [
  "pytest>=8.3.5",
  "pytest-cov>=5.0.0",
  "ruff>=0.14.10",
  "tox>=4.25.0",
  "tox-uv>=1.13.1",
  "ty>=0.0.9",
]
test = [
  "pytest>=8.3.5",
]

[tool.pytest.ini_options]
minversion = "6.0"
testpaths = ["tests"]
log_cli_level = "INFO"
xfail_strict = true
addopts = [
  "-ra",
  "--strict-config",
  "--strict-markers",
]
filterwarnings = ["error"]

[tool.coverage]
run.source_pkgs = ["parse_formula", "tests"]
run.branch = true
run.parallel = true
report.exclude_lines = [
  "no cov",
  "if __name__ == .__main__.:",
  "if TYPE_CHECKING:",
  "@overload",
]

[tool.ruff]
line-length = 88
lint.extend-select = [
  "B",  # flake8-bugbear
  "I",  # isort
  "UP", # pyupgrade
]
format.docstring-code-format = true

[tool.tox]
requires = [
  "tox>=4.21",
  "tox-uv",
]
env_list = [
  "3.14",
  "3.13",
  "3.12",
  "3.11",
  "3.10",
  "3.9",
  "3.8",
]

[tool.tox.env_run_base]
package = "wheel"
wheel_build_env = ".pkg"
dependency_groups = ["test"]
commands = [
  ["pytest", { replace = "posargs", default = [], extend = true }],
]
