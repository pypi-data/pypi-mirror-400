var ge=Object.defineProperty;var s=(d,a)=>ge(d,"name",{value:a,configurable:!0});import{defineComponent as E,mergeModels as ee,useModel as y,ref as V,onMounted as H,onUnmounted as K,resolveDirective as N,openBlock as r,createElementBlock as b,createVNode as w,unref as e,withCtx as C,withDirectives as M,createElementVNode as n,normalizeClass as T,vShow as J,computed as z,createBlock as U,createCommentVNode as _,Fragment as Y,renderList as Z,createTextVNode as le,toDisplayString as q,withModifiers as L,Transition as ve,isRef as A}from"vue";import D from"primevue/button";import ie from"primevue/slider";import{u as X,t as Q,d as se,c8 as me,l as fe,c9 as he,ca as xe,r as be,cb as ke}from"./index-6STX4Oia.js";import ae from"primevue/select";const we={class:"relative show-slider"},ye={class:"absolute top-0 left-12 rounded-lg bg-black/50 p-4 shadow-lg w-[150px]"},de=E({__name:"PopupSlider",props:ee({icon:{default:"pi-expand"},tooltipText:{},min:{default:10},max:{default:150},step:{default:1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(d){const a=y(d,"modelValue"),o=V(!1),t=s(()=>{o.value=!o.value},"toggleSlider"),i=s(u=>{u.target.closest(".show-slider")||(o.value=!1)},"closeSlider");return H(()=>{document.addEventListener("click",i)}),K(()=>{document.removeEventListener("click",i)}),(u,g)=>{const v=N("tooltip");return r(),b("div",we,[w(e(D),{class:"p-button-rounded p-button-text",onClick:t},{default:C(()=>[M(n("i",{class:T(["pi",u.icon,"text-lg text-white"])},null,2),[[v,{value:u.tooltipText,showDelay:300},void 0,{right:!0}]])]),_:1}),M(n("div",ye,[w(e(ie),{modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=p=>a.value=p),class:"w-full",min:u.min,max:u.max,step:u.step},null,8,["modelValue","min","max","step"])],512),[[J,o.value]])])}}}),Ce={class:"flex flex-col"},Me={class:T(["pi","pi-camera","text-lg text-white"])},_e=E({__name:"CameraControls",props:{cameraType:{},cameraTypeModifiers:{},fov:{},fovModifiers:{}},emits:["update:cameraType","update:fov"],setup(d){const a=y(d,"cameraType"),o=y(d,"fov"),t=z(()=>a.value==="perspective"),i=s(()=>{a.value=a.value==="perspective"?"orthographic":"perspective"},"switchCamera");return(u,g)=>{const v=N("tooltip");return r(),b("div",Ce,[w(e(D),{class:"p-button-rounded p-button-text",onClick:i},{default:C(()=>[M(n("i",Me,null,512),[[v,{value:u.$t("load3d.switchCamera"),showDelay:300},void 0,{right:!0}]])]),_:1}),t.value?(r(),U(de,{key:0,modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=p=>o.value=p),"tooltip-text":u.$t("load3d.fov")},null,8,["modelValue","tooltip-text"])):_("",!0)])}}}),$e={class:"flex flex-col"},De={class:"show-export-formats relative"},Re={class:"pi pi-download text-lg text-white"},Ie={class:"absolute top-0 left-12 rounded-lg bg-black/50 shadow-lg"},Le={class:"flex flex-col"},Se=E({__name:"ExportControls",emits:["exportModel"],setup(d,{emit:a}){const o=a,t=V(!1),i=[{label:"GLB",value:"glb"},{label:"OBJ",value:"obj"},{label:"STL",value:"stl"}],u=s(()=>{t.value=!t.value},"toggleExportFormats"),g=s(p=>{o("exportModel",p),t.value=!1},"exportModel"),v=s(p=>{p.target.closest(".show-export-formats")||(t.value=!1)},"closeExportFormatsList");return H(()=>{document.addEventListener("click",v)}),K(()=>{document.removeEventListener("click",v)}),(p,h)=>{const l=N("tooltip");return r(),b("div",$e,[n("div",De,[w(e(D),{class:"p-button-rounded p-button-text",onClick:u},{default:C(()=>[M(n("i",Re,null,512),[[l,{value:p.$t("load3d.exportModel"),showDelay:300},void 0,{right:!0}]])]),_:1}),M(n("div",Ie,[n("div",Le,[(r(),b(Y,null,Z(i,x=>w(e(D),{key:x.value,class:"p-button-text text-white",onClick:s(R=>g(x.value),"onClick")},{default:C(()=>[le(q(x.label),1)]),_:2},1032,["onClick"])),64))])],512),[[J,t.value]])])])}}}),Ue={class:"flex flex-col"},Be={key:0,class:"show-light-intensity relative"},Ve={class:"pi pi-sun text-lg text-white"},Ee={class:"absolute top-0 left-12 rounded-lg bg-black/50 p-4 shadow-lg",style:{width:"150px"}},Pe=E({__name:"LightControls",props:{lightIntensity:{},lightIntensityModifiers:{},materialMode:{},materialModeModifiers:{}},emits:["update:lightIntensity","update:materialMode"],setup(d){const a=y(d,"lightIntensity"),o=y(d,"materialMode"),t=z(()=>o.value==="original"),i=V(!1),u=X().get("Comfy.Load3D.LightIntensityMaximum"),g=X().get("Comfy.Load3D.LightIntensityMinimum"),v=X().get("Comfy.Load3D.LightAdjustmentIncrement"),p=s(()=>{i.value=!i.value},"toggleLightIntensity"),h=s(l=>{l.target.closest(".show-light-intensity")||(i.value=!1)},"closeLightSlider");return H(()=>{document.addEventListener("click",h)}),K(()=>{document.removeEventListener("click",h)}),(l,x)=>{const R=N("tooltip");return r(),b("div",Ue,[t.value?(r(),b("div",Be,[w(e(D),{class:"p-button-rounded p-button-text",onClick:p},{default:C(()=>[M(n("i",Ve,null,512),[[R,{value:l.$t("load3d.lightIntensity"),showDelay:300},void 0,{right:!0}]])]),_:1}),M(n("div",Ee,[w(e(ie),{modelValue:a.value,"onUpdate:modelValue":x[0]||(x[0]=$=>a.value=$),class:"w-full",min:e(g),max:e(u),step:e(v)},null,8,["modelValue","min","max","step"])],512),[[J,i.value]])])):_("",!0)])}}}),ze={class:"flex flex-col"},Te={class:"show-up-direction relative"},Ge={class:"pi pi-arrow-up text-lg text-white"},Ae={class:"absolute top-0 left-12 rounded-lg bg-black/50 shadow-lg"},Fe={class:"flex flex-col"},Oe={class:"show-material-mode relative"},je={class:"pi pi-box text-lg text-white"},Ne={class:"absolute top-0 left-12 rounded-lg bg-black/50 shadow-lg"},We={class:"flex flex-col"},Je=E({__name:"ModelControls",props:{materialMode:{},materialModeModifiers:{},upDirection:{},upDirectionModifiers:{}},emits:["update:materialMode","update:upDirection"],setup(d){const a=y(d,"materialMode"),o=y(d,"upDirection"),t=V(!1),i=V(!1),u=["original","-x","+x","-y","+y","-z","+z"],g=z(()=>["original","normal","wireframe"]),v=s(()=>{t.value=!t.value,i.value=!1},"toggleUpDirection"),p=s($=>{o.value=$,t.value=!1},"selectUpDirection"),h=s(()=>{i.value=!i.value,t.value=!1},"toggleMaterialMode"),l=s($=>{a.value=$,i.value=!1},"selectMaterialMode"),x=s($=>Q(`load3d.materialModes.${$}`),"formatMaterialMode"),R=s($=>{const G=$.target;G.closest(".show-up-direction")||(t.value=!1),G.closest(".show-material-mode")||(i.value=!1)},"closeSceneSlider");return H(()=>{document.addEventListener("click",R)}),K(()=>{document.removeEventListener("click",R)}),($,G)=>{const F=N("tooltip");return r(),b("div",ze,[n("div",Te,[w(e(D),{class:"p-button-rounded p-button-text",onClick:v},{default:C(()=>[M(n("i",Ge,null,512),[[F,{value:e(Q)("load3d.upDirection"),showDelay:300},void 0,{right:!0}]])]),_:1}),M(n("div",Ae,[n("div",Fe,[(r(),b(Y,null,Z(u,I=>w(e(D),{key:I,class:T(["p-button-text text-white",{"bg-blue-500":o.value===I}]),onClick:s(W=>p(I),"onClick")},{default:C(()=>[le(q(I.toUpperCase()),1)]),_:2},1032,["class","onClick"])),64))])],512),[[J,t.value]])]),n("div",Oe,[w(e(D),{class:"p-button-rounded p-button-text",onClick:h},{default:C(()=>[M(n("i",je,null,512),[[F,{value:e(Q)("load3d.materialMode"),showDelay:300},void 0,{right:!0}]])]),_:1}),M(n("div",Ne,[n("div",We,[(r(!0),b(Y,null,Z(g.value,I=>(r(),U(e(D),{key:I,class:T(["p-button-text whitespace-nowrap text-white",{"bg-blue-500":a.value===I}]),onClick:s(W=>l(I),"onClick")},{default:C(()=>[le(q(x(I)),1)]),_:2},1032,["class","onClick"]))),128))])],512),[[J,i.value]])])])}}}),qe={class:"flex flex-col"},He={class:"pi pi-table text-lg text-white"},Ke={key:0},Qe={class:"pi pi-palette text-lg text-white"},Xe=["value"],Ye={key:1},Ze={class:"pi pi-image text-lg text-white"},et={key:2},tt={class:"pi pi-globe text-lg text-white"},ot={key:4},lt={class:"pi pi-times text-lg text-white"},nt=E({__name:"SceneControls",props:{showGrid:{type:Boolean},showGridModifiers:{},backgroundColor:{},backgroundColorModifiers:{},backgroundImage:{},backgroundImageModifiers:{},backgroundRenderMode:{default:"tiled"},backgroundRenderModeModifiers:{},fov:{},fovModifiers:{}},emits:ee(["updateBackgroundImage"],["update:showGrid","update:backgroundColor","update:backgroundImage","update:backgroundRenderMode","update:fov"]),setup(d,{emit:a}){const o=a,t=y(d,"showGrid"),i=y(d,"backgroundColor"),u=y(d,"backgroundImage"),g=y(d,"backgroundRenderMode"),v=y(d,"fov"),p=z(()=>u.value&&u.value!==""),h=V(null),l=V(null),x=s(()=>{t.value=!t.value},"toggleGrid"),R=s(S=>{i.value=S},"updateBackgroundColor"),$=s(()=>{h.value?.click()},"openColorPicker"),G=s(()=>{l.value?.click()},"openImagePicker"),F=s(S=>{const P=S.target;P.files&&P.files[0]&&o("updateBackgroundImage",P.files[0])},"uploadBackgroundImage"),I=s(()=>{o("updateBackgroundImage",null)},"removeBackgroundImage"),W=s(()=>{g.value=g.value==="panorama"?"tiled":"panorama"},"toggleBackgroundRenderMode");return(S,P)=>{const O=N("tooltip");return r(),b("div",qe,[w(e(D),{class:T(["p-button-rounded p-button-text",{"p-button-outlined":t.value}]),onClick:x},{default:C(()=>[M(n("i",He,null,512),[[O,{value:S.$t("load3d.showGrid"),showDelay:300},void 0,{right:!0}]])]),_:1},8,["class"]),p.value?_("",!0):(r(),b("div",Ke,[w(e(D),{class:"p-button-rounded p-button-text",onClick:$},{default:C(()=>[M(n("i",Qe,null,512),[[O,{value:S.$t("load3d.backgroundColor"),showDelay:300},void 0,{right:!0}]]),n("input",{ref_key:"colorPickerRef",ref:h,type:"color",value:i.value,class:"pointer-events-none absolute m-0 h-0 w-0 p-0 opacity-0",onInput:P[0]||(P[0]=j=>R(j.target.value))},null,40,Xe)]),_:1})])),p.value?_("",!0):(r(),b("div",Ye,[w(e(D),{class:"p-button-rounded p-button-text",onClick:G},{default:C(()=>[M(n("i",Ze,null,512),[[O,{value:S.$t("load3d.uploadBackgroundImage"),showDelay:300},void 0,{right:!0}]]),n("input",{ref_key:"imagePickerRef",ref:l,type:"file",accept:"image/*",class:"pointer-events-none absolute m-0 h-0 w-0 p-0 opacity-0",onChange:F},null,544)]),_:1})])),p.value?(r(),b("div",et,[w(e(D),{class:T(["p-button-rounded p-button-text",{"p-button-outlined":g.value==="panorama"}]),onClick:W},{default:C(()=>[M(n("i",tt,null,512),[[O,{value:S.$t("load3d.panoramaMode"),showDelay:300},void 0,{right:!0}]])]),_:1},8,["class"])])):_("",!0),p.value&&g.value==="panorama"?(r(),U(de,{key:3,modelValue:v.value,"onUpdate:modelValue":P[1]||(P[1]=j=>v.value=j),"tooltip-text":S.$t("load3d.fov")},null,8,["modelValue","tooltip-text"])):_("",!0),p.value?(r(),b("div",ot,[w(e(D),{class:"p-button-rounded p-button-text",onClick:I},{default:C(()=>[M(n("i",lt,null,512),[[O,{value:S.$t("load3d.removeBackgroundImage"),showDelay:300},void 0,{right:!0}]])]),_:1})])):_("",!0)])}}}),at={class:"show-menu relative"},it={class:"absolute top-0 left-12 rounded-lg bg-black/50 shadow-lg"},st={class:"flex flex-col"},dt={class:"whitespace-nowrap text-white"},rt={class:"rounded-lg bg-smoke-700/30"},ut=E({__name:"Load3DControls",props:{sceneConfig:{},sceneConfigModifiers:{},modelConfig:{},modelConfigModifiers:{},cameraConfig:{},cameraConfigModifiers:{},lightConfig:{},lightConfigModifiers:{}},emits:ee(["updateBackgroundImage","exportModel"],["update:sceneConfig","update:modelConfig","update:cameraConfig","update:lightConfig"]),setup(d,{emit:a}){const o=y(d,"sceneConfig"),t=y(d,"modelConfig"),i=y(d,"cameraConfig"),u=y(d,"lightConfig"),g=V(!1),v=V("scene"),p={scene:"load3d.scene",model:"load3d.model",camera:"load3d.camera",light:"load3d.light",export:"load3d.export"},h=z(()=>["scene","model","camera","light","export"]),l=z(()=>v.value==="scene"&&!!o.value),x=z(()=>v.value==="model"&&!!t.value),R=z(()=>v.value==="camera"&&!!i.value),$=z(()=>v.value==="light"&&!!u.value&&!!t.value),G=z(()=>v.value==="export"),F=s(()=>{g.value=!g.value},"toggleMenu"),I=s(B=>{v.value=B,g.value=!1},"selectCategory"),W=s(B=>`${{scene:"pi pi-image",model:"pi pi-box",camera:"pi pi-camera",light:"pi pi-sun",export:"pi pi-download"}[B]} text-white text-lg`,"getCategoryIcon"),S=a,P=s(B=>{S("updateBackgroundImage",B)},"handleBackgroundImageUpdate"),O=s(B=>{S("exportModel",B)},"handleExportModel"),j=s(B=>{B.target.closest(".show-menu")||(g.value=!1)},"closeSlider");return H(()=>{document.addEventListener("click",j)}),K(()=>{document.removeEventListener("click",j)}),(B,c)=>(r(),b("div",{class:"pointer-events-auto absolute top-12 left-2 z-20 flex flex-col rounded-lg bg-smoke-700/30",onPointerdown:c[11]||(c[11]=L(()=>{},["stop"])),onPointermove:c[12]||(c[12]=L(()=>{},["stop"])),onPointerup:c[13]||(c[13]=L(()=>{},["stop"])),onWheel:c[14]||(c[14]=L(()=>{},["stop"]))},[n("div",at,[w(e(D),{class:"p-button-rounded p-button-text",onClick:F},{default:C(()=>c[15]||(c[15]=[n("i",{class:"pi pi-bars text-lg text-white"},null,-1)])),_:1}),M(n("div",it,[n("div",st,[(r(!0),b(Y,null,Z(h.value,f=>(r(),U(e(D),{key:f,class:T(["p-button-text flex w-full items-center justify-start",{"bg-smoke-600":v.value===f}]),onClick:s(ne=>I(f),"onClick")},{default:C(()=>[n("i",{class:T(W(f))},null,2),n("span",dt,q(B.$t(p[f])),1)]),_:2},1032,["class","onClick"]))),128))])],512),[[J,g.value]])]),M(n("div",rt,[l.value?(r(),U(nt,{key:0,ref:"sceneControlsRef","show-grid":o.value.showGrid,"onUpdate:showGrid":c[0]||(c[0]=f=>o.value.showGrid=f),"background-color":o.value.backgroundColor,"onUpdate:backgroundColor":c[1]||(c[1]=f=>o.value.backgroundColor=f),"background-image":o.value.backgroundImage,"onUpdate:backgroundImage":c[2]||(c[2]=f=>o.value.backgroundImage=f),"background-render-mode":o.value.backgroundRenderMode,"onUpdate:backgroundRenderMode":c[3]||(c[3]=f=>o.value.backgroundRenderMode=f),fov:i.value.fov,"onUpdate:fov":c[4]||(c[4]=f=>i.value.fov=f),onUpdateBackgroundImage:P},null,8,["show-grid","background-color","background-image","background-render-mode","fov"])):_("",!0),x.value?(r(),U(Je,{key:1,ref:"modelControlsRef","material-mode":t.value.materialMode,"onUpdate:materialMode":c[5]||(c[5]=f=>t.value.materialMode=f),"up-direction":t.value.upDirection,"onUpdate:upDirection":c[6]||(c[6]=f=>t.value.upDirection=f)},null,8,["material-mode","up-direction"])):_("",!0),R.value?(r(),U(_e,{key:2,ref:"cameraControlsRef","camera-type":i.value.cameraType,"onUpdate:cameraType":c[7]||(c[7]=f=>i.value.cameraType=f),fov:i.value.fov,"onUpdate:fov":c[8]||(c[8]=f=>i.value.fov=f)},null,8,["camera-type","fov"])):_("",!0),$.value?(r(),U(Pe,{key:3,ref:"lightControlsRef","light-intensity":u.value.intensity,"onUpdate:lightIntensity":c[9]||(c[9]=f=>u.value.intensity=f),"material-mode":t.value.materialMode,"onUpdate:materialMode":c[10]||(c[10]=f=>t.value.materialMode=f)},null,8,["light-intensity","material-mode"])):_("",!0),G.value?(r(),U(Se,{key:4,ref:"exportControlsRef",onExportModel:O},null,512)):_("",!0)],512),[[J,v.value]])],32))}}),ct={key:0,class:"bg-opacity-50 absolute inset-0 z-50 flex items-center justify-center bg-black"},pt={class:"flex flex-col items-center"},gt={class:"mt-4 text-lg text-white"},vt=E({__name:"LoadingOverlay",props:{loading:{type:Boolean},loadingMessage:{}},setup(d){return(a,o)=>(r(),U(ve,{name:"fade"},{default:C(()=>[a.loading?(r(),b("div",ct,[n("div",pt,[o[0]||(o[0]=n("div",{class:"spinner"},null,-1)),n("div",gt,q(a.loadingMessage),1)])])):_("",!0)]),_:1}))}}),mt=se(vt,[["__scopeId","data-v-b13965f5"]]),ft={key:0,class:"pointer-events-none absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm"},ht={class:"rounded-lg border-2 border-dashed border-blue-400 bg-blue-500/20 px-6 py-4 text-lg font-medium text-blue-100"},xt=E({__name:"Load3DScene",props:{initializeLoad3d:{type:Function},cleanup:{type:Function},loading:{type:Boolean},loadingMessage:{},onModelDrop:{type:Function},isPreview:{type:Boolean}},setup(d){const a=d,o=V(null),t=V(null),{isDragging:i,dragMessage:u,handleDragOver:g,handleDragLeave:v,handleDrop:p}=me({onModelDrop:s(async h=>{a.onModelDrop&&await a.onModelDrop(h)},"onModelDrop"),disabled:z(()=>a.isPreview)});return H(()=>{o.value&&a.initializeLoad3d(o.value)}),K(()=>{a.cleanup()}),(h,l)=>(r(),b("div",{ref_key:"container",ref:o,class:"relative h-full w-full","data-capture-wheel":"true",onPointerdown:l[0]||(l[0]=L(()=>{},["stop"])),onPointermove:l[1]||(l[1]=L(()=>{},["stop"])),onPointerup:l[2]||(l[2]=L(()=>{},["stop"])),onMousedown:l[3]||(l[3]=L(()=>{},["stop"])),onMousemove:l[4]||(l[4]=L(()=>{},["stop"])),onMouseup:l[5]||(l[5]=L(()=>{},["stop"])),onContextmenu:l[6]||(l[6]=L(()=>{},["stop","prevent"])),onDragover:l[7]||(l[7]=L((...x)=>e(g)&&e(g)(...x),["prevent","stop"])),onDragleave:l[8]||(l[8]=L((...x)=>e(v)&&e(v)(...x),["stop"])),onDrop:l[9]||(l[9]=L((...x)=>e(p)&&e(p)(...x),["prevent","stop"]))},[w(mt,{ref_key:"loadingOverlayRef",ref:t,loading:h.loading,"loading-message":h.loadingMessage},null,8,["loading","loading-message"]),!h.isPreview&&e(i)?(r(),b("div",ft,[n("div",ht,q(e(u)),1)])):_("",!0)],544))}}),bt={key:0,class:"pointer-events-auto absolute top-0 left-0 z-10 flex w-full items-center justify-center gap-2 pt-2"},kt=E({__name:"AnimationControls",props:{animations:{},animationsModifiers:{},playing:{type:Boolean},playingModifiers:{},selectedSpeed:{},selectedSpeedModifiers:{},selectedAnimation:{},selectedAnimationModifiers:{}},emits:["update:animations","update:playing","update:selectedSpeed","update:selectedAnimation"],setup(d){const a=y(d,"animations"),o=y(d,"playing"),t=y(d,"selectedSpeed"),i=y(d,"selectedAnimation"),u=[{name:"0.1x",value:.1},{name:"0.5x",value:.5},{name:"1x",value:1},{name:"1.5x",value:1.5},{name:"2x",value:2}],g=s(()=>{o.value=!o.value},"togglePlay");return(v,p)=>a.value&&a.value.length>0?(r(),b("div",bt,[w(e(D),{class:"p-button-rounded p-button-text",onClick:g},{default:C(()=>[n("i",{class:T(["pi",o.value?"pi-pause":"pi-play","text-lg text-white"])},null,2)]),_:1}),w(e(ae),{modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=h=>t.value=h),options:u,"option-label":"name","option-value":"value",class:"w-24"},null,8,["modelValue"]),w(e(ae),{modelValue:i.value,"onUpdate:modelValue":p[1]||(p[1]=h=>i.value=h),options:a.value,"option-label":"name","option-value":"index",class:"w-32"},null,8,["modelValue","options"])])):_("",!0)}}),wt={class:"relative rounded-lg bg-smoke-700/30"},yt={class:"flex flex-col gap-2"},Ct={class:"pi pi-download text-lg text-white"},Mt={class:"pi pi-trash text-lg text-white"},_t={key:2,class:"mt-1 text-center text-xs text-white"},$t=E({__name:"RecordingControls",props:{hasRecording:{type:Boolean},hasRecordingModifiers:{},isRecording:{type:Boolean},isRecordingModifiers:{},recordingDuration:{},recordingDurationModifiers:{}},emits:ee(["startRecording","stopRecording","exportRecording","clearRecording"],["update:hasRecording","update:isRecording","update:recordingDuration"]),setup(d,{emit:a}){const o=y(d,"hasRecording"),t=y(d,"isRecording"),i=y(d,"recordingDuration"),u=a,g=s(()=>{t.value?u("stopRecording"):u("startRecording")},"toggleRecording"),v=s(()=>{u("exportRecording")},"handleExportRecording"),p=s(()=>{u("clearRecording")},"handleClearRecording"),h=s(l=>{const x=Math.floor(l/60),R=Math.floor(l%60);return`${x.toString().padStart(2,"0")}:${R.toString().padStart(2,"0")}`},"formatDuration");return(l,x)=>{const R=N("tooltip");return r(),b("div",wt,[n("div",yt,[w(e(D),{class:T(["p-button-rounded p-button-text",{"p-button-danger":t.value,"recording-button-blink":t.value}]),onClick:g},{default:C(()=>[M(n("i",{class:T(["pi",t.value?"pi-circle-fill":"pi-video","text-lg text-white"])},null,2),[[R,{value:t.value?l.$t("load3d.stopRecording"):l.$t("load3d.startRecording"),showDelay:300},void 0,{right:!0}]])]),_:1},8,["class"]),o.value&&!t.value?(r(),U(e(D),{key:0,class:"p-button-rounded p-button-text",onClick:v},{default:C(()=>[M(n("i",Ct,null,512),[[R,{value:l.$t("load3d.exportRecording"),showDelay:300},void 0,{right:!0}]])]),_:1})):_("",!0),o.value&&!t.value?(r(),U(e(D),{key:1,class:"p-button-rounded p-button-text",onClick:p},{default:C(()=>[M(n("i",Mt,null,512),[[R,{value:l.$t("load3d.clearRecording"),showDelay:300},void 0,{right:!0}]])]),_:1})):_("",!0),i.value&&i.value>0&&!t.value?(r(),b("div",_t,q(h(i.value)),1)):_("",!0)])])}}}),Dt=se($t,[["__scopeId","data-v-145dbaf6"]]),Rt={class:"relative rounded-lg bg-smoke-700/30"},It={class:"flex flex-col gap-2"},Lt={class:"pi pi-expand text-lg text-white"},St=E({__name:"ViewerControls",props:{node:{}},setup(d){const a=s(()=>{const o={node:d.node};fe().showDialog({key:"global-load3d-viewer",title:Q("load3d.viewer.title"),component:he,props:o,dialogComponentProps:{style:"width: 80vw; height: 80vh;",maximizable:!0,onClose:s(async()=>{await xe().handleViewerClose(o.node)},"onClose")}})},"openIn3DViewer");return(o,t)=>{const i=N("tooltip");return r(),b("div",Rt,[n("div",It,[w(e(D),{class:"p-button-rounded p-button-text",onClick:a},{default:C(()=>[M(n("i",Lt,null,512),[[i,{value:e(Q)("load3d.openIn3DViewer"),showDelay:300},void 0,{right:!0}]])]),_:1})])])}}}),Ut={class:"pointer-events-none absolute top-0 left-0 h-full w-full"},Bt={key:1,class:"pointer-events-auto absolute top-12 right-2 z-20"},At=E({__name:"Load3D",props:{widget:{},nodeId:{}},setup(d){const a=d;function o(oe){return"node"in oe&&oe.node!==void 0}s(o,"isComponentWidget");const t=V(null);o(a.widget)?t.value=a.widget.node:a.nodeId&&H(()=>{t.value=be.rootGraph?.getNodeById(a.nodeId)||null});const i=V(null),{sceneConfig:u,modelConfig:g,cameraConfig:v,lightConfig:p,isRecording:h,isPreview:l,hasRecording:x,recordingDuration:R,animations:$,playing:G,selectedSpeed:F,selectedAnimation:I,loading:W,loadingMessage:S,initializeLoad3d:P,handleMouseEnter:O,handleMouseLeave:j,handleStartRecording:B,handleStopRecording:c,handleExportRecording:f,handleClearRecording:ne,handleBackgroundImageUpdate:re,handleExportModel:ue,handleModelDrop:ce,cleanup:pe}=ke(t),te=z(()=>X().get("Comfy.Load3D.3DViewerEnable"));return(oe,m)=>(r(),b("div",{class:"widget-expands relative h-full w-full",onMouseenter:m[11]||(m[11]=(...k)=>e(O)&&e(O)(...k)),onMouseleave:m[12]||(m[12]=(...k)=>e(j)&&e(j)(...k)),onPointerdown:m[13]||(m[13]=L(()=>{},["stop"])),onPointermove:m[14]||(m[14]=L(()=>{},["stop"])),onPointerup:m[15]||(m[15]=L(()=>{},["stop"]))},[t.value?(r(),U(xt,{key:0,ref_key:"load3DSceneRef",ref:i,"initialize-load3d":e(P),cleanup:e(pe),loading:e(W),"loading-message":e(S),"on-model-drop":e(l)?void 0:e(ce),"is-preview":e(l)},null,8,["initialize-load3d","cleanup","loading","loading-message","on-model-drop","is-preview"])):_("",!0),n("div",Ut,[w(ut,{"scene-config":e(u),"onUpdate:sceneConfig":m[0]||(m[0]=k=>A(u)?u.value=k:null),"model-config":e(g),"onUpdate:modelConfig":m[1]||(m[1]=k=>A(g)?g.value=k:null),"camera-config":e(v),"onUpdate:cameraConfig":m[2]||(m[2]=k=>A(v)?v.value=k:null),"light-config":e(p),"onUpdate:lightConfig":m[3]||(m[3]=k=>A(p)?p.value=k:null),onUpdateBackgroundImage:e(re),onExportModel:e(ue)},null,8,["scene-config","model-config","camera-config","light-config","onUpdateBackgroundImage","onExportModel"]),e($)&&e($).length>0?(r(),U(kt,{key:0,animations:e($),"onUpdate:animations":m[4]||(m[4]=k=>A($)?$.value=k:null),playing:e(G),"onUpdate:playing":m[5]||(m[5]=k=>A(G)?G.value=k:null),"selected-speed":e(F),"onUpdate:selectedSpeed":m[6]||(m[6]=k=>A(F)?F.value=k:null),"selected-animation":e(I),"onUpdate:selectedAnimation":m[7]||(m[7]=k=>A(I)?I.value=k:null)},null,8,["animations","playing","selected-speed","selected-animation"])):_("",!0)]),te.value&&t.value?(r(),b("div",Bt,[w(St,{node:t.value},null,8,["node"])])):_("",!0),e(l)?_("",!0):(r(),b("div",{key:2,class:T(["pointer-events-auto absolute right-2 z-20",{"top-12":!te.value,"top-24":te.value}])},[w(Dt,{"is-recording":e(h),"onUpdate:isRecording":m[8]||(m[8]=k=>A(h)?h.value=k:null),"has-recording":e(x),"onUpdate:hasRecording":m[9]||(m[9]=k=>A(x)?x.value=k:null),"recording-duration":e(R),"onUpdate:recordingDuration":m[10]||(m[10]=k=>A(R)?R.value=k:null),onStartRecording:e(B),onStopRecording:e(c),onExportRecording:e(f),onClearRecording:e(ne)},null,8,["is-recording","has-recording","recording-duration","onStartRecording","onStopRecording","onExportRecording","onClearRecording"])],2))],32))}});export{At as _};
//# sourceMappingURL=Load3D.vue_vue_type_script_setup_true_lang-BKrIKZkc.js.map
