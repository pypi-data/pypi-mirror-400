[tool.poetry]
name = "python-spartan"
version = "0.3.9"
description = "Spartan, often referred to as \"The swiss army knife for serverless development,\" is a tool that simplifies the creation of serverless applications on popular cloud providers by generating Python code for classes and more. It streamlines your development process, saving you time and ensuring code consistency in your serverless projects."
authors = ["nerdmonkey <sydel.palinlin@gmail.com>"]
readme = "README.md"
packages = [{ include = "spartan" }]
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Topic :: System :: Systems Administration",
    "Topic :: Internet :: WWW/HTTP :: Dynamic Content",
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3 :: Only",
]


[tool.poetry.dependencies]
python = ">=3.11,<4.0"
alembic = "^1.12.0"
boto3 = "^1.34.0"
inflect = "^7.2.1"
poetry = "^1.7.0"
pymysql = "^1.1.0"
pytest = "^8.3.2"
pyyaml = "^6.0.1"
requests = "^2.31.0"
typer = "0.12.3"
click = "8.1.7"
rich = "^14.0.0"
pre-commit = "^4.2.0"
pandas = "^2.3.1"
pyarrow = "^21.0.0"
google-cloud-workflows = "^1.16.0"
google-cloud = "^0.34.0"
google-cloud-functions = "^1.21.0"
google-cloud-storage = "^3.7.0"
pytest-coverage = "^0.0"


[tool.poetry.group.dev.dependencies]
pytest-cov = "^4.1.0"
faker = "^20.1.0"
pytest = "^8.3.2"
pytest-mock = "^3.12.0"
black = "^24.8.0"
isort = "^5.12.0"
flake8 = "^6.1.0"
moto = { extras = ["s3"], version = "^5.1.8" }
flake8-docstrings = "^1.7.0"
flake8-bugbear = "^24.0.0"
flake8-comprehensions = "^3.15.0"
sphinx = "^8.1.3"
sphinx-rtd-theme = "^3.0.2"
sphinx-autoapi = "^3.3.3"
myst-parser = "^4.0.0"
bandit = "^1.8.6"
mypy = "^1.17.0"
types-requests = "^2.31.0"
types-PyYAML = "^6.0.0"
pydocstyle = "^6.3.0"
commitizen = "^4.8.3"
tox = "^4.11.0"
pytest-xdist = "^3.8.0"

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"

[tool.poetry.scripts]
spartan = "spartan.main:app"

# ==============================================================================
# ðŸ”§ DEVELOPMENT TOOL CONFIGURATIONS
# ==============================================================================

[tool.black]
line-length = 88
target-version = ['py311']
include = '\.pyi?$'
extend-exclude = '''
/(
  # directories
  \.eggs
  | \.git
  | \.hg
  | \.mypy_cache
  | \.tox
  | \.venv
  | _build
  | buck-out
  | build
  | dist
)/
'''

[tool.isort]
profile = "black"
multi_line_output = 3
line_length = 88
known_first_party = ["spartan"]

[tool.mypy]
python_version = "3.11"
warn_return_any = false
warn_unused_configs = true
disallow_untyped_defs = false
disallow_incomplete_defs = false
check_untyped_defs = false
disallow_untyped_decorators = false
no_implicit_optional = false
warn_redundant_casts = false
warn_unused_ignores = false
warn_no_return = false
warn_unreachable = false
strict_equality = false
ignore_missing_imports = true
# Allow mypy to skip files if there are issues
follow_imports = "skip"
namespace_packages = true

[[tool.mypy.overrides]]
module = "tests.*"
disallow_untyped_defs = false

[tool.bandit]
exclude_dirs = ["tests", "docs"]
skips = [
    "B101", # Skip assert_used test
    "B110", # Skip try_except_pass
    "B311", # Skip random for non-cryptographic use
    "B324", # Skip MD5 for non-security use (file checksums)
    "B404", # Skip subprocess import warnings
    "B603", # Skip subprocess without shell=true warnings
    "B607", # Skip subprocess partial path warnings
]

[tool.bandit.assert_used]
skips = ["*_test.py", "*/test_*.py"]

[tool.pytest.ini_options]
minversion = "6.0"
addopts = "-ra -q --strict-markers"
testpaths = ["tests"]
pythonpath = ["."]
markers = [
    "slow: marks tests as slow (deselect with '-m \"not slow\"')",
    "integration: marks tests as integration tests",
    "unit: marks tests as unit tests",
]

[tool.coverage.run]
source = ["spartan"]
omit = ["*/tests/*", "*/test_*", "*/__pycache__/*", "*/venv/*", "*/.venv/*"]

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "def __repr__",
    "if self.debug:",
    "if settings.DEBUG",
    "raise AssertionError",
    "raise NotImplementedError",
    "if 0:",
    "if __name__ == .__main__.:",
    "class .*\\bProtocol\\):",
    "@(abc\\.)?abstractmethod",
]

[tool.pydocstyle]
convention = "google"
add-ignore = [
    "D100",
    "D101",
    "D102",
    "D103",
    "D104",
    "D105",
    "D107", # Missing docstrings
    "D200",
    "D202",
    "D205",
    "D212", # Docstring format issues
]
match-dir = "(?!tests|docs|build|dist)"

[tool.commitizen]
name = "cz_conventional_commits"
version = "0.3.7"
version_files = ["pyproject.toml:version", "spartan/__init__.py:__version__"]
