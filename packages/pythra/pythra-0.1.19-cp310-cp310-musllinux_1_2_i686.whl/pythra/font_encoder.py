import base64
import os
import sys

def convert_ttf_to_css(ttf_path, output_css_path="icons.css", font_family="Material Icons"):
    """
    Reads a TTF file, encodes it to Base64, and writes a CSS file.
    """
    
    # 1. Check if file exists
    if not os.path.exists(ttf_path):
        print(f"âŒ Error: File not found at '{ttf_path}'")
        return

    try:
        print(f"ðŸ”„ Reading '{ttf_path}'...")
        
        # 2. Read the binary font file
        with open(ttf_path, "rb") as font_file:
            font_data = font_file.read()
            
        # 3. Convert to Base64 string
        # .decode('utf-8') converts the bytes object to a standard string
        base64_string = base64.b64encode(font_data).decode('utf-8')
        
        print("âœ… Encoding complete.")

        # 4. Create the CSS content
        # We use font-display: block to prevent FOUT (Flash of Unstyled Text)
        css_content = f"""/* Generated by Pythra Font Encoder */
@font-face {{
    font-family: '{font_family}';
    font-style: normal;
    font-weight: 400;
    font-display: block;
    src: url(data:font/truetype;charset=utf-8;base64,{base64_string}) format('truetype');
}}

.material-icons {{
    font-family: '{font_family}';
    font-weight: normal;
    font-style: normal;
    font-size: 24px;
    display: inline-block;
    line-height: 1;
    text-transform: none;
    letter-spacing: normal;
    word-wrap: normal;
    white-space: nowrap;
    direction: ltr;
    /* Support for all WebKit browsers. */
    -webkit-font-smoothing: antialiased;
    /* Support for Safari and Chrome. */
    text-rendering: optimizeLegibility;
    /* Support for Firefox. */
    -moz-osx-font-smoothing: grayscale;
    /* Support for IE. */
    font-feature-settings: 'liga';
}}
"""

        # 5. Write the CSS file
        with open(output_css_path, "w") as css_file:
            css_file.write(css_content)
            
        print(f"ðŸŽ‰ Success! CSS file generated at: {output_css_path}")
        print(f"ðŸ“ Total size: {len(css_content) / 1024:.2f} KB")

    except Exception as e:
        print(f"âŒ An error occurred: {e}")

if __name__ == "__main__":
    # Default filename if you download MaterialIcons-Regular.ttf to the same folder
    input_font = "MaterialIcons-Regular.ttf" 
    
    # Check if user provided a file path via command line
    if len(sys.argv) > 1:
        input_font = sys.argv[1]

    convert_ttf_to_css(input_font)