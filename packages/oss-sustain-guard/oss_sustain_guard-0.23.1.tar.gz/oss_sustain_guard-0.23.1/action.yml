name: 'OSS Sustain Guard - Package Sustainability Checker'
description: 'Check package sustainability metrics (estimated contributor redundancy, maintainer retention, funding signals, etc.) across multiple ecosystems'
author: 'onukura'

inputs:
  packages:
    description: 'Packages to analyze (space-separated). Format: "requests" (Python) or "npm:react" (JavaScript) or "rust:tokio" (Rust)'
    required: false
    default: ''
  ecosystem:
    description: 'Default ecosystem for unqualified packages (python, javascript, go, rust, php, java, kotlin, scala, csharp, dotnet, dart, elixir, haskell, perl, r, ruby, swift). Use "auto" to detect.'
    required: false
    default: 'auto'
  include-lock:
    description: 'Auto-detect packages from lock files (package-lock.json, Cargo.lock, pyproject.toml, etc.)'
    required: false
    default: 'false'
  output-style:
    description: 'Output format style: compact, normal, or detail'
    required: false
    default: 'normal'
  verbose:
    description: 'Enable verbose logging (cache operations, metric reconstruction)'
    required: false
    default: 'false'
  profile:
    description: 'Scoring profile: balanced (default), security_first, contributor_experience, long_term_stability'
    required: false
    default: 'balanced'
  show-dependencies:
    description: 'Analyze and display dependency package scores (requires lockfiles)'
    required: false
    default: 'false'
  root-dir:
    description: 'Root directory for auto-detection of manifest files (default: current directory)'
    required: false
    default: '.'
  manifest:
    description: 'Path to specific manifest file (e.g., package.json, requirements.txt). Overrides auto-detection'
    required: false
    default: ''
  recursive:
    description: 'Recursively scan subdirectories for manifest and lock files'
    required: false
    default: 'false'
  insecure:
    description: 'Disable SSL certificate verification for HTTPS requests'
    required: false
    default: 'false'
  github-token:
    description: 'GitHub token for API calls (uses GITHUB_TOKEN by default)'
    required: false

outputs:
  summary:
    description: 'Summary of analysis results'

runs:
  using: 'docker'
  image: 'docker://ghcr.io/onukura/oss-sustain-guard:latest'
  env:
    INPUT_PACKAGES: ${{ inputs.packages }}
    INPUT_ECOSYSTEM: ${{ inputs.ecosystem }}
    INPUT_INCLUDE_LOCK: ${{ inputs.include-lock }}
    INPUT_OUTPUT_STYLE: ${{ inputs.output-style }}
    INPUT_VERBOSE: ${{ inputs.verbose }}
    INPUT_PROFILE: ${{ inputs.profile }}
    INPUT_SHOW_DEPENDENCIES: ${{ inputs.show-dependencies }}
    INPUT_ROOT_DIR: ${{ inputs.root-dir }}
    INPUT_MANIFEST: ${{ inputs.manifest }}
    INPUT_RECURSIVE: ${{ inputs.recursive }}
    INPUT_INSECURE: ${{ inputs.insecure }}
    GITHUB_TOKEN: ${{ inputs.github-token }}
