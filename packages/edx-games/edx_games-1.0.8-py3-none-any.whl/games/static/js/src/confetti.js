/* Confetti Animation Utility */

var GamesConfetti = (function() {
    'use strict';

    var confettiShapes = [
        // Star yellow
        '<svg xmlns="http://www.w3.org/2000/svg" width="15" height="16" viewBox="0 0 15 16" fill="none"><path d="M4.3689 1.70102L4.20772 5.87694L0.634194 8.15426C0.52103 8.22609 0.430148 8.3277 0.3718 8.44764C0.313451 8.56757 0.289954 8.70105 0.303958 8.83303C0.317963 8.96502 0.368912 9.09025 0.45106 9.19462C0.533208 9.29899 0.643286 9.37834 0.768888 9.42372L4.7254 10.8438L5.76617 14.8831C5.7996 15.0112 5.86844 15.1273 5.96496 15.2183C6.06148 15.3093 6.18187 15.3717 6.3126 15.3984C6.44334 15.4252 6.57925 15.4152 6.70507 15.3697C6.8309 15.3241 6.94167 15.2448 7.02493 15.1406L9.63538 11.8407L13.8405 12.0823C13.9741 12.0908 14.1077 12.0619 14.2261 11.9988C14.3444 11.9357 14.4426 11.841 14.5095 11.7255C14.5765 11.61 14.6094 11.4784 14.6046 11.3457C14.5997 11.2131 14.5573 11.0847 14.4822 10.9752L12.1663 7.48355L13.7259 3.59318C13.776 3.46986 13.7903 3.3353 13.767 3.20484C13.7437 3.07439 13.6839 2.95328 13.5943 2.85534C13.5048 2.75739 13.3891 2.68655 13.2604 2.65089C13.1318 2.61523 12.9954 2.61619 12.8668 2.65366L8.80774 3.81192L5.56113 1.14907C5.45667 1.05926 5.32801 1.00149 5.19069 0.982742C5.05337 0.963994 4.91326 0.985062 4.78723 1.04341C4.6612 1.10175 4.55465 1.19488 4.48042 1.31157C4.40619 1.42825 4.36746 1.56351 4.3689 1.70102Z" fill="#F0CC00"/></svg>',
        // Star red
        '<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" fill="none"><path d="M3.74811 1.21691L3.96916 5.20027L0.776141 7.62915C0.674762 7.70687 0.597386 7.81107 0.552749 7.92999C0.508112 8.04891 0.497997 8.17781 0.523546 8.30211C0.549095 8.42642 0.609292 8.54118 0.697332 8.63343C0.785372 8.72568 0.897744 8.79175 1.02176 8.82416L4.91724 9.84429L6.27305 13.5993C6.31641 13.7184 6.39249 13.8231 6.49274 13.9017C6.59299 13.9803 6.71343 14.0297 6.84052 14.0444C6.9676 14.059 7.0963 14.0383 7.21214 13.9846C7.32797 13.9308 7.42635 13.8462 7.49622 13.7402L9.68221 10.3932L13.7103 10.2766C13.8364 10.2689 13.958 10.2269 14.0616 10.1554C14.1652 10.0838 14.2468 9.98545 14.2976 9.87102C14.3483 9.75658 14.3662 9.63053 14.3493 9.5067C14.3323 9.38288 14.2812 9.26605 14.2016 9.16906L11.657 6.07467L12.7917 2.25161C12.8268 2.13003 12.8268 2.0012 12.7919 1.87958C12.757 1.75796 12.6886 1.64836 12.5942 1.56309C12.4998 1.47783 12.3832 1.42027 12.2576 1.39687C12.132 1.37348 12.0022 1.38517 11.8829 1.43065L8.125 2.88798L4.79444 0.638836C4.69035 0.575937 4.57121 0.541547 4.44925 0.539192C4.32729 0.536837 4.2069 0.566601 4.10041 0.625435C3.99392 0.684269 3.90516 0.770055 3.84325 0.873993C3.78135 0.977932 3.74851 1.09628 3.74811 1.21691Z" fill="#D23228"/></svg>',
        // Circle yellow large
        '<svg xmlns="http://www.w3.org/2000/svg" width="11" height="12" viewBox="0 0 11 12" fill="none"><path d="M5.71153 11.2259C8.62645 11.2259 10.9895 8.87555 10.9895 5.97623C10.9895 3.07692 8.62645 0.726562 5.71153 0.726562C2.7966 0.726562 0.433594 3.07692 0.433594 5.97623C0.433594 8.87555 2.7966 11.2259 5.71153 11.2259Z" fill="#F0CC00"/></svg>',
        // Circle red small
        '<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10" fill="none"><path d="M5.03881 9.09091C7.52934 9.09091 9.54831 7.09606 9.54831 4.6353C9.54831 2.17453 7.52934 0.179688 5.03881 0.179688C2.54827 0.179688 0.529297 2.17453 0.529297 4.6353C0.529297 7.09606 2.54827 9.09091 5.03881 9.09091Z" fill="#D23228"/></svg>',
        // Triangle yellow
        '<svg xmlns="http://www.w3.org/2000/svg" width="19" height="20" viewBox="0 0 19 20" fill="none"><path d="M7.02198 0.612796C9.96344 1.66839 12.5617 3.51018 14.5361 5.93919C16.5105 8.36819 17.786 11.2921 18.2247 14.3949L11.161 19.4365C11.161 19.4365 8.60681 9.12353 0.850844 6.98984L7.02198 0.612796Z" fill="#F0CC00"/></svg>',
        // Triangle red
        '<svg xmlns="http://www.w3.org/2000/svg" width="19" height="20" viewBox="0 0 19 20" fill="none"><path d="M7.02198 0.612796C9.96344 1.66839 12.5617 3.51018 14.5361 5.93919C16.5105 8.36819 17.786 11.2921 18.2247 14.3949L11.161 19.4365C11.161 19.4365 8.60681 9.12353 0.850844 6.98984L7.02198 0.612796Z" fill="#D23228"/></svg>',
        // Curve small
        '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="14" viewBox="0 0 20 14" fill="none"><path d="M18.6847 12.6267C18.3969 12.824 18.0708 12.9558 17.7358 13.0102C17.4009 13.0646 17.0677 13.0398 16.7665 12.938C11.4582 11.1591 6.57121 8.58468 2.27206 5.30239C1.84252 5.03332 1.49915 4.66316 1.26958 4.22171C1.04 3.78025 0.930651 3.27983 0.950302 2.76071C1.01618 2.18584 1.28373 1.62393 1.7094 1.16646C2.13507 0.708984 2.69381 0.382889 3.29463 0.241256C3.83165 0.0916393 4.38289 0.117982 4.85474 0.315825C5.32658 0.513668 5.68992 0.87081 5.88312 1.32661C6.0696 1.76745 6.05612 2.28317 5.84552 2.76346C9.65696 5.5386 13.9377 7.72986 18.5596 9.27167C18.7989 9.35059 19.0131 9.47608 19.19 9.64093C19.3668 9.80577 19.5028 10.0067 19.5901 10.2322C19.6773 10.4577 19.7142 10.7034 19.6986 10.955C19.683 11.2066 19.6151 11.4592 19.499 11.6984C19.323 12.0675 19.039 12.3913 18.6847 12.6267Z" fill="#DFEAEF"/></svg>',
        // Curve medium
        '<svg xmlns="http://www.w3.org/2000/svg" width="33" height="22" viewBox="0 0 33 22" fill="none"><path d="M0.480491 16.2974C0.156876 15.8164 0.0207007 15.2344 0.101927 14.6796C0.183156 14.1248 0.475139 13.6425 0.913626 13.3388C1.35211 13.0352 1.9012 12.9351 2.44009 13.0605C2.97898 13.186 3.46351 13.5267 3.78713 14.0077C4.45967 14.7992 5.27704 15.4428 6.18401 15.8951C7.09098 16.3473 8.06643 16.5977 9.04448 16.6292C9.9686 16.7084 10.8835 16.5768 11.7252 16.2436C12.567 15.9104 13.3154 15.3836 13.9181 14.7L14.0921 14.6006C12.4901 14.2568 10.9392 13.6205 9.51257 12.7217C8.52635 12.1449 7.6448 11.3787 6.91828 10.4668C6.19176 9.55496 5.63452 8.51532 5.27837 7.40727C4.87366 6.08211 4.906 4.68496 5.37005 3.44746C5.8341 2.20995 6.702 1.20639 7.82986 0.603093C8.6534 0.258497 9.55149 0.108944 10.463 0.164596C11.3746 0.220248 12.2782 0.479804 13.1126 0.925615C14.5281 1.66757 15.7828 2.73082 16.7777 4.03161C17.7727 5.3324 18.4808 6.83518 18.8462 8.42161C19.0101 9.10554 19.1202 9.79843 19.1754 10.4931C19.662 10.4161 20.1204 10.33 20.6028 10.2052C23.8768 9.15478 26.9783 7.6622 29.8326 5.76352C30.294 5.50005 30.8504 5.44683 31.3794 5.61557C31.9084 5.78432 32.3667 6.1612 32.6534 6.66331C32.9401 7.16542 33.0317 7.75163 32.9082 8.29298C32.7846 8.83432 32.456 9.28646 31.9946 9.54993C28.8474 11.6588 25.4063 13.2858 21.7671 14.3856C20.7391 14.6566 19.6855 14.8384 18.6169 14.9291C18.266 15.9566 17.7436 16.9003 17.0723 17.719C16.0985 18.8582 14.8804 19.7412 13.5044 20.3057C12.1284 20.8701 10.6281 21.1022 9.10946 20.9854C7.53272 20.9213 5.96288 20.5053 4.50569 19.7653C3.0485 19.0254 1.7378 17.9788 0.6619 16.6959L0.480491 16.2974ZM14.0803 7.22656C13.5073 6.17612 12.633 5.32613 11.5913 4.80679C11.0106 4.45862 10.3377 4.35533 9.7201 4.51957C9.23296 4.79772 8.96573 5.70346 9.18091 6.48435C9.60039 7.61302 10.4067 8.56264 11.4348 9.13881C12.5669 9.83318 13.8034 10.296 15.0732 10.5007C15.0406 10.0684 14.972 9.63718 14.868 9.21198C14.7 8.51975 14.4345 7.8504 14.0803 7.22656Z" fill="#DFEAEF"/></svg>',
        // Curve large
        '<svg xmlns="http://www.w3.org/2000/svg" width="36" height="24" viewBox="0 0 36 24" fill="none"><path d="M1.0001 22.5439C0.92879 22.3673 0.922554 22.1727 0.982737 22.0021C2.34499 18.1282 4.57633 14.7378 7.48867 12.1167C9.65341 10.076 12.315 8.71935 15.2138 8.17918C17.1734 5.20335 19.9633 3.0044 23.221 1.86822C27.0078 0.602926 31.0761 0.301098 35.1234 0.985149C35.2976 1.00942 35.4611 1.10654 35.5785 1.25539C35.6958 1.40425 35.7575 1.5928 35.7501 1.78007C35.7459 1.87355 35.7246 1.9638 35.6874 2.04565C35.6501 2.12749 35.5977 2.19931 35.5331 2.257C35.4685 2.31469 35.3931 2.35712 35.311 2.38184C35.2289 2.40655 35.1418 2.41307 35.0548 2.40103C31.204 1.74987 27.3331 2.03306 23.7275 3.22969C21.1007 4.15673 18.7904 5.81798 17.0181 8.05429C20.663 8.13468 24.1055 10.0777 25.906 13.1457C26.4336 13.9962 26.7898 14.9481 26.9491 15.9334C27.1084 16.9188 27.0669 17.9134 26.8276 18.8465C26.2923 20.3729 25.2504 21.5971 23.8923 22.2951C22.8483 22.9241 21.654 23.2457 20.4195 23.2302C19.185 23.2148 17.9501 22.8627 16.8288 22.2066C13.0475 19.8295 12.4823 13.8656 14.3106 9.85735C12.1048 10.5096 10.0842 11.6628 8.37741 13.2438C5.6177 15.7252 3.50336 18.9361 2.21291 22.6055C2.15115 22.7768 2.02716 22.9094 1.86802 22.9744C1.70888 23.0393 1.52753 23.0314 1.36357 22.9522C1.20079 22.8694 1.07011 22.7226 1.0001 22.5439ZM16.0682 9.53197C15.8756 9.86934 15.6946 10.2177 15.5233 10.5385C13.9608 13.9757 14.3621 18.9871 17.4556 20.9706C18.3828 21.4864 19.3963 21.7555 20.4059 21.7538C21.4155 21.7521 22.3899 21.4797 23.2423 20.9608C24.324 20.4372 25.1639 19.4928 25.6073 18.3017C25.7883 17.5692 25.8131 16.7898 25.6798 16.0197C25.5466 15.2497 25.2586 14.5082 24.8367 13.8488C23.261 11.1594 20.023 9.40744 16.7797 9.4846C16.5206 9.50411 16.2856 9.51377 16.0501 9.53934L16.0682 9.53197Z" fill="#DFEAEF"/></svg>'
    ];

    function createBurst(container, burstIndex, count) {
        var burstClass = 'confetti-burst-' + burstIndex;

        for (var i = 0; i < count; i++) {
            var type = Math.floor(Math.random() * confettiShapes.length);
            var left = 50; // Center of viewport

            // 180 degree spread: angle from -90 to +90 degrees
            var angle = (Math.random() * 180) - 90; // -90 to +90
            var velocity = 10 + (Math.random() * 60); // 10-70vh travel distance for fuller coverage

            // Convert angle to x and y components
            var angleRad = angle * (Math.PI / 180);
            var xSpread = Math.sin(angleRad) * velocity * 1.2; // Increased horizontal spread
            var ySpread = -Math.cos(angleRad) * velocity; // Vertical (negative = up)

            var duration = (Math.random() * 2) + 1;

            var confettiHtml = '<div class="confetti ' + burstClass + '" style="left:' + left + '%; --confetti-x:' + xSpread + 'vw; --confetti-y:' + ySpread + 'vh; animation:confetti ' + duration + 's ease-out forwards;">' +
                confettiShapes[type] + '</div>';

            container.append(confettiHtml);
        }
    }

    function trigger(containerElement, count) {
        count = count || 20;
        var container = $(containerElement);

        if (!container.length) {
            console.warn('Confetti container not found');
            return;
        }

        createBurst(container, 1, count);

        setTimeout(function() {
            createBurst(container, 2, count);
        }, 800);

        setTimeout(function() {
            createBurst(container, 3, count);
        }, 1600);
    }

    return {
        trigger: trigger
    };
})();
