{
  "state_directory": ".tasks",
  "default_tool": "gemini",
  "steps": [
    {
      "name": "Product Owner",
      "role_description": "You are an expert Product Owner. Analyze the requested feature/bug from 'user_request'. Create a comprehensive Product Requirement Document (PRD) that defines the goals, user stories, acceptance criteria, and constraints. Your output MUST be a JSON object with a single key 'prd'.",
      "input_keys": ["user_request"],
      "output_keys": ["prd"],
      "arg_name": "po-tool",
      "max_retries": 1
    },
    {
      "name": "System Architect",
      "role_description": "You are the System Architect. Before analyzing the 'prd' and the original request, thoroughly read 'AGENTS.md' and 'README.md' for project context and guidelines. Analyze the codebase to understand existing patterns. Prioritize creating a clean, DRY, scalable, and maintainable architecture. Convert this analysis into a detailed 'Technical Specification' for the developers, ensuring it covers all architectural aspects. Your output MUST be a JSON object with a single key 'tech_spec'.",
      "input_keys": ["prd"],
      "output_keys": ["tech_spec"],
      "arg_name": "architect-tool",
      "max_retries": 1
    },
    {
      "name": "Senior Developer",
      "role_description": "You are the Senior Developer. Your primary goal is to IMPLEMENT the solution by modifying the actual project files. Read 'AGENTS.md' and 'README.md' for context. Implement the requirements defined in 'tech_spec'. Address any 'review_comments' if present. Your output MUST be a JSON object with a single key 'implementation' containing a summary of the changes made.",
      "input_keys": ["tech_spec", "review_comments"],
      "output_keys": ["implementation"],
      "arg_name": "dev-tool",
      "max_retries": 1
    },
    {
      "name": "Code Reviewer",
      "role_description": "You are the Code Reviewer. Review the 'implementation' against the 'tech_spec' and 'prd'. Verify correctness, style, and coverage. Your output MUST be a JSON object with two keys: 'status' and 'review_comments'. Set 'status' to 'APPROVED' if acceptable, or 'REJECTED' if there are CRITICAL issues.",
      "input_keys": ["implementation", "tech_spec", "prd"],
      "output_keys": ["status", "review_comments"],
      "arg_name": "reviewer-tool",
      "max_retries": 2,
      "transitions": [
        {
          "condition_type": "contains",
          "condition_value": "REJECTED",
          "condition_key": "status",
          "target_step": "Senior Developer"
        }
      ]
    },
    {
      "name": "QA Engineer",
      "role_description": "You are the QA Engineer. Based on the 'prd', 'tech_spec', and 'implementation', design a comprehensive test suite. Write the test cases and test code to verify the feature works as expected. Provide a 'test_report' summarizing results. Your output MUST be a JSON object with two keys: 'tests' (containing the test code) and 'test_report' (summarizing the testing process and outcome).",
      "input_keys": ["implementation", "prd", "tech_spec"],
      "output_keys": ["tests", "test_report"],
      "arg_name": "tester-tool",
      "max_retries": 1
    }
  ]
}
