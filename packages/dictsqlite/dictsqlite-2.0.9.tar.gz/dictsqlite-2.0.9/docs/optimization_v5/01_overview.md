# DictSQLite v5 最適化計画 - 概要

## プロジェクト目標
DictSQLiteのパフォーマンス、並行性、および安全性を大幅に向上させるための包括的な最適化計画です。
特に「読み取り時の書き込み（Write-on-Read）」によるボトルネックの解消と、Rust/Python間の統合効率化に焦点を当てています。

## 最適化の柱

### 1. I/Oと並行性の最適化
- **Write-on-Readの撤廃**: アクセスカウント更新をバッファリングし、読み取り操作を純粋なReadとして実行。
- **グローバルロックの排除**: `AsyncDictSQLite`の巨大なMutexを削除し、真の並列アクセスを実現。
- **ロックフリーWarm Tier**: `DashMap`の採用による内部競合の解消。
- **安全性と速度のバランス**: `PRAGMA synchronous=NORMAL`の採用。

### 2. リソースと統合の最適化
- **共有Tokio Runtime**: インスタンスごとのランタイム生成を廃止し、リソース効率を向上。
- **Pythonizeの採用**: JSON変換の高速化とコードの簡素化。
- **Zstd圧縮**: ディスク容量とI/O帯域の節約。

### 3. 効率化
- **テーブル存在キャッシュ**: 不要なSQLクエリの削減。

## ファイル構成
本計画は以下のドキュメントで構成されています：

- `01_overview.md`: 本ファイル（概要）
- `02_storage_engine.md`: StorageEngine（Core）の変更詳細
- `03_async_layer.md`: AsyncDictSQLite（Wrapper）の変更詳細
- `04_integration.md`: ライブラリ統合と依存関係
- `05_verification.md`: 検証とベンチマーク計画

## 期待される効果
- **読み取りスループット**: 10倍以上の向上（高並列時）
- **書き込みスループット**: 安定性の向上
- **リソース使用量**: スレッド数とメモリオーバーヘッドの削減
- **安全性**: データ破損リスクの低減
