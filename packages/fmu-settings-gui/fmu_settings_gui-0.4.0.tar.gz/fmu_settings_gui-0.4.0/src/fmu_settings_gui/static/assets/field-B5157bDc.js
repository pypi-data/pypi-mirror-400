var at=s=>{throw TypeError(s)};var ot=(s,i,t)=>i.has(s)||at("Cannot "+t);var F=(s,i,t)=>(ot(s,i,"read from private field"),t?t.call(s):i.get(s)),$=(s,i,t)=>i.has(s)?at("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(s):i.set(s,t),O=(s,i,t,e)=>(ot(s,i,"write to private field"),e?e.call(s,t):i.set(s,t),t);var lt=(s,i,t,e)=>({set _(n){O(s,i,n,t)},get _(){return F(s,i,e)}});import{r as S,t as X,j as v,d as E,al as ts,aw as se,p as Rt,l as W,h as De,i as Ye,o as Pt,n as Ue,s as Bt,aS as Wt,b6 as ct,K as je,A as ue,aG as ss,b7 as is,b8 as ns,z as zt,Q as rs}from"./index-CGCOPtAd.js";const as=(s,i)=>{S.useEffect(()=>{const t=()=>{s.style.height="auto";const{scrollHeight:e,clientHeight:n}=s;let r=n;i>r&&(r=Math.min(i,Math.max(e,r)),e>i?s.style.overflow="auto":s.style.overflow="hidden",r>n&&(s.style.height=`${r}px`))};return s&&i&&(t(),s.addEventListener("keyup",t,!0)),()=>{s==null||s.removeEventListener("keyup",t,!0)}},[s,i])},os=(s,i)=>{const t=s.value;s.value=i;const e=s._valueTracker;typeof e<"u"&&e.setValue(t),s.dispatchEvent(new Event("change",{bubbles:!0}))},Je=s=>{const{fontFamily:i,fontSize:t,fontWeight:e,lineHeight:n,letterSpacing:r,fontFeature:a,textDecoration:o,textTransform:l,fontStyle:u}=s;return{fontFeatureSettings:a,fontFamily:i,fontSize:t,fontWeight:e,letterSpacing:r,lineHeight:n,textDecoration:o,textTransform:l,fontStyle:u}},{colors:{infographic:{primary__moss_green_100:{rgba:ls}},interactive:{icon_on_interactive_colors:{rgba:cs},danger__resting:{rgba:us}}}}=X,ds={background:ls},hs={background:cs},fs={background:us},ut=Object.freeze(Object.defineProperty({__proto__:null,neutral:hs,primary:ds,tertiary:fs},Symbol.toStringTag,{value:"Module"})),Pe=ts(["0%{opacity:1;}100%{opacity:0.5;}"]),ms=E.svg.withConfig({displayName:"DotProgress__Svg",componentId:"sc-1s6o2q7-0"})(["fill:",";circle{&:nth-child(1){animation:"," 1s ease infinite;}&:nth-child(2){animation:"," 1s ease 0.2s infinite;}&:nth-child(3){animation:"," 1s ease 0.4s infinite;}}"],({color:s})=>s,Pe,Pe,Pe),gs=s=>ut[s]?ut[s].background:s,Ht=S.forwardRef(function({color:i="neutral",size:t=32,...e},n){const r={...e,color:gs(i),ref:n},a=t/4,o=t;return v.jsxs(ms,{...r,role:"progressbar",viewBox:"0 0 16 4",height:a,width:o,preserveAspectRatio:"xMidYMid meet",children:[v.jsx("circle",{cx:2,cy:2,r:2}),v.jsx("circle",{cx:8,cy:2,r:2}),v.jsx("circle",{cx:14,cy:2,r:2})]})}),{colors:{ui:{background__light:{rgba:ps}},text:{static_icons__default:vs,static_icons__tertiary:Be},interactive:{disabled__text:dt,primary__resting:ys,danger__resting:bs,danger__hover:ht,warning__resting:Fs,warning__hover:ft,success__resting:Ms,success__hover:mt}},spacings:{comfortable:{small:gt,x_small:be}},typography:de,shape:pt}=X,Ne={minHeight:pt.straight.minHeight,background:ps,spacings:{left:gt,right:gt,top:"6px",bottom:"6px"},typography:{...de.input.text,color:vs.rgba},entities:{placeholder:{typography:{color:Be.rgba}},helperText:{typography:{...de.input.label,color:Be.rgba},states:{disabled:{typography:{color:dt.rgba}}}}},states:{disabled:{typography:{color:dt.rgba}},readOnly:{background:"transparent",boxShadow:"none"},active:{outline:{type:"outline",color:"transparent",width:"1px",style:"solid",offset:"0px"}},focus:{outline:{type:"outline",width:"2px",color:ys.rgba,style:"solid",offset:"0px"}}},boxShadow:"inset 0px -1px 0px 0px "+Be.rgba,modes:{compact:{minHeight:pt._modes.compact.straight.minHeight,spacings:{left:be,right:be,top:be,bottom:be}}}},Ss=se(Ne,{boxShadow:"none",outline:{color:bs.rgba},states:{focus:{outline:{color:ht.rgba}}},entities:{helperText:{typography:{...de.input.label,color:ht.rgba}}}}),ws=se(Ne,{boxShadow:"none",outline:{color:Fs.rgba},states:{focus:{outline:{color:ft.rgba}}},entities:{helperText:{typography:{...de.input.label,color:ft.rgba}}}}),_s=se(Ne,{boxShadow:"none",outline:{color:Ms.rgba},states:{focus:{outline:{color:mt.rgba}}},entities:{helperText:{typography:{...de.input.label,color:mt.rgba}}}}),Vs={input:Ne,error:Ss,warning:ws,success:_s},{colors:vt,spacings:{comfortable:yt},typography:xs}=X,re={typography:{...xs.input.label,color:vt.text.static_icons__tertiary.rgba},spacings:{left:yt.small,right:yt.small},states:{disabled:{typography:{color:vt.interactive.disabled__text.rgba}}}},As=E.label.withConfig({displayName:"Label__LabelBase",componentId:"sc-1gi2bcn-0"})(["display:flex;justify-content:space-between;align-items:flex-end;position:relative;"," margin-left:",";margin-right:",";color:",";"],Rt(re.typography),re.spacings.left,re.spacings.right,({$disabledText:s})=>s?re.states.disabled.typography.color:re.typography.color),bt=E.span.withConfig({displayName:"Label__Text",componentId:"sc-1gi2bcn-1"})(["margin:0;"]),Ut=S.forwardRef(function(i,t){const{label:e="",meta:n,disabled:r=!1,...a}=i;return v.jsxs(As,{ref:t,$disabledText:r,...a,children:[v.jsx(bt,{children:e}),n&&v.jsx(bt,{children:n})]})}),{colors:Is,typography:Es}=X,Gt={typography:{...Es.input.helper,color:Is.text.static_icons__tertiary.rgba}},ks=E.div.withConfig({displayName:"HelperText__Container",componentId:"sc-189ug61-0"})(({color:s})=>W({display:"grid",gap:"8px",gridAutoFlow:"column",alignItems:"start",justifyContent:"start",color:s})),Cs=E.p.withConfig({displayName:"HelperText__Text",componentId:"sc-189ug61-1"})(["margin:0;",";white-space:pre-line;"],Je(Gt.typography)),Ls=S.forwardRef(function({text:i,icon:t,color:e=Gt.typography.color,...n},r){return i?v.jsxs(ks,{...n,color:e,ref:r,children:[t,v.jsx(Cs,{children:i})]}):null}),Ts=E.div.withConfig({displayName:"InputWrapper__Container",componentId:"sc-v6o9z1-0"})([""]),Os=E(Ls).withConfig({displayName:"InputWrapper__HelperText",componentId:"sc-v6o9z1-1"})(["margin-top:8px;margin-left:8px;"]),$s=E(Ut).withConfig({displayName:"InputWrapper__Label",componentId:"sc-v6o9z1-2"})(["margin-left:8px;margin-right:8px;"]),ve=S.forwardRef(function({children:i,color:t,label:e,labelProps:n={},helperProps:r={},helperIcon:a,...o},l){const{density:u}=De(),d=Vs[t||"input"],c=Ye({density:u},d),m=S.useCallback(()=>{const p=c();return o.disabled?p.entities.helperText.states.disabled.typography.color:p.entities.helperText.typography.color},[c,o.disabled])(),f=!!(r!=null&&r.text),g=!!(e||n!=null&&n.label);return v.jsx(Pt,{theme:c,children:v.jsxs(Ts,{...o,ref:l,children:[g&&v.jsx($s,{label:e,...n}),i,f&&v.jsx(Os,{color:m,icon:a,...r})]})})}),{colors:{ui:{background__light:{rgba:Ds}},text:{static_icons__default:js,static_icons__tertiary:We},interactive:{disabled__text:Ft,primary__resting:Ns,danger__resting:Mt,danger__hover:St,warning__resting:wt,warning__hover:_t,success__resting:Vt,success__hover:xt}},spacings:{comfortable:{small:Fe,x_small:Me}},typography:he,shape:At}=X,ie={height:At.straight.minHeight,width:"100%",background:Ds,spacings:{left:Fe,right:Fe,top:"6px",bottom:"6px"},typography:{...he.input.text,color:js.rgba},outline:{type:"outline",color:"transparent",width:"1px",style:"solid",offset:"0px"},entities:{placeholder:{typography:{color:We.rgba}},adornment:{typography:{...he.input.label,color:We.rgba},spacings:{left:Fe,right:Fe},states:{disabled:{typography:{color:Ft.rgba}}}}},states:{disabled:{typography:{color:Ft.rgba}},readOnly:{background:"transparent",boxShadow:"none"},active:{},focus:{outline:{type:"outline",width:"2px",color:Ns.rgba,style:"solid",offset:"0px"}}},boxShadow:"inset 0px -1px 0px 0px "+We.rgba,modes:{compact:{height:At._modes.compact.straight.minHeight,spacings:{left:Me,right:Me,top:Me,bottom:Me}}}},Kt=se(ie,{boxShadow:"none",outline:{color:Mt.rgba},states:{focus:{outline:{color:St.rgba}}},entities:{adornment:{typography:{...he.input.label,color:Mt.rgba},states:{focus:{outline:{color:St.rgba}}}}}}),qt=se(ie,{boxShadow:"none",outline:{color:wt.rgba},states:{focus:{outline:{color:_t.rgba}}},entities:{adornment:{typography:{...he.input.label,color:wt.rgba},states:{focus:{outline:{color:_t.rgba}}}}}}),Xt=se(ie,{boxShadow:"none",outline:{color:Vt.rgba},states:{focus:{outline:{color:xt.rgba}}},entities:{adornment:{typography:{...he.input.label,color:Vt.rgba},states:{focus:{outline:{color:xt.rgba}}}}}}),Ie={input:ie,error:Kt,warning:qt,success:Xt},Rs=Object.freeze(Object.defineProperty({__proto__:null,error:Kt,input:ie,inputToken:Ie,success:Xt,warning:qt},Symbol.toStringTag,{value:"Module"})),Ps=E.div.withConfig({displayName:"Input__Container",componentId:"sc-1ykv024-0"})(({$token:s,disabled:i,readOnly:t})=>{var r,a;const{states:e,entities:n}=s;return W(["--eds-input-adornment-color:",";--eds-input-color:",";position:relative;height:",";width:",";display:flex;flex-direction:row;border:none;box-sizing:border-box;box-shadow:",";background:var(--eds-input-background,",");"," &:focus-within{--eds-input-adornment-color:",";box-shadow:none;","}"," "," & > input{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}"],n.adornment.typography.color,s.typography.color,s.height,s.width,s.boxShadow,s.background,Ue(s.outline),(a=(r=n.adornment)==null?void 0:r.states.focus)==null?void 0:a.outline.color,Ue(e.focus.outline),i&&W(["--eds-input-adornment-color:",";--eds-input-color:",";cursor:not-allowed;box-shadow:none;"],e.disabled.typography.color,e.disabled.typography.color),t&&W({background:e.readOnly.background,boxShadow:e.readOnly.boxShadow}))}),Bs=E.input.withConfig({displayName:"Input__StyledInput",componentId:"sc-1ykv024-1"})(({$token:s,$paddingLeft:i,$paddingRight:t})=>W(["width:100%;border:none;background:transparent;"," "," outline:none;padding-left:",";padding-right:",";&::placeholder{color:",";}&:disabled{color:var(--eds-input-color);cursor:not-allowed;}"],Bt(s.spacings),Je(s.typography),i,t,s.entities.placeholder.typography.color)),Qt=E.div.withConfig({displayName:"Input__Adornments",componentId:"sc-1ykv024-2"})(({$token:s})=>W(["position:absolute;top:",";bottom:",";display:flex;align-items:center;"," color:var(--eds-input-adornment-color);"],s.spacings.top,s.spacings.bottom,Je(s.entities.adornment.typography))),Ws=E(Qt).withConfig({displayName:"Input__LeftAdornments",componentId:"sc-1ykv024-3"})(({$token:s})=>W(["left:0;padding-left:",";"],s.entities.adornment.spacings.left)),zs=E(Qt).withConfig({displayName:"Input__RightAdornments",componentId:"sc-1ykv024-4"})(({$token:s})=>W(["right:0;padding-right:",";"],s.entities.adornment.spacings.right)),Ze=S.forwardRef(function({variant:i,disabled:t=!1,type:e="text",leftAdornments:n,rightAdornments:r,readOnly:a,className:o,style:l,leftAdornmentsProps:u,rightAdornmentsProps:h,leftAdornmentsWidth:d,rightAdornmentsWidth:c,...m},f){const g=Ie[i]?Ie[i]:Ie.input,{density:p}=De(),y=Ye({density:p},g)(),[b,M]=S.useState(),[w,x]=S.useState(),V=S.useCallback(()=>{const U=d||(w?w.clientWidth:0),ne=c||(b?b.clientWidth:0);return{...y,spacings:{...y.spacings,left:`${U+parseInt(y.spacings.left)}px`,right:`${ne+parseInt(y.spacings.right)}px`}}},[d,w,c,b,y])(),I={ref:f,type:e,disabled:t,readOnly:a,$token:V,style:{resize:"none"},...m},k={disabled:t,readOnly:a,className:o,style:l,$token:V},A={...u,ref:x,$token:V},z={...h,ref:M,$token:V};return v.jsxs(Ps,{...k,children:[n?v.jsx(Ws,{...A,children:n}):null,v.jsx(Bs,{$paddingLeft:V.spacings.left,$paddingRight:V.spacings.right,...I}),r?v.jsx(zs,{...z,children:r}):null]})}),{input:It}=Rs,Hs=S.forwardRef(function({variant:i,disabled:t=!1,type:e="text",rowsMax:n,...r},a){const[o,l]=S.useState(null),{density:u}=De(),h=u==="compact"?It.modes.compact.spacings:It.spacings,{lineHeight:d}=ie.typography,{top:c,bottom:m}=h;let f=16;o&&(f=parseInt(window.getComputedStyle(o).fontSize));const g=parseInt(c)+parseInt(m),p=parseFloat(d)*f*n+g;as(o,n?p:null);const b={ref:S.useCallback(()=>Wt(a,l),[l,a])(),type:e,disabled:t,variant:i,...r},M={style:{alignItems:"flex-start"}},w={style:{alignItems:"flex-start",pointerEvents:"none"}};return v.jsx(Ze,{as:"textarea",rightAdornmentsProps:w,leftAdornmentsProps:M,style:{height:"auto"},...b})}),Us=S.forwardRef(function(i,t){return i.$multiline?v.jsx(Hs,{ref:t,...i}):v.jsx(Ze,{ref:t,...i})}),Gs=S.forwardRef(function({id:i,label:t,meta:e,unit:n,helperText:r,placeholder:a,disabled:o,multiline:l=!1,className:u,variant:h,inputIcon:d,helperIcon:c,style:m,rowsMax:f,textareaRef:g,inputRef:p,...y},b){const M=ct(i,"input"),w=ct(null,"helpertext");let V={"aria-invalid":h==="error"||void 0,disabled:o,placeholder:a,id:M,variant:h,rightAdornments:!!(n||d)&&v.jsxs(v.Fragment,{children:[d,v.jsx("span",{children:n})]}),rowsMax:f,ref:b||p||g,$multiline:l,...y},I={id:null,text:r,icon:c,disabled:o};const k={className:u,style:{width:"100%",...m},color:h},A={htmlFor:M,label:t,meta:e,disabled:o};return r&&(V={"aria-describedby":w,...V},I={...I,id:w}),v.jsx(ve,{helperProps:I,labelProps:A,...k,children:v.jsx(Us,{...V})})}),Ks=E(Ze).withConfig({displayName:"Search__SearchInput",componentId:"sc-v8l23u-0"})(["input{&[type='search']::-webkit-search-decoration,&[type='search']::-webkit-search-cancel-button,&[type='search']::-webkit-search-results-button,&[type='search']::-webkit-search-results-decoration{-webkit-appearance:none;}}"]),qs=E(je).withConfig({displayName:"Search__InsideButton",componentId:"sc-v8l23u-1"})(["height:24px;width:24px;"]),Xs=S.forwardRef(function({onChange:i,style:t,className:e,...n},r){const a=S.useRef(null),[o,l]=S.useState(!!n.defaultValue);S.useEffect(()=>{n.disabled?l(!1):n.value&&l(!!n.value)},[n.value,n.disabled]);const u=()=>{const c=a.current;os(c,"")},h=c=>{l(!!c.currentTarget.value)},d=S.useMemo(()=>Wt(a,r),[a,r]);return v.jsx(ve,{role:"search",style:t,className:e,children:v.jsx(Ks,{onChange:c=>{h(c),i&&i(c)},ref:d,leftAdornmentsWidth:32,leftAdornments:v.jsx(ue,{data:is,"aria-hidden":!0,size:18}),rightAdornmentsWidth:32,rightAdornments:v.jsx(v.Fragment,{children:o&&v.jsx(qs,{"aria-label":"clear search",title:"clear",variant:"ghost_icon",onClick:c=>{c.stopPropagation(),u()},children:v.jsx(ue,{data:ss,size:16})})}),...n})})}),{colors:ae,spacings:{comfortable:{small:Et,x_small:kt}},typography:Qs,shape:Ys}=X,D={background:ae.ui.background__light.rgba,typography:{...Qs.input.text,color:ae.text.static_icons__default.rgba},entities:{input:{spacings:{left:Et,right:Et,top:"6px",bottom:"6px"}},icon:{width:"24px"}},boxShadow:"inset 0 -1px 0 0 "+ae.text.static_icons__tertiary.rgba,states:{focus:{outline:{type:"outline",width:"2px",color:ae.interactive.primary__resting.rgba,style:"solid",offset:"0px"}},disabled:{typography:{color:ae.interactive.disabled__text.rgba}}},modes:{compact:{minHeight:Ys._modes.compact.straight.minHeight,entities:{input:{spacings:{left:kt,right:kt,top:"0",bottom:"0"}}}}}},Js=E.div.withConfig({displayName:"NativeSelect__Container",componentId:"sc-82vb16-0"})(["min-width:100px;width:100%;"]),Zs=E.select.withConfig({displayName:"NativeSelect__StyledSelect",componentId:"sc-82vb16-1"})(["border:none;border-radius:0;box-shadow:",";"," "," padding-right:calc("," *2 + ",");display:block;margin:0;appearance:none;background-image:"," linear-gradient( to bottom,"," 0%,"," 100% );background-repeat:no-repeat,repeat;background-position:right "," top 50%;width:100%;&:active,&:focus{box-shadow:none;","}&:disabled{color:",`;background-image:url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23bebebe' d='M7 9.5l5 5 5-5H7z'/%3E%3C/svg%3E"),linear-gradient( to bottom,`," 0%,"," 100% );cursor:not-allowed;box-shadow:none;outline:none;.arrow-icon{fill:red;}&:focus,&:active{outline:none;}}"],D.boxShadow,Rt(D.typography),({theme:s})=>W(["height:",";",""],s.minHeight,Bt(s.entities.input.spacings)),D.entities.input.spacings.right,D.entities.icon.width,s=>s.multiple?"":`url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%236f6f6f' d='M7 9.5l5 5 5-5H7z'/%3E%3C/svg%3E"),`,D.background,D.background,D.entities.input.spacings.right,Ue(D.states.focus.outline),D.states.disabled.typography.color,D.background,D.background),ei=S.forwardRef(function({label:i,children:t,className:e,style:n,selectRef:r,id:a,meta:o,disabled:l=!1,multiple:u=!1,...h},d){const{density:c}=De(),m=Ye({density:c},D),f={ref:d,className:e,style:n},g={ref:r,id:a,disabled:l,multiple:u,...h},p={htmlFor:a,label:i,meta:o,disabled:l},y=i||o;return v.jsx(Pt,{theme:m,children:v.jsxs(Js,{...f,children:[y&&v.jsx(Ut,{...p}),v.jsx(Zs,{...g,children:t})]})})}),J=new WeakMap,Ee=new WeakMap,Le={current:[]};let ze=!1,ce=0;const le=new Set,Se=new Map;function Yt(s){const i=Array.from(s).sort((t,e)=>t instanceof P&&t.options.deps.includes(e)?1:e instanceof P&&e.options.deps.includes(t)?-1:0);for(const t of i){if(Le.current.includes(t))continue;Le.current.push(t),t.recompute();const e=Ee.get(t);if(e)for(const n of e){const r=J.get(n);r&&Yt(r)}}}function ti(s){const i={prevVal:s.prevState,currentVal:s.state};for(const t of s.listeners)t(i)}function si(s){const i={prevVal:s.prevState,currentVal:s.state};for(const t of s.listeners)t(i)}function Jt(s){if(ce>0&&!Se.has(s)&&Se.set(s,s.prevState),le.add(s),!(ce>0)&&!ze)try{for(ze=!0;le.size>0;){const i=Array.from(le);le.clear();for(const t of i){const e=Se.get(t)??t.prevState;t.prevState=e,ti(t)}for(const t of i){const e=J.get(t);e&&(Le.current.push(t),Yt(e))}for(const t of i){const e=J.get(t);if(e)for(const n of e)si(n)}}}finally{ze=!1,Le.current=[],Se.clear()}}function R(s){ce++;try{s()}finally{if(ce--,ce===0){const i=le.values().next().value;i&&Jt(i)}}}function ii(s){return typeof s=="function"}class Ge{constructor(i,t){this.listeners=new Set,this.subscribe=e=>{var n,r;this.listeners.add(e);const a=(r=(n=this.options)==null?void 0:n.onSubscribe)==null?void 0:r.call(n,e,this);return()=>{this.listeners.delete(e),a==null||a()}},this.prevState=i,this.state=i,this.options=t}setState(i){var t,e,n;this.prevState=this.state,(t=this.options)!=null&&t.updateFn?this.state=this.options.updateFn(this.prevState)(i):ii(i)?this.state=i(this.prevState):this.state=i,(n=(e=this.options)==null?void 0:e.onUpdate)==null||n.call(e),Jt(this)}}class P{constructor(i){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const t=this.options.deps.length,e=new Array(t),n=new Array(t);for(let r=0;r<t;r++){const a=this.options.deps[r];e[r]=a.prevState,n[r]=a.state}return this.lastSeenDepValues=n,{prevDepVals:e,currDepVals:n,prevVal:this.prevState??void 0}},this.recompute=()=>{var t,e;this.prevState=this.state;const n=this.getDepVals();this.state=this.options.fn(n),(e=(t=this.options).onUpdate)==null||e.call(t)},this.checkIfRecalculationNeededDeeply=()=>{for(const r of this.options.deps)r instanceof P&&r.checkIfRecalculationNeededDeeply();let t=!1;const e=this.lastSeenDepValues,{currDepVals:n}=this.getDepVals();for(let r=0;r<n.length;r++)if(n[r]!==e[r]){t=!0;break}t&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const t of this._subscriptions)t()}),this.subscribe=t=>{var e,n;this.listeners.add(t);const r=(n=(e=this.options).onSubscribe)==null?void 0:n.call(e,t,this);return()=>{this.listeners.delete(t),r==null||r()}},this.options=i,this.state=i.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(i=this.options.deps){for(const t of i)if(t instanceof P)t.registerOnGraph(),this.registerOnGraph(t.options.deps);else if(t instanceof Ge){let e=J.get(t);e||(e=new Set,J.set(t,e)),e.add(this);let n=Ee.get(this);n||(n=new Set,Ee.set(this,n)),n.add(t)}}unregisterFromGraph(i=this.options.deps){for(const t of i)if(t instanceof P)this.unregisterFromGraph(t.options.deps);else if(t instanceof Ge){const e=J.get(t);e&&e.delete(this);const n=Ee.get(this);n&&n.delete(t)}}}function ye(s,i){return typeof s=="function"?s(i):s}function G(s,i){return Re(i).reduce((e,n)=>{if(e===null)return null;if(typeof e<"u")return e[n]},s)}function we(s,i,t){const e=Re(i);function n(r){if(!e.length)return ye(t,r);const a=e.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(r))return typeof r=="object"?(r===null&&(r={}),{...r,[a]:n(r[a])}):{[a]:n()};if(Array.isArray(r)&&typeof a=="number"){const o=r.slice(0,a);return[...o.length?o:new Array(a),n(r[a]),...r.slice(a+1)]}return[...new Array(a),n()]}return n(s)}function ni(s,i){const t=Re(i);function e(n){if(!n)return;if(t.length===1){const a=t[0];if(Array.isArray(n)&&typeof a=="number")return n.filter((u,h)=>h!==a);const{[a]:o,...l}=n;return l}const r=t.shift();if(typeof r=="string"&&typeof n=="object")return{...n,[r]:e(n[r])};if(typeof r=="number"&&Array.isArray(n)){if(r>=n.length)return n;const a=n.slice(0,r);return[...a.length?a:new Array(r),e(n[r]),...n.slice(r+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return e(s)}const ri=/^(\d+)$/gm,ai=/\.(\d+)(?=\.)/gm,oi=/^(\d+)\./gm,li=/\.(\d+$)/gm,ci=/\.{2,}/gm,Ke="__int__",_e=`${Ke}$1`;function Re(s){if(Array.isArray(s))return[...s];if(typeof s!="string")throw new Error("Path must be a string.");return s.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(ri,_e).replace(ai,`.${_e}.`).replace(oi,`${_e}.`).replace(li,`.${_e}`).replace(ci,".").split(".").map(i=>{if(i.startsWith(Ke)){const t=i.substring(Ke.length),e=parseInt(t,10);return String(e)===t?e:t}return i})}function Ct(s,i){return s.length===0?i:i.length===0?s:i.startsWith("[")||i.startsWith(".")?s+i:`${s}.${i}`}function ui(s){return!(Array.isArray(s)&&s.length===0)}function qe(s,i){const t=e=>e.validators.filter(Boolean).map(n=>({cause:n.cause,validate:n.fn}));return i.validationLogic({form:i.form,validators:i.validators,event:{type:s,async:!1},runValidation:t})}function Xe(s,i){const{asyncDebounceMs:t}=i,{onBlurAsyncDebounceMs:e,onChangeAsyncDebounceMs:n,onDynamicAsyncDebounceMs:r}=i.validators||{},a=t??0,o=l=>l.validators.filter(Boolean).map(u=>{const h=(u==null?void 0:u.cause)||s;let d=a;switch(h){case"change":d=n??a;break;case"blur":d=e??a;break;case"dynamic":d=r??a;break;case"submit":d=0;break}return s==="submit"&&(d=0),{cause:h,validate:u.fn,debounceMs:d}});return i.validationLogic({form:i.form,validators:i.validators,event:{type:s,async:!0},runValidation:o})}const Qe=s=>!!s&&typeof s=="object"&&"fields"in s;function Q(s,i){if(Object.is(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;if(s instanceof Date&&i instanceof Date)return s.getTime()===i.getTime();if(s instanceof Map&&i instanceof Map){if(s.size!==i.size)return!1;for(const[n,r]of s)if(!i.has(n)||!Object.is(r,i.get(n)))return!1;return!0}if(s instanceof Set&&i instanceof Set){if(s.size!==i.size)return!1;for(const n of s)if(!i.has(n))return!1;return!0}const t=Object.keys(s),e=Object.keys(i);if(t.length!==e.length)return!1;for(const n of t)if(!e.includes(n)||!Q(s[n],i[n]))return!1;return!0}const Lt=({newFormValidatorError:s,isPreviousErrorFromFormValidator:i,previousErrorValue:t})=>s?{newErrorValue:s,newSource:"form"}:i?{newErrorValue:void 0,newSource:void 0}:t?{newErrorValue:t,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},Tt=({formLevelError:s,fieldLevelError:i})=>i?{newErrorValue:i,newSource:"field"}:s?{newErrorValue:s,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function T(s,i){return s==null?i:{...s,...i}}let K=256;const ke=[];let Ve;for(;K--;)ke[K]=(K+256).toString(16).substring(1);function di(){let s=0,i,t="";if(!Ve||K+16>256){for(Ve=new Array(256),s=256;s--;)Ve[s]=256*Math.random()|0;s=0,K=0}for(;s<16;s++)i=Ve[K+s],s===6?t+=ke[i&15|64]:s===8?t+=ke[i&63|128]:t+=ke[i],s&1&&s>1&&s<11&&(t+="-");return K++,t}const Y=s=>{if(!s.validators)return s.runValidation({validators:[],form:s.form});const i=s.event.async,t=i?void 0:{fn:s.validators.onMount,cause:"mount"},e={fn:i?s.validators.onChangeAsync:s.validators.onChange,cause:"change"},n={fn:i?s.validators.onBlurAsync:s.validators.onBlur,cause:"blur"},r={fn:i?s.validators.onSubmitAsync:s.validators.onSubmit,cause:"submit"},a=i?void 0:{fn:()=>{},cause:"server"};switch(s.event.type){case"mount":return s.runValidation({validators:[t],form:s.form});case"submit":return s.runValidation({validators:[e,n,r,a],form:s.form});case"server":return s.runValidation({validators:[],form:s.form});case"blur":return s.runValidation({validators:[n,a],form:s.form});case"change":return s.runValidation({validators:[e,a],form:s.form});default:throw new Error(`Unknown validation event type: ${s.event.type}`)}};function hi(s,i){const t=new Map;for(const e of s){const n=e.path??[];let r=i,a="";for(let o=0;o<n.length;o++){const l=n[o];if(l===void 0)continue;const u=typeof l=="object"?l.key:l,h=Number(u);Array.isArray(r)&&!Number.isNaN(h)?a+=`[${h}]`:a+=(o>0?".":"")+String(u),typeof r=="object"&&r!==null?r=r[u]:r=void 0}t.set(a,(t.get(a)??[]).concat(e))}return Object.fromEntries(t)}const Ot=(s,i)=>{const t=hi(s,i);return{form:t,fields:t}},Z={validate({value:s,validationSource:i},t){const e=t["~standard"].validate(s);if(e instanceof Promise)throw new Error("async function passed to sync validator");if(e.issues)return i==="field"?e.issues:Ot(e.issues,s)},async validateAsync({value:s,validationSource:i},t){const e=await t["~standard"].validate(s);if(e.issues)return i==="field"?e.issues:Ot(e.issues,s)}},Zt=s=>!!s&&"~standard"in s,Te={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function xe(s){function i(d,c,m,f){const g=e(d,c,m,f);({insert:()=>o(g,d,c),remove:()=>l(g),swap:()=>f!==void 0&&h(g,d,c,f),move:()=>f!==void 0&&u(g,d,c,f)})[m]()}function t(d,c){return`${d}[${c}]`}function e(d,c,m,f){const g=[t(d,c)];if(m==="swap")g.push(t(d,f));else if(m==="move"){const[p,y]=[Math.min(c,f),Math.max(c,f)];for(let b=p;b<=y;b++)g.push(t(d,b))}else{const p=s.getFieldValue(d),y=Array.isArray(p)?p.length:0;for(let b=c+1;b<y;b++)g.push(t(d,b))}return Object.keys(s.fieldInfo).filter(p=>g.some(y=>p.startsWith(y)))}function n(d,c){return d.replace(/\[(\d+)\]/,(m,f)=>{const g=parseInt(f,10);return`[${c==="up"?g+1:Math.max(0,g-1)}]`})}function r(d,c){(c==="up"?d:[...d].reverse()).forEach(f=>{const g=n(f.toString(),c),p=s.getFieldMeta(g);p?s.setFieldMeta(f,p):s.setFieldMeta(f,a())})}const a=()=>Te,o=(d,c,m)=>{r(d,"down"),d.forEach(f=>{f.toString().startsWith(t(c,m))&&s.setFieldMeta(f,a())})},l=d=>{r(d,"up")},u=(d,c,m,f)=>{const g=new Map(Object.keys(s.fieldInfo).filter(p=>p.startsWith(t(c,m))).map(p=>[p,s.getFieldMeta(p)]));r(d,m<f?"up":"down"),Object.keys(s.fieldInfo).filter(p=>p.startsWith(t(c,f))).forEach(p=>{const y=p.replace(t(c,f),t(c,m)),b=g.get(y);b&&s.setFieldMeta(p,b)})},h=(d,c,m,f)=>{d.forEach(g=>{if(!g.toString().startsWith(t(c,m)))return;const p=g.toString().replace(t(c,m),t(c,f)),[y,b]=[s.getFieldMeta(g),s.getFieldMeta(p)];y&&s.setFieldMeta(p,y),b&&s.setFieldMeta(g,b)})};return{handleArrayFieldMetaShift:i}}var L,C,me,H,q,B,ee,ge,$e,pe,te;class fi{constructor({pluginId:i,debug:t=!1}){$(this,L);$(this,C);$(this,me);$(this,H);$(this,q);$(this,B);$(this,ee);$(this,ge,0);$(this,$e,5);$(this,pe,()=>{this.debugLog("Connected to event bus"),O(this,q,!0),this.debugLog("Emitting queued events",F(this,H)),F(this,H).forEach(i=>this.emitEventToBus(i)),O(this,H,[]),this.stopConnectLoop(),F(this,C).call(this).removeEventListener("tanstack-connect-success",F(this,pe))});$(this,te,()=>{if(F(this,C).call(this).addEventListener("tanstack-connect-success",F(this,pe)),F(this,ge)<F(this,$e)){lt(this,ge)._++,this.dispatchCustomEvent("tanstack-connect",{});return}F(this,C).call(this).removeEventListener("tanstack-connect",F(this,te)),this.debugLog("Max retries reached, giving up on connection"),this.stopConnectLoop()});O(this,L,i),O(this,C,this.getGlobalTarget),O(this,me,t),this.debugLog(" Initializing event subscription for plugin",F(this,L)),O(this,H,[]),O(this,q,!1),O(this,B,null),O(this,ee,500)}startConnectLoop(){F(this,B)!==null||F(this,q)||(this.debugLog(`Starting connect loop (every ${F(this,ee)}ms)`),O(this,B,setInterval(F(this,te),F(this,ee))))}stopConnectLoop(){F(this,B)!==null&&(clearInterval(F(this,B)),O(this,B,null),this.debugLog("Stopped connect loop"))}debugLog(...i){F(this,me)&&console.log(`ðŸŒ´ [tanstack-devtools:${F(this,L)}-plugin]`,...i)}getGlobalTarget(){if(typeof globalThis<"u"&&globalThis.__TANSTACK_EVENT_TARGET__)return this.debugLog("Using global event target"),globalThis.__TANSTACK_EVENT_TARGET__;if(typeof window<"u"&&typeof window.addEventListener<"u")return this.debugLog("Using window as event target"),window;const i=typeof EventTarget<"u"?new EventTarget:void 0;return typeof i>"u"||typeof i.addEventListener>"u"?(this.debugLog("No event mechanism available, running in non-web environment"),{addEventListener:()=>{},removeEventListener:()=>{},dispatchEvent:()=>!1}):(this.debugLog("Using new EventTarget as fallback"),i)}getPluginId(){return F(this,L)}dispatchCustomEventShim(i,t){try{const e=new Event(i,{detail:t});F(this,C).call(this).dispatchEvent(e)}catch{this.debugLog("Failed to dispatch shim event")}}dispatchCustomEvent(i,t){try{F(this,C).call(this).dispatchEvent(new CustomEvent(i,{detail:t}))}catch{this.dispatchCustomEventShim(i,t)}}emitEventToBus(i){this.debugLog("Emitting event to client bus",i),this.dispatchCustomEvent("tanstack-dispatch-event",i)}emit(i,t){if(!F(this,q)){this.debugLog("Bus not available, will be pushed as soon as connected"),F(this,H).push({type:`${F(this,L)}:${i}`,payload:t,pluginId:F(this,L)}),typeof CustomEvent<"u"&&(F(this,te).call(this),this.startConnectLoop());return}return this.emitEventToBus({type:`${F(this,L)}:${i}`,payload:t,pluginId:F(this,L)})}on(i,t){const e=`${F(this,L)}:${i}`,n=r=>{this.debugLog("Received event from bus",r.detail),t(r.detail)};return F(this,C).call(this).addEventListener(e,n),this.debugLog("Registered event to bus",e),()=>{F(this,C).call(this).removeEventListener(e,n)}}onAll(i){const t=e=>{const n=e.detail;i(n)};return F(this,C).call(this).addEventListener("tanstack-devtools-global",t),()=>F(this,C).call(this).removeEventListener("tanstack-devtools-global",t)}onAllPluginEvents(i){const t=e=>{const n=e.detail;F(this,L)&&n.pluginId!==F(this,L)||i(n)};return F(this,C).call(this).addEventListener("tanstack-devtools-global",t),()=>F(this,C).call(this).removeEventListener("tanstack-devtools-global",t)}}L=new WeakMap,C=new WeakMap,me=new WeakMap,H=new WeakMap,q=new WeakMap,B=new WeakMap,ee=new WeakMap,ge=new WeakMap,$e=new WeakMap,pe=new WeakMap,te=new WeakMap;class mi extends fi{constructor(){super({pluginId:"form-devtools"})}}const j=new mi;function He(s){return{values:s.values??{},errorMap:s.errorMap??{},fieldMetaBase:s.fieldMetaBase??{},isSubmitted:s.isSubmitted??!1,isSubmitting:s.isSubmitting??!1,isValidating:s.isValidating??!1,submissionAttempts:s.submissionAttempts??0,isSubmitSuccessful:s.isSubmitSuccessful??!1,validationMetaMap:s.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}}}class gi{constructor(i){var t;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var o,l;const e=this.fieldMetaDerived.mount(),n=this.store.mount(),r=()=>{e(),n(),j.emit("form-unmounted",{id:this._formId})};(l=(o=this.options.listeners)==null?void 0:o.onMount)==null||l.call(o,{formApi:this});const{onMount:a}=this.options.validators||{};return j.emit("form-state-change",{id:this._formId,state:this.store.state,options:this.options}),a&&this.validateSync("mount"),r},this.update=e=>{var l,u;if(!e)return;const n=this.options;this.options=e;const r=!!((u=(l=e.transform)==null?void 0:l.deps)!=null&&u.some((h,d)=>h!==this.prevTransformArray[d])),a=e.defaultValues&&!Q(e.defaultValues,n.defaultValues)&&!this.state.isTouched,o=!Q(e.defaultState,n.defaultState)&&!this.state.isTouched;!a&&!o&&!r||R(()=>{this.baseStore.setState(()=>He(Object.assign({},this.state,o?e.defaultState:{},a?{values:e.defaultValues}:{},r?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(e,n)=>{const{fieldMeta:r}=this.state,a=this.resetFieldMeta(r);e&&!(n!=null&&n.keepDefaultValues)&&(this.options={...this.options,defaultValues:e}),this.baseStore.setState(()=>{var o;return He({...this.options.defaultState,values:e??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async e=>{const n=[];return R(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;n.push(Promise.resolve().then(()=>o.validate(e,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(n)).flat()},this.validateArrayFieldsStartingFrom=async(e,n,r)=>{const a=this.getFieldValue(e),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${e}[${n}]`];for(let c=n+1;c<=(o??0);c++)l.push(`${e}[${c}]`);const u=Object.keys(this.fieldInfo).filter(c=>l.some(m=>c.startsWith(m))),h=[];return R(()=>{u.forEach(c=>{h.push(Promise.resolve().then(()=>this.validateField(c,r)))})}),(await Promise.all(h)).flat()},this.validateField=(e,n)=>{var a;const r=(a=this.fieldInfo[e])==null?void 0:a.instance;return r?(r.state.meta.isTouched||r.setMeta(o=>({...o,isTouched:!0})),r.validate(n)):[]},this.validateSync=e=>{const n=qe(e,{...this.options,form:this,validationLogic:this.options.validationLogic||Y});let r=!1;const a={};return R(()=>{var u,h,d;for(const c of n){if(!c.validate)continue;const m=this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:f,fieldErrors:g}=Ce(m),p=oe(c.cause);for(const y of Object.keys(this.state.fieldMeta)){const b=this.getFieldMeta(y);if(!b)continue;const{errorMap:M,errorSourceMap:w}=b,x=g==null?void 0:g[y],{newErrorValue:V,newSource:I}=Lt({newFormValidatorError:x,isPreviousErrorFromFormValidator:(w==null?void 0:w[p])==="form",previousErrorValue:M==null?void 0:M[p]});I==="form"&&(a[y]={...a[y],[p]:x}),(M==null?void 0:M[p])!==V&&this.setFieldMeta(y,k=>({...k,errorMap:{...k.errorMap,[p]:V},errorSourceMap:{...k.errorSourceMap,[p]:I}}))}((u=this.state.errorMap)==null?void 0:u[p])!==f&&this.baseStore.setState(y=>({...y,errorMap:{...y.errorMap,[p]:f}})),(f||g)&&(r=!0)}const o=oe("submit");(h=this.state.errorMap)!=null&&h[o]&&e!=="submit"&&!r&&this.baseStore.setState(c=>({...c,errorMap:{...c.errorMap,[o]:void 0}}));const l=oe("server");(d=this.state.errorMap)!=null&&d[l]&&e!=="server"&&!r&&this.baseStore.setState(c=>({...c,errorMap:{...c.errorMap,[l]:void 0}}))}),{hasErrored:r,fieldsErrorMap:a}},this.validateAsync=async e=>{const n=Xe(e,{...this.options,form:this,validationLogic:this.options.validationLogic||Y});this.state.isFormValidating||this.baseStore.setState(u=>({...u,isFormValidating:!0}));const r=[];let a;for(const u of n){if(!u.validate)continue;const h=oe(u.cause),d=this.state.validationMetaMap[h];d==null||d.lastAbortController.abort();const c=new AbortController;this.state.validationMetaMap[h]={lastAbortController:c},r.push(new Promise(async m=>{let f;try{f=await new Promise((b,M)=>{setTimeout(async()=>{if(c.signal.aborted)return b(void 0);try{b(await this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:c.signal},type:"validateAsync"}))}catch(w){M(w)}},u.debounceMs)})}catch(b){f=b}const{formError:g,fieldErrors:p}=Ce(f);p&&(a=a?{...a,...p}:p);const y=oe(u.cause);for(const b of Object.keys(this.state.fieldMeta)){const M=this.getFieldMeta(b);if(!M)continue;const{errorMap:w,errorSourceMap:x}=M,V=a==null?void 0:a[b],{newErrorValue:I,newSource:k}=Lt({newFormValidatorError:V,isPreviousErrorFromFormValidator:(x==null?void 0:x[y])==="form",previousErrorValue:w==null?void 0:w[y]});(w==null?void 0:w[y])!==I&&this.setFieldMeta(b,A=>({...A,errorMap:{...A.errorMap,[y]:I},errorSourceMap:{...A.errorSourceMap,[y]:k}}))}this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[y]:g}})),m(a?{fieldErrors:a,errorMapKey:y}:void 0)}))}let o=[];const l={};if(r.length){o=await Promise.all(r);for(const u of o)if(u!=null&&u.fieldErrors){const{errorMapKey:h}=u;for(const[d,c]of Object.entries(u.fieldErrors)){const f={...l[d]||{},[h]:c};l[d]=f}}}return this.baseStore.setState(u=>({...u,isFormValidating:!1})),l},this.validate=e=>{const{hasErrored:n,fieldsErrorMap:r}=this.validateSync(e);return n&&!this.options.asyncAlways?r:this.validateAsync(e)},this.getFieldValue=e=>G(this.state.values,e),this.getFieldMeta=e=>this.state.fieldMeta[e],this.getFieldInfo=e=>{var n;return(n=this.fieldInfo)[e]||(n[e]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}})},this.setFieldMeta=(e,n)=>{this.baseStore.setState(r=>({...r,fieldMetaBase:{...r.fieldMetaBase,[e]:ye(n,r.fieldMetaBase[e])}}))},this.resetFieldMeta=e=>Object.keys(e).reduce((n,r)=>{const a=r;return n[a]=Te,n},{}),this.setFieldValue=(e,n,r)=>{var u;const a=(r==null?void 0:r.dontUpdateMeta)??!1,o=(r==null?void 0:r.dontRunListeners)??!1,l=(r==null?void 0:r.dontValidate)??!1;R(()=>{a||this.setFieldMeta(e,h=>({...h,isTouched:!0,isDirty:!0,errorMap:{...h==null?void 0:h.errorMap,onMount:void 0}})),this.baseStore.setState(h=>({...h,values:we(h.values,e,n)}))}),o||(u=this.getFieldInfo(e).instance)==null||u.triggerOnChangeListener(),l||this.validateField(e,"change")},this.deleteField=e=>{const r=[...Object.keys(this.fieldInfo).filter(a=>{const o=e.toString();return a!==o&&a.startsWith(o)}),e];this.baseStore.setState(a=>{const o={...a};return r.forEach(l=>{o.values=ni(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(e,n,r)=>{this.setFieldValue(e,a=>[...Array.isArray(a)?a:[],n],r)},this.insertFieldValue=async(e,n,r,a)=>{this.setFieldValue(e,o=>[...o.slice(0,n),r,...o.slice(n)],T(a,{dontValidate:!0})),await this.validateField(e,"change"),xe(this).handleArrayFieldMetaShift(e,n,"insert"),await this.validateArrayFieldsStartingFrom(e,n,"change")},this.replaceFieldValue=async(e,n,r,a)=>{this.setFieldValue(e,o=>o.map((l,u)=>u===n?r:l),T(a,{dontValidate:!0})),await this.validateField(e,"change"),await this.validateArrayFieldsStartingFrom(e,n,"change")},this.removeFieldValue=async(e,n,r)=>{const a=this.getFieldValue(e),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(e,l=>l.filter((u,h)=>h!==n),T(r,{dontValidate:!0})),xe(this).handleArrayFieldMetaShift(e,n,"remove"),o!==null){const l=`${e}[${o}]`;this.deleteField(l)}await this.validateField(e,"change"),await this.validateArrayFieldsStartingFrom(e,n,"change")},this.swapFieldValues=(e,n,r,a)=>{this.setFieldValue(e,o=>{const l=o[n],u=o[r];return we(we(o,`${n}`,u),`${r}`,l)},T(a,{dontValidate:!0})),xe(this).handleArrayFieldMetaShift(e,n,"swap",r),this.validateField(e,"change"),this.validateField(`${e}[${n}]`,"change"),this.validateField(`${e}[${r}]`,"change")},this.moveFieldValues=(e,n,r,a)=>{this.setFieldValue(e,o=>{const l=[...o];return l.splice(r,0,l.splice(n,1)[0]),l},T(a,{dontValidate:!0})),xe(this).handleArrayFieldMetaShift(e,n,"move",r),this.validateField(e,"change"),this.validateField(`${e}[${n}]`,"change"),this.validateField(`${e}[${r}]`,"change")},this.clearFieldValues=(e,n)=>{const r=this.getFieldValue(e),a=Array.isArray(r)?Math.max(r.length-1,0):null;if(this.setFieldValue(e,[],T(n,{dontValidate:!0})),a!==null)for(let o=0;o<=a;o++){const l=`${e}[${o}]`;this.deleteField(l)}this.validateField(e,"change")},this.resetField=e=>{this.baseStore.setState(n=>({...n,fieldMetaBase:{...n.fieldMetaBase,[e]:Te},values:this.options.defaultValues?we(n.values,e,G(this.options.defaultValues,e)):n.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((e,[n,r])=>(Object.keys(r).length&&r.errors.length&&(e[n]={errors:r.errors,errorMap:r.errorMap}),e),{})}),this.parseValuesWithSchema=e=>Z.validate({value:this.state.values,validationSource:"form"},e),this.parseValuesWithSchemaAsync=e=>Z.validateAsync({value:this.state.values,validationSource:"form"},e),this.timeoutIds={validations:{},listeners:{},formListeners:{}},this._formId=(i==null?void 0:i.formId)??di(),this._devtoolsSubmissionOverride=!1,this.baseStore=new Ge(He({...i==null?void 0:i.defaultState,values:(i==null?void 0:i.defaultValues)??((t=i==null?void 0:i.defaultState)==null?void 0:t.values)})),this.fieldMetaDerived=new P({deps:[this.baseStore],fn:({prevDepVals:e,currDepVals:n,prevVal:r})=>{var d,c,m;const a=r,o=e==null?void 0:e[0],l=n[0];let u=0;const h={};for(const f of Object.keys(l.fieldMetaBase)){const g=l.fieldMetaBase[f],p=o==null?void 0:o.fieldMetaBase[f],y=a==null?void 0:a[f],b=G(l.values,f);let M=y==null?void 0:y.errors;if(!p||g.errorMap!==p.errorMap){M=Object.values(g.errorMap??{}).filter(k=>k!==void 0);const I=(d=this.getFieldInfo(f))==null?void 0:d.instance;I&&!I.options.disableErrorFlat&&(M=M==null?void 0:M.flat(1))}const w=!ui(M??[]),x=!g.isDirty,V=Q(b,G(this.options.defaultValues,f))||Q(b,(m=(c=this.getFieldInfo(f))==null?void 0:c.instance)==null?void 0:m.options.defaultValue);if(y&&y.isPristine===x&&y.isValid===w&&y.isDefaultValue===V&&y.errors===M&&g===p){h[f]=y,u++;continue}h[f]={...g,errors:M,isPristine:x,isValid:w,isDefaultValue:V}}return Object.keys(l.fieldMetaBase).length&&a&&u===Object.keys(l.fieldMetaBase).length?a:h}}),this.store=new P({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:e,currDepVals:n,prevVal:r})=>{var st,it,nt,rt;const a=r,o=e==null?void 0:e[0],l=n[0],u=n[1],h=Object.values(u).filter(Boolean),d=h.some(_=>_.isValidating),c=h.every(_=>_.isValid),m=h.some(_=>_.isTouched),f=h.some(_=>_.isBlurred),g=h.every(_=>_.isDefaultValue),p=m&&((st=l.errorMap)==null?void 0:st.onMount),y=h.some(_=>_.isDirty),b=!y,M=!!((it=l.errorMap)!=null&&it.onMount||h.some(_=>{var N;return(N=_==null?void 0:_.errorMap)==null?void 0:N.onMount})),w=!!d;let x=(a==null?void 0:a.errors)??[];(!o||l.errorMap!==o.errorMap)&&(x=Object.values(l.errorMap).reduce((_,N)=>N===void 0?_:N&&Qe(N)?(_.push(N.form),_):(_.push(N),_),[]));const V=x.length===0,I=c&&V,k=this.options.canSubmitWhenInvalid??!1,A=l.submissionAttempts===0&&!m&&!M||!w&&!l.isSubmitting&&I||k;let z=l.errorMap;if(p&&(x=x.filter(_=>_!==l.errorMap.onMount),z=Object.assign(z,{onMount:void 0})),a&&o&&a.errorMap===z&&a.fieldMeta===this.fieldMetaDerived.state&&a.errors===x&&a.isFieldsValidating===d&&a.isFieldsValid===c&&a.isFormValid===V&&a.isValid===I&&a.canSubmit===A&&a.isTouched===m&&a.isBlurred===f&&a.isPristine===b&&a.isDefaultValue===g&&a.isDirty===y&&Q(o,l))return a;let U={...l,errorMap:z,fieldMeta:this.fieldMetaDerived.state,errors:x,isFieldsValidating:d,isFieldsValid:c,isFormValid:V,isValid:I,canSubmit:A,isTouched:m,isBlurred:f,isPristine:b,isDefaultValue:g,isDirty:y};const ne=((nt=this.options.transform)==null?void 0:nt.deps)??[];if(ne.length!==this.prevTransformArray.length||ne.some((_,N)=>_!==this.prevTransformArray[N])){const _=Object.assign({},this,{state:U});(rt=this.options.transform)==null||rt.fn(_),U=_.state,this.prevTransformArray=ne}return U}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(i||{}),this.store.subscribe(()=>{j.emit("form-state-change",{id:this._formId,state:this.store.state,options:this.options})}),j.on("request-form-state",e=>{e.payload.id===this._formId&&j.emit("form-state-change",{id:this._formId,state:this.store.state,options:this.options})}),j.on("request-form-reset",e=>{e.payload.id===this._formId&&this.reset()}),j.on("request-form-force-submit",e=>{e.payload.id===this._formId&&(this._devtoolsSubmissionOverride=!0,this.handleSubmit(),this._devtoolsSubmissionOverride=!1)})}get state(){return this.store.state}get formId(){return this._formId}runValidator(i){return Zt(i.validate)?Z[i.type](i.value,i.validate):i.validate(i.value)}async handleSubmit(i){var n,r,a,o,l,u,h,d,c,m;this.baseStore.setState(f=>({...f,isSubmitted:!1,submissionAttempts:f.submissionAttempts+1,isSubmitSuccessful:!1})),R(()=>{Object.values(this.fieldInfo).forEach(f=>{f.instance&&(f.instance.state.meta.isTouched||f.instance.setMeta(g=>({...g,isTouched:!0})))})});const t=i??this.options.onSubmitMeta;if(!this.state.canSubmit&&!this._devtoolsSubmissionOverride){(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this,meta:t});return}this.baseStore.setState(f=>({...f,isSubmitting:!0}));const e=()=>{this.baseStore.setState(f=>({...f,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){e(),(o=(a=this.options).onSubmitInvalid)==null||o.call(a,{value:this.state.values,formApi:this,meta:t}),j.emit("form-submission-state-change",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validateAllFields",errors:Object.values(this.state.fieldMeta).map(f=>f.errors).flat()});return}if(await this.validate("submit"),!this.state.isValid){e(),(u=(l=this.options).onSubmitInvalid)==null||u.call(l,{value:this.state.values,formApi:this,meta:t}),j.emit("form-submission-state-change",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validate",errors:this.state.errors});return}R(()=>{Object.values(this.fieldInfo).forEach(f=>{var g,p,y;(y=(p=(g=f.instance)==null?void 0:g.options.listeners)==null?void 0:p.onSubmit)==null||y.call(p,{value:f.instance.state.value,fieldApi:f.instance})})}),(d=(h=this.options.listeners)==null?void 0:h.onSubmit)==null||d.call(h,{formApi:this,meta:t});try{await((m=(c=this.options).onSubmit)==null?void 0:m.call(c,{value:this.state.values,formApi:this,meta:t})),R(()=>{this.baseStore.setState(f=>({...f,isSubmitted:!0,isSubmitSuccessful:!0})),j.emit("form-submission-state-change",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!0}),e()})}catch(f){throw this.baseStore.setState(g=>({...g,isSubmitSuccessful:!1})),j.emit("form-submission-state-change",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"inflight",onError:f}),e(),f}}setErrorMap(i){R(()=>{Object.entries(i).forEach(([t,e])=>{const n=t;if(Qe(e)){const{formError:r,fieldErrors:a}=Ce(e);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,u=>({...u,errorMap:{...u.errorMap,[n]:a==null?void 0:a[o]},errorSourceMap:{...u.errorSourceMap,[n]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[n]:r}}))}else this.baseStore.setState(r=>({...r,errorMap:{...r.errorMap,[n]:e}}))})})}}function Ce(s){if(s){if(Qe(s)){const i=Ce(s.form).formError,t=s.fields;return{formError:i,fieldErrors:t}}return{formError:s}}return{formError:void 0}}function oe(s){switch(s){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";case"change":default:return"onChange"}}class pi{constructor(i){this.options={},this.mount=()=>{var r,a;const t=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const e=this.getInfo();e.instance=this,this.update(this.options);const{onMount:n}=this.options.validators||{};if(n){const o=this.runValidator({validate:n,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(a=(r=this.options.listeners)==null?void 0:r.onMount)==null||a.call(r,{value:this.state.value,fieldApi:this}),t},this.update=t=>{this.options=t;const e=this.name!==t.name;if(this.name=t.name,this.state.value===void 0){const n=G(t.form.options.defaultValues,t.name),r=t.defaultValue??n;e?this.setValue(a=>a||r,{dontUpdateMeta:!0}):r!==void 0&&this.setValue(r,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(t,e)=>{this.form.setFieldValue(this.name,t,T(e,{dontRunListeners:!0,dontValidate:!0})),e!=null&&e.dontRunListeners||this.triggerOnChangeListener(),e!=null&&e.dontValidate||this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=t=>this.form.setFieldMeta(this.name,t),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(t,e)=>{this.form.pushFieldValue(this.name,t,T(e,{dontRunListeners:!0})),e!=null&&e.dontRunListeners||this.triggerOnChangeListener()},this.insertValue=(t,e,n)=>{this.form.insertFieldValue(this.name,t,e,T(n,{dontRunListeners:!0})),n!=null&&n.dontRunListeners||this.triggerOnChangeListener()},this.replaceValue=(t,e,n)=>{this.form.replaceFieldValue(this.name,t,e,T(n,{dontRunListeners:!0})),n!=null&&n.dontRunListeners||this.triggerOnChangeListener()},this.removeValue=(t,e)=>{this.form.removeFieldValue(this.name,t,T(e,{dontRunListeners:!0})),e!=null&&e.dontRunListeners||this.triggerOnChangeListener()},this.swapValues=(t,e,n)=>{this.form.swapFieldValues(this.name,t,e,T(n,{dontRunListeners:!0})),n!=null&&n.dontRunListeners||this.triggerOnChangeListener()},this.moveValue=(t,e,n)=>{this.form.moveFieldValues(this.name,t,e,T(n,{dontRunListeners:!0})),n!=null&&n.dontRunListeners||this.triggerOnChangeListener()},this.clearValues=t=>{this.form.clearFieldValues(this.name,T(t,{dontRunListeners:!0})),t!=null&&t.dontRunListeners||this.triggerOnChangeListener()},this.getLinkedFields=t=>{const e=Object.values(this.form.fieldInfo),n=[];for(const r of e){if(!r.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=r.instance.options.validators||{};t==="change"&&(a!=null&&a.includes(this.name))&&n.push(r.instance),t==="blur"&&(o!=null&&o.includes(this.name))&&n.push(r.instance)}return n},this.validateSync=(t,e)=>{var u;const n=qe(t,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||Y}),a=this.getLinkedFields(t).reduce((h,d)=>{const c=qe(t,{...d.options,form:d.form,validationLogic:d.form.options.validationLogic||Y});return c.forEach(m=>{m.field=d}),h.concat(c)},[]);let o=!1;R(()=>{const h=(d,c)=>{var b;const m=Ae(c.cause),f=c.validate?$t(d.runValidator({validate:c.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,g=e[m],{newErrorValue:p,newSource:y}=Tt({formLevelError:g,fieldLevelError:f});((b=d.state.meta.errorMap)==null?void 0:b[m])!==p&&d.setMeta(M=>({...M,errorMap:{...M.errorMap,[m]:p},errorSourceMap:{...M.errorSourceMap,[m]:y}})),p&&(o=!0)};for(const d of n)h(this,d);for(const d of a)d.validate&&h(d.field,d)});const l=Ae("submit");return(u=this.state.meta.errorMap)!=null&&u[l]&&t!=="submit"&&!o&&this.setMeta(h=>({...h,errorMap:{...h.errorMap,[l]:void 0},errorSourceMap:{...h.errorSourceMap,[l]:void 0}})),{hasErrored:o}},this.validateAsync=async(t,e)=>{const n=Xe(t,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||Y}),r=await e,a=this.getLinkedFields(t),o=a.reduce((c,m)=>{const f=Xe(t,{...m.options,form:m.form,validationLogic:m.form.options.validationLogic||Y});return f.forEach(g=>{g.field=m}),c.concat(f)},[]);this.state.meta.isValidating||this.setMeta(c=>({...c,isValidating:!0}));for(const c of a)c.setMeta(m=>({...m,isValidating:!0}));const l=[],u=[],h=(c,m,f)=>{const g=Ae(m.cause),p=c.getInfo().validationMetaMap[g];p==null||p.lastAbortController.abort();const y=new AbortController;this.getInfo().validationMetaMap[g]={lastAbortController:y},f.push(new Promise(async b=>{var k;let M;try{M=await new Promise((A,z)=>{this.timeoutIds.validations[m.cause]&&clearTimeout(this.timeoutIds.validations[m.cause]),this.timeoutIds.validations[m.cause]=setTimeout(async()=>{if(y.signal.aborted)return A(void 0);try{A(await this.runValidator({validate:m.validate,value:{value:c.store.state.value,fieldApi:c,signal:y.signal,validationSource:"field"},type:"validateAsync"}))}catch(U){z(U)}},m.debounceMs)})}catch(A){M=A}if(y.signal.aborted)return b(void 0);const w=$t(M),x=(k=r[this.name])==null?void 0:k[g],{newErrorValue:V,newSource:I}=Tt({formLevelError:x,fieldLevelError:w});c.setMeta(A=>({...A,errorMap:{...A==null?void 0:A.errorMap,[g]:V},errorSourceMap:{...A.errorSourceMap,[g]:I}})),b(V)}))};for(const c of n)c.validate&&h(this,c,l);for(const c of o)c.validate&&h(c.field,c,u);let d=[];(l.length||u.length)&&(d=await Promise.all(l),await Promise.all(u)),this.setMeta(c=>({...c,isValidating:!1}));for(const c of a)c.setMeta(m=>({...m,isValidating:!1}));return d.filter(Boolean)},this.validate=(t,e)=>{var o;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:n}=e!=null&&e.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(t),{hasErrored:r}=this.validateSync(t,n[this.name]??{});if(r&&!this.options.asyncAlways)return(o=this.getInfo().validationMetaMap[Ae(t)])==null||o.lastAbortController.abort(),this.state.meta.errors;const a=e!=null&&e.skipFormValidation?Promise.resolve({}):this.form.validateAsync(t);return this.validateAsync(t,a)},this.handleChange=t=>{this.setValue(t)},this.handleBlur=()=>{this.state.meta.isTouched||this.setMeta(e=>({...e,isTouched:!0})),this.state.meta.isBlurred||this.setMeta(e=>({...e,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=t=>Z.validate({value:this.state.value,validationSource:"field"},t),this.parseValueWithSchemaAsync=t=>Z.validateAsync({value:this.state.value,validationSource:"field"},t),this.form=i.form,this.name=i.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new P({deps:[this.form.store],fn:()=>{const t=this.form.getFieldValue(this.name),e=this.form.getFieldMeta(this.name)??{...Te,...i.defaultMeta};return{value:t,meta:e}}}),this.options=i}get state(){return this.store.state}runValidator(i){return Zt(i.validate)?Z[i.type](i.value,i.validate):i.validate(i.value)}setErrorMap(i){this.setMeta(t=>({...t,errorMap:{...t.errorMap,...i}}))}triggerOnBlurListener(){var e,n,r,a,o,l;const i=(e=this.form.options.listeners)==null?void 0:e.onBlurDebounceMs;i&&i>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var u,h;(h=(u=this.form.options.listeners)==null?void 0:u.onBlur)==null||h.call(u,{formApi:this.form,fieldApi:this})},i)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const t=(a=this.options.listeners)==null?void 0:a.onBlurDebounceMs;t&&t>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var u,h;(h=(u=this.options.listeners)==null?void 0:u.onBlur)==null||h.call(u,{value:this.state.value,fieldApi:this})},t)):(l=(o=this.options.listeners)==null?void 0:o.onBlur)==null||l.call(o,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var e,n,r,a,o,l;const i=(e=this.form.options.listeners)==null?void 0:e.onChangeDebounceMs;i&&i>0?(this.timeoutIds.formListeners.change&&clearTimeout(this.timeoutIds.formListeners.change),this.timeoutIds.formListeners.change=setTimeout(()=>{var u,h;(h=(u=this.form.options.listeners)==null?void 0:u.onChange)==null||h.call(u,{formApi:this.form,fieldApi:this})},i)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const t=(a=this.options.listeners)==null?void 0:a.onChangeDebounceMs;t&&t>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var u,h;(h=(u=this.options.listeners)==null?void 0:u.onChange)==null||h.call(u,{value:this.state.value,fieldApi:this})},t)):(l=(o=this.options.listeners)==null?void 0:o.onChange)==null||l.call(o,{value:this.state.value,fieldApi:this})}}function $t(s){if(s)return s}function Ae(s){switch(s){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";case"change":default:return"onChange"}}class Oe{constructor(i){if(this.getFormFieldName=t=>{if(typeof this.fieldsMap=="string")return Ct(this.fieldsMap,t);const e=Re(t)[0];if(typeof e!="string")return"";const n=t.slice(e.length),r=this.fieldsMap[e];return Ct(r,n)},this.getFormFieldOptions=t=>{const e={...t},n=e.validators;if(e.name=this.getFormFieldName(t.name),n&&(n.onChangeListenTo||n.onBlurListenTo)){const r={...n},a=o=>{if(o)return o.map(l=>this.getFormFieldName(l))};r.onChangeListenTo=a(n.onChangeListenTo),r.onBlurListenTo=a(n.onBlurListenTo),e.validators=r}return e},this.mount=()=>this.store.mount(),this.validateArrayFieldsStartingFrom=async(t,e,n)=>this.form.validateArrayFieldsStartingFrom(this.getFormFieldName(t),e,n),this.validateField=(t,e)=>this.form.validateField(this.getFormFieldName(t),e),this.getFieldValue=t=>this.form.getFieldValue(this.getFormFieldName(t)),this.getFieldMeta=t=>this.form.getFieldMeta(this.getFormFieldName(t)),this.setFieldMeta=(t,e)=>this.form.setFieldMeta(this.getFormFieldName(t),e),this.setFieldValue=(t,e,n)=>this.form.setFieldValue(this.getFormFieldName(t),e,n),this.deleteField=t=>this.form.deleteField(this.getFormFieldName(t)),this.pushFieldValue=(t,e,n)=>this.form.pushFieldValue(this.getFormFieldName(t),e,n),this.insertFieldValue=async(t,e,n,r)=>this.form.insertFieldValue(this.getFormFieldName(t),e,n,r),this.replaceFieldValue=async(t,e,n,r)=>this.form.replaceFieldValue(this.getFormFieldName(t),e,n,r),this.removeFieldValue=async(t,e,n)=>this.form.removeFieldValue(this.getFormFieldName(t),e,n),this.swapFieldValues=(t,e,n,r)=>this.form.swapFieldValues(this.getFormFieldName(t),e,n,r),this.moveFieldValues=(t,e,n,r)=>this.form.moveFieldValues(this.getFormFieldName(t),e,n,r),this.clearFieldValues=(t,e)=>this.form.clearFieldValues(this.getFormFieldName(t),e),this.resetField=t=>this.form.resetField(this.getFormFieldName(t)),this.validateAllFields=t=>this.form.validateAllFields(t),i.form instanceof Oe){const t=i.form;if(this.form=t.form,typeof i.fields=="string")this.fieldsMap=t.getFormFieldName(i.fields);else{const e={...i.fields};for(const n in e)e[n]=t.getFormFieldName(e[n]);this.fieldsMap=e}}else this.form=i.form,this.fieldsMap=i.fields;this.store=new P({deps:[this.form.store],fn:({currDepVals:t})=>{const e=t[0];let n;if(typeof this.fieldsMap=="string")n=G(e.values,this.fieldsMap);else{n={};const r=this.fieldsMap;for(const a in r)n[a]=G(e.values,r[a])}return{values:n}}})}get state(){return this.store.state}async handleSubmit(i){return this.form.handleSubmit(i)}}function et(s,i=t=>t){return ns.useSyncExternalStoreWithSelector(s.subscribe,()=>s.state,()=>s.state,i,vi)}function vi(s,i){if(Object.is(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;if(s instanceof Map&&i instanceof Map){if(s.size!==i.size)return!1;for(const[e,n]of s)if(!i.has(e)||!Object.is(n,i.get(e)))return!1;return!0}if(s instanceof Set&&i instanceof Set){if(s.size!==i.size)return!1;for(const e of s)if(!i.has(e))return!1;return!0}if(s instanceof Date&&i instanceof Date)return s.getTime()===i.getTime();const t=Dt(s);if(t.length!==Dt(i).length)return!1;for(let e=0;e<t.length;e++)if(!Object.prototype.hasOwnProperty.call(i,t[e])||!Object.is(s[t[e]],i[t[e]]))return!1;return!0}function Dt(s){return Object.keys(s).concat(Object.getOwnPropertySymbols(s))}const fe=typeof window<"u"?S.useLayoutEffect:S.useEffect;function yi(s){const[i]=S.useState(()=>{const e=new pi({...s,form:s.form,name:s.name});return e.Field=es,e});return fe(i.mount,[i]),fe(()=>{i.update(s)}),et(i.store,s.mode==="array"?t=>[t.meta,Object.keys(t.value??[]).length]:void 0),i}const es=(({children:s,...i})=>{const t=yi(i),e=S.useMemo(()=>ye(s,t),[s,t,t.state.value,t.state.meta]);return v.jsx(v.Fragment,{children:e})});function bi({form:s,selector:i,children:t}){const e=et(s.store,i);return ye(t,e)}function Fi(s){const[i]=S.useState(()=>{const t=new gi(s),e=t;return e.Field=function(r){return v.jsx(es,{...r,form:t})},e.Subscribe=function(r){return v.jsx(bi,{form:t,selector:r.selector,children:r.children})},e});return fe(i.mount,[]),fe(()=>{i.update(s)}),i}function Mi({lens:s,selector:i,children:t}){const e=et(s.store,i);return ye(t,e)}function Si(s){const[i]=S.useState(()=>{const t=new Oe(s),e=s.form instanceof Oe?s.form.form:s.form,n=t;return n.AppForm=function(a){return v.jsx(e.AppForm,{...a})},n.AppField=function(a){return v.jsx(e.AppField,{...i.getFormFieldOptions(a)})},n.Field=function(a){return v.jsx(e.Field,{...i.getFormFieldOptions(a)})},n.Subscribe=function(a){return v.jsx(Mi,{lens:i,selector:a.selector,children:a.children})},Object.assign(n,{...s.formComponents})});return fe(i.mount,[i]),i}const jt=S.createContext(null),Nt=S.createContext(null);function wi(){function s(){const t=S.useContext(jt);if(!t)throw new Error("`fieldContext` only works when within a `fieldComponent` passed to `createFormHook`");return t}function i(){const t=S.useContext(Nt);if(!t)throw new Error("`formContext` only works when within a `formComponent` passed to `createFormHook`");return t}return{fieldContext:jt,useFieldContext:s,useFormContext:i,formContext:Nt}}function ki({fieldComponents:s,fieldContext:i,formContext:t,formComponents:e}){function n(o){const l=Fi(o),u=S.useMemo(()=>(({children:m})=>v.jsx(t.Provider,{value:l,children:m})),[l]),h=S.useMemo(()=>(({children:m,...f})=>v.jsx(l.Field,{...f,children:g=>v.jsx(i.Provider,{value:g,children:m(Object.assign(g,s))})})),[l]);return S.useMemo(()=>Object.assign(l,{AppField:h,AppForm:u,...e}),[l,h,u])}function r({render:o,props:l}){return u=>o({...l,...u})}function a({render:o,props:l,defaultValues:u}){return function(d){const c=S.useMemo(()=>({form:d.form,fields:d.fields,defaultValues:u,formComponents:e}),[d.form,d.fields]),m=Si(c);return o({...l,...d,group:m})}}return{useAppForm:n,withForm:r,withFieldGroup:a}}function Ci({label:s,variant:i,disabled:t,isPending:e,tooltipText:n,onClick:r}){return v.jsx(zt,{title:n??"",children:v.jsxs(je,{variant:i,"aria-disabled":t,onClick:t?a=>{a.preventDefault()}:r,children:[e&&v.jsx(Ht,{color:i==="outlined"?"primary":void 0,style:{position:"absolute"}}),v.jsx("span",{style:{visibility:e?"hidden":void 0},children:s})]})})}function Li({label:s,disabled:i,isPending:t,helperTextDisabled:e="Form can be submitted when errors have been resolved"}){return v.jsx(zt,{title:i?e:void 0,children:v.jsx(je,{type:"submit","aria-disabled":i,onClick:n=>{i&&n.preventDefault()},children:t?v.jsx(Ht,{}):s})})}function Ti({onClick:s}){return v.jsx(je,{type:"reset",variant:"outlined",onClick:s,children:"Cancel"})}const{fieldContext:Oi,formContext:$i,useFieldContext:tt,useFormContext:Di}=wi();function ji(s){return s.map(i=>({value:i.uuid,label:i.identifier}))}function Ni(s,i){const t=s.filter(e=>String(e.uuid)===i);return t.length===1?t[0]:void 0}function Ri(s,i,t){const e=Array.isArray(t)?t:[t],n=s.state.value;if(i==="addition")e.map(r=>{n.findIndex(o=>o.uuid===r.uuid)<0&&s.pushValue(r)});else{const r=[];e.map(a=>{const o=n.findIndex(l=>l.uuid===a.uuid);o>=0&&r.push(o)}),r.length>0&&r.sort((a,o)=>o-a).map(a=>{s.removeValue(a)})}}const _i=E(ve)`

  .errorText {
    color: ${X.colors.interactive.danger__text.hex};
  }
`,Vi=E(Xs)`
  width: 100%;
`;ue.add({error_filled:rs});const xi="Loading options...";function Pi({label:s,multiline:i=!1,rows:t,placeholder:e,helperText:n,isReadOnly:r,toUpperCase:a,setSubmitDisabled:o}){const l=tt();return S.useEffect(()=>{o&&o(l.state.meta.isDefaultValue||!l.state.meta.isValid)},[o,l.state.meta.isDefaultValue,l.state.meta.isValid]),v.jsx(ve,{helperProps:{text:n},children:v.jsx(Gs,{id:l.name,name:l.name,label:s,multiline:i,rows:t,readOnly:r,value:l.state.value,placeholder:e,onBlur:l.handleBlur,onChange:u=>{let h=u.target.value;a&&(h=h.toUpperCase()),l.handleChange(h)},...!l.state.meta.isValid&&{variant:"error",helperIcon:v.jsx(ue,{name:"error_filled",title:"Error",size:16}),helperText:l.state.meta.errors.map(u=>u.message).join(", ")}})})}function Bi({placeholder:s,helperText:i,toUpperCase:t}){const e=tt();return v.jsx(ve,{helperProps:{text:i},children:v.jsx(Vi,{id:e.name,value:e.state.value,placeholder:s,onBlur:e.handleBlur,onChange:n=>{let r=n.target.value;t&&(r=r.toUpperCase()),e.handleChange(r)}})})}function Wi({label:s,helperText:i,value:t,options:e,loadingOptions:n,onChange:r}){const a=tt();return v.jsx(_i,{helperProps:a.state.meta.isValid||n?{text:n?xi:i}:{className:"errorText",icon:v.jsx(ue,{name:"error_filled",title:"Error",size:16}),text:a.state.meta.errors.map(o=>o).join(", ")},children:v.jsx(ei,{id:a.name,label:s,value:t,onChange:o=>{r(o.target.value)},children:e.map(o=>v.jsx("option",{value:o.value,children:o.label},o.value))})})}export{Ti as C,Ht as D,Ci as G,ve as I,Ut as L,ei as N,Li as S,Pi as T,$i as a,Di as b,ki as c,Wi as d,Ze as e,Oi as f,Ls as g,Ni as h,ji as i,Ri as j,Bi as k,tt as u};
