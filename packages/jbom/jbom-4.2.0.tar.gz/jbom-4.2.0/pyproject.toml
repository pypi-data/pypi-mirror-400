[build-system]
requires = ["setuptools>=61.0", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "jbom"
version = "4.2.0"
description = "Intelligent KiCad Bill of Materials generator with inventory matching"
readme = "README.md"
license = "AGPL-3.0-only"
authors = [{name = "John Plocher", email = "John.Plocher@gmail.com"}]
keywords = ["kicad", "bom", "bill-of-materials", "pcb", "electronics", "inventory"]
classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Environment :: Console",
    "Intended Audience :: Developers",
    "Intended Audience :: Manufacturing",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Topic :: Scientific/Engineering",
    "Topic :: Office/Business",
    "Topic :: Utilities",
]
requires-python = ">=3.9"
dependencies = [
    "sexpdata>=0.0.3",
    "PyYAML>=5.4.0",
]

[project.optional-dependencies]
excel = ["openpyxl>=3.0"]
numbers = ["numbers-parser>=3.0"]
search = ["requests>=2.28.0"]
dev = [
    "build>=0.10.0",
    "twine>=4.0.0",
    "wheel>=0.37.0",
]
all = [
    "openpyxl>=3.0",
    "numbers-parser>=3.0",
    "requests>=2.28.0",
]

[project.urls]
Homepage = "https://github.com/plocher/jBOM"
Documentation = "https://github.com/plocher/jBOM#readme"
Repository = "https://github.com/plocher/jBOM.git"
Issues = "https://github.com/plocher/jBOM/issues"

[project.scripts]
jbom = "jbom.cli.main:main"

[tool.setuptools]
package-dir = {"" = "src"}

[tool.setuptools.package-data]
# Include configuration files in the package
jbom = [
    "config/*.yaml",
    "config/fabricators/*.yaml",
]

# Python Semantic Release v9 configuration
# See: https://python-semantic-release.readthedocs.io/
[tool.semantic_release]
# Version management
version_toml = ["pyproject.toml:project.version"]
version_variables = ["src/jbom/__version__.py:__version__"]

# Build configuration
build_command = "pip install build && python -m build"
dist_glob_patterns = ["dist/*"]

# Branch configuration
branch = "main"

# Changelog configuration
[tool.semantic_release.changelog]
exclude_commit_patterns = [
    "^chore(?:\\(.+\\))?: .*",
    "^ci(?:\\(.+\\))?: .*",
    "^docs(?:\\(.+\\))?: .*",
    "^style(?:\\(.+\\))?: .*",
    "^test(?:\\(.+\\))?: .*",
]

# Commit parsing (use default Angular-style)
[tool.semantic_release.commit_parser_options]
major_tags = ["breaking"]
minor_tags = ["feat", "feature"]
patch_tags = ["fix", "perf", "refactor"]

# Publishing configuration
[tool.semantic_release.publish]
dist_glob_patterns = ["dist/*"]
upload_to_vcs_release = true
upload_to_pypi = true
upload_to_repository = true

# Behave (BDD testing) configuration
[tool.behave]
default_tags = ["-wip"]
paths = ["features"]
default_format = "pretty"
show_timings = true
stdout_capture = false
stderr_capture = false
