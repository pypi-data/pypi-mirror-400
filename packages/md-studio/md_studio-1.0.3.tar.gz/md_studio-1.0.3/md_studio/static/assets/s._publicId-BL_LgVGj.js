import{r as n,j as e}from"./jsx-runtime-BiXka7E7.js";import{M as w}from"./MarkdownPreview-CMAtWhhj.js";import{T as j,A as b}from"./AttachmentGallery-rQjnqjTm.js";import{w as y}from"./index-BwWm0JV9.js";import{c as N,a as v,f as P}from"./date-utils-CPa5qVN4.js";import{N as S}from"./not-found-page-FnOw7Rim.js";import{v as E}from"./components-CZmywKMH.js";import"./loader-circle-BRNhzI2j.js";import"./index-CkllyZqd.js";function A(s,t){const r=new Set;let a;for(;(a=t.exec(s))!==null;)r.add(a[1]);return Array.from(r)}const L=()=>[{title:"Shared Document | md-studio"},{name:"robots",content:"noindex, nofollow"}];function C(){const{publicId:s}=E(),[t,r]=n.useState(null),[a,i]=n.useState(!0),[l,c]=n.useState(null),[u,d]=n.useState(!1),m=typeof window<"u"?window.location.origin:"";if(n.useEffect(()=>{if(!s)return;d(!1);const g=typeof window<"u"?window.ENV?.BASE_PATH??"":"";fetch(y(`/api/get?publicId=${encodeURIComponent(s)}`,g)).then(async o=>{if(o.status===404)return d(!0),i(!1),null;if(!o.ok)throw new Error(`Failed to load document (${o.status})`);return o.json()}).then(o=>{o&&(o?.doc?.isPublic?r(o.doc):c("Document not found or not public"),i(!1))}).catch(o=>{console.error("Failed to load document:",o),c("Failed to load document"),i(!1)})},[s]),a)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."});if(u)return e.jsx(S,{});if(l||!t)return e.jsx("div",{className:"min-h-screen flex items-center justify-center text-red-500",children:l||"Document not found"});const f=/!\[([^\]]*)\]\((uploads\/[^)]+)\)/g,p=A(t.bodyMd||"",f),x=N(t.bodyMd||""),h=v(t.bodyMd||"");return e.jsxs("main",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight",children:t.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Updated ",P(t.updatedAt)]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[x.toLocaleString()," words"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[h," min read"]})]})]}),e.jsx("div",{children:e.jsx(j,{doc:t,shareBaseUrl:m,allowEdit:!1,showVisibilityToggle:!1})}),e.jsx("article",{className:"prose prose-neutral dark:prose-invert prose-headings:scroll-mt-20 prose-p:leading-7 prose-pre:bg-transparent prose-pre:p-0 mx-auto max-w-4xl",children:e.jsx(w,{content:t.bodyMd})}),e.jsx(b,{images:p,shareBaseUrl:m})]})}export{C as default,L as meta};
