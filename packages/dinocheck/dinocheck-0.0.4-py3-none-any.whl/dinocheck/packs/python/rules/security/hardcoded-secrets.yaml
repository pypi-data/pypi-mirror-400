id: python/hardcoded-secrets
name: Hardcoded Secrets Detection
level: critical
category: security
description: |
  Detects API keys, passwords, tokens, and other secrets hardcoded in source code.

  These should be loaded from environment variables, secret managers, or config files
  that are not committed to version control.

triggers:
  file_patterns:
    - "**/*.py"
  code_patterns:
    - "api_key\\s*="
    - "api_secret\\s*="
    - "password\\s*="
    - "secret\\s*="
    - "token\\s*="
    - "AWS_"
    - "OPENAI_"
    - "sk-"
    - "Bearer "

checklist:
  - Is this a real secret value or a placeholder/example?
  - Does the value look like a real API key, token, or password (not "changeme" or "xxx")?
  - Is this loaded from environment variables or a secrets manager?
  - Could this be a test/mock value that's safe to commit?
  - Is this in a config file that should be gitignored?

fix: |
  Load secrets from environment variables using os.environ.get() or
  a library like python-dotenv. Never commit real credentials to source control.

tags:
  - security
  - secrets
  - credentials

examples:
  bad: |
    API_KEY = "sk-1234567890abcdef"
    client = OpenAI(api_key="sk-real-key-here")
  good: |
    API_KEY = os.environ.get("API_KEY")
    client = OpenAI(api_key=os.environ["OPENAI_API_KEY"])
