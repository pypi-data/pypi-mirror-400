@prefix ex: <http://datashapes.org/sh/tests/core/complex/personexample.test#> .
@prefix mf: <http://www.w3.org/2001/sw/DataAccess/tests/test-manifest#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix sht: <http://www.w3.org/ns/shacl-test#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

@base <urn:shacl-advanced-core:> .
<personexample> a sht:Validate ;
    rdfs:label "Test of personexample" ;
    mf:action [ sht:dataGraph <personexample.test.ttl> ;
            sht:shapesGraph <personexample.test.ttl> ] ;
    mf:result [ a sh:ValidationReport ;
            sh:conforms false ;
            sh:result [ a sh:ValidationResult ;
                    sh:focusNode ex:Bob ;
                    sh:resultPath ex:ssn ;
                    sh:resultSeverity sh:Violation ;
                    sh:sourceConstraintComponent sh:MaxCountConstraintComponent ;
                    sh:sourceShape _:n5289ed6dae574208a33741e1a2e758f3b4 ],
                [ a sh:ValidationResult ;
                    sh:focusNode ex:Calvin ;
                    sh:resultPath ex:birthDate ;
                    sh:resultSeverity sh:Violation ;
                    sh:sourceConstraintComponent sh:ClosedConstraintComponent ;
                    sh:sourceShape ex:PersonShape ;
                    sh:value "1999-09-09"^^xsd:date ],
                [ a sh:ValidationResult ;
                    sh:focusNode ex:Calvin ;
                    sh:resultPath ex:worksFor ;
                    sh:resultSeverity sh:Violation ;
                    sh:sourceConstraintComponent sh:ClassConstraintComponent ;
                    sh:sourceShape _:n5289ed6dae574208a33741e1a2e758f3b7 ;
                    sh:value ex:UntypedCompany ],
                [ a sh:ValidationResult ;
                    sh:focusNode ex:Alice ;
                    sh:resultPath ex:ssn ;
                    sh:resultSeverity sh:Violation ;
                    sh:sourceConstraintComponent sh:PatternConstraintComponent ;
                    sh:sourceShape _:n5289ed6dae574208a33741e1a2e758f3b4 ;
                    sh:value "987-65-432A" ] ] ;
    mf:status sht:approved .

ex:Alice a ex:Person ;
    ex:ssn "987-65-432A" .

ex:Bob a ex:Person ;
    ex:ssn "123-45-6789",
        "124-35-6789" .

ex:PersonShape a sh:NodeShape ;
    sh:closed true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:name "employee" ;
            sh:path [ sh:inversePath ex:worksFor ] ],
        _:n5289ed6dae574208a33741e1a2e758f3b4,
        _:n5289ed6dae574208a33741e1a2e758f3b7 ;
    sh:targetClass ex:Person .

<personexample.test.ttl> a mf:Manifest ;
    mf:entries ( <personexample> ) .

ex:Calvin a ex:Person ;
    ex:birthDate "1999-09-09"^^xsd:date ;
    ex:worksFor ex:UntypedCompany .

_:n5289ed6dae574208a33741e1a2e758f3b7 sh:class ex:Company ;
    sh:nodeKind sh:IRI ;
    sh:path ex:worksFor .

_:n5289ed6dae574208a33741e1a2e758f3b4 sh:datatype xsd:string ;
    sh:maxCount 1 ;
    sh:path ex:ssn ;
    sh:pattern "^\\d{3}-\\d{2}-\\d{4}$" .
