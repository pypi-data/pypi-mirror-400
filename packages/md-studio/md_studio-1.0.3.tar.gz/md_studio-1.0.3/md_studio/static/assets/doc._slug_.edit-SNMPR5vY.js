import{j as r,r as u}from"./jsx-runtime-BiXka7E7.js";import{u as p,w as c,t as f}from"./index-BwWm0JV9.js";import{E as g}from"./Editor-336Gjtep.js";import{t as h,v as b}from"./components-CZmywKMH.js";import{B as x}from"./Breadcrumb-UgS0yS-w.js";import"./index-CkllyZqd.js";import"./index-DsP7OPKi.js";import"./MarkdownPreview-CMAtWhhj.js";import"./slug-DE7USKAG.js";function E({initialValues:a,originalSlug:i}){const d=h(),{basePath:t}=p(),l=async o=>{const s=new FormData;s.append("originalSlug",i),s.append("title",o.title),s.append("slug",o.slug||""),s.append("bodyMd",o.bodyMd);const e=await fetch(c("/api/update",t),{method:"POST",body:s}),n=await e.json().catch(()=>({}));if(!e.ok||n?.success===!1){const m=n?.error||`Update failed (${e.status})`;throw f.error(m),new Error(m)}n?.slug&&d(c(`/doc/${n.slug}`,t))};return r.jsx(g,{initialValues:a,submitLabel:"Save changes",successMessage:"Document updated.",onSubmit:l})}const v=()=>[{title:"Edit Document | md-studio"}];function F(){const{slug:a}=b(),{basePath:i,dashboardPath:d}=p(),[t,l]=u.useState(null),[o,s]=u.useState(!0);return u.useEffect(()=>{a&&fetch(c(`/api/get?slug=${encodeURIComponent(a)}`,i)).then(e=>e.json()).then(e=>{e?.doc&&l(e.doc),s(!1)}).catch(e=>{console.error("Failed to load document:",e),s(!1)})},[a]),o||!t?r.jsx("div",{className:"p-8",children:"Loading..."}):r.jsxs("main",{className:"flex flex-col gap-6",children:[r.jsx(x,{items:[{label:t.title,href:c(`/doc/${t.slug}`,i)},{label:"Edit"}],dashboardPath:d}),r.jsx(E,{initialValues:{title:t.title,slug:t.slug,bodyMd:t.bodyMd},originalSlug:t.slug})]})}export{F as default,v as meta};
