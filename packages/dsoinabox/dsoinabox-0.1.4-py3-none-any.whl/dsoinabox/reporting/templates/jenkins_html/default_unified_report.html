<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Consolidated Security Report</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="report-header" role="banner">
      <div class="title-row">
        <img src="assets/logo.png"
             alt="DSOIAB Logo"
             class="logo-img" />
        <h1>Consolidated Security Report</h1>
        <div class="badges">
          {% if report_context and report_context.branch %}
            <span class="badge"><span class="badge-dot"></span> {{ report_context.branch }}</span>
          {% endif %}
          {% if report_context and report_context.commit %}
            <span class="badge badge--accent">Commit: {{ report_context.commit[:7] }}</span>
          {% endif %}
          {% if report_context and report_context.generated_at %}
            <span class="badge">Generated: {{ report_context.generated_at }}</span>
          {% endif %}
        </div>
      </div>
      <div class="meta">
        {% if report_context and report_context.repo_url %}
          Source: <a href="{{ report_context.repo_url }}" target="_blank" rel="noopener">{{ report_context.repo_url }}</a>
        {% endif %}
      </div>
    </header>

    <!-- Git Repo Info -->
    {% if git_repo_info %}
    <section class="section" id="git-repo-info">
      <div class="section__head">
        <h2>Git Repository</h2>
      </div>
      <div class="section__body">
        <ul class="kvs" aria-label="Repository key values">
          {% for key, value in git_repo_info.items() %}
          <li>
            <span class="key">{{ key }}</span>
            <span class="val">{{ value }}</span>
          </li>
          {% endfor %}
        </ul>
      </div>
    </section>
    {% endif %}

    {% include "default_syft.html" %}
    {% include "default_grype.html" %}
    {% include "default_trufflehog.html" %}
    {% include "default_opengrep.html" %}
    {% include "default_checkov.html" %}

    <p class="footer">Generated by internal tooling â€¢ Confidential</p>
  </div>

  <script src="assets/app.js"></script>
</body>
</html>

