import{r as s,j as e}from"./jsx-runtime-BiXka7E7.js";import{c as T,a as F,f as Be,o as Ue,D as Fe,h as fe,g as qe,e as Ge,P as Ve,i as B,B as w,u as Je,t as U,w as Ke}from"./index-BwWm0JV9.js";import{c as he,C as Qe,R as Xe,A as We,a as Ye}from"./index-CkllyZqd.js";import{R as Ze}from"./index-DsP7OPKi.js";import{M as et}from"./MarkdownPreview-CMAtWhhj.js";import{D as tt,a as nt,b as st,c as rt,d as ot,e as at,s as it}from"./slug-DE7USKAG.js";import{x as lt}from"./components-CZmywKMH.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],dt=T("bold",ct);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],pt=T("circle-question-mark",ut);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],ft=T("cloud-upload",xt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],mt=T("code",ht);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],vt=T("heading-2",gt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],bt=T("image",yt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],kt=T("italic",jt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Ct=T("link",wt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Nt=T("list",Tt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],St=T("maximize",Et);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=[["path",{d:"M5 12h14",key:"1ays0h"}]],Rt=T("minus",Mt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],Lt=T("minimize",zt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],_t=T("quote",Pt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],It=T("square-check-big",Dt);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]],Ot=T("strikethrough",Ht);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],$t=T("table",At),me=s.forwardRef(({className:t,...o},n)=>e.jsx("textarea",{"data-slot":"textarea",className:F("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...o}));me.displayName="Textarea";var Bt=Symbol("radix.slottable");function Ut(t){const o=({children:n})=>e.jsx(e.Fragment,{children:n});return o.displayName=`${t}.Slottable`,o.__radixId=Bt,o}var[K]=Be("Tooltip",[he]),Q=he(),ge="TooltipProvider",Ft=700,te="tooltip.open",[qt,se]=K(ge),ve=t=>{const{__scopeTooltip:o,delayDuration:n=Ft,skipDelayDuration:i=300,disableHoverableContent:a=!1,children:c}=t,d=s.useRef(!0),u=s.useRef(!1),p=s.useRef(0);return s.useEffect(()=>{const g=p.current;return()=>window.clearTimeout(g)},[]),e.jsx(qt,{scope:o,isOpenDelayedRef:d,delayDuration:n,onOpen:s.useCallback(()=>{window.clearTimeout(p.current),d.current=!1},[]),onClose:s.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>d.current=!0,i)},[i]),isPointerInTransitRef:u,onPointerInTransitChange:s.useCallback(g=>{u.current=g},[]),disableHoverableContent:a,children:c})};ve.displayName=ge;var G="Tooltip",[Gt,X]=K(G),ye=t=>{const{__scopeTooltip:o,children:n,open:i,defaultOpen:a,onOpenChange:c,disableHoverableContent:d,delayDuration:u}=t,p=se(G,t.__scopeTooltip),g=Q(o),[l,h]=s.useState(null),b=qe(),v=s.useRef(0),j=d??p.disableHoverableContent,f=u??p.delayDuration,k=s.useRef(!1),[z,N]=Ge({prop:i,defaultProp:a??!1,onChange:C=>{C?(p.onOpen(),document.dispatchEvent(new CustomEvent(te))):p.onClose(),c?.(C)},caller:G}),_=s.useMemo(()=>z?k.current?"delayed-open":"instant-open":"closed",[z]),O=s.useCallback(()=>{window.clearTimeout(v.current),v.current=0,k.current=!1,N(!0)},[N]),D=s.useCallback(()=>{window.clearTimeout(v.current),v.current=0,N(!1)},[N]),$=s.useCallback(()=>{window.clearTimeout(v.current),v.current=window.setTimeout(()=>{k.current=!0,N(!0),v.current=0},f)},[f,N]);return s.useEffect(()=>()=>{v.current&&(window.clearTimeout(v.current),v.current=0)},[]),e.jsx(Xe,{...g,children:e.jsx(Gt,{scope:o,contentId:b,open:z,stateAttribute:_,trigger:l,onTriggerChange:h,onTriggerEnter:s.useCallback(()=>{p.isOpenDelayedRef.current?$():O()},[p.isOpenDelayedRef,$,O]),onTriggerLeave:s.useCallback(()=>{j?D():(window.clearTimeout(v.current),v.current=0)},[D,j]),onOpen:O,onClose:D,disableHoverableContent:j,children:n})})};ye.displayName=G;var ne="TooltipTrigger",be=s.forwardRef((t,o)=>{const{__scopeTooltip:n,...i}=t,a=X(ne,n),c=se(ne,n),d=Q(n),u=s.useRef(null),p=fe(o,u,a.onTriggerChange),g=s.useRef(!1),l=s.useRef(!1),h=s.useCallback(()=>g.current=!1,[]);return s.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),e.jsx(We,{asChild:!0,...d,children:e.jsx(Ve.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...i,ref:p,onPointerMove:B(t.onPointerMove,b=>{b.pointerType!=="touch"&&!l.current&&!c.isPointerInTransitRef.current&&(a.onTriggerEnter(),l.current=!0)}),onPointerLeave:B(t.onPointerLeave,()=>{a.onTriggerLeave(),l.current=!1}),onPointerDown:B(t.onPointerDown,()=>{a.open&&a.onClose(),g.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:B(t.onFocus,()=>{g.current||a.onOpen()}),onBlur:B(t.onBlur,a.onClose),onClick:B(t.onClick,a.onClose)})})});be.displayName=ne;var Vt="TooltipPortal",[Tn,Jt]=K(Vt,{forceMount:void 0}),q="TooltipContent",je=s.forwardRef((t,o)=>{const n=Jt(q,t.__scopeTooltip),{forceMount:i=n.forceMount,side:a="top",...c}=t,d=X(q,t.__scopeTooltip);return e.jsx(Ue,{present:i||d.open,children:d.disableHoverableContent?e.jsx(ke,{side:a,...c,ref:o}):e.jsx(Kt,{side:a,...c,ref:o})})}),Kt=s.forwardRef((t,o)=>{const n=X(q,t.__scopeTooltip),i=se(q,t.__scopeTooltip),a=s.useRef(null),c=fe(o,a),[d,u]=s.useState(null),{trigger:p,onClose:g}=n,l=a.current,{onPointerInTransitChange:h}=i,b=s.useCallback(()=>{u(null),h(!1)},[h]),v=s.useCallback((j,f)=>{const k=j.currentTarget,z={x:j.clientX,y:j.clientY},N=Zt(z,k.getBoundingClientRect()),_=en(z,N),O=tn(f.getBoundingClientRect()),D=sn([..._,...O]);u(D),h(!0)},[h]);return s.useEffect(()=>()=>b(),[b]),s.useEffect(()=>{if(p&&l){const j=k=>v(k,l),f=k=>v(k,p);return p.addEventListener("pointerleave",j),l.addEventListener("pointerleave",f),()=>{p.removeEventListener("pointerleave",j),l.removeEventListener("pointerleave",f)}}},[p,l,v,b]),s.useEffect(()=>{if(d){const j=f=>{const k=f.target,z={x:f.clientX,y:f.clientY},N=p?.contains(k)||l?.contains(k),_=!nn(z,d);N?b():_&&(b(),g())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[p,l,d,g,b]),e.jsx(ke,{...t,ref:c})}),[Qt,Xt]=K(G,{isInside:!1}),Wt=Ut("TooltipContent"),ke=s.forwardRef((t,o)=>{const{__scopeTooltip:n,children:i,"aria-label":a,onEscapeKeyDown:c,onPointerDownOutside:d,...u}=t,p=X(q,n),g=Q(n),{onClose:l}=p;return s.useEffect(()=>(document.addEventListener(te,l),()=>document.removeEventListener(te,l)),[l]),s.useEffect(()=>{if(p.trigger){const h=b=>{b.target?.contains(p.trigger)&&l()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[p.trigger,l]),e.jsx(Fe,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:h=>h.preventDefault(),onDismiss:l,children:e.jsxs(Qe,{"data-state":p.stateAttribute,...g,...u,ref:o,style:{...u.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(Wt,{children:i}),e.jsx(Qt,{scope:n,isInside:!0,children:e.jsx(Ze,{id:p.contentId,role:"tooltip",children:a||i})})]})})});je.displayName=q;var we="TooltipArrow",Yt=s.forwardRef((t,o)=>{const{__scopeTooltip:n,...i}=t,a=Q(n);return Xt(we,n).isInside?null:e.jsx(Ye,{...a,...i,ref:o})});Yt.displayName=we;function Zt(t,o){const n=Math.abs(o.top-t.y),i=Math.abs(o.bottom-t.y),a=Math.abs(o.right-t.x),c=Math.abs(o.left-t.x);switch(Math.min(n,i,a,c)){case c:return"left";case a:return"right";case n:return"top";case i:return"bottom";default:throw new Error("unreachable")}}function en(t,o,n=5){const i=[];switch(o){case"top":i.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":i.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":i.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":i.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return i}function tn(t){const{top:o,right:n,bottom:i,left:a}=t;return[{x:a,y:o},{x:n,y:o},{x:n,y:i},{x:a,y:i}]}function nn(t,o){const{x:n,y:i}=t;let a=!1;for(let c=0,d=o.length-1;c<o.length;d=c++){const u=o[c],p=o[d],g=u.x,l=u.y,h=p.x,b=p.y;l>i!=b>i&&n<(h-g)*(i-l)/(b-l)+g&&(a=!a)}return a}function sn(t){const o=t.slice();return o.sort((n,i)=>n.x<i.x?-1:n.x>i.x?1:n.y<i.y?-1:n.y>i.y?1:0),rn(o)}function rn(t){if(t.length<=1)return t.slice();const o=[];for(let i=0;i<t.length;i++){const a=t[i];for(;o.length>=2;){const c=o[o.length-1],d=o[o.length-2];if((c.x-d.x)*(a.y-d.y)>=(c.y-d.y)*(a.x-d.x))o.pop();else break}o.push(a)}o.pop();const n=[];for(let i=t.length-1;i>=0;i--){const a=t[i];for(;n.length>=2;){const c=n[n.length-1],d=n[n.length-2];if((c.x-d.x)*(a.y-d.y)>=(c.y-d.y)*(a.x-d.x))n.pop();else break}n.push(a)}return n.pop(),o.length===1&&n.length===1&&o[0].x===n[0].x&&o[0].y===n[0].y?o:o.concat(n)}var on=ve,an=ye,ln=be,Ce=je;const cn=on,M=an,R=ln,S=s.forwardRef(({className:t,sideOffset:o=4,...n},i)=>e.jsx(Ce,{ref:i,sideOffset:o,className:F("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-xs text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));S.displayName=Ce.displayName;const dn=[{category:"Headers",items:[{syntax:"# Heading 1",description:"Largest heading"},{syntax:"## Heading 2",description:"Second-level heading"},{syntax:"### Heading 3",description:"Third-level heading"}]},{category:"Emphasis",items:[{syntax:"**bold text**",description:"Bold"},{syntax:"*italic text*",description:"Italic"},{syntax:"~~strikethrough~~",description:"Strikethrough"},{syntax:"`code`",description:"Inline code"}]},{category:"Lists",items:[{syntax:`- Item
- Item`,description:"Unordered list"},{syntax:`1. Item
2. Item`,description:"Ordered list"},{syntax:`- [ ] Task
- [x] Done`,description:"Task list"}]},{category:"Links & Images",items:[{syntax:"[Link text](url)",description:"Link"},{syntax:"![Alt text](image-url)",description:"Image"}]},{category:"Code Blocks",items:[{syntax:"```language\ncode here\n```",description:"Code block with syntax highlighting"}]},{category:"Other",items:[{syntax:"> Quote text",description:"Blockquote"},{syntax:"---",description:"Horizontal rule"},{syntax:`| Header |
| --- |
| Cell |`,description:"Table"}]}];function un(){return e.jsxs(tt,{children:[e.jsx(nt,{asChild:!0,children:e.jsx(w,{variant:"ghost",size:"icon",className:"size-8",children:e.jsx(pt,{className:"size-4"})})}),e.jsxs(st,{className:"max-h-[80vh] max-w-2xl overflow-y-auto",children:[e.jsxs(rt,{children:[e.jsx(ot,{children:"Markdown Cheat Sheet"}),e.jsx(at,{children:"Quick reference guide for markdown formatting"})]}),e.jsx("div",{className:"flex flex-col gap-6",children:dn.map(t=>e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold uppercase tracking-wider text-muted-foreground",children:t.category}),e.jsx("div",{className:"flex flex-col gap-2",children:t.items.map((o,n)=>e.jsxs("div",{className:"flex flex-col gap-1 rounded-lg border border-border bg-muted/30 p-3",children:[e.jsx("code",{className:"rounded bg-muted px-2 py-1 font-mono text-xs",children:o.syntax}),e.jsx("span",{className:"text-xs text-muted-foreground",children:o.description})]},n))})]},t.category))}),e.jsxs("div",{className:"mt-6 rounded-lg bg-muted/50 p-4",children:[e.jsx("h4",{className:"mb-2 text-sm font-semibold",children:"Keyboard Shortcuts"}),e.jsxs("div",{className:"grid gap-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Save document"}),e.jsx("kbd",{className:"rounded bg-background px-2 py-1 font-mono",children:"⌘/Ctrl + S"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bold text"}),e.jsx("kbd",{className:"rounded bg-background px-2 py-1 font-mono",children:"⌘/Ctrl + B"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Italic text"}),e.jsx("kbd",{className:"rounded bg-background px-2 py-1 font-mono",children:"⌘/Ctrl + I"})]})]})]})]})]})}const pn=5*1024*1024,xe=["image/png","image/jpeg","image/jpg","image/webp","image/gif"];function xn({onInsert:t,className:o}){const n=s.useRef(null),[i,a]=s.useState(!1),{revalidate:c}=lt(),{basePath:d}=Je(),u=s.useCallback(async l=>{if(!l||l.length===0)return;const h=l[0];if(!xe.includes(h.type)){U.error("Unsupported file type.");return}if(h.size>pn){U.error("Image must be 5MB or less.");return}try{a(!0);const b=new FormData;b.append("file",h);const v=await fetch(Ke("/api/upload",d),{method:"POST",body:b});if(!v.ok){const k=await v.json();throw new Error(k.error||"Upload failed")}const j=await v.json(),f=j.alt??h.name.replace(/\.[^/.]+$/,"");t(`![${f}](${j.url})`),U.success("Image uploaded. Markdown snippet copied into the editor."),c()}catch(b){const v=b instanceof Error?b.message:"Failed to upload image.";U.error(v)}finally{a(!1),n.current&&(n.current.value="")}},[t,d,c]),p=s.useCallback(l=>{l.preventDefault(),u(l.dataTransfer.files)},[u]),g=s.useCallback(l=>{u(l.target.files)},[u]);return e.jsxs("div",{className:F("flex h-32 w-full flex-col items-center justify-center gap-2 rounded-lg border border-dashed border-border bg-muted/20 text-center",o),onDragOver:l=>l.preventDefault(),onDrop:p,children:[e.jsx(ft,{className:"size-8 text-muted-foreground"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Drag & drop to upload images"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, JPEG, WEBP, GIF up to 5MB"})]}),e.jsx("input",{ref:n,type:"file",accept:xe.join(","),className:"hidden",onChange:g}),e.jsx(w,{type:"button",size:"sm",variant:"outline",onClick:()=>n.current?.click(),disabled:i,children:i?"Uploading...":"Choose file"})]})}function fn(t,o){const{key:n,interval:i=3e4,onSave:a}=o,[c,d]=s.useState(()=>{if(typeof window>"u")return null;const l=localStorage.getItem(n);if(l)try{const h=JSON.parse(l);if(h.timestamp)return new Date(h.timestamp)}catch{}return null}),u=s.useRef(null);return s.useEffect(()=>{if(t)return u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const l=new Date,h={value:t,timestamp:l.toISOString()};localStorage.setItem(n,JSON.stringify(h)),d(l),a?.(t)},i),()=>{u.current&&clearTimeout(u.current)}},[t,n,i,a]),{lastSaved:c,clearSaved:()=>{localStorage.removeItem(n),d(null)},getSaved:()=>{const l=localStorage.getItem(n);if(l)try{return JSON.parse(l).value||null}catch{return null}return null}}}function hn(t){s.useEffect(()=>{const o=n=>{t&&(n.preventDefault(),n.returnValue="")};return window.addEventListener("beforeunload",o),()=>window.removeEventListener("beforeunload",o)},[t])}function mn(t){if(!t)return"Never";const n=Math.floor((new Date().getTime()-t.getTime())/1e3);if(n<10)return"Just now";if(n<60)return`${n}s ago`;const i=Math.floor(n/60);if(i<60)return`${i}m ago`;const a=Math.floor(i/60);return a<24?`${a}h ago`:t.toLocaleDateString()}const gn=s.memo(function({value:o,onCommit:n}){const i=s.useRef(null),a=s.useRef(!1);return s.useEffect(()=>{if(!i.current||a.current)return;const c=o.trim()||"Untitled document";i.current.textContent!==c&&(i.current.textContent=c)},[o]),e.jsx("h2",{ref:i,contentEditable:!0,suppressContentEditableWarning:!0,role:"textbox","aria-label":"Document title",spellCheck:!0,onFocus:()=>{a.current=!0},onInput:c=>{},onBlur:c=>{a.current=!1;const d=(c.currentTarget.textContent??"").trim();if(!d){c.currentTarget.textContent="Untitled document",n("Untitled document");return}n(d)},onKeyDown:c=>{c.key==="Enter"&&(c.preventDefault(),c.currentTarget.blur())},className:"min-w-[12ch] max-w-full truncate text-left text-2xl font-semibold tracking-tight text-foreground outline-none focus-visible:rounded-sm focus-visible:bg-muted/60 focus-visible:px-1 focus-visible:ring-2 focus-visible:ring-primary/30 focus-visible:ring-offset-2 focus-visible:ring-offset-background",children:o.trim()||"Untitled document"})});function Nn({initialValues:t,submitLabel:o,successMessage:n,onSubmit:i}){const[a,c]=s.useState(t?.title??""),[d]=s.useState(t?.slug??""),[u,p]=s.useState(t?.bodyMd??""),[g,l]=s.useTransition(),[h,b]=s.useState(!1),[v,j]=s.useState(!1),f=s.useRef(null),k=s.useRef(null),z=s.useRef(null),N=s.useRef(null),[_,O]=s.useState(.45),[D,$]=s.useState(!1),[C,Te]=s.useState("split"),[re,Ne]=s.useState({top:0,left:0}),[Ee,oe]=s.useState(!1),[ae,Se]=s.useState(!1),Me=s.useMemo(()=>d.trim()?d.trim():it(a)||"auto-generated",[d,a]);s.useEffect(()=>{Se(!0)},[]);const Re=`md-cms-draft-${t?.slug||"new"}`,{lastSaved:W,clearSaved:ie}=fn(JSON.stringify({title:a,body:u}),{key:Re,interval:3e4}),le=s.useMemo(()=>t?a!==t.title||u!==t.bodyMd:a.length>0||u.length>0,[a,u,t]);hn(le&&!g);const ze=s.useCallback(r=>{Te(r),r!=="split"&&$(!1)},[]),ce=s.useCallback(r=>Math.min(.82,Math.max(.28,r)),[]),V=s.useCallback((r,x,y)=>{const m=f.current;if(!m)return;const E=m.selectionStart??0,L=m.selectionEnd??E,P=m.value,H=P.slice(E,L)||y,ee=P.slice(0,E)+r+H+x+P.slice(L);p(ee);const pe=E+r.length,$e=pe+H.length;requestAnimationFrame(()=>{m.focus(),m.setSelectionRange(pe,$e)})},[]),I=s.useCallback((r,x)=>{const y=f.current;if(!y)return;const m=y.selectionStart??0,E=y.selectionEnd??m,L=y.value,P=L.slice(0,m)+r+L.slice(E);p(P);const A=m+(x?x[0]:r.length),H=m+(x?x[1]:r.length);requestAnimationFrame(()=>{y.focus(),y.setSelectionRange(A,H)})},[]),Le=s.useCallback(()=>{const r=f.current;if(!r)return;const x=r.selectionStart??0,y=r.selectionEnd??x,m=r.value,L=`[${m.slice(x,y)||"link text"}](https://)`,P=m.slice(0,x)+L+m.slice(y);p(P);const A=x+L.indexOf("https://"),H=A+8;requestAnimationFrame(()=>{r.focus(),r.setSelectionRange(A,H)})},[]),Pe=s.useCallback(()=>{I(`| Header 1 | Header 2 | Header 3 |
| --- | --- | --- |
| Cell 1 | Cell 2 | Cell 3 |
| Cell 4 | Cell 5 | Cell 6 |

`,[2,10])},[I]),_e=s.useCallback(()=>{I(`- [ ] Task 1
- [ ] Task 2
- [x] Completed task

`,[6,12])},[I]),De=s.useCallback(()=>{I(`
---

`,[1,4])},[I]),Ie=s.useCallback(()=>{b(r=>!r)},[]),Y=(t?a.trim().length>0:!0)&&u.trim().length>0,Z=s.useCallback(()=>{!Y||g||l(async()=>{try{const x={title:a.trim()||"Untitled document",bodyMd:u};await i(x),U.success(n),ie()}catch(r){const x=r instanceof Error?r.message:"Unable to save document.";U.error(x)}})},[Y,g,i,a,d,u,n,ie]);s.useEffect(()=>{const r=x=>{const y=x.target;y&&["INPUT","TEXTAREA"].includes(y.tagName)&&y.hasAttribute("data-hotkey-ignore"),x.key==="s"&&(x.metaKey||x.ctrlKey)&&(x.preventDefault(),Z())};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[Z]),s.useEffect(()=>{if(!D||C!=="split")return;const r=y=>{if(!z.current)return;const m=z.current.getBoundingClientRect();if(m.width<=0)return;const E=(y.clientX-m.left)/m.width;O(ce(E)),y.preventDefault()},x=()=>{$(!1)};return window.addEventListener("pointermove",r,{passive:!1}),window.addEventListener("pointerup",x),window.addEventListener("pointercancel",x),()=>{window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",x)}},[ce,D,C]),s.useEffect(()=>{if(!(typeof document>"u")&&D&&C==="split"){const r=document.body.style.cursor,x=document.body.style.userSelect;return document.body.style.cursor="col-resize",document.body.style.userSelect="none",()=>{document.body.style.cursor=r,document.body.style.userSelect=x}}},[D,C]),s.useEffect(()=>{const r=f.current,x=k.current;if(!r||!x)return;const y=()=>{if(!x)return;const m=r.scrollTop/Math.max(1,r.scrollHeight-r.clientHeight);x.scrollTop=m*Math.max(0,x.scrollHeight-x.clientHeight)};return r.addEventListener("scroll",y,{passive:!0}),()=>{r.removeEventListener("scroll",y)}},[u]);const J=s.useCallback(()=>{const r=f.current;if(!r)return;const x=r.selectionStart,E=r.value.substring(0,x).split(`
`).length,L=r.getBoundingClientRect(),P=parseInt(window.getComputedStyle(r).lineHeight)||28,A=(E-1)*P-r.scrollTop,H=Math.max(10,A-50),ee=L.width/2;Ne({top:H,left:ee})},[]);s.useEffect(()=>{const r=f.current;if(!r)return;const x=()=>{oe(!0),J()},y=L=>{const P=L.relatedTarget;P&&N.current?.contains(P)||setTimeout(()=>{document.activeElement!==r&&!N.current?.contains(document.activeElement)&&oe(!1)},150)},m=()=>{document.activeElement===r&&J()},E=()=>{document.activeElement===r&&J()};return r.addEventListener("focus",x),r.addEventListener("blur",y),r.addEventListener("click",E),r.addEventListener("keyup",m),r.addEventListener("mouseup",m),()=>{r.removeEventListener("focus",x),r.removeEventListener("blur",y),r.removeEventListener("click",E),r.removeEventListener("keyup",m),r.removeEventListener("mouseup",m)}},[J]);const He=s.useMemo(()=>({flexBasis:`${_*100}%`,flexGrow:0,flexShrink:0}),[_]),Oe=s.useMemo(()=>({flexBasis:`${(1-_)*100}%`,flexGrow:0,flexShrink:0}),[_]),Ae=s.useCallback(r=>{C==="split"&&(r.pointerType==="mouse"&&r.preventDefault(),$(!0))},[C]),de=C!=="preview",ue=C!=="write";return e.jsx(cn,{children:e.jsxs("div",{className:F("flex flex-col gap-6",h&&"fixed inset-0 z-50 bg-background p-6 overflow-y-auto"),children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(gn,{value:a,onCommit:r=>{c(r)}})})}),e.jsxs("div",{className:"text-[11px] text-muted-foreground",children:["Slug: ",e.jsx("span",{className:"font-mono text-foreground",children:Me}),". Auto-generated and unique."]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 rounded-lg border border-border bg-card px-4 py-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-1 rounded-md border border-border bg-muted px-1 py-1",children:["write","split","preview"].map(r=>e.jsxs(w,{type:"button",size:"sm",variant:C===r?"default":"ghost",className:F("h-7 px-3 text-xs font-medium",C===r?"":"text-muted-foreground"),onClick:()=>ze(r),children:[r==="write"&&"Edit",r==="split"&&"Split",r==="preview"&&"Preview"]},r))}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-mono font-semibold",children:u.length.toLocaleString()}),e.jsx("span",{children:"chars"}),e.jsx("span",{className:"text-border",children:"·"}),e.jsx("span",{className:"font-mono font-semibold",children:u.split(/\s+/).filter(Boolean).length.toLocaleString()}),e.jsx("span",{children:"words"})]}),ae&&W&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["· Last saved: ",mn(W)]}),ae&&le&&!W&&e.jsx("span",{className:"text-xs text-amber-600 dark:text-amber-500",children:"· Unsaved changes"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(un,{}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(w,{type:"button",variant:"outline",size:"sm",onClick:Ie,children:[h?e.jsx(Lt,{className:"mr-1.5 size-3.5"}):e.jsx(St,{className:"mr-1.5 size-3.5"}),h?"Exit":"Fullscreen"]})}),e.jsx(S,{children:"Toggle fullscreen (F11)"})]}),e.jsx(w,{type:"button",onClick:Z,disabled:!Y||g,size:"sm",children:g?"Saving...":o})]})]}),e.jsxs("div",{ref:z,className:F("relative flex overflow-hidden rounded-lg border border-border bg-card shadow-sm","min-h-[calc(100vh-28rem)]"),children:[de&&e.jsx("div",{className:"relative flex flex-col overflow-hidden",style:C==="split"?He:{flex:1},children:e.jsxs("div",{className:"relative flex flex-1 flex-col overflow-y-auto",children:[Ee&&e.jsx("div",{ref:N,className:"pointer-events-auto absolute z-10 -translate-x-1/2 transition-all duration-150",style:{top:`${re.top}px`,left:`${re.left}px`},onMouseDown:r=>{r.preventDefault()},children:e.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-border bg-background/95 p-1 shadow-lg backdrop-blur-sm",children:[e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{I(`## Heading

`,[3,10]),f.current?.focus()},children:e.jsx(vt,{className:"size-3.5"})})}),e.jsx(S,{children:"Heading"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{V("**","**","bold"),f.current?.focus()},children:e.jsx(dt,{className:"size-3.5"})})}),e.jsx(S,{children:"Bold"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{V("*","*","italic"),f.current?.focus()},children:e.jsx(kt,{className:"size-3.5"})})}),e.jsx(S,{children:"Italic"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{V("~~","~~","strikethrough"),f.current?.focus()},children:e.jsx(Ot,{className:"size-3.5"})})}),e.jsx(S,{children:"Strikethrough"})]}),e.jsx("div",{className:"mx-1 h-4 w-px bg-border"}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{V("`","`","code"),f.current?.focus()},children:e.jsx(mt,{className:"size-3.5"})})}),e.jsx(S,{children:"Code"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{I(`> Quote

`,[2,7]),f.current?.focus()},children:e.jsx(_t,{className:"size-3.5"})})}),e.jsx(S,{children:"Quote"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{I(`- Item
`,[2,6]),f.current?.focus()},children:e.jsx(Nt,{className:"size-3.5"})})}),e.jsx(S,{children:"List"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{_e(),f.current?.focus()},children:e.jsx(It,{className:"size-3.5"})})}),e.jsx(S,{children:"Tasks"})]}),e.jsx("div",{className:"mx-1 h-4 w-px bg-border"}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{Le(),f.current?.focus()},children:e.jsx(Ct,{className:"size-3.5"})})}),e.jsx(S,{children:"Link"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{Pe(),f.current?.focus()},children:e.jsx($t,{className:"size-3.5"})})}),e.jsx(S,{children:"Table"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{j(r=>!r),f.current?.focus()},children:e.jsx(bt,{className:"size-3.5"})})}),e.jsx(S,{children:"Image"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsx(w,{type:"button",variant:"ghost",size:"icon",className:"size-7",onClick:()=>{De(),f.current?.focus()},children:e.jsx(Rt,{className:"size-3.5"})})}),e.jsx(S,{children:"Divider"})]})]})}),e.jsx(me,{ref:f,value:u,onChange:r=>p(r.target.value),className:"h-full flex-1 resize-none border-0 bg-transparent px-3 pb-6 pt-2 font-mono text-[15px] leading-7 focus-visible:ring-0",placeholder:"Start typing your markdown..."}),v&&e.jsx("div",{className:"border-t border-border px-6 py-4",children:e.jsx(xn,{onInsert:I,className:"h-24 shrink-0 bg-muted/40"})})]})}),C==="split"&&de&&ue&&e.jsxs("div",{role:"separator","aria-orientation":"vertical","aria-label":"Resize editor and preview",className:"group relative w-px shrink-0 cursor-col-resize bg-border hover:bg-primary",onPointerDown:Ae,children:[e.jsx("div",{className:"absolute inset-y-0 -left-1 -right-1"}),e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full bg-muted p-1 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx("div",{className:"text-[10px] text-muted-foreground",children:"⇔"})})]}),ue&&e.jsx("div",{ref:k,className:"flex flex-1 flex-col overflow-y-auto px-0 py-0",style:C==="split"?Oe:void 0,children:e.jsx(et,{value:u,className:"w-full"})})]})]})})}export{Nn as E};
