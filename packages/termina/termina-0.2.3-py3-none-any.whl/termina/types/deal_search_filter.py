# This file was auto-generated by Fern from our API Definition.

from __future__ import annotations

import typing

import pydantic
import typing_extensions
from ..core.pydantic_utilities import IS_PYDANTIC_V2, UniversalBaseModel, update_forward_refs
from ..core.serialization import FieldMetadata
from .benchmark_metric_filter import BenchmarkMetricFilter
from .date_criterion import DateCriterion
from .status import Status


class DealSearchFilter(UniversalBaseModel):
    """
    Base filter model for deal search.
    Supports individual field filters or logical operators (`$and`, `$or`).

    Example with benchmark metrics:
    ```json
    {
        "filters": {
            "$and": [
                {"company_name": "Acme"},
                {
                    "benchmark_metrics": {
                        "field_name": "revenue",
                        "conditions": [
                            {"operator": "$gte", "value": 1000000},
                            {"operator": "$lte", "value": 5000000}
                        ]
                    }
                }
            ]
        }
    }
    ```
    """

    and_: typing_extensions.Annotated[typing.Optional[typing.List["DealSearchFilter"]], FieldMetadata(alias="$and")] = (
        None
    )
    or_: typing_extensions.Annotated[typing.Optional[typing.List["DealSearchFilter"]], FieldMetadata(alias="$or")] = (
        None
    )
    company_name: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive partial match (no fuzzy). Matches must be consecutive tokens in order. E.g., 'acme' matches 'Acme Corp', 'acme c' matches 'Acme Corp', but 'corp acme' does NOT match 'Acme Corp'.
    """

    company_domain: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive partial match (no fuzzy). Matches must be consecutive tokens in order. E.g., 'acme' matches 'acme.com', but does not allow typos or fuzzy matching.
    """

    categories: typing.Optional[typing.List[str]] = pydantic.Field(default=None)
    """
    Case-insensitive exact match. If multiple values are provided, matches deals that contain ANY of them.
    """

    round_name: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive partial match (no fuzzy). Matches must be consecutive tokens in order. E.g., 'series' matches 'Series A', 'series a' matches 'Series A', but 'series b' does NOT match 'Series A'.
    """

    deal_lead_name: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive partial match (no fuzzy). Matches must be consecutive tokens in order. E.g., 'jane' matches 'Jane Doe', 'jane d' matches 'Jane Doe', but 'doe jane' does NOT match 'Jane Doe'.
    """

    deal_lead_email: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive partial match (no fuzzy). Matches must be consecutive tokens in order. E.g., 'jane' matches 'jane@example.com', but does not allow typos or fuzzy matching.
    """

    group_account: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive partial match on group account/domain. Combine with $or for multiple accounts.
    """

    group_name: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive partial match on group name (no fuzzy). Combine with $or for multiple names.
    """

    notes: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive fuzzy match. Allows approximate matching with typos and misspellings.
    """

    tags: typing.Optional[typing.List[str]] = pydantic.Field(default=None)
    """
    Case-insensitive exact match. If multiple values are provided, matches deals that contain ANY of them.
    """

    priority: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive exact match (no partials, no fuzzy).
    """

    status: typing.Optional[Status] = pydantic.Field(default=None)
    """
    Exact match on deal status. Accepts single status or list. If multiple values are provided, matches deals that have ANY of them.
    """

    general_text: typing.Optional[str] = pydantic.Field(default=None)
    """
    Case-insensitive search across all searchable fields. Performs partial/fuzzy matching on text fields (company name, domain, round name, deal lead, notes, etc.) AND exact matching on keyword fields (priority, tags, categories). Returns deals matching either type.
    """

    dates: typing.Optional[DateCriterion] = None
    benchmark_metrics: typing.Optional[BenchmarkMetricFilter] = None

    if IS_PYDANTIC_V2:
        model_config: typing.ClassVar[pydantic.ConfigDict] = pydantic.ConfigDict(extra="allow", frozen=True)  # type: ignore # Pydantic v2
    else:

        class Config:
            frozen = True
            smart_union = True
            extra = pydantic.Extra.allow


update_forward_refs(DealSearchFilter)
