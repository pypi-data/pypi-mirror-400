[build-system]
requires = ["hatchling", "hatch-calver"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
packages = ["master_mind"]

[tool.hatch.version]
path = "master_mind/__version__.py"
scheme = "calver"
calver-format = "YYYY.MM.DD.MICRO"

[project]
name = "su_master_mind"
dynamic = ["version"]
description = "Sorbonne University Master MIND dependency & dataset manager"
authors = [
    { name = "Benjamin Piwowarski", email = "benjamin@piwowarski.fr" }
]
requires-python = ">= 3.10"
dependencies = [
    "click >= 8",
    "packaging >= 23",
    "appdirs >= 1.4",
    "requests >= 2",
    "importlib_resources >= 6; python_version <= '3.8'",
    "cached-property >= 1.5; python_version <= '3.7'",
]

[project.optional-dependencies]
# Base deep learning dependencies
deep = [
    "future",
    "matplotlib",
    "seaborn",
    "scikit-learn",
    "pandas",
    "ipython",
    "jupyter",
    "jupyterlab",
    "jupyterlab-widgets",
    "jupyterlab_empinken_extension",
    "ipywidgets",
    "torch >= 2.5",
    "torchvision",
    "tensorboard >= 2.10",
    "tensorflow >= 2.10; platform_machine != 'arm64' or sys_platform != 'darwin'",
    "tensorflow-macos >= 2.10; platform_machine == 'arm64' and sys_platform == 'darwin'",
    "experimaestro >= 1.11.1",
    "datamaestro >= 1.5",
    "datamaestro_image >= 2025.9.21",
    "datamaestro_text >= 2026.1.1",
]

# Reinforcement learning
rl = [
    "su_master_mind[deep]",
    "bbrl_utils >= 1.1.1",
    "box2d",
    "box2d-kengz",
    "pyglet < 2",
    "torchdiffeq",
    "ipyreact >= 0.4.0",
    "mazemdp >= 1.2.11",
    "pystk2-gymnasium >= 0.7.9",
    "moviepy",
    "dash >= 3",
]

# Deep learning experiments
deepl = [
    "su_master_mind[deep]",
    "optuna",
    "pytorch-lightning",
    "einops",
    "datasets >= 2.7.0",
    "transformers",
    "conllu",
    "spacy",
    "bs4",
    "sentencepiece",
    "networkx",
]

# Advanced deep learning
adl = [
    "su_master_mind[deep]",
    "scikit-image >= 0.24.0",
]

# Information retrieval
rital = [
    "su_master_mind[deep]",
    "experimaestro-ir >= 0.6.1",
    "pyserini",
]

# Large language models
llm = [
    "su_master_mind[deep]",

    "datasets>=4.4.1",
    "accelerate>=1.12.0",
    "outlines>=1.2.9",
    "peft>=0.13.2",

    "bert-score>=0.3.13",
    "bertviz>=1.4.1",
    "evaluate>=0.4.6",
    "gensim>=4.4.0",
    "ipywidgets>=8.1.8",
    "ir-datasets>=0.5.0",
    "pyterrier>=1",
    "rouge-score>=0.1.2",
    "scikit-learn>=1.7.2",
    "seaborn>=0.13.2",
    "sentence-transformers>=3.0.0",
    "transformers>=4.56.1",

    # Quantized model support (Linux only - triton dependency)
    "auto-gptq>=0.7.0; sys_platform == 'linux'",
    "autoawq>=0.2.0; sys_platform == 'linux'",
]

[project.scripts]
master-mind = "master_mind.__main__:main"
