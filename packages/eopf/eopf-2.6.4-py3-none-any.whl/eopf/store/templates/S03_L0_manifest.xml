<?xml version="1.0" encoding="UTF-8"?>
<xfdu:XFDU xmlns:xfdu="urn:ccsds:schema:xfdu:1" xmlns:sentinel-safe="http://www.esa.int/safe/sentinel/1.1" xmlns:gml="http://www.opengis.net/gml" xmlns:sentinel3="http://www.esa.int/safe/sentinel/sentinel-3/1.0" xmlns:s3-level0="http://www.esa.int/safe/sentinel/sentinel-3/level-0/1.0" version="esa/safe/sentinel/sentinel-3/level-0/1.0">
  <informationPackageMap>
    <xfdu:contentUnit ID="packageUnit" unitType="Information Package" textInfo="SENTINEL-3 IPF Level 0 Product Manifest File" pdiID="processing" dmdID="acquisitionPeriod platform measurementOrbitReference measurementQualityInformation measurementFrameSet generalProductInformation">
      <xfdu:contentUnit ID="ISPUnit" unitType="Measurement Data Unit" textInfo="ISP data as raw binary" repID="ISPDataSchema" dmdID="ISPAnnotation">
        <dataObjectPointer dataObjectID="ISPData"/>
      </xfdu:contentUnit>
      <xfdu:contentUnit ID="ISPAnnotationUnit" unitType="Metadata Unit" textInfo="ISP Annotation data as raw binary" repID="ISPAnnotationSchema">
        <dataObjectPointer dataObjectID="ISPAnnotationData"/>
      </xfdu:contentUnit>
    </xfdu:contentUnit>
  </informationPackageMap>
  <metadataSection>
    <metadataObject ID="processing" classification="PROVENANCE" category="PDI">
      <metadataWrap mimeType="text/xml" vocabularyName="Sentinel-SAFE" textInfo="Processing">
        <xmlData>
          <sentinel-safe:processing name="DataProcessing" outputLevel="0" start="Not Available" stop="Not Available">
            <sentinel-safe:facility name="{{ PRODUCT['stac_discovery']['properties']['providers'][0]['name'] }}" organisation="{{ PRODUCT['stac_discovery']['properties']['providers'][1]['name'] }}" site="Cloud Service Provider" country="EU">
              <sentinel-safe:hardware name="OPE"/>
              <sentinel-safe:software name="IPF-0" version="{{ PRODUCT['stac_discovery']['properties']['processing:software']['IPF-0'] }}"/>
            </sentinel-safe:facility>
            <sentinel-safe:resource name="Not Available" role="Time Correlation File"/>
            <sentinel-safe:resource name="Not Available" role="FOS Orbit File (Restituted)">
              <sentinel-safe:processing name="ADC_AUX_REFORMATTER">
                <sentinel-safe:facility name="MAR" organisation="European Organisation for the Exploitation of Meteorological Satellites" site="Darmstadt" country="Germany">
                  <sentinel-safe:hardware name="OPE"/>
                  <sentinel-safe:software name="ADC" version="2.0"/>
                </sentinel-safe:facility>
              </sentinel-safe:processing>
            </sentinel-safe:resource>
            <sentinel-safe:resource name="Not Available" role="Reference Orbit Scenario File">
              <sentinel-safe:processing name="ADC_AUX_REFORMATTER">
                <sentinel-safe:facility name="MAR" organisation="European Organisation for the Exploitation of Meteorological Satellites" site="Darmstadt" country="Germany">
                  <sentinel-safe:hardware name="OPE"/>
                  <sentinel-safe:software name="ADC" version="2.0"/>
                </sentinel-safe:facility>
              </sentinel-safe:processing>
            </sentinel-safe:resource>
            <sentinel-safe:resource name="Not Available" role="L0PP Granule"/>
            <sentinel-safe:resource name="Not Available" role="Orbit File"/>
            <sentinel-safe:resource name="Not Available" role="L0 Product">
              <sentinel-safe:processing name="DataProcessing" outputLevel="0" start="Not Available" stop="Not Available">
                <sentinel-safe:facility name="{{ PRODUCT['stac_discovery']['properties']['providers'][0]['name'] }}" organisation="{{ PRODUCT['stac_discovery']['properties']['providers'][1]['name'] }}" site="Cloud Service Provider" country="EU">
                  <sentinel-safe:hardware name="OPE"/>
                  <sentinel-safe:software name="IPF-0" version="06.15"/>
                </sentinel-safe:facility>
                <sentinel-safe:resource name="Not Available" role="Time Correlation File"/>
                <sentinel-safe:resource name="Not Available" role="FOS Orbit File (Restituted)"/>
                <sentinel-safe:resource name="Not Available" role="Reference Orbit Scenario File"/>
                <sentinel-safe:resource name="Not Available" role="L0PP Granule"/>
                <sentinel-safe:resource name="S3IPF PDS 001 - i1r8 - Product Data Format Specification - Level 0" role="Product Data Format Specification - Level 0"/>
              </sentinel-safe:processing>
            </sentinel-safe:resource>
            <sentinel-safe:resource name="S3IPF PDS 001 - i1r8 - Product Data Format Specification - Level 0" role="Product Data Format Specification - Level 0"/>
          </sentinel-safe:processing>
        </xmlData>
      </metadataWrap>
    </metadataObject>
    <metadataObject ID="acquisitionPeriod" classification="DESCRIPTION" category="DMD">
      <metadataWrap mimeType="text/xml" vocabularyName="Sentinel-SAFE" textInfo="Acquisition Period">
        <xmlData>
          <sentinel-safe:acquisitionPeriod>
            <sentinel-safe:startTime>{{ PRODUCT['stac_discovery']['properties']['start_datetime'] }}</sentinel-safe:startTime>
            <sentinel-safe:stopTime>{{ PRODUCT['stac_discovery']['properties']['end_datetime'] }}</sentinel-safe:stopTime>
          </sentinel-safe:acquisitionPeriod>
        </xmlData>
      </metadataWrap>
    </metadataObject>
    <metadataObject ID="platform" classification="DESCRIPTION" category="DMD">
      <metadataWrap mimeType="text/xml" vocabularyName="Sentinel-SAFE" textInfo="Platform Description">
        <xmlData>
          <sentinel-safe:platform>
            <sentinel-safe:nssdcIdentifier>{{ PRODUCT['stac_discovery']['properties']['sat:platform_international_designator'] }}</sentinel-safe:nssdcIdentifier>
            <sentinel-safe:familyName>{{ PRODUCT['stac_discovery']['properties']["platform"][:-1] }}</sentinel-safe:familyName>
            <sentinel-safe:number>{{ PRODUCT['stac_discovery']['properties']["platform"][-1] }}</sentinel-safe:number>
            <sentinel-safe:instrument>
              <sentinel-safe:familyName abbreviation="{{ PRODUCT['stac_discovery']['properties']['instrument'] }}">Not Available</sentinel-safe:familyName>
              <sentinel-safe:mode identifier="EO">{{ PRODUCT['stac_discovery']['properties']['eopf:instrument_mode'] }}</sentinel-safe:mode>
            </sentinel-safe:instrument>
          </sentinel-safe:platform>
        </xmlData>
      </metadataWrap>
    </metadataObject>
    <metadataObject ID="generalProductInformation" classification="DESCRIPTION" category="DMD">
      <metadataWrap mimeType="text/xml" vocabularyName="Sentinel-SAFE" textInfo="General Product Information">
        <xmlData>
          <sentinel3:generalProductInformation>
            <sentinel3:productName>{{ PRODUCT['stac_discovery']['id'] }}</sentinel3:productName>
            <sentinel3:productType>{{ PRODUCT['stac_discovery']['id'][4:15] }}</sentinel3:productType>
            <sentinel3:timeliness>{{ PRODUCT['stac_discovery']['properties']['product:timeliness_category'] }}</sentinel3:timeliness>
            <sentinel3:baselineCollection>{{ PRODUCT['stac_discovery']['collection'] }}</sentinel3:baselineCollection>
            <sentinel3:creationTime>{{ PRODUCT['stac_discovery']['properties']['created'][:-1].replace('-','').replace(':','') }}</sentinel3:creationTime>
            <sentinel3:productSize>Not Available</sentinel3:productSize>
            <sentinel3:dumpInformation>
              <sentinel3:granuleNumber>{{ PRODUCT['other_metadata']['dump_granule_number'] }}</sentinel3:granuleNumber>
              <sentinel3:granulePosition>{{ PRODUCT['other_metadata']['dump_granule_position'] }}</sentinel3:granulePosition>
              <sentinel3:dumpStart>{{ PRODUCT['other_metadata']['dump_start'] }}</sentinel3:dumpStart>
              <sentinel3:receivingGroundStation>{{ PRODUCT['other_metadata']['receiving_ground_station'] }}</sentinel3:receivingGroundStation>
              <sentinel3:receivingStartTime>{{ PRODUCT['other_metadata']['receiving_start_time'] }}</sentinel3:receivingStartTime>
              <sentinel3:receivingStopTime>{{ PRODUCT['other_metadata']['receiving_stop_time'] }}</sentinel3:receivingStopTime>
            </sentinel3:dumpInformation>
            <sentinel3:dispositionMode>Not Available</sentinel3:dispositionMode>
            <sentinel3:productUnit>
              <sentinel3:type>{{ PRODUCT['other_metadata']['product_unit']['type'] }}</sentinel3:type>
              <sentinel3:duration>{{ PRODUCT['other_metadata']['product_unit']['duration'] }}</sentinel3:duration>
            </sentinel3:productUnit>
            <s3-level0:packetCount>{{ PRODUCT['other_metadata']['packet_count'] }}</s3-level0:packetCount>
          </sentinel3:generalProductInformation>
        </xmlData>
      </metadataWrap>
    </metadataObject>
    <metadataObject ID="measurementOrbitReference" classification="DESCRIPTION" category="DMD">
      <metadataWrap mimeType="text/xml" vocabularyName="Sentinel-SAFE" textInfo="Orbit Reference">
        <xmlData>
          <sentinel-safe:orbitReference>
            <sentinel-safe:orbitNumber groundTrackDirection="{{ PRODUCT['stac_discovery']['properties']['sat:orbit_state'] }}" type="start">{{ PRODUCT['stac_discovery']['properties']['sat:absolute_orbit'] }}</sentinel-safe:orbitNumber>
            <sentinel-safe:relativeOrbitNumber groundTrackDirection="descending" type="start">{{ PRODUCT['stac_discovery']['properties']['sat:relative_orbit'] }}</sentinel-safe:relativeOrbitNumber>
            <sentinel-safe:passNumber groundTrackDirection="descending" type="start">{{ PRODUCT['other_metadata']['absolute_pass_number'] }}</sentinel-safe:passNumber>
            <sentinel-safe:relativePassNumber groundTrackDirection="descending" type="start">{{ PRODUCT['other_metadata']['relative_pass_number'] }}</sentinel-safe:relativePassNumber>
            <sentinel-safe:cycleNumber>{{ PRODUCT['other_metadata']['cycle_number'] }}</sentinel-safe:cycleNumber>
            <sentinel-safe:phaseIdentifier>{{ PRODUCT['other_metadata']['phase_identifier'] }}</sentinel-safe:phaseIdentifier>
            <sentinel-safe:elementSet>
              <sentinel-safe:ephemeris>
                <sentinel-safe:epoch type="UTC">{{ PRODUCT['other_metadata']['ephemeris']['start']['UTC'] }}</sentinel-safe:epoch>
                <sentinel-safe:epoch type="UT1">{{ PRODUCT['other_metadata']['ephemeris']['start']['UT1'] }}</sentinel-safe:epoch>
                <sentinel-safe:epoch type="TAI">{{ PRODUCT['other_metadata']['ephemeris']['start']['TAI'] }}</sentinel-safe:epoch>
                <sentinel-safe:position>
                  <sentinel-safe:x>{{ PRODUCT['other_metadata']['ephemeris']['start']['position']['x'] }}</sentinel-safe:x>
                  <sentinel-safe:y>{{ PRODUCT['other_metadata']['ephemeris']['start']['position']['y'] }}</sentinel-safe:y>
                  <sentinel-safe:z>{{ PRODUCT['other_metadata']['ephemeris']['start']['position']['z'] }}</sentinel-safe:z>
                </sentinel-safe:position>
                <sentinel-safe:velocity>
                  <sentinel-safe:x>{{ PRODUCT['other_metadata']['ephemeris']['start']['velocity']['x'] }}</sentinel-safe:x>
                  <sentinel-safe:y>{{ PRODUCT['other_metadata']['ephemeris']['start']['velocity']['y'] }}</sentinel-safe:y>
                  <sentinel-safe:z>{{ PRODUCT['other_metadata']['ephemeris']['start']['velocity']['z'] }}</sentinel-safe:z>
                </sentinel-safe:velocity>
              </sentinel-safe:ephemeris>
              <sentinel-safe:ephemeris>
                <sentinel-safe:epoch type="UTC">{{ PRODUCT['other_metadata']['ephemeris']['stop']['UTC'] }}</sentinel-safe:epoch>
                <sentinel-safe:epoch type="UT1">{{ PRODUCT['other_metadata']['ephemeris']['stop']['UT1'] }}</sentinel-safe:epoch>
                <sentinel-safe:epoch type="TAI">{{ PRODUCT['other_metadata']['ephemeris']['stop']['TAI'] }}</sentinel-safe:epoch>
                <sentinel-safe:position>
                  <sentinel-safe:x>{{ PRODUCT['other_metadata']['ephemeris']['stop']['position']['x'] }}</sentinel-safe:x>
                  <sentinel-safe:y>{{ PRODUCT['other_metadata']['ephemeris']['stop']['position']['y'] }}</sentinel-safe:y>
                  <sentinel-safe:z>{{ PRODUCT['other_metadata']['ephemeris']['stop']['position']['z'] }}</sentinel-safe:z>
                </sentinel-safe:position>
                <sentinel-safe:velocity>
                  <sentinel-safe:x>{{ PRODUCT['other_metadata']['ephemeris']['stop']['velocity']['x'] }}</sentinel-safe:x>
                  <sentinel-safe:y>{{ PRODUCT['other_metadata']['ephemeris']['stop']['velocity']['y'] }}</sentinel-safe:y>
                  <sentinel-safe:z>{{ PRODUCT['other_metadata']['ephemeris']['stop']['velocity']['z'] }}</sentinel-safe:z>
                </sentinel-safe:velocity>
              </sentinel-safe:ephemeris>
            </sentinel-safe:elementSet>
          </sentinel-safe:orbitReference>
        </xmlData>
      </metadataWrap>
    </metadataObject>
    <metadataObject ID="measurementQualityInformation" classification="DESCRIPTION" category="DMD">
      <metadataWrap mimeType="text/xml" vocabularyName="Sentinel-SAFE" textInfo="Quality Information">
        <xmlData>
          <sentinel-safe:qualityInformation>
            <sentinel-safe:extension>
              <sentinel3:productQuality>
                <sentinel3:onlineQualityCheck>Not Available</sentinel3:onlineQualityCheck>
                <s3-level0:rawDataQuality>
                  <s3-level0:tooManyTransmissionErrors>Not Available</s3-level0:tooManyTransmissionErrors>
                  <s3-level0:transmissionErrorThreshold>Not Available</s3-level0:transmissionErrorThreshold>
                  <s3-level0:tooManyFormatErrors>Not Available</s3-level0:tooManyFormatErrors>
                  <s3-level0:formatErrorThreshold>Not Available</s3-level0:formatErrorThreshold>
                </s3-level0:rawDataQuality>
              </sentinel3:productQuality>
            </sentinel-safe:extension>
          </sentinel-safe:qualityInformation>
        </xmlData>
      </metadataWrap>
    </metadataObject>
    <metadataObject ID="measurementFrameSet" classification="DESCRIPTION" category="DMD">
      <metadataWrap mimeType="text/xml" vocabularyName="Sentinel-SAFE" textInfo="Frame Set">
        <xmlData>
          <sentinel-safe:frameSet>
            <sentinel-safe:footPrint srsName="http://www.opengis.net/def/crs/EPSG/0/4326">
              <gml:posList>{% for coord in PRODUCT['stac_discovery']['geometry']['coordinates'] %}{{ coord }} {% endfor %}</gml:posList>
            </sentinel-safe:footPrint>
          </sentinel-safe:frameSet>
        </xmlData>
      </metadataWrap>
    </metadataObject>
    <metadataObject ID="ISPAnnotation" classification="DESCRIPTION" category="DMD">
      <dataObjectPointer dataObjectID="ISPAnnotationData"/>
    </metadataObject>
    <metadataObject ID="ISPDataSchema" classification="SYNTAX" category="REP">
      <metadataReference mimeType="text/xml" vocabularyName="SDF" locatorType="URL" href="ISPData.xsd"/>
    </metadataObject>
    <metadataObject ID="ISPAnnotationSchema" classification="SYNTAX" category="REP">
      <metadataReference mimeType="text/xml" vocabularyName="SDF" locatorType="URL" href="ISPAnnotation.xsd"/>
    </metadataObject>
  </metadataSection>
  <dataObjectSection>
    <dataObject ID="ISPData" repID="ISPDataSchema">
      <byteStream mimeType="application/octetstream" size="{{ ISPData_size }}">
        <fileLocation locatorType="URL" href="ISPData.dat"/>
        <checksum checksumName="MD5">{{ PRODUCT['other_metadata']['ISPDataMD5'] }}</checksum>
      </byteStream>
    </dataObject>
    <dataObject ID="ISPAnnotationData" repID="ISPAnnotationSchema">
      <byteStream mimeType="application/octetstream" size="{{ ISPAnnotation_size }}">
        <fileLocation locatorType="URL" href="ISPAnnotation.dat"/>
        <checksum checksumName="MD5">{{ PRODUCT['other_metadata']['ISPAnnotationMD5'] }}</checksum>
      </byteStream>
    </dataObject>
  </dataObjectSection>
</xfdu:XFDU>
