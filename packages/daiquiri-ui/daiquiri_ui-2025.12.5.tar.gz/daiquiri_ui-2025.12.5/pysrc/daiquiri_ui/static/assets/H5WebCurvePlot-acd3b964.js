import{j as n,r as O,ax as w,ac as N}from"./index-4cf586ed.js";import{K as V,b as p,w as A,d as H,O as W,Q as D,s as G,W as R,G as z,q as K,V as Y,e as P,f as k,T as _,i as q,B,Y as F,g as J,P as Q,J as U}from"./index-19c84627.js";function X(i){const{curve:t,onClick:a,onDoubleClick:x}=i;return n.jsxs("button",{className:"btn-clean entry",type:"button","data-not-visible":t.visible?void 0:"",onClick:()=>a(),onDoubleClick:()=>x(),children:[n.jsx("div",{className:"handle",style:{backgroundColor:t.color}}),t.name]},t.name)}function T(i){const{curves:t,onEntryClick:a,onEntryDoubleClick:x}=i;return n.jsx("div",{children:t.map((u,o)=>n.jsx(X,{curve:u,onClick:()=>a(o),onDoubleClick:()=>x(o)},u.name))})}function Z(i){const{curves:t}=i,a=t[0].x,x=V(a,!0),{abscissaConfig:u}=p();return n.jsx(A,{guides:"both",renderTooltip:o=>{const d=x(o);return n.jsxs("div",{className:"h5web-tooltip",children:[u.label||"x","=",a[d],t.filter(r=>r.visible).map(r=>n.jsxs("div",{children:[n.jsxs("strong",{children:[r.name,":"]})," ",r.y[d]]},r.name))]})}})}function $(i){const{onDataPointClick:t,...a}=i,{abscissas:x,ordinates:u,color:o}=a,[d,r]=O.useState(),h=V(x,!0),{worldToData:s}=p(),e=t?(j,m)=>{const{unprojectedPoint:y}=m,l=s(y),f=h(l.x);t(f,m)}:void 0,c=t?(j,m)=>{const{unprojectedPoint:y}=m,l=s(y);r(h(l.x))}:void 0,v=t?()=>r(void 0):void 0;return n.jsxs(n.Fragment,{children:[n.jsx(H,{onDataPointClick:e,onDataPointEnter:c,onDataPointLeave:v,...a}),d&&n.jsx(W,{x:x[d],y:u[d],center:!0,children:n.jsx("svg",{className:"line-hover-svg",style:{fill:o},children:n.jsx("circle",{r:4})})})]})}function rn(i){const[t]=i;return!!t&&Object.getOwnPropertyNames(t).includes("marker")}function I(i){return i!=null}function nn(i){return I(i)&&i.length>0}function en(){const{abscissaScale:i,ordinateScale:t}=p(),[a,x]=i.domain(),[u,o]=t.domain();return(d,r,h,s)=>{const e=h==="paper"?a+d*(x-a):d,c=s==="paper"?u+r*(o-u):r;return new w(e,c)}}function sn(i){const{shapes:t=[],annotations:a=[]}=i,{width:x,height:u}=N(s=>s.size),{dataToHtml:o}=p(),d=en(),r=D(s=>t.map(e=>{const c=o(s,d(e.x0,e.y0,e.xref,e.yref)),v=o(s,d(e.x1,e.y1,e.xref,e.yref));return{v0:c,v1:v,...e}}),[t]),h=D(s=>a.map((e,c)=>({v:o(s,d(e.x,e.y,e.xref,e.yref)),...e})),[a]);return n.jsx(G,{children:n.jsxs("svg",{width:x,height:u,children:[r.map((s,e)=>{const{v0:c,v1:v,fillcolor:j,line:m,opacity:y}=s;return n.jsx("rect",{x:Math.min(c.x,v.x),y:Math.min(c.y,v.y),width:Math.abs(v.x-c.x),height:Math.abs(v.y-c.y),fill:j,strokeWidth:m==null?void 0:m.width,fillOpacity:y},e)}),h.map((s,e)=>{const{text:c,v}=s;return n.jsx("text",{x:v.x,y:v.y,textAnchor:"middle",children:c},e)})]})})}function tn(i){const{onValidSelection:t}=i,a=N(h=>h.camera),{ordinateConfig:x,dataToHtml:u,dataToWorld:o}=p(),[d,r]=x.visDomain;return n.jsx(R,{axis:"x",onValidSelection:h=>{const{data:s}=h,e=new w(s[0].x,d),c=new w(s[1].x,r);t({data:[e,c],html:[u(a,e),u(a,c)],world:[o(e),o(c)]})},children:({html:h})=>n.jsx(z,{children:n.jsx(K,{coords:h,fill:"gray",fillOpacity:.25})})})}const M=["#1f77b4","#ff7f0e","#2ca02c","#d62728"],S=[.1,1],E=6;function cn(i){var m,y;const{data:t,insetLegend:a,onClick:x,curveType:u,layout:o,onRoiSelection:d}=i,[r,h]=O.useState(t.map(()=>!0)),s=t.filter(I).flatMap((l,f)=>{const{x:b,y:C,name:L}=l;if(!nn(C))return[];const g=Y(b,C.length);return[{color:M[f%M.length],visible:r[f],name:L,x:Array.isArray(g)?g:[...g],y:C}]}),e=P(k(s.map(l=>l.x)))||S,c=P(k(s.map(l=>l.y)))||S;if(s.length===0)return n.jsx("div",{children:"No curve data. Please select a series."});const v=l=>{h(r.map((f,b)=>b===l?!f:f))},j=l=>{h(r.map((f,b)=>b===l))};return n.jsxs("div",{className:"h5web-plot",children:[n.jsxs(_,{abscissaConfig:{visDomain:e,showGrid:!0,label:(m=o==null?void 0:o.xaxis)==null?void 0:m.title},ordinateConfig:{visDomain:c,showGrid:!0,label:(y=o==null?void 0:o.yaxis)==null?void 0:y.title},raycasterThreshold:E,children:[s.map(l=>n.jsx($,{abscissas:l.x,ordinates:l.y,color:l.color,visible:l.visible,onDataPointClick:x,glyphSize:E,glyphType:q.Circle,curveType:u},l.name)),n.jsx(B,{}),n.jsx(F,{}),n.jsx(J,{modifierKey:"Control"}),n.jsx(Z,{curves:s}),n.jsx(Q,{}),a&&n.jsx(U,{children:s.length>1&&n.jsx("div",{className:"h5web-legend","data-inset":"",children:n.jsx(T,{curves:s,onEntryClick:v,onEntryDoubleClick:j})})}),o&&n.jsx(sn,{shapes:o.shapes,annotations:o.annotations}),d&&n.jsx(tn,{onValidSelection:d})]}),!a&&s.length>1&&n.jsx("div",{className:"h5web-legend",children:n.jsx(T,{curves:s,onEntryClick:v,onEntryDoubleClick:j})})]})}export{cn as H,nn as h,rn as i};
