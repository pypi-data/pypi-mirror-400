[project]
name = "wbcore"
description = ""
authors = [{ name = "Christopher Wittlinger", email = "c.wittlinger@stainly.com"}]
dynamic = ["version"]

dependencies = [
  # Database Depenendencies
  "redis == 7.*",
  "psycopg[binary] == 3.*",

  # Generic Python Dependencies
  "python-slugify == 8.*",
  "requests == 2.*",
  "inscriptis == 1.*",   # TODO: Discuss if really needed

  # Django Dependencies
  "django == 5.2.*",
  "django-eventtools == 1.*",
  "django-configurations[database] == 2.5.*",
  "django-dynamic-preferences == 1.17.*",
  "django-filter == 25.*",
  "django-cors-headers == 4.9.*",
  "django-extensions == 4.1.*",
  "django-storages[boto3] == 1.14.*",
  "django-fsm == 2.*",  # Locked at 2.*, since 3 only adds the deprecation warning for removal
  "django-ordered-model == 3.7.*",

  # Django Rest Framework Dependencies
  "djangorestframework == 3.15.*", # bug in 3.16 regarding uniqueconstraint check, is fixed in the next 3.17 release
  "djangorestframework-simplejwt == 5.*",
  "pyjwt == 2.*",
  "django-rest-fuzzysearch == 0.5.*",

  # Background and Periodic Tasks
  "celery[redis] == 5.*",
  "django-celery-beat == 2.*",

  # Model Object Permissions
  "django-guardian == 3.2.*",
  "djangorestframework-guardian == 0.4.*",

  # Revision System
  "django-reversion == 5.1.*",
  "django-reversion-compare == 0.18.*",

  # Visualization
  "plotly == 6.*", # WARNING please ensure that the version is compatible with the Plotly.js defined in WBCORE_PLOTLY_CDN_URL

  # Terminal Formatting and Utils
  "tqdm == 4.*",
  "prettytable == 3.*",
  "igraph == 1.*",
  "openpyxl == 3.*",

  "django-colorfield == 0.14.*",
  "django-better-admin-arrayfield == 1.4.*",
  "django-picklefield == 3.*",

  "firebase-admin == 6.*",

  "fabric == 3.2.*",

  "croniter == 2.*",
  "python-magic == 0.*",
  "django-import-export == 4.*",
  "django-admin-inline-paginator == 0.4.0",
  "django-anymail == 13.*",
  "pytest-sftpserver == 1.*",
  "django-mptt == 0.*",
  "pycountry == 24.*",
  "phonenumbers == 9.*",
  "schwifty == 2025.*",
  "ics == 0.*",
  "tatsu == 5.*",
  "humanize==4.*",
  "faker == 38.*",       # We add exlicitly faker because it's used in production
  "graphviz == 0.*",
  "django-maintenance-mode == 0.22.*",
  "rstr == 3.2.*",
  "django-modeltrans >= 0.9",

    # Markdown
  "markdown == 3.10.*",

  "langchain == 1.0.*",
  "langchain-openai == 1.0.*",

  "weasyprint == 66.*",
  "reportlab == 4.*",
]

[project.optional-dependencies]
pandas = [
  # Datascience
  "numpy == 1.*",
  "pandas == 2.2.*",
]

[tool.uv]
package = true

[tool.hatch.version]
path = "../../pyproject.toml"

[tool.hatch.build]
include = [
  "wbcore/**/*",
]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.pyright]
venvPath = "../.."
venv = ".venv"
reportIncompatibleVariableOverride = false

[tool.pytest.ini_options]
DJANGO_SETTINGS_MODULE = "wbcore_config.settings"
DJANGO_CONFIGURATION = "Test"
addopts = "--nomigrations --cov=. --cov-report=html --cov-report=xml --cov-report=term-missing:skip-covered"
python_files = ["tests.py", "test_*.py", "*_tests.py"]

markers = [
    "with_db: marks tests that use a testing database",
    "model_tests: marks tests for the models in the directory package",
    "serializer_tests: marks tests that are specifically for serializers",
    "viewset_tests: marks tests that are specifically for viewsets"
]
