import pytest
from regfans.vectorconfig import VectorConfiguration

# non-totally-cyclic VC tests
# ---------------------------
def test_acyclic():
    pts = [[0,0,1], [0,1,1], [1,0,1], [1,1,1]]
    vc  = VectorConfiguration(pts)

    assert vc.is_acyclic()
    assert not vc.is_totally_cyclic()
    assert sorted([tuple(n) for n in vc.support()]) == [(-1, 0, 1), (0, -1, 1), (0, 1, 0), (1, 0, 0)]

def test_lineality():
    pts = [[-1,0], [0,1], [1,0]]
    vc  = VectorConfiguration(pts)

    assert not vc.is_acyclic()
    assert not vc.is_totally_cyclic()
    assert sorted([tuple(n) for n in vc.support()]) == [(0,1)]

# 4D reflexive polytope tests
# ---------------------------
def test_eq():
    pts1 = [[-5, -2, -3, -2], [0, 1, 0, 0], [0, 1, 2, 0], [1, 0, 0, 0], [1, 0, 1, 2], [-2, -1, -1, 0], [0, 1, 1, 0]]
    pts2 = [[-2, -1, -2, -3], [0, 0, 1, 0], [0, 0, 1, 3], [0, 1, 0, 0], [1, 0, 0, 0], [0, 0, 1, 1], [0, 0, 1, 2]]

    vc1  = VectorConfiguration(pts1)
    vc2  = VectorConfiguration(pts2)

    assert not (vc1 == vc2)
    assert vc1 != vc2
    assert vc1 == vc1.copy()

def test_basic_and_subdivide():
    all_pts = [
         [[-5, -2, -3, -2], [0, 1, 0, 0], [0, 1, 2, 0], [1, 0, 0, 0], [1, 0, 1, 2], [-2, -1, -1, 0], [0, 1, 1, 0]] ,
         [[-2, -1, -2, -3], [0, 0, 1, 0], [0, 0, 1, 3], [0, 1, 0, 0], [1, 0, 0, 0], [0, 0, 1, 1], [0, 0, 1, 2]] ,
         [[0, 0, 0, 1], [1, -3, -2, -1], [-2, 2, 1, 0], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 1, 1, 0]] ,
         [[-2, -1, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [2, -1, 0, -1], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[-2, -2, -1, -2], [-1, 1, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, -1, 0, -1]] ,
         [[0, 0, 1, 0], [0, 0, 0, 1], [0, 1, 0, 0], [1, -2, -1, -1], [-2, 0, -1, 0], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[-1, -1, 1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [-1, 0, -1, -1], [0, -1, -1, -1], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[0, 0, 1, 0], [1, 0, 0, 0], [-1, -1, 0, 2], [0, -1, -1, 0], [0, 1, 0, 0], [-1, 0, -1, -1], [0, 0, 0, 1]] ,
         [[-2, -1, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [2, 0, -1, -1], [-1, 0, 0, 0]] ,
         [[1, 0, 0, 0], [-5, -3, -1, -2], [0, 1, 0, 0], [1, 1, 1, 2], [-2, 0, -1, 0], [0, 0, 1, 0], [-2, -1, 0, 0]] ,
         [[1, 0, 0, 0], [-3, -1, -1, -2], [-2, -1, 0, 0], [-2, 0, -1, 0], [0, 0, 1, 0], [0, 1, 0, 0], [1, 1, 1, 2]] ,
         [[-2, -1, -2, -2], [0, 0, 1, 0], [0, 0, 1, 2], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, -1, -1], [0, 0, 1, 1]] ,
         [[1, 0, 0, 0], [-1, 1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [-2, -2, -1, 0], [0, 1, 0, 0], [-1, -1, 0, 0]] ,
         [[0, -2, -2, -1], [0, 0, 0, 1], [-1, 1, 1, 0], [0, -1, -1, 0], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[1, 0, 0, 0], [-2, 2, -3, -2], [0, 0, 0, 1], [0, 0, 1, 0], [-1, -1, 0, 0], [0, 1, 0, 0], [-1, 1, -1, -1]] ,
         [[-1, -1, 1, -1], [0, 0, 0, 1], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, -1, 0], [0, -1, -1, 0], [0, 0, 1, 0]] ,
         [[-1, -1, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [2, -1, 0, -1], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[-2, 0, 0, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, -1, -1, 0], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[0, 1, 0, 0], [-1, -2, -2, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, -1, -1, 0], [1, 0, 0, 0], [-1, 0, 1, 0]] ,
         [[0, 0, 1, 0], [1, 0, 0, 0], [-1, 0, -1, 2], [0, 0, 0, 1], [0, 1, 0, 0], [-2, -2, -1, -1], [-1, -1, 0, 0]] ,
         [[-2, -1, 2, 0], [-1, -1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, 1, 0]] ,
         [[-1, -1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [-1, 0, 1, 0], [0, -1, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [1, -2, -1, -1], [-1, 1, 0, 0], [0, 1, 0, 0], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[-3, -3, -3, -2], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-2, -2, -2, -1], [-1, -1, -1, 0]] ,
         [[0, 1, 0, 0], [1, 0, 0, 0], [-2, -2, -2, -1], [-1, -1, 0, -1], [0, 0, 0, 1], [0, 0, 1, 0], [-1, -1, -1, 0]] ,
         [[0, 1, 0, 0], [0, -1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [-2, -1, 0, 0], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[-2, -1, 1, 1], [0, -1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, -1, 0, 0]] ,
         [[0, -1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [-2, 1, 0, 0], [1, 0, 0, 0], [-1, 1, 0, 0]] ,
         [[-2, 0, -1, 0], [-1, -2, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[-2, -2, 0, -1], [0, 0, 0, 1], [0, 1, 0, 0], [1, 0, 0, 0], [-1, -1, 0, 0], [0, 0, 1, 0], [1, 0, -1, 0]] ,
         [[0, 1, 0, 0], [-2, -1, 2, -2], [0, 0, 0, 1], [1, 0, 0, 0], [-1, -1, -1, 0], [-1, 0, 1, -1], [0, 0, 1, 0]] ,
         [[1, 0, 0, 0], [-1, -1, -1, 0], [-1, -1, 0, -1], [-1, 0, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0]] ,
         [[0, 0, 1, 0], [0, 1, 0, 0], [0, -1, -1, -1], [0, 0, 0, 1], [-1, -1, -1, -1], [-1, 0, 0, 1], [1, 0, 0, 0]] ,
         [[-1, -1, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, -1, 0, -1], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[1, 0, 0, 0], [0, -1, -1, -1], [0, 0, 0, 1], [-1, -1, 0, 0], [-1, 0, -1, 0], [0, 0, 1, 0], [0, 1, 0, 0]] ,
         [[1, 0, 0, 0], [-1, -1, 0, 0], [-1, 0, -1, 0], [0, 0, 1, 0], [0, 1, 0, 0], [0, 0, 0, 1], [1, 0, 0, -1]] ,
         [[0, 0, 0, 1], [0, 1, 0, 0], [1, 0, 0, 0], [-1, -1, -1, 0], [-1, 0, 1, -1], [0, -1, 1, -1], [0, 0, 1, 0]] ,
         [[-1, 0, 1, -1], [0, -1, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [-1, 1, 0, 0], [1, 0, 0, 0]] ,
         [[-1, -1, -1, 0], [0, 0, 1, 0], [-1, 2, 0, -1], [0, 0, 0, 1], [0, 1, 0, 0], [1, 0, 0, 0], [0, 1, 0, -1]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [-1, -2, -1, -1], [0, -1, -1, -1], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [1, 1, -2, -1], [-1, 0, 0, 0], [0, -1, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [1, 0, -1, -1], [-1, -1, 0, 0], [-1, 0, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[-1, 0, 0, -1], [0, -1, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [1, 1, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [2, 0, -1, -1], [-1, -1, 0, 0], [-1, 0, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[-1, -1, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, -1, 0], [1, 0, 0, -1]] ,
         [[0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, -1, 0], [0, -1, 0, -1], [0, 0, 0, 1], [0, 0, 1, 0], [-1, -1, 0, 0]] ,
         [[-1, 0, 0, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [0, -1, -1, 0], [1, 1, 1, 0]] ,
         [[-2, -1, -1, -1], [0, -1, -1, 1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, -1, -1, 0]] ,
         [[0, 1, 0, 0], [0, 1, 1, 1], [1, 0, 0, 0], [-1, -1, -1, 0], [-1, -1, 0, -1], [0, 0, 0, 1], [0, 0, 1, 0]] ,
         [[0, 0, 1, 0], [0, 1, 0, 0], [0, -1, -1, -1], [0, 0, 0, 1], [1, -1, -1, 0], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [1, -1, -1, -1], [-1, 0, 0, 0], [0, -1, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[-1, -1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, 0, 0], [1, -1, 0, 0]] ,
         [[-1, -1, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0], [1, 0, 0, 0], [1, 1, -1, -1], [0, -1, 1, 0], [0, 1, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [2, -1, -1, -1], [-1, 0, 0, 0], [1, -2, -1, -1], [1, 0, 0, 0]] ,
         [[-5, -3, -3, -3], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-3, -2, -2, -2], [-1, -1, -1, -1]] ,
         [[-9, -5, -3, -2], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [1, 1, 1, 2], [-4, -2, -1, 0], [-2, -1, 0, 0]] ,
         [[-1, -1, -1, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, -1, -1, -1], [0, 0, 0, 1], [-1, -1, -1, 0]] ,
         [[-1, -1, -1, -1], [-1, -1, 1, 1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, -1, 0, 0]] ,
         [[-2, -2, -2, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [-1, -1, -1, 0], [-1, 0, 0, 1], [1, 0, 0, 0]] ,
         [[-3, -2, -2, -2], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [-2, -1, -1, -1], [1, 0, 0, 0], [-1, -1, -1, -1]] ,
         [[0, -2, -2, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [-1, 0, 0, 0], [0, -1, -1, 0], [1, 0, 0, 0]] ,
         [[-2, 0, 0, -1], [0, -1, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[0, 1, 0, 0], [1, 0, 0, 0], [-5, -3, -1, -2], [-4, -2, -1, 0], [0, 0, 1, 0], [1, 1, 1, 2], [-2, -1, 0, 0]] ,
         [[0, 0, 1, 0], [0, 1, 0, 0], [-1, -1, -1, -1], [0, -1, -1, 0], [0, 0, 0, 1], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[0, 1, 0, 0], [0, -1, -1, 0], [0, -1, 0, -1], [0, 0, 0, 1], [0, 0, 1, 0], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[0, -1, -1, 0], [0, 0, 1, 0], [0, 1, 0, 0], [-1, 0, 0, 0], [0, 0, 0, 1], [0, 1, 0, -1], [1, 0, 0, 0]] ,
         [[0, 1, 0, 0], [0, 0, 0, 1], [1, -1, 1, -1], [0, -1, -1, 0], [0, 0, 1, 0], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[0, -1, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 1, 1, -1], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[0, -1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 1, 0, 0], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[0, -1, 0, -1], [0, 0, 0, 1], [0, 1, 0, 0], [-1, 0, 0, 0], [0, 0, 1, 0], [1, 0, -1, 0], [1, 0, 0, 0]] ,
         [[-1, 1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [-1, 0, 0, 0], [0, 1, 0, 0], [1, -1, 0, 0], [1, 0, 0, 0]] ,
         [[1, 0, 0, 0], [-1, 0, -1, -1], [0, 0, 0, 1], [0, 1, 1, 0], [-1, -1, 0, 0], [0, 0, 1, 0], [0, 1, 0, 0]] ,
         [[0, 1, 0, 0], [1, 0, 0, 0], [-1, -1, 0, 0], [0, -1, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [1, 0, -1, 0]] ,
         [[1, 0, 0, 0], [0, 0, 0, 1], [1, 1, 1, -1], [-1, -1, 0, 0], [-1, 0, -1, 0], [0, 0, 1, 0], [0, 1, 0, 0]] ,
         [[0, 1, 0, 0], [1, 0, 0, 0], [-1, -1, 0, -1], [0, 0, 1, 0], [-1, -1, -1, 0], [0, 0, 0, 1], [0, 0, 1, -1]] ,
         [[1, 0, 0, 0], [-1, -1, -1, 0], [0, 0, 1, 0], [0, 1, 0, 1], [-1, 1, 0, -1], [0, 1, 0, 0], [0, 0, 0, 1]] ,
         [[-1, -1, -1, 0], [0, 0, 1, 0], [0, 1, 0, 0], [-1, 0, 0, 1], [0, 0, 0, 1], [0, 1, 0, -1], [1, 0, 0, 0]] ,
         [[0, 0, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [-1, 0, 0, 0], [0, -1, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[0, -1, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [2, -1, 0, -1], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[-1, 0, -1, 0], [0, 0, 0, 1], [0, 0, 1, 0], [1, -2, 0, -1], [1, 0, 0, 0], [0, 1, 0, 0], [1, -1, 0, 0]] ,
         [[-1, -1, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [2, 0, -1, -1], [1, 0, -1, -1], [1, 0, 0, 0]] ,
         [[-1, -2, -1, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [-2, 1, 0, 0], [1, 0, 0, 0], [-1, 1, 0, 0]] ,
         [[0, 1, 0, 0], [0, -1, 1, -1], [0, 0, 0, 1], [-1, -1, -1, 0], [0, 0, 1, 0], [1, 0, 0, 0], [-1, 0, 0, 0]] ,
         [[0, 0, 1, 0], [0, 0, 0, 1], [0, 1, -1, -1], [-1, -1, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, 1, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [1, 0, -1, -1], [-1, 0, 0, 0], [0, -1, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [1, -2, -1, -1], [0, 1, 0, 0], [1, 1, 0, 0], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[-1, -3, -2, -1], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [-1, 0, 0, 0], [0, -1, 0, 0]] ,
         [[-1, -1, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0], [0, 0, 0, 1], [0, 0, 1, -1], [0, 0, 1, 0], [1, 0, -1, 0]] ,
         [[1, 0, 0, 0], [-1, -1, 0, 0], [-1, 0, -1, 0], [0, 0, 1, 0], [0, 1, 0, 0], [0, 0, 0, 1], [0, 1, 0, -1]] ,
         [[1, 0, 0, 0], [-2, -1, -2, -1], [0, 0, 0, 1], [-1, -1, 0, 0], [-1, 0, -1, 0], [0, 0, 1, 0], [0, 1, 0, 0]] ,
         [[-2, -1, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [1, 1, -1, -1], [-1, 0, 0, 0]] ,
         [[0, 0, 1, 0], [0, 1, 0, 0], [1, -1, -1, 0], [-1, 0, 0, 0], [0, 0, 0, 1], [0, 1, 0, -1], [1, 0, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [1, 1, -1, -1], [-1, 0, 0, 0], [0, -1, 0, 0], [0, 1, 0, 0], [1, 0, 0, 0]] ,
         [[0, 0, 1, 0], [0, 1, 0, 0], [0, 0, 0, 1], [1, -1, -1, -1], [1, 0, 0, 0], [2, -1, -1, 0], [-1, 0, 0, 0]] ,
         [[0, 0, 1, 0], [1, 0, 0, 0], [-2, -2, -1, 0], [-2, -1, -1, -1], [0, 0, 0, 1], [0, 1, 0, 0], [-1, -1, 0, 0]] ,
         [[1, 0, 0, 0], [-2, -2, 0, -1], [0, 0, 0, 1], [0, 1, 0, 0], [-1, 0, -1, 0], [0, 0, 1, 0], [-1, -1, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [2, -2, -2, -1], [-1, 0, 0, 0], [1, -1, -1, 0], [1, 0, 0, 0]] ,
         [[-1, -1, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [2, 0, -2, -1], [1, 0, -1, 0]] ,
         [[0, 1, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0], [1, -1, -1, 0], [1, -1, 0, -1], [-1, 0, 0, 0], [1, 0, 0, 0]] ,
         [[0, 0, 0, 1], [0, 0, 1, 0], [0, 1, -1, -1], [-1, 0, 0, 0], [0, 1, 0, 0], [1, -1, 0, 0], [1, 0, 0, 0]] ,
    ]

    for pts in all_pts:
        vc  = VectorConfiguration(pts)
        assert vc.ambient_dim == 4
        assert vc.dim == 4
        assert vc.is_solid()
        assert vc.is_totally_cyclic()
        assert not vc.is_acyclic()

        assert vc.labels == tuple(list(range(1,vc.size+1)))

        fan = vc.subdivide()
        assert fan.is_fine()
        assert fan.is_regular()

def test_all_triangulations():
    pts = [[-2, 2, 1, -1], [0, 0, 0, 1], [1, -2, 1, 1], [1, 1, -1, -1], [-1, 1, 1, 0], [0, 0, 1, 0], [0, 1, 0, 0], [1, 0, 0, 0], [0, -1, -1, 0]]
    vc  = VectorConfiguration(pts)

    # construct all triangulations
    triangs = vc.all_triangulations(only_regular=False)
    assert len(triangs) == 3157

    # check the number of fine triangulations
    assert sum([t.is_fine() for t in triangs]) == 1814

    # check the number of regular triangulations
    assert sum([t.is_regular() for t in triangs]) == 1737

    # check the number of fine, regular triangulations
    assert sum([t.is_regular() and t.is_fine() for t in triangs]) == 794

    # check the number of fans that are also triangulations of the associated point configuration
    assert sum([t.respects_ptconfig() for t in triangs if t.is_regular()]) == 142

def test_all_circuits():
    pts = [[-5, -2, -3, -2], [0, 1, 0, 0], [0, 1, 2, 0], [1, 0, 0, 0], [1, 0, 1, 2], [-2, -1, -1, 0], [0, 1, 1, 0]]
    vc  = VectorConfiguration(pts)

    # construct all circuits
    circs = vc.circuits()
    supp  = {circ.Z for circ in circs}
    assert supp == {(1, 2, 3, 4, 5), (1, 4, 5, 7), (1, 5, 6), (2, 3, 4, 6), (2, 3, 7), (4, 6, 7)}

# smoke tests
def test_gale():
    pts = [[-5, -2, -3, -2], [0, 1, 0, 0], [0, 1, 2, 0], [1, 0, 0, 0], [1, 0, 1, 2], [-2, -1, -1, 0], [0, 1, 1, 0]]
    vc  = VectorConfiguration(pts)

    # smoke tests
    vc.gale()
    vc.flip_graph()
    vc.secondary_fan()
    vc.central_fan()
