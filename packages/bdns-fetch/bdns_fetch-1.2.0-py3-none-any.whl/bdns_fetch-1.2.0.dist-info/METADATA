Metadata-Version: 2.4
Name: bdns-fetch
Version: 1.2.0
Summary: Python client and CLI to fetch data from the Base de Datos Nacional de Subvenciones (BDNS)
License: GPL-3.0
License-File: LICENSE
Keywords: bdns,subsidies,spanish-government,api,data,cli
Author: Jos칠 Mar칤a Cruz Lorite
Author-email: josemariacruzlorite@gmail.com
Requires-Python: >=3.11,<4.0
Classifier: Development Status :: 4 - Beta
Classifier: Environment :: Console
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Programming Language :: Python :: 3.14
Classifier: Topic :: Scientific/Engineering :: Information Analysis
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Utilities
Requires-Dist: aiohttp (>=3.12.15,<4.0.0)
Requires-Dist: dateparser (>=1.2.2,<2.0.0)
Requires-Dist: requests (>=2.32.5,<3.0.0)
Requires-Dist: tenacity (>=9.1.2,<10.0.0)
Requires-Dist: tqdm (>=4.67.1,<5.0.0)
Requires-Dist: typer[all] (>=0.17.4,<0.18.0)
Project-URL: Documentation, https://github.com/cruzlorite/bdns-fetch#readme
Project-URL: Homepage, https://github.com/cruzlorite/bdns-fetch
Project-URL: Repository, https://github.com/cruzlorite/bdns-fetch
Description-Content-Type: text/markdown

# BDNS Fetch

[![PyPI version](https://badge.fury.io/py/bdns-fetch.svg)](https://badge.fury.io/py/bdns-fetch)
[![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
[![Python 3.11+](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)

[游섫릖 English version](./README.en.md)

## Introducci칩n

La **Base de Datos Nacional de Subvenciones (BDNS)** es un repositorio p칰blico espa침ol que ofrece transparencia sobre todas las subvenciones y ayudas p칰blicas concedidas por las administraciones. Gestionada por la Intervenci칩n General de la Administraci칩n del Estado (IGAE) bajo el Ministerio de Hacienda, la BDNS centraliza informaci칩n desde 2014 para el sector p칰blico estatal y desde 2016 para el resto de administraciones (ver [datos.gob.es](https://datos.gob.es/en/catalogo/e05188501-base-de-datos-nacional-de-subvenciones#:~:text=La%20Base%20de%20Datos%20Nacional,y%20salvaguardando%20el%20honor%20y), [transparencia.gob.es](https://transparencia.gob.es/transparencia/transparencia_Home/index/PublicidadActiva/Contratos/Subvenciones.html#:~:text=La%20Base%20de%20Datos%20Nacional,las%20Administraciones%20P%C3%BAblicas%20desde%202016)).
Estos datos incluyen el organismo convocante, el importe, el objeto, los beneficiarios y otra informaci칩n relevante de cada subvenci칩n ([transparencia.gob.es](https://transparencia.gob.es/transparencia/transparencia_Home/index/PublicidadActiva/Contratos/Subvenciones.html#:~:text=La%20Base%20de%20Datos%20Nacional,las%20Administraciones%20P%C3%BAblicas%20desde%202016)).
La BDNS est치 regulada por el art칤culo 20 de la Ley 38/2003, General de Subvenciones, y por el Real Decreto 130/2019 (ver [datos.gob.es](https://datos.gob.es/en/catalogo/e05188501-base-de-datos-nacional-de-subvenciones#:~:text=la%20intimidad%20personal%20o%20familiar,de%20la%20Administraci%C3%B3n%20del%20Estado), [BOE](https://www.boe.es/buscar/act.php?id=BOE-A-2019-4671#:~:text=Real%20Decreto%20130%2F2019%2C%20de%208,subvenciones%20y%20dem%C3%A1s%20ayudas%20p%C3%BAblicas)).
Los datos se publican en l칤nea respetando el honor y la intimidad de las personas f칤sicas ([datos.gob.es](https://datos.gob.es/en/catalogo/e05188501-base-de-datos-nacional-de-subvenciones#:~:text=en%20el%20Real%20Decreto%20130%2F2019,de%20la%20Administraci%C3%B3n%20del%20Estado)).

Los datos del BDNS son accesibles a trav칠s del **Sistema Nacional de Publicidad de Subvenciones y Ayudas P칰blicas (SNPSAP)**. La informaci칩n puede consultarse en formato HTML desde el portal web oficial del Ministerio de Hacienda, y es exportable a formatos abiertos como CSV, XLSX o PDF. Adem치s, existe una API REST que permite obtener los datos en formato JSON ([datos.gob.es](https://datos.gob.es/en/catalogo/e05188501-base-de-datos-nacional-de-subvenciones#:~:text=La%20informaci%C3%B3n%20es%20consultable%20en,REST%20en%20formato%20JSON)).
La base de datos se actualiza diariamente, aunque el portal oficial impone limitaciones: por ejemplo, solo admite descargas de hasta 10.000 registros por consulta ([transparencia.gob.es](https://transparencia.gob.es/transparencia/transparencia_Home/index/PublicidadActiva/Contratos/Subvenciones.html#:~:text=Informaci%C3%B3n%20actualizada%20diariamente%20y%20obtenida,000%20registros)).
Tambi칠n se aplica la retenci칩n legal de datos: las concesiones permanecen publicadas 4 a침os desde su concesi칩n (solo 1 a침o m치s en caso de personas f칤sicas) ([datos.gob.es](https://datos.gob.es/en/catalogo/e05188501-base-de-datos-nacional-de-subvenciones#:~:text=La%20informaci%C3%B3n%20sobre%20concesiones%20permanecer%C3%A1,que%20%C3%A9sta%20se%C3%B1ale%20plazos%20superiores)), tras lo cual se retiran autom치ticamente.

## Prop칩sito del proyecto

El objetivo del repositorio **bdns-fetch** es facilitar el acceso **program치tico** a los datos de la BDNS. Se trata de una librer칤a Python y herramienta de l칤nea de comandos (CLI) que implementa la API oficial de la BDNS, con el fin de extraer y analizar subvenciones de forma automatizada. En concreto, bdns-fetch cubre los 29 endpoints de datos disponibles en la API del BDNS, con soporte completo de par치metros y manejo autom치tico de paginaci칩n ([GitHub](https://github.com/cruzlorite/bdns-fetch#:~:text=,line%20interface%20for%20quick%20testing)). Ofrece tanto una interfaz de cliente Python limpia y tipada como un comando `bdns-fetch` para pruebas r치pidas. Esto supera las limitaciones del portal web oficial (b칰squeda b치sica y a menudo lenta, sin posibilidad de descarga masiva) pues bdns-fetch permite consultas automatizadas y la extracci칩n completa de datos a archivos JSONL.

**Ventajas principales de bdns-fetch:** permite descargar r치pidamente subvenciones filtradas por criterios (organismo, fecha, descripci칩n, etc.), aplicar paginaci칩n autom치tica sin cargar manualmente cada p치gina, y gestionar errores y reintentos.

## Instalaci칩n

```bash
pip install bdns-fetch
```
o

```bash
git clone https://github.com/cruzlorite/bdns-fetch.git
cd bdns-fetch
pip install .
```

## Uso

### Cliente Python

La librer칤a expone un cliente Python para llamar a los endpoints de la BDNS. Por ejemplo, para obtener la lista de organismos (ministerios, agencias, etc.) registrados:

```python
from bdns.fetch.client import BDNSClient

# Inicializar el cliente
client = BDNSClient()

# Ejecutar la consulta al endpoint "organos"
organos = list(client.fetch_organos())
for org in organos:
    print(org["codigo"], "-", org["descripcion"])

```

Otro ejemplo: buscar [Ayudas de Estado](https://es.wikipedia.org/wiki/Ayudas_de_Estado_en_la_Uni%C3%B3n_Europea) cuyo texto contenga "investigaci칩n". Se controla la paginaci칩n definiendo el tama침o de p치gina y cu치ntas p치ginas queremos:

```python
resultados = client.fetch_ayudasestado_busqueda(
    descripcion="investigaci칩n",
    pageSize=1000,   # registros por p치gina (m치x. 10000)
    num_pages=5,     # n칰mero m치ximo de p치ginas a recuperar
    from_page=0      # p치gina de inicio (0 = primera p치gina)
)
for element in resultados:
    print(element["titulo"], "-", element["importe"])

```

Tambi칠n es posible descargar documentos binarios asociados (por ejemplo, convocatorias o planes estrat칠gicos) usando los m칠todos apropiados que devuelven bytes. Por ejemplo:

```python
# Descargar PDF de convocatoria por ID (id y vpd obtenidos de la BDNS)
pdf_bytes = client.fetch_convocatorias_pdf(id=608268, vpd="A07")
with open("convocatoria.pdf", "wb") as f:
    f.write(pdf_bytes)

```

### Interfaz de L칤nea de Comandos (CLI)

bdns-fetch incluye un CLI sencillo. Tras la instalaci칩n, use  
`bdns-fetch --help` para ver opciones.

Obtener y guardar lista de 칩rganos:
```bash
bdns-fetch --output-file organos.jsonl organos
```
Buscar ayudas de Estado con palabra clave y rango de fechas:
```bash
bdns-fetch --verbose --output-file ayudas_busqueda.jsonl ayudasestado-busqueda \
    --descripcion "innovaci칩n" --fechaDesde "2023-01-01" --fechaHasta "2024-12-31"
```
Descargar las 칰ltimas convocatorias oficiales:
```bash
bdns-fetch --output-file convocatorias.jsonl convocatorias-ultimas
```
Todos los datos extra칤dos por el CLI se guardan en formato **JSON  
Lines** (`.jsonl`), donde cada l칤nea es un objeto JSON independiente. 

## Limitaciones conocidas y advertencias

-   **Limitaciones de la librer칤a:** bdns-fetch **no implementa** ciertos endpoints que no devuelven JSON de datos. En concreto no maneja los endpoints de _exportaci칩n_ (generaci칩n de ficheros CSV/XLSX desde la BDNS) ni las rutas de configuraci칩n del portal o sistema de suscripciones.

-   **Retenci칩n de datos:** La BDNS cumple el r칠gimen legal de publicidad limitada. Los registros de subvenciones se eliminan autom치ticamente **4 a침os naturales** despu칠s del a침o de concesi칩n (solo 2 a침os para ayudas a personas f칤sicas)  ([datos.gob.es](https://datos.gob.es/en/catalogo/e05188501-base-de-datos-nacional-de-subvenciones#:~:text=La%20informaci%C3%B3n%20sobre%20concesiones%20permanecer%C3%A1,que%20%C3%A9sta%20se%C3%B1ale%20plazos%20superiores)).  Por tanto, no encontrar치 en la BDNS concesiones muy antiguas.

-   **Uso de datos p칰blicos:** Si bien los datos provienen de fuentes oficiales, es responsabilidad del usuario verificar su idoneidad para cada caso. Esta herramienta no proporciona garant칤a sobre la precisi칩n de los datos, que pueden depender de la administraci칩n que reporta. Adem치s, algunos datos personales est치n protegidos: la BDNS "publica respetando el honor y la intimidad personal o familiar" ([datos.gob.es](https://datos.gob.es/en/catalogo/e05188501-base-de-datos-nacional-de-subvenciones#:~:text=en%20el%20Real%20Decreto%20130%2F2019,de%20la%20Administraci%C3%B3n%20del%20Estado)).  Se recomienda uso responsable de la informaci칩n y cumplimiento de la normativa de protecci칩n de datos correspondiente.

-   **Advertencia legal:** bdns-fetch se ofrece bajo la premisa de reutilizaci칩n de datos abiertos. La **Ley 38/2003** y el **RD 130/2019** establecen las condiciones de publicaci칩n de subvenciones ([datos.gob.es](https://datos.gob.es/en/catalogo/e05188501-base-de-datos-nacional-de-subvenciones#:~:text=la%20intimidad%20personal%20o%20familiar,de%20la%20Administraci%C3%B3n%20del%20Estado),  [BOE](https://www.boe.es/buscar/act.php?id=BOE-A-2019-4671#:~:text=Real%20Decreto%20130%2F2019%2C%20de%208,subvenciones%20y%20dem%C3%A1s%20ayudas%20p%C3%BAblicas)). El uso de esta herramienta para fines distintos a la investigaci칩n y transparencia ciudadana debe ce침irse a la legislaci칩n vigente. El autor no asume responsabilidad por interpretaciones err칩neas o usos indebidos de los datos p칰blicos obtenidos.

## Licencia y enlaces relevantes

-   **Licencia:** bdns-fetch est치 licenciado bajo la **GNU General Public License v3.0** (GPLv3) ([PyPI](https://pypi.org/project/bdns-fetch/#:~:text=,4.0%2C%20%3E%3D3.11), [GitHub](https://github.com/cruzlorite/bdns-fetch#:~:text=License)). Consulte el archivo [LICENSE](https://chatgpt.com/c/LICENSE) para m치s detalles.

-   **Portal oficial BDNS:** Sistema Nacional de Publicidad de Subvenciones y Ayudas P칰blicas -- [Ministerio de Hacienda (portal SNPSAP)](https://www.infosubvenciones.es/).

-   **Ley 38/2003 (General de Subvenciones):** texto oficial en BOE ([enlace](https://www.boe.es/eli/es/l/2003/11/17/38)).

-   **Real Decreto 130/2019:** regula la BDNS y publicidad de subvenciones, BOE ([enlace](https://www.boe.es/eli/es/rd/2019/03/08/130)).

-   **Informaci칩n adicional:** Portal de transparencia del Estado sobre subvenciones -- [transparencia.gob.es](https://transparencia.gob.es/transparencia/transparencia_Home/index/PublicidadActiva/Contratos/Subvenciones.html).

-   **GPLv3:** texto de la licencia en [gnu.org](https://www.gnu.org/licenses/gpl-3.0.html).

**bdns-fetch** es software libre, desarrollado para facilitar la reutilizaci칩n de datos p칰blicos y promover la transparencia. 춰Su colaboraci칩n y contribuciones son bienvenidas!

