# DictSQLite v4.1 åŒ…æ‹¬çš„ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœ

**æ¸¬å®šæ—¥**: 2025å¹´  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: DictSQLite v4.1 (Rustå®Ÿè£…)  
**æ¸¬å®šå›æ•°**: å„ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯5å›å®Ÿè¡Œï¼ˆã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—1å›ï¼‰

---

## ã‚µãƒãƒªãƒ¼

**ç·ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æ•°**: 27  
**å¹³å‡ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ**: 1,192,722 ops/sec  
**ä¸­å¤®å€¤**: 743,225 ops/sec  
**æœ€å¤§**: 4,612,142 ops/sec  
**æœ€å°**: 2 ops/sec

---

## Top 5 æœ€é€Ÿæ“ä½œ

1. **Deleteæ“ä½œ** (5K items): **4,612,142 ops/sec**
2. **Contains Check** (10K items): **3,769,566 ops/sec**
3. **LRUèª­ã¿è¾¼ã¿** (ã‚¨ãƒ“ã‚¯ã‚·ãƒ§ãƒ³å¾Œã€5K items): **2,913,405 ops/sec**
4. **ãƒãƒƒãƒGet** (10K items): **2,563,548 ops/sec**
5. **Single Get** (10K items): **2,358,022 ops/sec**

---

## è©³ç´°ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœ

### 1. åŸºæœ¬æ“ä½œ (Basic Operations)

| æ“ä½œ | Ops/sec | æ™‚é–“ (ms) | æ¨™æº–åå·® |
|:-----|--------:|----------:|---------:|
| Single Set (10K items) | 1,168,501 | 8.56 | 0.11 |
| Single Get (10K items) | 2,358,022 | 4.24 | 0.28 |
| Contains Check (10K items) | 3,769,566 | 2.65 | 0.03 |
| Delete (5K items) | 4,612,142 | 1.08 | 0.02 |
| keys() (1K items) | 11,756 | 0.09 | 0.01 |
| items() (1K items) | 6,429 | 0.16 | 0.01 |

**åˆ†æ**: 
- èª­ã¿å–ã‚Šæ“ä½œãŒæ›¸ãè¾¼ã¿ã‚ˆã‚Šç´„2å€é«˜é€Ÿ
- Contains checkã¯æœ€ã‚‚é«˜é€Ÿãªæ“ä½œã®1ã¤
- Deleteã‚‚éå¸¸ã«é«˜é€Ÿï¼ˆ4.6M ops/secï¼‰

### 2. ãƒãƒ«ã‚¯æ“ä½œ (Bulk Operations)

| æ“ä½œ | Ops/sec | æ™‚é–“ (ms) | æ¨™æº–åå·® |
|:-----|--------:|----------:|---------:|
| update() Bulk Insert (50K items) | 2,345,680 | 21.32 | 0.16 |
| Batch Get (10K items) | 2,563,548 | 3.90 | 0.11 |
| pop() (5K items) | 334,046 | 14.97 | 0.30 |
| setdefault() (5K items) | 1,268,622 | 3.94 | 0.35 |

**åˆ†æ**:
- ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆã¯50,000ã‚¢ã‚¤ãƒ†ãƒ ã‚’21.32msã§å‡¦ç†ï¼ˆ2.3M ops/secï¼‰
- ãƒãƒƒãƒGetã‚‚é«˜é€Ÿï¼ˆ2.5M ops/secï¼‰
- pop()ã¯ã‚„ã‚„é…ã„ãŒè¨±å®¹ç¯„å›²ï¼ˆ334K ops/secï¼‰

### 3. Pickleæ“ä½œ (Pickle Serialization)

| æ“ä½œ | Ops/sec | æ™‚é–“ (ms) | æ¨™æº–åå·® |
|:-----|--------:|----------:|---------:|
| Simple Dict Write (5K items) | 518,200 | 9.65 | 0.06 |
| Simple Dict Read (5K items) | 1,055,519 | 4.74 | 0.10 |
| Complex Nested Write (1K items) | 189,609 | 5.27 | 0.09 |
| Complex Nested Read (1K items) | 494,238 | 2.02 | 0.03 |
| Large Binary Write (500 x 10KB) | 7,436 | 67.24 | 0.04 |
| Large Binary Read (500 x 10KB) | 687,249 | 0.73 | 0.04 |

**åˆ†æ**:
- ã‚·ãƒ³ãƒ—ãƒ«ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯é«˜é€Ÿï¼ˆèª­ã¿è¾¼ã¿1M ops/secï¼‰
- è¤‡é›‘ãªãƒã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚ååˆ†ãªé€Ÿåº¦ï¼ˆèª­ã¿è¾¼ã¿494K ops/secï¼‰
- å¤§ããªãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ï¼ˆ10KBï¼‰ã®æ›¸ãè¾¼ã¿ã¯ã‚„ã‚„é…ã„ï¼ˆ7.4K ops/secï¼‰ãŒã€èª­ã¿è¾¼ã¿ã¯é«˜é€Ÿï¼ˆ687K ops/secï¼‰

### 4. æš—å·åŒ–æ“ä½œ (AES-256-GCM Encryption)

| æ“ä½œ | Ops/sec | æ™‚é–“ (ms) | æ¨™æº–åå·® |
|:-----|--------:|----------:|---------:|
| Encrypted Set (10K items) | 600,636 | 16.65 | 0.05 |
| Encrypted Get (10K items) | 1,706,806 | 5.86 | 0.28 |
| Encrypted Bulk Insert (20K items) | 1,789,830 | 11.17 | 0.17 |
| Encrypted Pickle Write (2K objects) | 323,309 | 6.19 | 0.05 |
| Encrypted Pickle Read (2K objects) | 743,225 | 2.69 | 0.05 |

**æš—å·åŒ–ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰åˆ†æ**:
- Set: 1,168,501 â†’ 600,636 ops/sec (**48.6%æ¸›å°‘**)
- Get: 2,358,022 â†’ 1,706,806 ops/sec (**27.6%æ¸›å°‘**)
- Bulk: 2,345,680 â†’ 1,789,830 ops/sec (**23.7%æ¸›å°‘**)

**åˆ†æ**:
- æš—å·åŒ–ã‚ã‚Šã§ã‚‚60ä¸‡ops/secä»¥ä¸Šã®æ›¸ãè¾¼ã¿æ€§èƒ½
- èª­ã¿è¾¼ã¿ã¯170ä¸‡ops/secã¨é«˜é€Ÿ
- æš—å·åŒ–ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã¯20-50%ç¨‹åº¦ã§è¨±å®¹ç¯„å›²

### 5. æ°¸ç¶šåŒ–ãƒ¢ãƒ¼ãƒ‰ (Persistence Modes)

| ãƒ¢ãƒ¼ãƒ‰ | æ“ä½œ | Ops/sec | æ™‚é–“ (ms) |
|:-------|:-----|--------:|----------:|
| Memory | Write (10K) | 1,378,988 | 7.25 |
| Lazy | Write (10K) | 1,316,355 | 7.60 |
| Lazy | Flush | 2 | 452.16 |
| WriteThrough | Write (1K) | 20,400 | 49.02 |

**åˆ†æ**:
- **Memory** ã¨ **Lazy** ãƒ¢ãƒ¼ãƒ‰ã¯ã»ã¼åŒç­‰ã®é«˜é€Ÿæ€§èƒ½ï¼ˆ1.3M ops/secï¼‰
- **WriteThrough** ã¯å³åº§ã«ãƒ‡ã‚£ã‚¹ã‚¯æ›¸ãè¾¼ã¿ã™ã‚‹ãŸã‚é…ã„ï¼ˆ20K ops/secï¼‰
- Lazy Flushã¯10,000ã‚¢ã‚¤ãƒ†ãƒ ã‚’452msã§æ°¸ç¶šåŒ–

**ãƒ¢ãƒ¼ãƒ‰é¸æŠã‚¬ã‚¤ãƒ‰**:
- é«˜é€Ÿæ€§é‡è¦– â†’ **Memory** ã¾ãŸã¯ **Lazy**
- ãƒ‡ãƒ¼ã‚¿å®‰å…¨æ€§é‡è¦– â†’ **WriteThrough**
- ãƒãƒ©ãƒ³ã‚¹é‡è¦– â†’ **Lazy** + å®šæœŸflush

### 6. LRUã‚¨ãƒ“ã‚¯ã‚·ãƒ§ãƒ³ (LRU Eviction)

| æ“ä½œ | Ops/sec | æ™‚é–“ (ms) | æ¨™æº–åå·® |
|:-----|--------:|----------:|---------:|
| Write with Eviction (cap=1000, writes=5000) | 19,975 | 250.32 | 16.33 |
| Read After Eviction (5K items) | 2,913,405 | 1.72 | 0.13 |

**åˆ†æ**:
- ã‚¨ãƒ“ã‚¯ã‚·ãƒ§ãƒ³ç™ºç”Ÿæ™‚ã‚‚ç´„20K ops/secç¶­æŒ
- ã‚¨ãƒ“ã‚¯ã‚·ãƒ§ãƒ³å¾Œã®èª­ã¿è¾¼ã¿ã¯é«˜é€Ÿï¼ˆ2.9M ops/secï¼‰
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒæ­£å¸¸ã«æ©Ÿèƒ½

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç‰¹æ€§ã¾ã¨ã‚

### ğŸš€ é«˜é€Ÿãªæ“ä½œï¼ˆ1M ops/secä»¥ä¸Šï¼‰

1. Deleteæ“ä½œ: **4.6M ops/sec**
2. Contains check: **3.8M ops/sec**
3. LRUèª­ã¿è¾¼ã¿: **2.9M ops/sec**
4. ãƒãƒƒãƒGet: **2.6M ops/sec**
5. å˜ä¸€Get: **2.4M ops/sec**
6. ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆ: **2.3M ops/sec**
7. æš—å·åŒ–Bulk: **1.8M ops/sec**
8. æš—å·åŒ–Get: **1.7M ops/sec**
9. Memory Write: **1.4M ops/sec**
10. Lazy Write: **1.3M ops/sec**

### âš¡ ä¸­é€Ÿã®æ“ä½œï¼ˆ100K - 1M ops/secï¼‰

- setdefault(): **1.3M ops/sec**
- å˜ä¸€Set: **1.2M ops/sec**
- Pickle Simple Read: **1.1M ops/sec**
- Large Binary Read: **687K ops/sec**
- æš—å·åŒ–Pickle Read: **743K ops/sec**
- æš—å·åŒ–Set: **601K ops/sec**
- Pickle Simple Write: **518K ops/sec**
- Pickle Complex Read: **494K ops/sec**
- pop(): **334K ops/sec**
- æš—å·åŒ–Pickle Write: **323K ops/sec**

### ğŸŒ ä½é€Ÿã®æ“ä½œï¼ˆ100K ops/secæœªæº€ï¼‰

- Pickle Complex Write: **190K ops/sec**
- WriteThrough Write: **20K ops/sec**
- LRU Eviction Write: **20K ops/sec**
- keys(): **12K ops/sec**
- Large Binary Write: **7.4K ops/sec**
- items(): **6.4K ops/sec**
- Lazy Flush: **2 ops/sec** (10,000ã‚¢ã‚¤ãƒ†ãƒ ä¸€æ‹¬å‡¦ç†ã®ãŸã‚)

---

## æœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ

### 1. ãƒ¢ãƒ¼ãƒ‰é¸æŠ

**é«˜é€Ÿæ€§ãŒæœ€å„ªå…ˆã®å ´åˆ:**
```python
db = DictSQLiteV4(path, persist_mode="lazy")
# 1.3M ops/sec
```

**ãƒ‡ãƒ¼ã‚¿æå¤±ã‚’çµ¶å¯¾ã«é¿ã‘ãŸã„å ´åˆ:**
```python
db = DictSQLiteV4(path, persist_mode="writethrough")
# 20K ops/sec ã ãŒå³åº§ã«æ°¸ç¶šåŒ–
```

### 2. ãƒãƒ«ã‚¯æ“ä½œã®æ´»ç”¨

å˜ä¸€æ“ä½œã§ã¯ãªããƒãƒ«ã‚¯æ“ä½œã‚’ä½¿ç”¨:
```python
# é…ã„: 1.2M ops/sec
for item in items:
    db[key] = value

# é«˜é€Ÿ: 2.3M ops/sec
db.update(items)
```

### 3. æš—å·åŒ–ã®ä½¿ç”¨åˆ¤æ–­

æš—å·åŒ–ãŒä¸è¦ãªã‚‰ç„¡åŠ¹åŒ–ã—ã¦æ€§èƒ½å‘ä¸Š:
- æš—å·åŒ–ãªã—: 1.2M ops/sec (Set)
- æš—å·åŒ–ã‚ã‚Š: 600K ops/sec (Set)
- **ç´„2å€ã®æ€§èƒ½å·®**

### 4. Pickleæœ€é©åŒ–

- ã‚·ãƒ³ãƒ—ãƒ«ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ï¼ˆè¤‡é›‘ãªãƒã‚¹ãƒˆã‚’é¿ã‘ã‚‹ï¼‰
- å¤§ããªãƒã‚¤ãƒŠãƒªã¯åˆ†å‰²ã—ã¦ä¿å­˜
- èª­ã¿è¾¼ã¿ã¯æ›¸ãè¾¼ã¿ã®ç´„2å€é«˜é€Ÿ

---

## çµè«–

DictSQLite v4.1ã¯ä»¥ä¸‹ã®å„ªã‚ŒãŸæ€§èƒ½ç‰¹æ€§ã‚’ç¤ºã—ã¦ã„ã¾ã™:

âœ… **èª­ã¿å–ã‚Šæ€§èƒ½**: æœ€å¤§4.6M ops/secï¼ˆDeleteï¼‰ã€å¹³å‡2-3M ops/sec  
âœ… **æ›¸ãè¾¼ã¿æ€§èƒ½**: æœ€å¤§2.3M ops/secï¼ˆBulkï¼‰ã€å¹³å‡1-1.5M ops/sec  
âœ… **æš—å·åŒ–**: ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰20-50%ã§é«˜ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£  
âœ… **LRUã‚¨ãƒ“ã‚¯ã‚·ãƒ§ãƒ³**: é€éçš„ã§é«˜é€Ÿï¼ˆèª­ã¿è¾¼ã¿2.9M ops/secï¼‰  
âœ… **æ°¸ç¶šåŒ–**: æŸ”è»Ÿãªãƒ¢ãƒ¼ãƒ‰é¸æŠï¼ˆMemory/Lazy/WriteThroughï¼‰

**æ¨å¥¨ç”¨é€”**:
- é«˜é€Ÿã‚­ãƒ£ãƒƒã‚·ãƒ¥: Memory/Lazyãƒ¢ãƒ¼ãƒ‰
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†: WriteThroughãƒ¢ãƒ¼ãƒ‰
- ã‚»ã‚­ãƒ¥ã‚¢ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: æš—å·åŒ–æœ‰åŠ¹åŒ–
- å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿: LRUã‚¨ãƒ“ã‚¯ã‚·ãƒ§ãƒ³ã§è‡ªå‹•ç®¡ç†

---

**ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ç’°å¢ƒ**: Ubuntu, Python 3.12, Rust 1.x (release build)  
**æ¸¬å®šãƒ„ãƒ¼ãƒ«**: tests/benchmark_comprehensive.py
