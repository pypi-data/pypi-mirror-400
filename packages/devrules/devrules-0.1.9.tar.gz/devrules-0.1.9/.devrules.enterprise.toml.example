# DevRules Enterprise Configuration Example
# Copy this to .devrules.enterprise.toml and customize for your organization

[enterprise]
# Enable enterprise mode
enabled = true
# Lock configuration (prevents user overrides)
locked = true
# Enable integrity verification
integrity_check = true

[enterprise.encryption]
# Fields to encrypt (supports dot notation)
# These fields will be encrypted in the final build
sensitive_fields = [
    "github.api_url",
    "github.owner",
    "github.repo",
    # Encrypt role assignments for compliance scenarios
    # This hides which users have which roles in the distributed config
    "permissions.user_assignments",
]

[branch]
# Corporate branch naming standards
pattern = "^(feature|bugfix|hotfix|release|docs)/(\\d+-)?[a-z0-9-]+"
prefixes = ["feature", "bugfix", "hotfix", "release", "docs"]
require_issue_number = true
enforce_single_branch_per_issue_env = true
labels_hierarchy = ["docs", "feature", "bugfix", "hotfix"]

[branch.labels_mapping]
enhancement = "feature"
bug = "bugfix"
documentation = "docs"

[commit]
# Corporate commit message standards
tags = ["WIP", "FTR", "FIX", "DOCS", "TST", "REF"]
pattern = "^\\[({tags})\\].+"
min_length = 10
max_length = 400
restrict_branch_to_owner = true
append_issue_number = true
allow_hook_bypass = false

[pr]
# Corporate PR standards
max_loc = 400
max_files = 20
require_title_tag = true
title_pattern = "^\\[({tags})\\].+"
require_issue_status_check = true
allowed_pr_statuses = ["In review", "Ready"]
project_for_status_check = []

[github]
# GitHub Enterprise configuration
# These values will be encrypted if listed in sensitive_fields
api_url = "https://github.company.com/api/v3"
timeout = 30
owner = "company-org"
repo = "company-repo"
valid_statuses = [
  "Backlog",
  "Ready",
  "In progress",
  "In review",
  "Done",
]

[github.projects]
main = "Main Project (#1)"

[github.status_emojis]
backlog = "üìã"
ready = "üöÄ"
in_progress = "‚è≥"
in_review = "üëÄ"
done = "‚úÖ"

# =============================================================================
# Role-Based Permissions
# =============================================================================
# Controls who can transition issue statuses and deploy to environments.
# If no permissions are configured, the system defaults to permissive mode.

[permissions]
# Fallback role when a user is not explicitly assigned a role.
# If null and user is not assigned, system allows action with warning.
default_role = "developer"

# Role definitions with allowed statuses and environments
# Each role can specify which statuses they can transition issues to,
# and which environments they can deploy to.

[permissions.roles.developer]
# Statuses this role can transition issues to
allowed_statuses = ["In progress", "In review"]
# Environments this role can deploy to
deployable_environments = ["dev"]

[permissions.roles.maintainer]
# Maintainers have full access to all statuses and environments
allowed_statuses = ["Backlog", "Ready", "In progress", "In review", "Done"]
deployable_environments = ["dev", "staging", "prod"]

[permissions.roles.viewer]
# Viewers have read-only access (no status transitions or deployments)
allowed_statuses = []
deployable_environments = []

# Map git usernames (from git config user.name) to role names.
# Users not listed will use default_role if set.
[permissions.user_assignments]
"John Doe" = "maintainer"
"Jane Smith" = "developer"
