

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installing Software Elements &mdash; Tools for Energy Model Optimization and Analysis (Temoa) 4.0.0a1.dev20251113 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/my_theme.css?v=a08f7516" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=09296c51"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Tools for Energy Model Optimization and Analysis (Temoa)
              <img src="_static/Temoa_logo_color_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#quick-start">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#database-construction">Database Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#data-quality">Data Quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#visualization">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#the-math-behind-temoa">The Math Behind Temoa</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#the-temoa-computational-implementation">The Temoa Computational Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#temoa-code-style-guide">Temoa Code Style Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Tools for Energy Model Optimization and Analysis (Temoa)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Installing Software Elements</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/quick_start.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="installing-software-elements">
<h1>Installing Software Elements<a class="headerlink" href="#installing-software-elements" title="Link to this heading"></a></h1>
<p>Temoa is implemented in <a class="reference external" href="https://www.pyomo.org/">Pyomo</a>, which is in turn
written in <a class="reference external" href="http://www.python.org/">Python</a>. Consequently, Temoa will run on
Linux, Mac, Windows, or any operating system that Pyomo supports. There are
several open source software elements required to run Temoa.</p>
<p><strong>Using pip</strong>:</p>
<p>The standard way to install Temoa:</p>
<p>First, it is highly recommended to use a Python virtual environment to manage dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m venv temoa_env
$ source temoa_env/bin/activate
</pre></div>
</div>
<p>Then, install Temoa:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Install from PyPI (when 4.0 is released)
$ pip install temoa

# Or install from nightlies (alpha/development versions)
$ pip install --index-url https://temoaproject.github.io/temoa-nightlies/simple/ temoa --extra-index-url https://pypi.org/simple/

# Get started
$ python -m temoa tutorial my_first_model
$ python -m temoa run my_first_model.toml
</pre></div>
</div>
<p><strong>Using uv (Alternative)</strong>:</p>
<p>For faster dependency resolution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Install uv
$ curl -LsSf https://astral.sh/uv/install.sh | sh

# Create a uv initialized virtual environment
$ uv init &lt;dir_name&gt;
$ cd &lt;dir_name&gt;


# add Temoa from nightlies to pyproject.toml
$ uv add temoa --default-index https://pypi.temoaproject.org/simple --index https://pypi.org/simple

# Get started
$ uv run temoa tutorial my_first_model
$ uv run temoa run my_first_model.toml
</pre></div>
</div>
<p><strong>For Contributors (Development Installation)</strong>:</p>
<p>If you want to contribute to Temoa or modify the code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Clone the repository
$ git clone https://github.com/TemoaProject/temoa.git
$ cd temoa

# Install in development mode with uv (recommended)
$ uv sync --all-extras --dev
</pre></div>
</div>
<p>For detailed contribution guidelines, see CONTRIBUTING.md in the repository.</p>
</section>
<section id="solvers">
<h1>Solvers<a class="headerlink" href="#solvers" title="Link to this heading"></a></h1>
<p>A few notes for on the choice of solvers. Different solvers
have widely varying solution times. If you plan to run Temoa with large datasets
and/or conduct uncertainty analysis, you may want to consider installing
commercial linear solvers such as <a class="reference external" href="https://www.ibm.com/analytics/cplex-optimizer">CPLEX</a> or <a class="reference external" href="https://www.gurobi.com/">Gurobi</a>. Both offer free academic licenses.</p>
<p>For smaller models, Temoa has been tested with both the <a class="reference external" href="https://github.com/coin-or/Cbc">CBC</a>
solver and the more recently released <a class="reference external" href="https://pypi.org/project/highspy/">HiGHS</a> solver.
Each of the respective websites contains installation instructions for the individual
solvers.  For those wishing to run the internal tests on Temoa, the <code class="code docutils literal notranslate"><span class="pre">CBC</span></code> solver
is required.</p>
</section>
<section id="running-temoa">
<h1>Running Temoa<a class="headerlink" href="#running-temoa" title="Link to this heading"></a></h1>
<p>To run the model, a configuration (‘config’) file is needed. An
example config file called <code class="code docutils literal notranslate"><span class="pre">config_sample.toml</span></code> resides within the
<code class="code docutils literal notranslate"><span class="pre">data_files/my_configs</span></code> folder. Running the model with a config file allows
the user to (1) use a sqlite
database for storing input and output data, (2) create a formatted Excel output
file, (2) specify the solver to use, (3) return the log file produced during
model execution, (4) return the lp file utilized by the solver, and (5) to
execute several of the modeling extensions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ temoa run config.toml
</pre></div>
</div>
<p><strong>For general help, use –help:</strong></p>
<pre class="literal-block">$ <strong>temoa --help</strong>
  usage: temoa [-h] [--version] [--how-to-cite] COMMAND ...

  Tools for Energy Model Optimization and Analysis (Temoa)

  options:
    -h, --help       show this help message and exit
    --version        Show version information
    --how-to-cite    Show citation information

  commands:
    COMMAND
      run            Run a Temoa model
      validate       Validate a configuration file
      migrate        Migrate a database to the latest schema
      tutorial       Create tutorial files</pre>
<section id="database-construction">
<h2>Database Construction<a class="headerlink" href="#database-construction" title="Link to this heading"></a></h2>
<p>Input datasets in Temoa can be constructed either as text files or relational
databases. Input text files are referred to as ‘DAT’ files and follow a specific
format. Take a look at the example DAT files in the <code class="code docutils literal notranslate"><span class="pre">temoa/data_files</span></code>
directory.</p>
<p>While DAT files work fine for small datasets, relational databases are preferred
for larger datasets. To first order, you can think of a database as a collection
of tables, where a ‘primary key’ within each table defines a unique entry (i.e.,
row) within the table. In addition, a ‘foreign key’ defines a table element drawn
from another table. Foreign keys enforce the defined relationships between
different sets and parameters.</p>
<p>Temoa uses <a class="reference external" href="https://www.sqlite.org/">sqlite</a>, a widely used, self-contained database
system. Building a database first requires constructing a sql file, which is
simply a text file that defines the structure of different database tables and
includes the input data. The snippet below is from the technology table used to
define the ‘temoa_utopia’ dataset:</p>
<p><strong>NOTE</strong>:  <em>As of Version 3, the below table format is dated, but still shows the general structure of
the SQL files used to create the database.</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">technologies</span> <span class="p">(</span>
<span class="n">tech</span> <span class="n">text</span> <span class="n">primary</span> <span class="n">key</span><span class="p">,</span>
<span class="n">flag</span> <span class="n">text</span><span class="p">,</span>
<span class="n">sector</span> <span class="n">text</span><span class="p">,</span>
<span class="n">tech_desc</span> <span class="n">text</span><span class="p">,</span>
<span class="n">tech_category</span> <span class="n">text</span><span class="p">,</span>
<span class="n">FOREIGN</span> <span class="n">KEY</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="n">REFERENCES</span> <span class="n">technology_labels</span><span class="p">(</span><span class="n">tech_labels</span><span class="p">),</span>
<span class="n">FOREIGN</span> <span class="n">KEY</span><span class="p">(</span><span class="n">sector</span><span class="p">)</span> <span class="n">REFERENCES</span> <span class="n">sector_labels</span><span class="p">(</span><span class="n">sector</span><span class="p">));</span>
<span class="n">INSERT</span> <span class="n">INTO</span> <span class="s2">&quot;technologies&quot;</span> <span class="n">VALUES</span><span class="p">(</span><span class="s1">&#39;IMPDSL1&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;supply&#39;</span><span class="p">,</span><span class="s1">&#39; imported diesel&#39;</span><span class="p">,</span><span class="s1">&#39;petroleum&#39;</span><span class="p">);</span>
<span class="n">INSERT</span> <span class="n">INTO</span> <span class="s2">&quot;technologies&quot;</span> <span class="n">VALUES</span><span class="p">(</span><span class="s1">&#39;IMPGSL1&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;supply&#39;</span><span class="p">,</span><span class="s1">&#39; imported gasoline&#39;</span><span class="p">,</span><span class="s1">&#39;petroleum&#39;</span><span class="p">);</span>
<span class="n">INSERT</span> <span class="n">INTO</span> <span class="s2">&quot;technologies&quot;</span> <span class="n">VALUES</span><span class="p">(</span><span class="s1">&#39;IMPHCO1&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;supply&#39;</span><span class="p">,</span><span class="s1">&#39; imported coal&#39;</span><span class="p">,</span><span class="s1">&#39;coal&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The first line creates the table. <strong>Lines 2-6</strong> define the columns within this table.
Note that the the technology (‘tech’) name defines the primary key. Therefore, the
same technology name cannot be entered twice; each technology name must be unique.
<strong>Lines 7-8</strong> define foreign keys within the table. For example, each technology
should be specified with a label (e.g., ‘r’ for ‘resource’). Those labels must
come from the ‘technology_labels’ table. Likewise, the sector name must be defined
in the ‘sector_labels’ table. This enforcement of names across tables using
foreign keys helps immediately catch typos. (As you can imagine, typos happen in
plain text files and Excel when defining thousands of rows of data.) Another big
advantage of using databases is that the model run outputs are stored in
separate database output tables. The outputs by model run are indexed by a scenario name,
which makes it possible to perform thousands of runs, programatically store all
the results, and execute arbitrary queries that instantaneously return the requested
data.</p>
<p>Because some database table elements serve as foreign keys in other tables, we
recommend that you populate input tables in the following order:</p>
<dl class="simple">
<dt><strong>Group 1: labels used for internal database processing</strong></dt><dd><ul class="simple">
<li><p>commodity_type: Need to identify which type of commodity. Do NOT change these abbreviations.</p></li>
<li><p>technology_type: Need to identify which type of technology. Do NOT change these abbreviations.  Categorizing
and sub-categorizing can be done in the Technology table itself.</p></li>
<li><p>time_period_type: Used to distinguish which time periods are simply used to specify pre-existing
vintages and which represent future optimization periods.</p></li>
<li><p>season_label: Unordered unique labels defining seasons in the model.</p></li>
</ul>
</dd>
<dt><strong>Group 2: sets used within Temoa</strong></dt><dd><ul class="simple">
<li><p>Commodity: list of commodities used within the database</p></li>
<li><p>Technology: list of technologies used within the database</p></li>
<li><p>time_period: list of both past and future time periods considered in the database</p></li>
<li><p>time_season: seasons modeled in the database</p></li>
<li><p>time_of_day: time of day segments modeled in the database</p></li>
</ul>
</dd>
<dt><strong>Group 3: parameters used to define processes within Temoa</strong></dt><dd><ul class="simple">
<li><p>metadata_real (global_discount_rate)</p></li>
<li><p>metadata (days_per_period)</p></li>
<li><p>Demand</p></li>
<li><p>demand_specific_distribution</p></li>
<li><p>efficiency</p></li>
<li><p>existing_capacity</p></li>
<li><p>capacity_factor</p></li>
<li><p>capacity_factor_process (only if CF varies by vintage; overwrites capacity_factor)</p></li>
<li><p>capacity_to_activity</p></li>
<li><p>cost_fixed</p></li>
<li><p>cost_invest</p></li>
<li><p>cost_variable</p></li>
<li><p>emission_activity</p></li>
<li><p>lifetime_tech</p></li>
<li><p>lifetime_process (only if LT varies by vintage; overwrites lifetime_tech)</p></li>
<li><p>time_segment_fraction: proportion of each period represented by each time slice</p></li>
</ul>
</dd>
<dt><strong>Group 4: parameters used to define constraints within Temoa</strong></dt><dd><ul class="simple">
<li><p>limit_activity</p></li>
<li><p>limit_capacity</p></li>
<li><p>limit_emission</p></li>
<li><p>limit_growth_capacity</p></li>
<li><p>limit_new_capacity</p></li>
<li><p>limit_resource</p></li>
<li><p>limit_tech_input_split</p></li>
<li><p>limit_tech_output_split</p></li>
</ul>
</dd>
</dl>
<p>For help getting started, take a look at how <code class="code docutils literal notranslate"><span class="pre">data_files/temoa_utopia.sql</span></code> is
constructed. Use <code class="code docutils literal notranslate"><span class="pre">data_files/temoa_schema.sql</span></code> (a database file with the requisite
structure but no data added) to begin building your own database file. We recommend
leaving the database structure intact, and simply adding data to the schema file, or
constructing an empty database from the schema file and then using a database editor
to import data.
Once the sql file is complete, you can convert it into a binary sqlite file by
installing sqlite3 and executing the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sqlite3 my_database.sqlite &lt; my_database.sql
</pre></div>
</div>
<p>Now you can specify this database as the source for both input and output data
in the config file.</p>
</section>
<section id="data-quality">
<h2>Data Quality<a class="headerlink" href="#data-quality" title="Link to this heading"></a></h2>
<p>In addition to numerous internal checks, Temoa (optionally) employs two quality checks on
data read in from the database.  The outputs (actions and warnings) generated by these processes
are reported in the log file for the run.</p>
<p>Both of the checks below can be run to QA data by running the model in <cite>CHECK</cite> mode and inspecting
the log file.  During <cite>CHECK</cite> mode runs, no solve is attempted on the model.</p>
</section>
</section>
<section id="price-checking">
<h1>Price Checking<a class="headerlink" href="#price-checking" title="Link to this heading"></a></h1>
<p>The “price checker” reviews cost data in the 3 cost tables and considers technology lifetime.  It
screens for possible inconsistencies that would corrupt output quality.  Larger models may have
well over 100K cost entries and an overlooked investment cost for a particular vintage tech in
a particular region could easily be overlooked.  Price checks performed/reported:</p>
<ol class="arabic simple">
<li><p><strong>Missing Costs (Check 0)</strong>:  This check looks for technologies that have no fixed/invest/variable
costs at all.  Other checks are more discriminating, so this check is only reported when Temoa is run
in <cite>debug</cite> mode by using the <cite>-d</cite> flag on the run command.</p></li>
<li><p><strong>Missing Fixed/Investment Costs (Check 1a)</strong>:  This check identifies technologies that are <em>not</em>
flagged as <cite>uncapacitated</cite> with neither a fixed or investment cost associated.  These <em>might</em> be
problematic for solve because the model minimizes cost, so capacity in these technologies would be
free.  <cite>uncapacitated</cite> technologies have no capacity measure, so fixed/investment costs are prohibited
for them and that is checked elsewhere.</p></li>
<li><p><strong>Inconsistent Fixed/Investment Cost (Check 1b)</strong>:  This check looks for inconsistent application
of fixed or base costs in the “base” or vintage year across all vintages and regions.  So, if a tech has
a fixed cost in some particular region and vintage year, but not in all, it will be flagged as a likely
omission.</p></li>
<li><p><strong>Inconsistent Fixed &amp; Variable Costs (Check 2)</strong>:  This check identifies techs that have
inconsistencies in the application of fixed - variable costs.  Techs that have <em>any</em> fixed cost for
a particular [region, tech, vintage] process, but do not have entries that match the variable cost
entries for the same process are flagged, and vice-versa.  This would hopefully identify an
accidental omission of some of the fixed/var costs for processes that have at least 1 entry for either.</p></li>
<li><p><strong>Lifetime Costing (Check 3)</strong>:  This check identifies costs that fall short or are missing
during the process’s lifetime.  If a process has a variable cost in <em>any</em> year during the lifetime, but
not all years, it is flagged.  Same for fixed cost.</p></li>
<li><p><strong>Uncapacitated Tech Costs</strong>:  Any technology flagged as <cite>uncapacitated</cite> will trigger warnings here
if it has any fixed/invest costs.</p></li>
</ol>
</section>
<section id="source-tracing">
<h1>Source Tracing<a class="headerlink" href="#source-tracing" title="Link to this heading"></a></h1>
<p>Temoa works backwards from demands to identify chains of technologies required to meet the demand.
Source Tracing is designed to ensure that this backward tracing from demands describes a proper
commodity network without gaps that might allow intermediate commodities to be treated as a free
“source” commodity.  Further description of possible network problems is included in the
<cite>commodity network notes.md</cite> file in the <cite>docs</cite> folder.</p>
<p>Source Tracing pre-builds the entire commodity network in each region-period contained in the
data and analyzes it for “orphans” which likely represent gaps in the network that would lead
to erroneous output data.  The operation is enabled by tagging foundational commodities for which
there are no predecessors as “source” commodities in the <cite>Commodity</cite> database table with an <cite>s</cite> tag.
Orphans (or chains of orphans) on either the demand or supply side are reported and <em>suppressed</em> in
the data to prevent network corruption.</p>
<p>Note that the myopic mode <em>requires</em> the use of Source Tracing to ensure accuracy as some orphans
may be produced by endogenous decisions in myopic runs.</p>
</section>
<section id="commodity-network-visualization">
<h1>Commodity Network Visualization<a class="headerlink" href="#commodity-network-visualization" title="Link to this heading"></a></h1>
<p>The output of the Source Tracing operation can be visualized by enabling the commodity network plots
in the config file.  This will add a set of region-period specific html files to the Outputs folder.
These files <em>should</em> be open-able in any web browser.  (See the note in the main <cite>README.md</cite> for trouble
with Windows OS systems).</p>
<figure class="center align-center" id="id1" style="width: 60%">
<img alt="_images/utopia_commodity_network.png" src="_images/utopia_commodity_network.png" />
<figcaption>
<p><span class="caption-text">An example of the Commodity Network for Utopia (interactive view in web browser by opening
the generated html file)</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The color legend for Commodity Networks is as follows:</p>
<ul class="simple">
<li><p>Green dot:  Source Commodity</p></li>
<li><p>Orange dot:  Demand Commodity</p></li>
<li><p>Violet dot:  Intermediate Commodity</p></li>
<li><p>Black arc:  Technology</p></li>
<li><p>Blue arc:  Linked Technology (the driven tech, <em>not</em> the driver)</p></li>
<li><p>Yellow arc:  Supply-Side Orphan (shown, but suppressed when model built)</p></li>
<li><p>Red arc:  Demand-Side Orphan (shown, but suppressed when model built)</p></li>
<li><p>Green arc:  Any Tech with a Negative Variable Cost</p></li>
</ul>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2025, NC State University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>