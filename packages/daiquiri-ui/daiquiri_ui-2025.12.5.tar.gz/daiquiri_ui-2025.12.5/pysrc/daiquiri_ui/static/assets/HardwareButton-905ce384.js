import{r as d,u as E,a as S,j as i,I as y,B as T,F as j,L as A,Q as C,c as H,q as g,U as m,V as O,W as p,Y as B}from"./index-4cf586ed.js";function R(){return d.useMemo(()=>t=>A.dispatch("REQUEST_HARDWARE_CHANGE",t),[])}function b(t){const[n,e]=d.useState(0),[a,o]=d.useState(!1),c=R(),u=E(),f=S();function h(){const s=[],l=C.getState().hardware;o(!0),t.ids.forEach(r=>{if(r.reference&&(r.increment||t.steps)){const x=l[r.id];s.push(c({...r,value:x.properties[r.reference]+(t.steps?n:r.increment)}))}else(r.function||r.property)&&s.push(c(r))}),Promise.all(s).finally(()=>{o(!1)})}d.useEffect(()=>{t.steps&&e(t.steps[0])},[t.steps]);const w=a||!u||f;return i.jsxs(y,{children:[i.jsx(T,{onClick:h,disabled:w,children:a?i.jsx("i",{className:"fa fa-spinner fa-spin"}):i.jsx(i.Fragment,{children:t.icon?i.jsx("i",{className:`fa ${t.icon}`,title:t.buttonTitle}):t.buttonTitle})}),t.steps&&i.jsx(j.Control,{as:"select",className:"step-size",defaultValue:n,onChange:s=>e(Number.parseFloat(s.target.value)),children:t.steps.map(s=>i.jsx("option",{value:s,children:s}))})]})}function k(t,n){return{}}function v(t){return{}}const F=H(k,v)(b);function L(t,n){if(n===void 0)throw new B(t,["id"]);if(typeof n.id!="string")throw new p(t,"id","A string is expected")}function N(t,n,e){if(e!==void 0){if(!Array.isArray(e))throw new p(t,"ids","An option list is expected");e.forEach((a,o)=>{const{id:c,function:u,property:f,value:h,increment:w,reference:s,...l}=a;g(t,l);try{L(t,a)}catch{throw new p(t,"ids",`The hardware button object description ${o} is wrong`)}})}}function q(t){const{providers:n,yamlNode:e,ids:a,steps:o,buttonTitle:c,icon:u,...f}=t;return g(e,f),N(e,"ids",a),m(e,"buttonTitle",c),m(e,"icon",u),O(e,"steps",o),i.jsx(F,{steps:o,ids:a,buttonTitle:c,icon:u,providers:n})}export{q as default};
