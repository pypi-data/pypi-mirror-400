"use strict";(self.webpackChunk_elyra_code_snippet_extension=self.webpackChunk_elyra_code_snippet_extension||[]).push([[509,453,55,436],{21411:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(36758),a=n.n(o),i=n(40935),r=n.n(i)()(a());r.push([e.id,'/*\n * Copyright 2018-2023 Elyra Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n.elyra-codeSnippet-drag-image {\n  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);\n  width: var(--jp-private-notebook-dragImage-width);\n  height: var(--jp-private-notebook-dragImage-height);\n  color: var(--jp-ui-font-color1);\n  background: var(--jp-layout-color1);\n}\n\n.elyra-metadata-code-snippets\n  .elyra-metadata-item\n  .elyra-expandableContainer-details-visible {\n  height: 100px;\n}\n',""]);const s=r},40935:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(o)for(var s=0;s<this.length;s++){var d=this[s][0];null!=d&&(r[d]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);o&&r[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},36758:e=>{e.exports=function(e){return e[1]}},13453:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var o=n(72591),a=n.n(o),i=n(1740),r=n.n(i),s=n(88128),d=n.n(s),l=n(30855),c=n.n(l),p=n(93051),u=n.n(p),m=n(73656),h=n.n(m),v=n(21411),g={};g.styleTagTransform=h(),g.setAttributes=c(),g.insert=d().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=u(),a()(v.A,g);const f=v.A&&v.A.locals?v.A.locals:void 0},72591:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var i={},r=[],s=0;s<e.length;s++){var d=e[s],l=o.base?d[0]+o.base:d[0],c=i[l]||0,p="".concat(l," ").concat(c);i[l]=c+1;var u=n(p),m={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==u)t[u].references++,t[u].updater(m);else{var h=a(m,o);o.byIndex=s,t.splice(s,0,{identifier:p,updater:h,references:1})}r.push(p)}return r}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var i=o(e=e||[],a=a||{});return function(e){e=e||[];for(var r=0;r<i.length;r++){var s=n(i[r]);t[s].references--}for(var d=o(e,a),l=0;l<i.length;l++){var c=n(i[l]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=d}}},88128:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},93051:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},30855:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},1740:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,a&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},73656:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},70096:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(a,i){function r(e){try{d(o.next(e))}catch(e){i(e)}}function s(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}d((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeSnippetService=t.CODE_SNIPPET_SCHEMA=t.CODE_SNIPPET_SCHEMASPACE=void 0;const a=n(20133),i=n(12200);t.CODE_SNIPPET_SCHEMASPACE="code-snippets",t.CODE_SNIPPET_SCHEMA="code-snippet",t.CodeSnippetService=class{static findAll(){return o(this,void 0,void 0,(function*(){return a.MetadataService.getMetadata(t.CODE_SNIPPET_SCHEMASPACE)}))}static findByLanguage(e){return o(this,void 0,void 0,(function*(){try{const t=yield this.findAll(),n=[];for(const o of t)o.metadata.language===e&&n.push(o);return n}catch(e){return Promise.reject(e)}}))}static deleteCodeSnippet(e){return(0,i.showDialog)({title:`Delete snippet '${e.display_name}'?`,buttons:[i.Dialog.cancelButton(),i.Dialog.okButton()]}).then((n=>!!n.button.accept&&a.MetadataService.deleteMetadata(t.CODE_SNIPPET_SCHEMASPACE,e.name).then((()=>!0))))}}},83971:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(a,i){function r(e){try{d(o.next(e))}catch(e){i(e)}}function s(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}d((o=o.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeSnippetWidget=void 0,n(13453);const i=n(66511),r=n(17151),s=n(12200),d=n(66607),l=n(40131),c=n(44993),p=n(81473),u=n(12710),m=n(19480),h=n(87460),v=n(64053),g=n(67262),f=n(71355),C=a(n(93345)),E=n(70096);class S extends i.MetadataDisplay{constructor(e){super(e),this.editors={},this.insertCodeSnippet=e=>o(this,void 0,void 0,(function*(){var t,n,o,a,i,r,s,l,c;const u=this.props.getCurrentWidget(),h=e.metadata.code.join("\n"),v=e.metadata.language;if(null!==u)if(this.isFileEditor(u)){const o=u.content.editor,a=/^\.(md|mkdn?|mdown|markdown)$/,i=this.getEditorLanguage(u);null!==p.PathExt.extname(u.context.path).match(a)&&"markdown"!==v.toLowerCase()?null===(t=o.replaceSelection)||void 0===t||t.call(o,this.addMarkdownCodeBlock(v,h)):i?this.verifyLanguageAndInsert(e,i,o):null===(n=o.replaceSelection)||void 0===n||n.call(o,h)}else if(u instanceof m.NotebookPanel){const t=u,n=t.content.activeCell;if(null===n)return;const p=n.editor;if(null!==p){if(n instanceof d.CodeCell){const n=yield null===(a=null===(o=t.sessionContext.session)||void 0===o?void 0:o.kernel)||void 0===a?void 0:a.info,i=(null==n?void 0:n.language_info.name)||"";this.verifyLanguageAndInsert(e,i,p)}else n instanceof d.MarkdownCell&&"markdown"!==v.toLowerCase()?null===(i=p.replaceSelection)||void 0===i||i.call(p,this.addMarkdownCodeBlock(v,h)):null===(r=p.replaceSelection)||void 0===r||r.call(p,h);const g=t.content,f=null!==(s=g.activeCellIndex)&&void 0!==s?s:-1,C=new m.NotebookPanel.ContentFactory({editorFactory:this.props.editorServices.factoryService.newInlineEditor}),E={model:null===(l=g.activeCell)||void 0===l?void 0:l.model,rendermime:g.rendermime,contentFactory:C},S=C.createCodeCell(E);S.cell_type="code",null===(c=u.content.model)||void 0===c||c.sharedModel.insertCell(f,S),t.content.activeCellIndex=f+1}else this.showErrDialog("notebookCellEditor have to be not null")}else this.showErrDialog("Code snippet insert failed: Unsupported widget")})),this.isFileEditor=e=>e.content instanceof u.FileEditor,this.getEditorLanguage=e=>{var t;const n=c.EditorLanguageRegistry.getDefaultLanguages().find((t=>t.mime.includes(e.content.model.mimeType)));return null!==(t=null==n?void 0:n.displayName)&&void 0!==t?t:""},this.addMarkdownCodeBlock=(e,t)=>"```"+e+"\n"+t+"\n```",this.verifyLanguageAndInsert=(e,t,n)=>o(this,void 0,void 0,(function*(){var o,a;const i=e.metadata.code.join("\n"),r=e.metadata.language;t&&r.toLowerCase()!==t.toLowerCase()?(yield this.showWarnDialog(t,e.display_name)).button.accept&&(null===(o=n.replaceSelection)||void 0===o||o.call(n,i)):null===(a=n.replaceSelection)||void 0===a||a.call(n,i)})),this.showWarnDialog=(e,t)=>o(this,void 0,void 0,(function*(){return(0,s.showDialog)({title:"Warning",body:`Code snippet "${t}" is incompatible with ${e}. Continue?`,buttons:[s.Dialog.cancelButton(),s.Dialog.okButton()]})})),this.showErrDialog=e=>(0,s.showDialog)({title:"Error",body:e,buttons:[s.Dialog.okButton()]}),this.actionButtons=e=>[{title:"Copy to clipboard",icon:h.pasteIcon,feedback:"Copied!",onClick:()=>{s.Clipboard.copyToSystem(e.metadata.code.join("\n"))}},{title:"Insert",icon:r.importIcon,onClick:()=>{this.insertCodeSnippet(e)}},{title:"Edit",icon:h.editIcon,onClick:()=>{this.props.openMetadataEditor({onSave:this.props.updateMetadata,schemaspace:E.CODE_SNIPPET_SCHEMASPACE,schema:E.CODE_SNIPPET_SCHEMA,name:e.name})}},{title:"Duplicate",icon:h.copyIcon,onClick:()=>{i.MetadataCommonService.duplicateMetadataInstance(E.CODE_SNIPPET_SCHEMASPACE,e,this.props.metadata).then((e=>{this.props.updateMetadata()})).catch((e=>r.RequestErrors.serverError(e)))}},{title:"Delete",icon:r.trashIcon,onClick:()=>{E.CodeSnippetService.deleteCodeSnippet(e).then((t=>{if(t){this.props.updateMetadata(),delete this.editors[e.name];const t=(0,v.find)(this.props.shell.widgets("main"),((t,n)=>t.id===`elyra-metadata-editor:${E.CODE_SNIPPET_SCHEMASPACE}:${E.CODE_SNIPPET_SCHEMA}:${e.name}`));t&&t.dispose()}})).catch((e=>r.RequestErrors.serverError(e)))}}],this.renderMetadata=e=>C.default.createElement("div",{key:e.name,"data-item-id":e.display_name,className:i.METADATA_ITEM,style:this.state.metadata.includes(e)?{}:{display:"none"}},C.default.createElement(r.ExpandableComponent,{displayName:this.getDisplayName(e),tooltip:e.metadata.description,actionButtons:this.actionButtons(e),onExpand:()=>{this.editors[e.name].redo()},onMouseDown:t=>{this.handleDragSnippet(t,e)}},C.default.createElement("div",{id:e.name}))),this.createPreviewEditors=()=>{const e=this.props.editorServices.factoryService.newInlineEditor;this.props.metadata.map((t=>{const n=t.metadata.code.join("\n");if(t.name in this.editors)this.editors[t.name].model.sharedModel.setSource(n);else{const o=document.getElementById(t.name);if(null===o)return;const a=this.props.editorServices.mimeTypeService.getMimeTypeByLanguage({value:t.metadata.code.join("\n"),name:t.metadata.language,codemirror_mode:t.metadata.language}),i=e({config:{readOnly:!0},host:o,model:new l.CodeEditor.Model({mimeType:a})});i.model.sharedModel.setSource(n),this.editors[t.name]=i}}))},this._drag=null,this._dragData=null,this.handleDragMove=this.handleDragMove.bind(this),this._evtMouseUp=this._evtMouseUp.bind(this)}handleDragSnippet(e,t){const{button:n}=e;if(0!==n)return;this._dragData={pressX:e.clientX,pressY:e.clientY,dragImage:null};const o=e=>{this._evtMouseUp(e,t,a)},a=e=>{this.handleDragMove(e,t,a,o)},i=e.target;i.addEventListener("mouseup",o,{once:!0,capture:!0}),i.addEventListener("mousemove",a,!0),i.ondragstart=()=>!1}_evtMouseUp(e,t,n){e.preventDefault(),e.stopPropagation(),e.target.removeEventListener("mousemove",n,!0)}handleDragMove(e,t,n,o){e.preventDefault(),e.stopPropagation();const a=this._dragData;if(a&&this.shouldStartDrag(a.pressX,a.pressY,e.clientX,e.clientY)){const i=document.createElement("div");i.innerHTML=this.getDisplayName(t),i.classList.add("elyra-codeSnippet-drag-image"),a.dragImage=i;const r=e.target;r.removeEventListener("mousemove",n,!0),r.removeEventListener("mouseup",o,!0),this.startDrag(a.dragImage,t,e.clientX,e.clientY)}}shouldStartDrag(e,t,n,o){const a=Math.abs(n-e),i=Math.abs(o-t);return a>=0||i>=5}startDrag(e,t,n,a){var i,r;return o(this,void 0,void 0,(function*(){const o=this.props.getCurrentWidget().content,s=new m.NotebookPanel.ContentFactory({editorFactory:this.props.editorServices.factoryService.newInlineEditor}),d={model:null===(i=o.activeCell)||void 0===i?void 0:i.model,rendermime:o.rendermime,contentFactory:s},l={model:null===(r=o.activeCell)||void 0===r?void 0:r.model,rendermime:o.rendermime,contentFactory:s},c=s.createCodeCell(d),p=s.createMarkdownCell(l),u=t.metadata.language,h="markdown"!==u.toLowerCase()?c:p,v=t.metadata.code.join("\n");"markdown"!==u.toLowerCase()&&"code"===h.model.type&&h.model.sharedModel.setSource(v),"markdown"===u.toLowerCase()&&"markdown"===h.model.type&&h.model.sharedModel.setSource(v),this._drag=new f.Drag({mimeData:new g.MimeData,dragImage:e,supportedActions:"copy-move",proposedAction:"copy",source:this});const C=[h.model.toJSON()];return this._drag.mimeData.setData("application/vnd.jupyter.cells",C),this._drag.mimeData.setData("text/plain",v),this._drag.start(n,a).then((()=>{this._drag=null,this._dragData=null}))}))}getDisplayName(e){return`[${e.metadata.language}] ${e.display_name}`}sortMetadata(){this.props.metadata.sort(((e,t)=>this.getDisplayName(e).localeCompare(this.getDisplayName(t))))}matchesSearch(e,t){return e=e.toLowerCase(),t.name.toLowerCase().includes(e)||t.display_name.toLowerCase().includes(e)||t.metadata.language.toLowerCase().includes(e)}componentDidMount(){this.createPreviewEditors()}componentDidUpdate(){this.createPreviewEditors()}}class y extends i.MetadataWidget{constructor(e){super(e),this.props=e}fetchMetadata(){return o(this,void 0,void 0,(function*(){return E.CodeSnippetService.findAll().catch((e=>r.RequestErrors.serverError(e)))}))}renderDisplay(e){return Array.isArray(e)&&!e.length?C.default.createElement("div",null,C.default.createElement("br",null),C.default.createElement("h6",{className:"elyra-no-metadata-msg"},"Click the + button to add ",this.props.display_name.toLowerCase())):C.default.createElement(S,{metadata:e,openMetadataEditor:this.openMetadataEditor,updateMetadata:this.updateMetadata,schemaspace:E.CODE_SNIPPET_SCHEMASPACE,schema:E.CODE_SNIPPET_SCHEMA,getCurrentWidget:this.props.getCurrentWidget,className:"elyra-metadata-code-snippets",editorServices:this.props.editorServices,shell:this.props.app.shell,sortMetadata:!0})}}t.CodeSnippetWidget=y},8509:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.code_snippet_extension=void 0,n(13453);const o=n(17151),a=n(87909),i=n(12200),r=n(40131),s=n(72135),d=n(12710),l=n(1086),c=n(19480),p=n(70096),u=n(83971),m="codesnippet:save-as-snippet";t.code_snippet_extension={id:"elyra-code-snippet-extension",autoStart:!0,requires:[i.ICommandPalette,a.ILayoutRestorer,r.IEditorServices],activate:(e,t,n,a)=>{console.log("Elyra - code-snippet extension is activated!");const i=new u.CodeSnippetWidget({app:e,display_name:"Code Snippets",schemaspace:p.CODE_SNIPPET_SCHEMASPACE,schema:p.CODE_SNIPPET_SCHEMA,icon:o.codeSnippetIcon,getCurrentWidget:()=>e.shell.currentWidget,editorServices:a,titleContext:"",addLabel:"code snippet"}),r=`elyra-metadata:${p.CODE_SNIPPET_SCHEMASPACE}`;i.id=r,i.title.icon=o.codeSnippetIcon,i.title.caption="Code Snippets",n.add(i,r),e.shell.add(i,"left",{rank:900}),e.commands.addCommand(m,{label:"Save As Code Snippet",isEnabled:()=>{var t,n;const o=e.shell.currentWidget,a=C(o);let i="";return a?i=h(a):f(o)&&(i=null!==(n=null===(t=document.getSelection())||void 0===t?void 0:t.toString())&&void 0!==n?n:""),i.length>0||!!(g(o)&&v().length>0)},isVisible:()=>!0,execute:()=>{var t,n;const o=e.shell.currentWidget,a=C(o);let r="";if(a?r=h(a):f(o)&&(r=null!==(n=null===(t=document.getSelection())||void 0===t?void 0:t.toString())&&void 0!==n?n:""),r.length>0)i.openMetadataEditor({schemaspace:p.CODE_SNIPPET_SCHEMASPACE,schema:p.CODE_SNIPPET_SCHEMA,code:r.split("\n"),onSave:i.updateMetadata});else{const e=v().join("\n\n").split("\n");i.openMetadataEditor({schemaspace:p.CODE_SNIPPET_SCHEMASPACE,schema:p.CODE_SNIPPET_SCHEMA,code:e,onSave:i.updateMetadata})}}}),e.contextMenu.addItem({command:m,selector:".jp-Cell"}),e.contextMenu.addItem({command:m,selector:".jp-FileEditor"}),e.contextMenu.addItem({command:m,selector:".jp-MarkdownViewer"});const h=(e,t)=>{var n,o;const a=e.getSelection(),i=e.getOffsetAt(a.start),r=e.getOffsetAt(a.end),s=e.model.sharedModel.getSource(),d=s.substring(i,r);return!d&&s?null!==(o=null===(n=document.getSelection())||void 0===n?void 0:n.toString())&&void 0!==o?o:"":d},v=()=>{const t=e.shell.currentWidget.content,n=t.activeCell,o=[];return n&&t.widgets.forEach((e=>{if(t.isSelectedOrActive(e)){const t=e.model.toJSON().source.toString();t.length>0&&o.push(t)}})),o},g=e=>e instanceof c.NotebookPanel,f=e=>e instanceof l.MarkdownDocument,C=e=>{if((e=>e instanceof s.DocumentWidget&&e.content instanceof d.FileEditor)(e))return e.content.editor;if(g(e)){const t=e.content.activeCell;return null==t?void 0:t.editor}}}},t.default=t.code_snippet_extension}}]);