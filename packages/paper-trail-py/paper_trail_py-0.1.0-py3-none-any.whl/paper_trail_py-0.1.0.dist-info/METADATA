Metadata-Version: 2.4
Name: paper-trail-py
Version: 0.1.0
Summary: Modern Python library for tracking changes to SQLAlchemy models
Project-URL: Homepage, https://github.com/yourusername/paper-trail-py
Project-URL: Documentation, https://paper-trail-py.readthedocs.io
Project-URL: Repository, https://github.com/yourusername/paper-trail-py
Project-URL: Issues, https://github.com/yourusername/paper-trail-py/issues
Author-email: alshin <alshin@126.com>
License: MIT
License-File: LICENSE
Keywords: audit,history,sqlalchemy,tracking,versioning
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Database
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.10
Requires-Dist: sqlalchemy>=2.0.0
Provides-Extra: async
Requires-Dist: sqlalchemy[asyncio]>=2.0.0; extra == 'async'
Provides-Extra: dev
Requires-Dist: black>=23.9.0; extra == 'dev'
Requires-Dist: isort>=5.12.0; extra == 'dev'
Requires-Dist: mypy>=1.5.0; extra == 'dev'
Requires-Dist: pre-commit>=3.4.0; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.21.0; extra == 'dev'
Requires-Dist: pytest-cov>=4.1.0; extra == 'dev'
Requires-Dist: pytest>=7.4.0; extra == 'dev'
Requires-Dist: ruff>=0.1.0; extra == 'dev'
Provides-Extra: mysql
Requires-Dist: pymysql>=1.1.0; extra == 'mysql'
Provides-Extra: postgresql
Requires-Dist: psycopg2-binary>=2.9.0; extra == 'postgresql'
Description-Content-Type: text/markdown

# ğŸ§¾ PaperTrail - Python

[![CI](https://github.com/yunshang/paper-trail-py/actions/workflows/ci.yml/badge.svg)](https://github.com/yunshang/paper-trail-py/actions/workflows/ci.yml)
[![codecov](https://codecov.io/gh/yunshang/paper-trail-py/branch/main/graph/badge.svg)](https://codecov.io/gh/yunshang/paper-trail-py)
[![PyPI version](https://badge.fury.io/py/paper-trail-py.svg)](https://badge.fury.io/py/paper-trail-py)
[![Python Versions](https://img.shields.io/pypi/pyversions/paper-trail-py.svg)](https://pypi.org/project/paper-trail-py/)

**ç°ä»£åŒ–çš„ SQLAlchemy æ¨¡å‹ç‰ˆæœ¬è¿½è¸ªåº“** - ä¸ºä½ çš„æ•°æ®åº“å˜æ›´æä¾›å®Œæ•´çš„å®¡è®¡æ—¥å¿—ã€‚

å— Ruby [PaperTrail](https://github.com/paper-trail-gem/paper_trail) å¯å‘ï¼Œä½¿ç”¨ **SQLAlchemy 2.0+**ã€**uv** å’Œç°ä»£ Python å·¥å…·é“¾æ„å»ºã€‚

## âœ¨ ç‰¹æ€§

- ğŸ¯ **ç®€å•æ˜“ç”¨** - ä¸€ä¸ªè£…é¥°å™¨å³å¯å¯ç”¨ç‰ˆæœ¬è¿½è¸ª
- ğŸ” **å®Œæ•´å†å²** - è¿½è¸ªæ‰€æœ‰ Createã€Updateã€Delete æ“ä½œ
- ğŸ‘¤ **Whodunnit** - è®°å½•è°åšäº†ä»€ä¹ˆæ”¹å˜
- ğŸ”„ **ç‰ˆæœ¬æ¢å¤** - è½»æ¾å›æ»šåˆ°ä»»æ„å†å²ç‰ˆæœ¬
- ğŸ”— **äº‹åŠ¡åˆ†ç»„** - å…³è”ç›¸å…³çš„å¤šä¸ªå˜æ›´
- âš¡ **é«˜æ€§èƒ½** - æ”¯æŒæ‰¹é‡æ“ä½œå’Œå¼‚æ­¥æŸ¥è¯¢
- ğŸ¨ **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ç±»å‹æç¤ºæ”¯æŒ
- ğŸ§ª **å…¨é¢æµ‹è¯•** - 70%+ æµ‹è¯•è¦†ç›–ç‡
- ğŸ—„ï¸ **å¤šæ•°æ®åº“æ”¯æŒ** - SQLiteã€PostgreSQLã€MySQL

## ğŸ“¦ å®‰è£…

```bash
# ä½¿ç”¨ uvï¼ˆæ¨èï¼‰
uv pip install paper-trail-py

# ä½¿ç”¨ pip
pip install paper-trail-py

# PostgreSQL æ”¯æŒï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰
uv pip install "paper-trail-py[postgresql]"

# å¼‚æ­¥æ”¯æŒ
uv pip install "paper-trail-py[async]"

# MySQL æ”¯æŒ
uv pip install "paper-trail-py[mysql]"
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®šä¹‰æ¨¡å‹å¹¶å¯ç”¨è¿½è¸ª

```python
from sqlalchemy import Column, Integer, String
from sqlalchemy.orm import DeclarativeBase
from paper_trail import track_versions

class Base(DeclarativeBase):
    pass

@track_versions()
class Article(Base):
    __tablename__ = 'articles'
    
    id = Column(Integer, primary_key=True)
    title = Column(String(200))
    content = Column(String(1000))
```

### 2. è‡ªåŠ¨è®°å½•å˜æ›´

```python
from sqlalchemy import create_engine
from sqlalchemy.orm import Session
from paper_trail import set_whodunnit

# PostgreSQL (æ¨èç”¨äºç”Ÿäº§ç¯å¢ƒ)
engine = create_engine('postgresql://user:pass@localhost/db')

# æˆ–ä½¿ç”¨ SQLite (å¼€å‘ç¯å¢ƒ)
# engine = create_engine('sqlite:///app.db')

session = Session(engine)

# è®¾ç½®æ“ä½œè€…
set_whodunnit('user@example.com')

# åˆ›å»ºæ–‡ç« 
article = Article(title="Hello World", content="First post")
session.add(article)
session.commit()  # âœ… è‡ªåŠ¨åˆ›å»ºç‰ˆæœ¬è®°å½•

# æ›´æ–°æ–‡ç« 
article.title = "Hello Python"
session.commit()  # âœ… è‡ªåŠ¨è®°å½•å˜æ›´
```

### 3. æŸ¥è¯¢å†å²ç‰ˆæœ¬

```python
from paper_trail import VersionQuery

# è·å–æ–‡ç« çš„æ‰€æœ‰ç‰ˆæœ¬
versions = (
    VersionQuery(session)
    .for_model(Article, article.id)
    .order_by_time(ascending=False)
    .all()
)

for v in versions:
    print(f"{v.event} by {v.whodunnit} at {v.created_at}")
    print(f"Changes: {v.changeset}")
```

### 4. æ¢å¤å†å²ç‰ˆæœ¬

```python
from paper_trail import reify_version

# è·å–ä¹‹å‰çš„ç‰ˆæœ¬
old_version = versions[1]

# æ¢å¤
restored_article = reify_version(session, old_version, Article, commit=True)
print(restored_article.title)  # æ¢å¤åˆ°æ—§æ ‡é¢˜
```

### 5. æŸ¥çœ‹å˜æ›´è¯¦æƒ…

```python
# ä½¿ç”¨ changeset å±æ€§è·å–å˜æ›´ï¼ˆè¿”å›å…ƒç»„ï¼‰
for version in versions:
    if version.event == 'update':
        for field, (old_val, new_val) in version.changeset.items():
            print(f"{field}: {old_val} â†’ {new_val}")
    elif version.event == 'create':
        for field, new_val in version.changeset.items():
            print(f"{field}: {new_val}")
```

## ğŸ“š æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### ğŸ¨ ç‰ˆæœ¬è¿½è¸ªè£…é¥°å™¨

```python
# åŸºç¡€ç”¨æ³•
@track_versions()
class Post(Base):
    __tablename__ = 'posts'
    id = Column(Integer, primary_key=True)
    title = Column(String)

# å¿½ç•¥ç‰¹å®šå­—æ®µ
@track_versions(ignore={'updated_at', 'view_count'})
class Article(Base):
    # ...

# ä»…è¿½è¸ªç‰¹å®šå­—æ®µ
@track_versions(only={'title', 'status'})
class Document(Base):
    # ...

# æ³¨æ„ï¼šè£…é¥°å™¨ä½¿ç”¨ SQLAlchemy Session äº‹ä»¶ç³»ç»Ÿ
# - before_flush: æ•è·å˜æ›´å‰çš„çŠ¶æ€
# - after_flush_postexec: åˆ›å»ºç‰ˆæœ¬è®°å½•
```

### ğŸ‘¤ ä¸Šä¸‹æ–‡ç®¡ç† (Whodunnit)

```python
from paper_trail import set_whodunnit, whodunnit

# å…¨å±€è®¾ç½®
set_whodunnit('admin@example.com')

# ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨
with whodunnit('user@example.com'):
    article.title = "New Title"
    session.commit()
```

### ğŸ”— äº‹åŠ¡åˆ†ç»„

```python
from paper_trail.context import transaction_group

# å°†å¤šä¸ªå˜æ›´å…³è”åˆ°ä¸€ä¸ªäº‹åŠ¡
with transaction_group() as tx_id:
    article1.title = "Update 1"
    article2.title = "Update 2"
    session.commit()
    
    # æ‰€æœ‰ç‰ˆæœ¬è®°å½•ä¼šæœ‰ç›¸åŒçš„ transaction_id
```

### ğŸ” å¼ºå¤§çš„æŸ¥è¯¢ API

```python
from paper_trail import VersionQuery
from datetime import datetime, timedelta

# æŸ¥è¯¢ç‰¹å®šç”¨æˆ·çš„æ“ä½œ
user_versions = (
    VersionQuery(session)
    .by_user('user@example.com')
    .after(datetime.now() - timedelta(days=7))
    .all()
)

# æŸ¥è¯¢ç‰¹å®šäº‹åŠ¡çš„æ‰€æœ‰å˜æ›´
tx_versions = (
    VersionQuery(session)
    .by_transaction(tx_id)
    .all()
)

# ç»„åˆæŸ¥è¯¢
recent_updates = (
    VersionQuery(session)
    .for_model_type(Article)
    .by_event('update')
    .between(start_date, end_date)
    .limit(10)
    .all()
)
```

### âš¡ æ€§èƒ½ä¼˜åŒ–

```python
from paper_trail.performance import bulk_track_changes, cleanup_old_versions

# æ‰¹é‡è¿½è¸ªå˜æ›´
articles = session.query(Article).filter(...).all()
count = bulk_track_changes(
    session,
    articles,
    Article,
    event='update',
    whodunnit='batch@example.com'
)

# æ¸…ç†æ—§ç‰ˆæœ¬ï¼ˆä¿ç•™ 30 å¤©ï¼‰
deleted = cleanup_old_versions(session, days=30, model_class=Article)
print(f"Deleted {deleted} old versions")
```

### ğŸŒŠ å¼‚æ­¥æ”¯æŒ

```python
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from paper_trail.async_support import get_versions_async, reify_version_async

engine = create_async_engine('postgresql+asyncpg://...')

async with AsyncSession(engine) as session:
    # å¼‚æ­¥æŸ¥è¯¢ç‰ˆæœ¬
    versions = await get_versions_async(session, Article, article_id)
    
    # å¼‚æ­¥æ¢å¤
    restored = await reify_version_async(session, versions[0], Article)
```

## ğŸ—„ï¸ æ•°æ®åº“æ¨¡å¼

```sql
CREATE TABLE versions (
    id SERIAL PRIMARY KEY,                -- PostgreSQL ä½¿ç”¨ SERIAL
    item_type VARCHAR(255) NOT NULL,      -- æ¨¡å‹è¡¨å
    item_id VARCHAR(255) NOT NULL,        -- è®°å½• ID
    event VARCHAR(50) NOT NULL,           -- create/update/destroy
    whodunnit VARCHAR(255),               -- æ“ä½œè€…
    transaction_id VARCHAR(255),          -- äº‹åŠ¡åˆ†ç»„ ID
    object JSONB,                         -- å®Œæ•´å¿«ç…§ (PostgreSQL ä½¿ç”¨ JSONB)
    object_changes JSONB,                 -- å˜æ›´å¢é‡ (PostgreSQL ä½¿ç”¨ JSONB)
    created_at TIMESTAMP NOT NULL,
    
    INDEX idx_item_lookup (item_type, item_id),
    INDEX idx_transaction_lookup (transaction_id, created_at),
    INDEX idx_whodunnit_lookup (whodunnit, created_at)
);
```

**é‡è¦æç¤º**ï¼š
- æ¨èä½¿ç”¨ PostgreSQL ä½œä¸ºç”Ÿäº§æ•°æ®åº“ï¼ˆæ”¯æŒ JSONB ç±»å‹ï¼‰
- SQLite ä»…é€‚åˆå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ
- `object_changes` åœ¨æ•°æ®åº“ä¸­å­˜å‚¨ä¸º JSON å¯¹è±¡ï¼Œä½¿ç”¨ `version.changeset` å±æ€§è·å– Python å…ƒç»„æ ¼å¼

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ç¯å¢ƒè®¾ç½®

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yunshang/paper-trail-py.git
cd paper-trail-py

# å®‰è£… uvï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
curl -LsSf https://astral.sh/uv/install.sh | sh

# å®‰è£…å¼€å‘ä¾èµ–
make dev-install

# è®¾ç½® PostgreSQL æµ‹è¯•æ•°æ®åº“
createdb paper_trail_test
export DATABASE_URL="postgresql://user:password@localhost/paper_trail_test"

# å®‰è£… pre-commit hooks
pre-commit install
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
make test

# å¸¦è¦†ç›–ç‡æŠ¥å‘Š
make test-cov

# ç±»å‹æ£€æŸ¥
make type-check

# Lint æ£€æŸ¥
make lint

# æ ¼å¼åŒ–ä»£ç 
make format

# æ³¨æ„ï¼šæµ‹è¯•ä½¿ç”¨äº‹åŠ¡éš”ç¦»å’Œè¡¨é‡å»ºç­–ç•¥ç¡®ä¿æµ‹è¯•ç‹¬ç«‹æ€§
```

### é¡¹ç›®ç»“æ„

```
paper-trail-py/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ paper_trail/
â”‚       â”œâ”€â”€ __init__.py          # å…¬å…± API
â”‚       â”œâ”€â”€ models.py            # Version æ•°æ®æ¨¡å‹ï¼ˆå« changeset å±æ€§ï¼‰
â”‚       â”œâ”€â”€ decorators.py        # @track_versionsï¼ˆåŸºäº Session äº‹ä»¶ï¼‰
â”‚       â”œâ”€â”€ context.py           # Whodunnit å’Œäº‹åŠ¡ç®¡ç†
â”‚       â”œâ”€â”€ query.py             # ç‰ˆæœ¬æŸ¥è¯¢ API
â”‚       â”œâ”€â”€ reify.py             # ç‰ˆæœ¬æ¢å¤åŠŸèƒ½
â”‚       â”œâ”€â”€ serializers.py       # å¯¹è±¡åºåˆ—åŒ–ï¼ˆä½¿ç”¨åŸç”Ÿ SQL æŸ¥è¯¢ï¼‰
â”‚       â”œâ”€â”€ config.py            # å…¨å±€é…ç½®ç®¡ç†
â”‚       â”œâ”€â”€ async_support.py     # å¼‚æ­¥æ“ä½œæ”¯æŒ
â”‚       â””â”€â”€ performance.py       # æ‰¹é‡æ“ä½œå’Œæ€§èƒ½ä¼˜åŒ–
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ conftest.py              # æµ‹è¯•é…ç½®ï¼ˆPostgreSQL + äº‹åŠ¡éš”ç¦»ï¼‰
â”‚   â”œâ”€â”€ test_decorators.py       # è£…é¥°å™¨æµ‹è¯•
â”‚   â”œâ”€â”€ test_query.py            # æŸ¥è¯¢ API æµ‹è¯•
â”‚   â”œâ”€â”€ test_reify.py            # ç‰ˆæœ¬æ¢å¤æµ‹è¯•
â”‚   â”œâ”€â”€ test_context.py          # ä¸Šä¸‹æ–‡ç®¡ç†æµ‹è¯•
â”‚   â”œâ”€â”€ test_serializers.py      # åºåˆ—åŒ–æµ‹è¯•
â”‚   â””â”€â”€ test_performance.py      # æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ ARCHITECTURE.md          # æ¶æ„è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ QUICKSTART.md            # å¿«é€Ÿå…¥é—¨æŒ‡å—
â”‚   â”œâ”€â”€ API.md                   # API å‚è€ƒ
â”‚   â””â”€â”€ CONTRIBUTING.md          # è´¡çŒ®æŒ‡å—
â”œâ”€â”€ pyproject.toml               # uv é¡¹ç›®é…ç½®
â”œâ”€â”€ Makefile                     # å¼€å‘å‘½ä»¤
â”œâ”€â”€ .pre-commit-config.yaml      # Pre-commit hooks
â””â”€â”€ README.md
```

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### Session äº‹ä»¶ç³»ç»Ÿ

æœ¬åº“ä½¿ç”¨ SQLAlchemy 2.0 çš„ Session äº‹ä»¶è€Œé Mapper äº‹ä»¶ï¼š

```python
# before_flush - æ•è·å˜æ›´å‰çš„çŠ¶æ€
@event.listens_for(Session, 'before_flush')
def before_flush_handler(session, flush_context, instances):
    # ä½¿ç”¨åŸç”Ÿ SQL æŸ¥è¯¢è·å–æ—§å€¼ï¼Œé¿å… identity map é—®é¢˜
    old_values = session.execute(
        select(table).where(table.c[pk] == pk_value)
    ).first()

# after_flush_postexec - åˆ›å»ºç‰ˆæœ¬è®°å½•
@event.listens_for(Session, 'after_flush_postexec')
def after_flush_handler(session, flush_context):
    # æ‰¹é‡æ’å…¥ç‰ˆæœ¬è®°å½•
    session.bulk_insert_mappings(Version, pending_versions)
```

### å˜æ›´æ£€æµ‹ç­–ç•¥

1. **æ•è·é˜¶æ®µ** (`before_flush`): åœ¨ flush å‰æŸ¥è¯¢æ•°æ®åº“è·å–æ—§å€¼
2. **æ¯”è¾ƒé˜¶æ®µ**: å¯¹æ¯”æ–°æ—§å€¼ç”Ÿæˆ changeset
3. **å­˜å‚¨é˜¶æ®µ** (`after_flush_postexec`): æ‰¹é‡åˆ›å»ºç‰ˆæœ¬è®°å½•
4. **è®¿é—®é˜¶æ®µ**: ä½¿ç”¨ `version.changeset` å°† JSON æ•°ç»„è½¬æ¢ä¸º Python å…ƒç»„

## ğŸ“Š é…ç½®é€‰é¡¹

```python
from paper_trail import configure

configure(
    enabled=True,                        # å…¨å±€å¼€å…³
    default_ignore_fields={'updated_at'},  # é»˜è®¤å¿½ç•¥å­—æ®µ
    store_object_snapshot=True,          # å­˜å‚¨å®Œæ•´å¿«ç…§
    store_object_changes=True,           # å­˜å‚¨å˜æ›´å¢é‡
    batch_insert_threshold=100,          # æ‰¹é‡æ’å…¥é˜ˆå€¼
)
```

## ğŸ¯ æˆåŠŸæ ‡å‡†

### âœ… åŠŸèƒ½å®Œæ•´æ€§
- [x] ç‰ˆæœ¬è¿½è¸ªè£…é¥°å™¨ (åŸºäº Session äº‹ä»¶)
- [x] Version æ•°æ®æ¨¡å‹ (å« changeset å±æ€§)
- [x] ç‰ˆæœ¬æŸ¥è¯¢ API (VersionQuery)
- [x] ç‰ˆæœ¬æ¢å¤ (Reify)
- [x] ä¸Šä¸‹æ–‡ç®¡ç† (Whodunnit)
- [x] äº‹åŠ¡åˆ†ç»„
- [x] è‡ªå®šä¹‰åºåˆ—åŒ– (åŸç”Ÿ SQL æŸ¥è¯¢)
- [x] é…ç½®ç®¡ç†
- [x] å¼‚æ­¥æ”¯æŒ
- [x] æ€§èƒ½ä¼˜åŒ– (æ‰¹é‡æ“ä½œ)

### âœ… ä»£ç è´¨é‡
- [x] ç±»å‹æç¤ºè¦†ç›– 100%
- [x] æµ‹è¯•è¦†ç›–ç‡ 70%+ (17 ä¸ªæµ‹è¯•ç”¨ä¾‹)
- [x] Ruff + Black æ ¼å¼åŒ–
- [x] MyPy ç±»å‹æ£€æŸ¥é€šè¿‡
- [x] Pre-commit hooks

### âœ… æ–‡æ¡£
- [x] å®Œæ•´çš„ README
- [x] æ¶æ„è®¾è®¡æ–‡æ¡£ (ARCHITECTURE.md)
- [x] å¿«é€Ÿå…¥é—¨æŒ‡å— (QUICKSTART.md)
- [x] API å‚è€ƒ (API.md)
- [x] è´¡çŒ®æŒ‡å— (CONTRIBUTING.md)

### ğŸ”§ æŠ€æœ¯æ ˆ
- Python 3.10+ 
- SQLAlchemy 2.0+ (Session Events API)
- PostgreSQL (æ¨è) / SQLite (å¼€å‘)
- uv (åŒ…ç®¡ç†å™¨)
- pytest (æµ‹è¯•æ¡†æ¶)
- ruff + black (ä»£ç æ ¼å¼åŒ–)
- mypy (ç±»å‹æ£€æŸ¥)

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ä½¿ç”¨ changeset è€Œé object_changes

```python
# âœ… æ¨èï¼šä½¿ç”¨ changesetï¼ˆè¿”å›å…ƒç»„ï¼‰
for field, (old, new) in version.changeset.items():
    print(f"{field}: {old} â†’ {new}")

# âŒ ä¸æ¨èï¼šä½¿ç”¨ object_changesï¼ˆè¿”å›åˆ—è¡¨ï¼‰
# object_changes ç›´æ¥æ¥è‡ª JSON å­—æ®µï¼Œå€¼æ˜¯åˆ—è¡¨è€Œéå…ƒç»„
```

### 2. PostgreSQL ç”¨äºç”Ÿäº§ç¯å¢ƒ

```python
# âœ… ç”Ÿäº§ç¯å¢ƒ
engine = create_engine('postgresql://user:pass@localhost/db')

# âŒ ä»…å¼€å‘ç¯å¢ƒ
# engine = create_engine('sqlite:///app.db')
```

### 3. è®¾ç½®é€‚å½“çš„å¿½ç•¥å­—æ®µ

```python
# å¿½ç•¥è‡ªåŠ¨æ›´æ–°çš„æ—¶é—´æˆ³å­—æ®µ
@track_versions(ignore={'updated_at', 'modified_at', 'last_sync'})
class Model(Base):
    ...
```

### 4. ä½¿ç”¨äº‹åŠ¡åˆ†ç»„å…³è”å˜æ›´

```python
from paper_trail.context import transaction_group

with transaction_group() as tx_id:
    # å¤šä¸ªç›¸å…³å˜æ›´
    user.email = "new@example.com"
    user.profile.bio = "Updated bio"
    session.commit()
    
    # æŸ¥è¯¢è¿™ä¸ªäº‹åŠ¡çš„æ‰€æœ‰å˜æ›´
    versions = VersionQuery(session).by_transaction(tx_id).all()
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£è¯¦æƒ…ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ™ è‡´è°¢

- çµæ„Ÿæ¥æºï¼š[PaperTrail](https://github.com/paper-trail-gem/paper_trail) (Ruby)
- ä½¿ç”¨å·¥å…·ï¼š[SQLAlchemy](https://www.sqlalchemy.org/)ã€[uv](https://github.com/astral-sh/uv)

## ğŸ“® è”ç³»æ–¹å¼

- Issue Tracker: https://github.com/yunshang/paper-trail-py/issues
- æ–‡æ¡£: https://paper-trail-py.readthedocs.io

---

**ä½¿ç”¨ â¤ï¸ å’Œ ğŸ æ„å»º**
