from collections.abc import Sequence
from typing_extensions import Self

from . import building_block_list, reaction_list, synthesis

class ChemicalSpaceDefinition:
    def get_primary_building_blocks(self) -> building_block_list.BuildingBlockList: ...
    def get_secondary_building_blocks(self) -> Sequence[synthesis.Synthesis]: ...
    def get_reactions(self) -> reaction_list.ReactionList: ...
    def save(self, dirpath: str) -> None: ...

_default_option = building_block_list.BuildingBlockPreprocessingOption()

class ChemicalSpaceDefinitionBuilder:
    def building_blocks_from_sdf(
        self,
        path: str,
        option: building_block_list.BuildingBlockPreprocessingOption = _default_option,
    ) -> Self: ...
    def building_blocks_from_cache(self, path: str) -> Self: ...
    def reactions_from_txt(self, path: str) -> Self: ...
    def reactions_from_cache(self, path: str) -> Self: ...
    def secondary_building_blocks_from_single_reaction(self) -> Self: ...
    def secondary_building_blocks_from_cache(self, path: str) -> Self: ...
    def no_secondary_building_blocks(self) -> Self: ...
    def build_primary_index(self) -> Self: ...
    def build_secondary_index(self) -> Self: ...
    def all_from_cache(self, dirpath: str) -> Self: ...
    def build(self) -> ChemicalSpaceDefinition: ...
    def count_secondary_building_blocks(self) -> int: ...
    def get_secondary_building_block(self, index: int) -> synthesis.Synthesis: ...

class SynthesisGeneratorOption:
    num_reactions_cutoff: int
    num_product_atoms_cutoff: int

class SynthesisGenerator:
    def __init__(
        self,
        csd: ChemicalSpaceDefinition,
        option: SynthesisGeneratorOption = SynthesisGeneratorOption(),
        seed: int = ...,
    ) -> None: ...
    def next(self) -> synthesis.Synthesis: ...
