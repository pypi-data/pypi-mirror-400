{"version":3,"file":"workspace-DPIadIP6.js","sources":["../../../.svelte-kit/adapter-node/chunks/workspace.js"],"sourcesContent":["import { am as writable, ai as derived, an as get } from \"./vendor.js\";\nconst projects = writable([]);\nconst wellStatsCache = writable(/* @__PURE__ */ new Map());\nfunction getStatsCache(projectId, wellName) {\n  const cache = get(wellStatsCache);\n  return cache.get(`${projectId}-${wellName}`);\n}\nfunction setStatsCache(projectId, wellName, data) {\n  wellStatsCache.update((cache) => {\n    cache.set(`${projectId}-${wellName}`, { data, timestamp: Date.now() });\n    return cache;\n  });\n}\nfunction clearStatsCache(projectId, wellName) {\n  if (projectId && wellName) {\n    wellStatsCache.update((cache) => {\n      cache.delete(`${projectId}-${wellName}`);\n      return cache;\n    });\n  } else {\n    wellStatsCache.set(/* @__PURE__ */ new Map());\n  }\n}\nconst workspace = writable({\n  title: \"QPP - Petrophysical Analysis\",\n  subtitle: void 0,\n  project: null,\n  depthFilter: {\n    enabled: false,\n    minDepth: null,\n    maxDepth: null\n  },\n  zoneFilter: {\n    enabled: false,\n    zones: []\n  }\n});\nconst depthFilter = derived(workspace, ($workspace) => $workspace.depthFilter);\nconst zoneFilter = derived(workspace, ($workspace) => $workspace.zoneFilter);\nderived(workspace, ($workspace) => $workspace.project);\nderived(workspace, ($workspace) => ({ title: $workspace.title, subtitle: $workspace.subtitle }));\nfunction selectProject(project) {\n  workspace.update((s) => {\n    const curId = s.project && s.project.project_id != null ? String(s.project.project_id) : null;\n    const newId = project && project.project_id != null ? String(project.project_id) : null;\n    const curName = s.project && s.project.name ? s.project.name : null;\n    let incomingName = null;\n    if (project && project.name) incomingName = project.name;\n    else if (project && project.project_id) {\n      try {\n        const list = get(projects) || [];\n        const found = list.find((p) => String(p.project_id) === String(project.project_id));\n        if (found && found.name) incomingName = found.name;\n      } catch (e) {\n      }\n    }\n    const newName = incomingName;\n    if (curId === newId && curName === newName) return s;\n    const projToSet = project ? { ...project, ...newName ? { name: newName } : {} } : null;\n    return { ...s, project: projToSet, title: projToSet ? projToSet.name ?? \"QPP - Petrophysical Analysis\" : \"QPP - Petrophysical Analysis\" };\n  });\n}\nasync function selectProjectAndLoadWells(project) {\n  if (!project || !project.project_id) {\n    selectProject(null);\n    return;\n  }\n  selectProject(project);\n  const API_BASE = \"http://localhost:6312\";\n  try {\n    const res = await fetch(`${API_BASE}/quick_pp/database/projects/${project.project_id}/wells`);\n    if (res.ok) {\n      const data = await res.json();\n      const wells = data.wells || [];\n      workspace.update((s) => {\n        if (s.project && String(s.project.project_id) === String(project.project_id)) {\n          return { ...s, project: { ...s.project, wells } };\n        }\n        return s;\n      });\n    }\n  } catch (err) {\n    console.error(\"Failed to load wells for project\", project.project_id, err);\n  }\n}\nfunction selectWell(well) {\n  workspace.update((s) => ({ ...s, selectedWell: well }));\n}\nfunction applyDepthFilter(rows, depthFilter2) {\n  if (!depthFilter2?.enabled || !depthFilter2.minDepth && !depthFilter2.maxDepth) {\n    return rows;\n  }\n  return rows.filter((row) => {\n    const depth = Number(row.depth ?? row.DEPTH ?? row.Depth ?? NaN);\n    if (isNaN(depth)) return false;\n    if (depthFilter2.minDepth !== null && depth < depthFilter2.minDepth) return false;\n    if (depthFilter2.maxDepth !== null && depth > depthFilter2.maxDepth) return false;\n    return true;\n  });\n}\nfunction extractZoneValue(row) {\n  if (!row || typeof row !== \"object\") return null;\n  const candidates = [\"name\", \"zone\", \"Zone\", \"ZONE\", \"formation\", \"formation_name\", \"formationName\", \"FORMATION\", \"formation_top\", \"formationTop\"];\n  for (const k of candidates) {\n    if (k in row && row[k] !== null && row[k] !== void 0 && String(row[k]).trim() !== \"\") {\n      return String(row[k]);\n    }\n  }\n  for (const k of Object.keys(row)) {\n    if (/zone|formation/i.test(k) && row[k] !== null && row[k] !== void 0 && String(row[k]).trim() !== \"\") {\n      return String(row[k]);\n    }\n  }\n  return null;\n}\nfunction applyZoneFilter(rows, zoneFilter2) {\n  if (!zoneFilter2?.enabled || !zoneFilter2.zones || zoneFilter2.zones.length === 0) return rows;\n  const allowed = new Set(zoneFilter2.zones.map((z) => String(z)));\n  return rows.filter((row) => {\n    const val = extractZoneValue(row);\n    if (val === null) return false;\n    return allowed.has(val);\n  });\n}\nexport {\n  selectWell as a,\n  applyZoneFilter as b,\n  applyDepthFilter as c,\n  setStatsCache as d,\n  clearStatsCache as e,\n  depthFilter as f,\n  getStatsCache as g,\n  projects as p,\n  selectProjectAndLoadWells as s,\n  workspace as w,\n  zoneFilter as z\n};\n"],"names":["get","derived"],"mappings":"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"}