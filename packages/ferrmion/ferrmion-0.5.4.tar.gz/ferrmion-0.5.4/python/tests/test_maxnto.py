"""Tests for MaxNTO encoding."""

from ferrmion.encode import MaxNTO
from ferrmion.utils import check_trivial_overlap
import numpy as np


def test_max_nto():
    mnto = MaxNTO(14)
    ipowers, symplectics = mnto._build_symplectic_matrix()
    valid, nto = check_trivial_overlap(symplectics)

    assert valid
    assert np.all(
        ipowers
        == np.array(
            [
                0,
                1,
                0,
                1,
                2,
                3,
                2,
                3,
                0,
                1,
                0,
                1,
                2,
                3,
                2,
                3,
                0,
                1,
                0,
                1,
                2,
                3,
                2,
                3,
                0,
                1,
                0,
                1,
            ],
            dtype=np.uint8,
        )
    )
    assert np.all(
        symplectics
        == np.array(
            [
                [
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    True,
                    True,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                    False,
                ],
                [
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    True,
                    False,
                ],
            ]
        )
    )
    assert np.all(
        nto
        == np.array(
            [
                [
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    3.0,
                    13.0,
                    11.0,
                    3.0,
                    5.0,
                    11.0,
                    9.0,
                    5.0,
                    7.0,
                    9.0,
                    7.0,
                    7.0,
                    9.0,
                    7.0,
                    5.0,
                    9.0,
                    11.0,
                    5.0,
                    3.0,
                    11.0,
                    13.0,
                    3.0,
                    1.0,
                    13.0,
                ],
                [
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    13.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    13.0,
                    13.0,
                    1.0,
                ],
                [
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    1.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    1.0,
                ],
                [
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    11.0,
                    1.0,
                    3.0,
                    11.0,
                    9.0,
                    3.0,
                    5.0,
                    9.0,
                    7.0,
                    5.0,
                    7.0,
                    7.0,
                    5.0,
                    7.0,
                    9.0,
                    5.0,
                    3.0,
                    9.0,
                    11.0,
                    3.0,
                    1.0,
                    11.0,
                ],
                [
                    3.0,
                    13.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    3.0,
                    13.0,
                    11.0,
                    3.0,
                    5.0,
                    11.0,
                    9.0,
                    5.0,
                    7.0,
                    9.0,
                    7.0,
                    7.0,
                    9.0,
                    7.0,
                    5.0,
                    9.0,
                    11.0,
                    5.0,
                    3.0,
                    11.0,
                ],
                [
                    13.0,
                    3.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    13.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    11.0,
                    11.0,
                    3.0,
                ],
                [
                    11.0,
                    3.0,
                    1.0,
                    11.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    1.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    3.0,
                ],
                [
                    3.0,
                    11.0,
                    11.0,
                    1.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    11.0,
                    1.0,
                    3.0,
                    11.0,
                    9.0,
                    3.0,
                    5.0,
                    9.0,
                    7.0,
                    5.0,
                    7.0,
                    7.0,
                    5.0,
                    7.0,
                    9.0,
                    5.0,
                    3.0,
                    9.0,
                ],
                [
                    5.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    13.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    3.0,
                    13.0,
                    11.0,
                    3.0,
                    5.0,
                    11.0,
                    9.0,
                    5.0,
                    7.0,
                    9.0,
                    7.0,
                    7.0,
                    9.0,
                    7.0,
                    5.0,
                    9.0,
                ],
                [
                    11.0,
                    5.0,
                    3.0,
                    11.0,
                    13.0,
                    3.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    13.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    9.0,
                    9.0,
                    5.0,
                ],
                [
                    9.0,
                    5.0,
                    3.0,
                    9.0,
                    11.0,
                    3.0,
                    1.0,
                    11.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    1.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    5.0,
                ],
                [
                    5.0,
                    9.0,
                    9.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    1.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    11.0,
                    1.0,
                    3.0,
                    11.0,
                    9.0,
                    3.0,
                    5.0,
                    9.0,
                    7.0,
                    5.0,
                    7.0,
                    7.0,
                    5.0,
                    7.0,
                ],
                [
                    7.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    13.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    3.0,
                    13.0,
                    11.0,
                    3.0,
                    5.0,
                    11.0,
                    9.0,
                    5.0,
                    7.0,
                    9.0,
                    7.0,
                    7.0,
                ],
                [
                    9.0,
                    7.0,
                    5.0,
                    9.0,
                    11.0,
                    5.0,
                    3.0,
                    11.0,
                    13.0,
                    3.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    13.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    7.0,
                    7.0,
                    7.0,
                ],
                [
                    7.0,
                    7.0,
                    5.0,
                    7.0,
                    9.0,
                    5.0,
                    3.0,
                    9.0,
                    11.0,
                    3.0,
                    1.0,
                    11.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    1.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    7.0,
                ],
                [
                    7.0,
                    7.0,
                    7.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    1.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    11.0,
                    1.0,
                    3.0,
                    11.0,
                    9.0,
                    3.0,
                    5.0,
                    9.0,
                    7.0,
                    5.0,
                ],
                [
                    9.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    13.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    3.0,
                    13.0,
                    11.0,
                    3.0,
                    5.0,
                    11.0,
                    9.0,
                    5.0,
                ],
                [
                    7.0,
                    9.0,
                    7.0,
                    7.0,
                    9.0,
                    7.0,
                    5.0,
                    9.0,
                    11.0,
                    5.0,
                    3.0,
                    11.0,
                    13.0,
                    3.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    13.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    5.0,
                    5.0,
                    9.0,
                ],
                [
                    5.0,
                    9.0,
                    7.0,
                    5.0,
                    7.0,
                    7.0,
                    5.0,
                    7.0,
                    9.0,
                    5.0,
                    3.0,
                    9.0,
                    11.0,
                    3.0,
                    1.0,
                    11.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    1.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    9.0,
                ],
                [
                    9.0,
                    5.0,
                    5.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    1.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    11.0,
                    1.0,
                    3.0,
                    11.0,
                    9.0,
                    3.0,
                ],
                [
                    11.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    13.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    3.0,
                    13.0,
                    11.0,
                    3.0,
                ],
                [
                    5.0,
                    11.0,
                    9.0,
                    5.0,
                    7.0,
                    9.0,
                    7.0,
                    7.0,
                    9.0,
                    7.0,
                    5.0,
                    9.0,
                    11.0,
                    5.0,
                    3.0,
                    11.0,
                    13.0,
                    3.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    13.0,
                    3.0,
                    3.0,
                    11.0,
                ],
                [
                    3.0,
                    11.0,
                    9.0,
                    3.0,
                    5.0,
                    9.0,
                    7.0,
                    5.0,
                    7.0,
                    7.0,
                    5.0,
                    7.0,
                    9.0,
                    5.0,
                    3.0,
                    9.0,
                    11.0,
                    3.0,
                    1.0,
                    11.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                    1.0,
                    11.0,
                ],
                [
                    11.0,
                    3.0,
                    3.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    1.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                    11.0,
                    1.0,
                ],
                [
                    13.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    13.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                    13.0,
                    1.0,
                ],
                [
                    3.0,
                    13.0,
                    11.0,
                    3.0,
                    5.0,
                    11.0,
                    9.0,
                    5.0,
                    7.0,
                    9.0,
                    7.0,
                    7.0,
                    9.0,
                    7.0,
                    5.0,
                    9.0,
                    11.0,
                    5.0,
                    3.0,
                    11.0,
                    13.0,
                    3.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                    1.0,
                    13.0,
                ],
                [
                    1.0,
                    13.0,
                    11.0,
                    1.0,
                    3.0,
                    11.0,
                    9.0,
                    3.0,
                    5.0,
                    9.0,
                    7.0,
                    5.0,
                    7.0,
                    7.0,
                    5.0,
                    7.0,
                    9.0,
                    5.0,
                    3.0,
                    9.0,
                    11.0,
                    3.0,
                    1.0,
                    11.0,
                    13.0,
                    1.0,
                    0.0,
                    13.0,
                ],
                [
                    13.0,
                    1.0,
                    1.0,
                    11.0,
                    11.0,
                    3.0,
                    3.0,
                    9.0,
                    9.0,
                    5.0,
                    5.0,
                    7.0,
                    7.0,
                    7.0,
                    7.0,
                    5.0,
                    5.0,
                    9.0,
                    9.0,
                    3.0,
                    3.0,
                    11.0,
                    11.0,
                    1.0,
                    1.0,
                    13.0,
                    13.0,
                    0.0,
                ],
            ]
        )
    )
