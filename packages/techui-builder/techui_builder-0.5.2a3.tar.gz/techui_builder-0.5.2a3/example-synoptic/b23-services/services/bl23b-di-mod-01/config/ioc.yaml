# yaml-language-server: $schema=/epics/ibek-defs/ioc.schema.json

ioc_name: "{{  _global.get_env('IOC_NAME') }}"

description: auto-generated by https://github.com/epics-containers/builder2ibek

entities:
  - type: epics.EpicsEnvSet
    name: EPICS_TS_MIN_WEST
    value: "0"

  - type: epics.EpicsEnvSet
    name: STREAM_PROTOCOL_PATH
    value: /epics/runtime/protocol/

  - type: devIocStats.iocAdminSoft
    IOC: "{{ ioc_name | upper }}"

  - type: epics.EpicsCaMaxArrayBytes
    max_bytes: 9000000

  - type: epics.StartupCommand
    command: callbackSetQueueSize(10000)

  - type: autosave.Autosave
    P: "{{ ioc_name | upper }}"
    debug: false

  - type: ADAravis.aravisCamera
    BUFFERS: 200
    CLASS: AutoADGenICam
    ID: Allied Vision Technologies-50-0536889551
    P: BL23B-DI-MOD-01
    PORT: CAMA.CAM
    R: ":CAM:"

  - type: ADCore.NDROI
    ADDR: 0
    NDARRAY_ADDR: 0
    NDARRAY_PORT: CAMA.CAM
    P: BL23B-DI-MOD-01
    PORT: CAMA.roi
    QUEUE: 16
    R: ":ROI:"
    TIMEOUT: 1

  - type: ADCore.NDStats
    ADDR: 0
    HIST_SIZE: 65535
    NCHANS: 20000
    NDARRAY_ADDR: 0
    NDARRAY_PORT: CAMA.CAM
    P: BL23B-DI-MOD-01
    PORT: CAMA.stat
    QUEUE: 16
    R: ":STAT:"
    TIMEOUT: 1
    XSIZE: 1024
    YSIZE: 768

  - type: ADCore.NDStdArrays
    ADDR: 0
    FTVL: UCHAR
    NDARRAY_ADDR: 0
    NDARRAY_PORT: CAMA.roi
    NELEMENTS: 786432
    P: BL23B-DI-MOD-01
    PORT: CAMA.arr
    QUEUE: 2
    R: ":ARR:"
    TIMEOUT: 1
    TYPE: Int8

  - type: ADCore.NDProcess
    ADDR: 0
    NDARRAY_ADDR: 0
    NDARRAY_PORT: CAMA.CAM
    P: BL23B-DI-MOD-01
    PORT: CAMA.proc
    QUEUE: 16
    R: ":PROC:"
    TIMEOUT: 1

  - type: ADCore.NDOverlay
    ADDR: 0
    NDARRAY_ADDR: 0
    NDARRAY_PORT: CAMA.proc
    P: BL23B-DI-MOD-01
    PORT: CAMA.over
    QUEUE: 16
    R: ":OVER:"
    TIMEOUT: 1

  - type: ADCore.NDFileTIFF
    ADDR: 0
    NDARRAY_ADDR: 0
    NDARRAY_PORT: CAMA.CAM
    P: BL23B-DI-MOD-01
    PORT: CAMA.tiff
    QUEUE: 16
    R: ":TIFF:"
    TIMEOUT: 1

  - type: ADCore.NDFileHDF5
    ADDR: 0
    NDARRAY_ADDR: 0
    NDARRAY_PORT: CAMA.CAM
    P: BL23B-DI-MOD-01
    PORT: CAMA.hdf
    QUEUE: 16
    R: ":HDF5:"
    TIMEOUT: 1

  - type: epics.dbpf
    pv: BL23B-DI-MOD-01:CAM:GC_GevSCPSPacketSize
    value: "{1500}"

  - type: epics.dbpf
    pv: BL23B-DI-MOD-01:CAM:PixelFormat
    value: "{'Mono8'}"
