[tool.ruff]
target-version = "py311"

line-length = 120

preview = true
lint.explicit-preview-rules = true

lint.select = [
    'F', # Pyflakes
    'E', # pycodestyle - format warnings
    'W', # pycodestyle - format warnings
    'N', # pep8-naming - naming conventions
    'UP', # pyupgrade - checking deprecated language functionality
    'YTT', # flake8-2020 - python 3.10 related
    'ANN', # flake8-annotations - type annotation
    'B', # flake8-bugbear - likely bugs and design problems
    'A', # flake8-builtins - builtin shadowing
    'COM', # flake8-commas - comma usage
    'C90', # mccabe - code complexity
    'C4', # flake8-comprehensions - comprehension usage
    'DTZ', # flake8-datetimez - datetime usage
    'ISC', # flake8-implicit-str-concat
    'G', # flake8-logging-format - logging usage
    'INP', # flake8-no-pep420 - requires __init__.py in packages
    'PIE', # flake8-pie - misc lints
    'T20', # flake8-print - print usage. Library should use logger
    'PT', # flake8-pytest-style - pytest usage
    'RET', # flake8-return - return semantics
    'SIM', # flake8-simplify - simplify code
    'TID', # flake8-tidy-imports - tidy imports
    'ARG', # flake8-unused-arguments
    'PTH', # flake8-use-pathlib
    'CPY001', # flake8-copyright
    'TD', # flake8-todos - TODO usage
    'ERA', # eradicate - remove commented out code
    'PL', # Pylint - general pylint rules
    'TRY', # tryceratops - exception usage
    'FLY', # flynt - string formatting converter
    'RUF', # Ruff-specific rules
    'FURB', # refurb, modernizing Python
]

lint.ignore = [
    'ANN204', # missing-return-type-special-method
    'ANN201', # missing-return-type-undocumented-public-function - often can be inferred
    'ANN205', # missing-return-type-static-method - often can be inferred
    'ANN202', # missing-return-type-private-function - often can be inferred
    'ANN002', # missing-type-args - typing for *args
    'ANN003', # missing-type-kwargs - typing for **kwargs
    'ANN206', # missing-return-type-class-method - often can be inferred
    'ANN401', # any-type - Any usage
    'B024', # abstract-base-class-without-abstract-method
    'A003', # builtin-attribute-shadowing - class attribute (e.g. id) shadowing a builtin
    'COM812', # missing-trailing-comma - requires trailing commas for pretty much everything
    'G004', # logging-f-string - minor performance penalty
    'PIE790', # unnecessary-pass - allow pass in a method only containing docstring
    'PT003', # pytest-extraneous-scope-function - explicit scope='function'
    'PT013', # pytest-incorrect-pytest-import - directly importing pytest contents
    'PT006', # pytest-parametrize-names-wrong-type - requires parameter names to be tuple, should be configurable, but isn't in ruff
    'RET505', # superfluous-else-return - improves readability
    'RET506', # superfluous-else-raise - improves readability
    'RET507', # superfluous-else-continue - improves readability
    'RET508', # superfluous-else-break - improves readability
    'TD003', # missing-todo-link
    'PLR0913', # too-many-arguments
    'PLR0911', # too-many-return-statements
    'TRY003', # raise-vanilla-args - avoid long messages as exception args. We have unique exceptions that usually are not handled
    'TRY301', # raise-within-try - avoid raising within try blocks. Sounds rather arbitrary.
    'TRY300', # try-consider-else - use try..else. Might consider this language feature in the future.
    'TRY002', # raise-vanilla-class - avoid using Exception. We have unique exceptions that usually are not handled
    'RUF009', # function-call-in-dataclass-default-argument - incorrectly flags a lot
    'PLR2004', # magic-value-comparison - flags things like "len(something) == 2" or "r.code == 500"
]

[tool.ruff.lint.flake8-copyright]
author = "CUJO Testops"

[tool.ruff.lint.per-file-ignores]
"*tests/**/*" = [
    'ANN001', # missing-type-function-argument - fixture types can be inferred
    'T20', # print statements - fine in tests
    'PT015', # pytest-assert-always-false - assert False
    'PLW0211' # "First argument of a static method should not be named `cls`" goes against pytest convention
]
"**/*plugin.py" = ['ANN001'] # missing-type-function-argument - fixture types can be inferred
"*tests/**/*sample*" = [
    'B011', # assert-false
    'ARG', # unused argument
    'PT004', # side effect only fixtures
]
"/**/command_line/*" = ['T20'] # print statements - fine in command line applications
