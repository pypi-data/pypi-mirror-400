export const __webpack_id__="51486";export const __webpack_ids__=["51486"];export const __webpack_modules__={90433:function(t,e,a){a.d(e,{Vy:()=>r,fI:()=>h,ux:()=>n});var i=a(22786),s=a(79468);const o=54;function r(t,e){const a=t%o+1;return e.getPropertyValue(`--color-${a}`)}function h(t,e){const a=e.getPropertyValue(`--graph-color-${t+1}`)||r(t,e);return(0,s.RQ)(a)}const n=(0,i.A)(t=>Array.from({length:o},(e,a)=>h(a,t)),(t,e)=>t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")&&t[0].getPropertyValue("--color-1")===e[0].getPropertyValue("--color-1"))},36525:function(t,e,a){a.a(t,async function(t,i){try{a.d(e,{n:()=>x});a(44114),a(18111),a(22489),a(7588),a(61701),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698);var s=a(62826),o=a(96196),r=a(44457),h=a(6415),n=a(22786),d=a(90433),c=a(36312),l=a(95747),p=a(20058),u=a(8549),m=a(15638),_=a(23528),y=a(44439),g=t([y,l,p]);[y,l,p]=g.then?(await g)():g;const x={mean:"mean",min:"min",max:"max",sum:"sum",state:"sum",change:"sum"};class f extends o.WF{shouldUpdate(t){return t.size>1||!t.has("hass")}willUpdate(t){(t.has("statisticsData")||t.has("statTypes")||t.has("chartType")||t.has("hideLegend")||t.has("_hiddenStats"))&&this._generateData(),(!this.hasUpdated||t.has("unit")||t.has("period")||t.has("chartType")||t.has("minYAxis")||t.has("maxYAxis")||t.has("fitYData")||t.has("logarithmicScale")||t.has("hideLegend")||t.has("startTime")||t.has("endTime")||t.has("_legendData")||t.has("_chartData"))&&this._createOptions()}firstUpdated(){this._computedStyle=getComputedStyle(this)}render(){return(0,c.x)(this.hass,"history")?this.isLoadingData&&!this.statisticsData?o.qy`<div class="info"> ${this.hass.localize("ui.components.statistics_charts.loading_statistics")} </div>`:this.statisticsData&&Object.keys(this.statisticsData).length?o.qy` <ha-chart-base .hass="${this.hass}" .data="${this._chartData}" .options="${this._chartOptions}" .height="${this.height}" style="${(0,h.W)({height:this.height})}" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}" .expandLegend="${this.expandLegend}"></ha-chart-base> `:o.qy`<div class="info"> ${this.hass.localize("ui.components.statistics_charts.no_statistics_found")} </div>`:o.qy`<div class="info"> ${this.hass.localize("ui.components.history_charts.history_disabled")} </div>`}_datasetHidden(t){this._legendData&&(this._hiddenStats.add(t.detail.id),this.requestUpdate("_hiddenStats"))}_datasetUnhidden(t){this._legendData&&(this._hiddenStats.delete(t.detail.id),this.requestUpdate("_hiddenStats"))}_createOptions(){const t=this.daysToShow??1;let e=this.minYAxis,a=this.maxYAxis;"number"==typeof e?this.fitYData&&(e=({min:t})=>Math.min(this._roundYAxis(t,Math.floor),this.minYAxis)):this.logarithmicScale&&(e=({min:t})=>{const e=t>0?.95*t:1.05*t;return this._roundYAxis(e,Math.floor)}),"number"==typeof a?this.fitYData&&(a=({max:t})=>Math.max(this._roundYAxis(t,Math.ceil),this.maxYAxis)):this.logarithmicScale&&(a=({max:t})=>{const e=t>0?1.05*t:.95*t;return this._roundYAxis(e,Math.ceil)});const i=this.endTime??new Date;let s=this.startTime;s||(this._chartData.forEach(t=>{if(!Array.isArray(t.data)||!t.data[0])return;const e=t.data[0],a=Array.isArray(e)?e[0]:e.value?.[0];a&&(!s||new Date(a)<s)&&(s=new Date(a))}),s||(s=new Date(i.getTime()-24*t*3600*1e3))),this._chartOptions={xAxis:[{id:"xAxis",type:"time",min:s,max:this.endTime},{id:"hiddenAxis",type:"time",show:!1}],yAxis:{type:this.logarithmicScale?"log":"value",name:this.unit,nameGap:2,nameTextStyle:{align:"left"},position:(0,m.qC)(this.hass)?"right":"left",scale:"bar"!==this.chartType||this.logarithmicScale||void 0!==e||void 0!==a,min:this._clampYAxis(e),max:this._clampYAxis(a),splitLine:{show:!0},axisLabel:{formatter:this._formatYAxisLabel}},legend:{type:"custom",show:!this.hideLegend,data:this._legendData},grid:{top:15,left:1,right:1,bottom:0,containLabel:!0},tooltip:{trigger:"axis",appendTo:document.body,formatter:this._renderTooltip}}}async _generateData(){if(!this.statisticsData)return;const t=this.metadata||await this._getStatisticsMetaData(Object.keys(this.statisticsData));let e=0;const a=Object.entries(this.statisticsData),i=[],s=[],o=[];let r,h;if(0===a.length)return;r=this.endTime||new Date(Math.max(...a.map(([t,e])=>new Date(e[e.length-1].start).getTime()))),r>new Date&&(r=new Date);const n=this.names||{};a.forEach(([a,r])=>{const c=t?.[a];let l=n[a];void 0===l&&(l=(0,_.$O)(this.hass,a,c)),this.unit||(void 0===h?h=(0,_.JE)(this.hass,a,c):null!==h&&h!==(0,_.JE)(this.hass,a,c)&&(h=null));let p,u=null;const m=[],y=[],g=(t,e,a)=>{a.length&&(t>e||(m.forEach((e,i)=>{"line"===this.chartType&&p&&u&&p.getTime()!==t.getTime()&&(e.data.push(this._transformDataValue([p,...u[i]])),e.data.push([p,null])),e.data.push(this._transformDataValue([t,...a[i]]))}),u=a,p=e))},x=(0,d.fI)(e,this._computedStyle||getComputedStyle(this));e++;const f=[],b=this.statTypes.includes("mean")&&(0,_.iY)(r,"mean"),D=this.statTypes.includes("max")&&(0,_.iY)(r,"max"),v=this.statTypes.includes("min")&&(0,_.iY)(r,"min"),M=[b,D,v].filter(Boolean).length>1,T=this.statTypes.includes("state"),A=D?"max":"mean",S=v?"min":"mean",w=M?[...this.statTypes].sort((t,e)=>"min"===t||"max"===e?-1:"max"===t||"min"===e?1:0):this.statTypes;let Y=!1;w.forEach(t=>{if((0,_.iY)(r,t)){const e=M&&(t===A||t===S);f.push(t);const i=e&&v&&D&&b||T&&["change","sum"].includes(t)?x+(this.hideLegend?"00":"7F"):x,s=e?x+"3F":x+"7F",r={id:`${a}-${t}`,type:this.chartType,smooth:"line"===this.chartType&&.4,smoothMonotone:"x",cursor:"default",data:[],name:l?`${l} (${this.hass.localize(`ui.components.statistics_charts.statistic_types.${t}`)})`:this.hass.localize(`ui.components.statistics_charts.statistic_types.${t}`),symbol:"none",sampling:"minmax",animationDurationUpdate:0,lineStyle:{width:1.5},itemStyle:"bar"===this.chartType?{borderRadius:[4,4,0,0],borderColor:i,borderWidth:1.5}:void 0,color:"bar"===this.chartType?s:i};if(e&&"line"===this.chartType&&(r.stack=`band-${a}`,r.stackStrategy="all",M&&t===A&&(r.areaStyle={color:x+"3F"})),!this.hideLegend){const e=b?"mean"===t:!1===Y;e&&y.push({id:a,name:l,color:r.color,borderColor:r.itemStyle?.borderColor}),Y=Y||e}m.push(r),o.push(a)}});let $=null,L=null;r.forEach(t=>{const e=new Date(t.start);if($===e)return;$=e;const i=[];f.forEach(e=>{const a=[];if("sum"===e)null==L?(a.push(0),L=t.sum):a.push((t.sum||0)-L);else if(e===A&&"line"===this.chartType&&M){const e=t[A]||0;a.push(Math.abs(e-(t[S]||0))),a.push(e)}else a.push(t[e]??null);i.push(a)}),this._hiddenStats.has(a)||g(e,new Date(t.end),i)}),Array.prototype.push.apply(i,m),Array.prototype.push.apply(s,y)}),h&&(this.unit=h),s.forEach(({id:t,name:e,color:a,borderColor:s})=>{i.push({id:t,name:e,color:a,itemStyle:{borderColor:s},type:this.chartType,data:[],xAxisIndex:1})}),this._chartData=i,s.length!==this._legendData?.length&&(this._legendData=s.length>1?s.map(({id:t,name:e})=>({id:t,name:e})):void 0),this._statisticIds=o}_transformDataValue(t){return"bar"===this.chartType&&t[1]&&t[1]<0?{value:t,itemStyle:{borderRadius:[0,0,4,4]}}:t}_clampYAxis(t){if(this.logarithmicScale){if("number"==typeof t)return Math.max(t,Number.EPSILON);if("function"==typeof t)return e=>Math.max(t(e),Number.EPSILON)}return t}_roundYAxis(t,e){return Math.abs(t)<1?t:e(t)}constructor(...t){super(...t),this.statTypes=["sum","min","mean","max"],this.chartType="line",this.fitYData=!1,this.hideLegend=!1,this.logarithmicScale=!1,this.isLoadingData=!1,this.clickForMoreInfo=!0,this._chartData=[],this._statisticIds=[],this._hiddenStats=new Set,this._previousYAxisLabelValue=0,this._renderTooltip=t=>{const e={},a=this.unit?`${(0,u.A)(this.unit,this.hass.locale)}${this.unit}`:"";return t.map((t,i)=>{if(e[t.seriesIndex])return"";e[t.seriesIndex]=!0;const s=this._statisticIds[t.seriesIndex],o=this.hass.states[s],r=this.hass.entities[s],h=String(t.value[2]??t.value[1]),n=(0,p.ZQ)(o,r)??{maximumFractionDigits:2},d=`${(0,p.ZV)(h,this.hass.locale,n)}${a}`;return`${0===i?(0,l.yg)(new Date(t.value[0]),this.hass.locale,this.hass.config)+"<br>":""}${t.marker} ${t.seriesName}: ${d}`}).filter(Boolean).join("<br>")},this._getStatisticsMetaData=(0,n.A)(async t=>{const e=await(0,_.Wr)(this.hass,t),a={};return e.forEach(t=>{a[t.statistic_id]=t}),a}),this._formatYAxisLabel=t=>{const e=Math.max(1,-Math.floor(Math.log10(Math.abs(t-this._previousYAxisLabelValue||1)))),a=(0,p.ZV)(t,this.hass.locale,{maximumFractionDigits:e});return this._previousYAxisLabelValue=t,a}}}f.styles=o.AH`:host{display:block;min-height:60px}.info{text-align:center;line-height:60px;color:var(--secondary-text-color)}`,(0,s.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"hass",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"statisticsData",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"metadata",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"names",void 0),(0,s.__decorate)([(0,r.MZ)()],f.prototype,"unit",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"startTime",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"endTime",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1,type:Array})],f.prototype,"statTypes",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1})],f.prototype,"chartType",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1,type:Number})],f.prototype,"minYAxis",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:!1,type:Number})],f.prototype,"maxYAxis",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:"fit-y-data",type:Boolean})],f.prototype,"fitYData",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:"hide-legend",type:Boolean})],f.prototype,"hideLegend",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:"logarithmic-scale",type:Boolean})],f.prototype,"logarithmicScale",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:"is-loading-data",type:Boolean})],f.prototype,"isLoadingData",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:"click-for-more-info",type:Boolean})],f.prototype,"clickForMoreInfo",void 0),(0,s.__decorate)([(0,r.MZ)()],f.prototype,"period",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:"days-to-show",type:Number})],f.prototype,"daysToShow",void 0),(0,s.__decorate)([(0,r.MZ)({type:String})],f.prototype,"height",void 0),(0,s.__decorate)([(0,r.MZ)({attribute:"expand-legend",type:Boolean})],f.prototype,"expandLegend",void 0),(0,s.__decorate)([(0,r.wk)()],f.prototype,"_chartData",void 0),(0,s.__decorate)([(0,r.wk)()],f.prototype,"_legendData",void 0),(0,s.__decorate)([(0,r.wk)()],f.prototype,"_statisticIds",void 0),(0,s.__decorate)([(0,r.wk)()],f.prototype,"_chartOptions",void 0),(0,s.__decorate)([(0,r.wk)()],f.prototype,"_hiddenStats",void 0),f=(0,s.__decorate)([(0,r.EM)("statistics-chart")],f),i()}catch(t){i(t)}})}};
//# sourceMappingURL=51486.2beb7de78c8d1c61.js.map