# SPDX-License-Identifier: Apache-2.0

[build-system]
requires = ["setuptools>=64", "setuptools_scm>=8", "wheel>=0.43", "packaging>=20.9"]
build-backend = "setuptools.build_meta"

[project]
name = "training-hub"
description = "An algorithm-focused interface for common language model training, continual learning, and reinforcement learning techniques"
readme = "README.md"
license = "Apache-2.0"
requires-python = ">=3.11"
dependencies = [
    "setuptools>=80.0",
    "packaging>=24.2",
    "wheel>=0.43",
    "instructlab-training>=0.13.0",
    "rhai-innovation-mini-trainer>=0.5.0",
    "torch>=2.6.0",
    "numba>=0.62.0",
    "transformers>=4.57.0",
    "datasets>=4.0.0",
    "numpy>=1.26.4",
    "rich>=14.1.0",
    "peft>=0.15",
    "pydantic>=2.7.0",
    "aiofiles>=23.2.1",
    "accelerate>=0.34.2",
    "sympy>=1.0",
    "networkx>=3.0",
    "jinja2>=3.1.0",
    "fsspec>=2025.0",
    "pandas>=2.2",
    "multiprocess>=0.70.16",
    "aiohttp>=3.12",
    "pyparsing>=3.0",
    "regex>=2025.0",
    "llvmlite>=0.42",
    "filelock>=3.0",
    "psutil>=6.0",
    "urllib3>=2.4",
    "frozenlist>=1.7",
    "xxhash>=3.0",
    "requests>=2.32.5",
    "attr>=0.3.2",
    "filelock>=3.19.1",
    "mpmath>=1.3.0",
    "pytest>=8.0"
]

dynamic = ["version"]

[project.optional-dependencies]
cuda = [
    "instructlab-training[cuda]>=0.13.0",
    "rhai-innovation-mini-trainer[cuda]>=0.5.0",
    "flash-attn>=2.8",
    "einops>=0.8",
    "kernels>=0.9.0",
    "bitsandbytes>=0.47.0",
    "liger-kernel>=0.5.10",
    "mamba-ssm[causal-conv1d]>=2.2.5",
]

lora = [
    "unsloth>=2025.10.11",
    "trl>=0.18.0",
    "xformers>=0.0.33.post1",
]

dev = [
    "ipykernel",
    "ipython"
]

[project.urls]
homepage = "https://ai-innovation.team/"
source = "https://github.com/Red-Hat-AI-Innovation-Team/training_hub"
issues = "https://github.com/Red-Hat-AI-Innovation-Team/training_hub/issues"

[tool.setuptools_scm]
version_file = "src/training_hub/_version.py"
# do not include +gREV local version, required for Test PyPI upload
local_scheme = "no-local-version"

[tool.setuptools]
package-dir = {"" = "src"}

[tool.setuptools.packages.find]
where = ["src"]
include = ["training_hub"]

