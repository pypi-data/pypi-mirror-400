## 1. Analysis
- [x] 1.1 Identify all duplicated code patterns between backends
- [x] 1.2 Design shared utilities structure
- [x] 1.3 Plan abstract base class design

## 2. Implementation
- [x] 2.1 Extract common merge logic into `fsspeckit.core.merge`
- [x] 2.2 Create abstract base class `BaseDatasetHandler`
- [x] 2.3 Refactor duplicate compaction logic into shared functions
- [x] 2.4 Refactor duplicate optimization logic into shared functions
- [x] 2.5 Standardize error handling patterns
- [x] 2.6 Eliminate code duplication in deduplication implementations

## 3. Testing
- [x] 3.1 Ensure all functionality works after refactoring
- [x] 3.2 Test both backends work identically
- [x] 3.3 Validate no regressions in existing functionality
