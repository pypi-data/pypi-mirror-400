"use strict";(self.webpackChunkgitoon_frontend=self.webpackChunkgitoon_frontend||[]).push([["6434"],{75428:function(t,e,i){i.d(e,{D:function(){return a}});var n=i(75158),r=i.n(n),a=function(t){return r()(t,{whiteList:{},stripIgnoreTag:!0,stripIgnoreTagBody:!0})}},23528:function(t,e,i){i.a(t,async function(t,n){try{i.d(e,{$3:function(){return m},$O:function(){return T},$j:function(){return p},ED:function(){return c},JE:function(){return x},OQ:function(){return O},PU:function(){return j},Ph:function(){return v},Uf:function(){return E},W1:function(){return y},Wr:function(){return _},Z:function(){return d},gF:function(){return b},iY:function(){return S},jU:function(){return u},nN:function(){return k},p3:function(){return h},pJ:function(){return g},r_:function(){return l},sz:function(){return f}});var r=i(31432),a=(i(74423),i(18111),i(13579),i(69085),i(26099),i(21699),i(28978)),s=i(380),o=t([s]);s=(o.then?(await o)():o)[0];var c=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({}),u=["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"],l=["L","gal","ft³","m³","CCF","MCF"],d=function(t){return t.sendMessagePromise({type:"recorder/info"})},h=function(t,e){return t.callWS({type:"recorder/list_statistic_ids",statistic_type:e})},_=function(t,e){return t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e})},f=function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"hour",a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;return t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==i?void 0:i.toISOString(),statistic_ids:n,period:r,units:a,types:s})},g=function(t,e,i,n){return t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:n,fixed_period:i.fixed_period?{start_time:i.fixed_period.start instanceof Date?i.fixed_period.start.toISOString():i.fixed_period.start,end_time:i.fixed_period.end instanceof Date?i.fixed_period.end.toISOString():i.fixed_period.end}:void 0,calendar:i.calendar?Object.assign(Object.assign({},"week"===i.calendar.period?{first_weekday:(0,s.D)(t.locale).substring(0,3)}:{}),i.calendar):void 0,rolling_window:i.rolling_window})},v=function(t){return t.callWS({type:"recorder/validate_statistics"})},y=function(t,e,i,n){return t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:i,unit_class:n})},m=function(t,e){return t.callWS({type:"recorder/clear_statistics",statistic_ids:e})},p=function(t){var e=null;if(!t)return null;var i,n=(0,r.A)(t);try{for(n.s();!(i=n.n()).done;){var a=i.value;null!==a.change&&void 0!==a.change&&(null===e?e=a.change:e+=a.change)}}catch(s){n.e(s)}finally{n.f()}return e},b=function(t,e){var i,n=null,a=(0,r.A)(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s in t){var o=p(t[s]);null!==o&&(null===n?n=o:n+=o)}}}catch(c){a.e(c)}finally{a.f()}return n},S=function(t,e){return t.some(function(t){return void 0!==t[e]&&null!==t[e]})},w=["mean","min","max"],A=["sum","state","change"],k=function(t,e){return!(!w.includes(e)||0===t.mean_type)||!(!A.includes(e)||!t.has_sum)},E=function(t,e,i,n,r){var a=new Date(i).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:a,adjustment:n,adjustment_unit_of_measurement:r})},T=function(t,e,i){var n=t.states[e];return n?(0,a.u)(n):(null==i?void 0:i.name)||e},x=function(t,e,i){var n,r;e&&(n=null===(r=t.states[e])||void 0===r?void 0:r.attributes.unit_of_measurement);return void 0===n?null==i?void 0:i.statistics_unit_of_measurement:n},O=function(t){return t.includes(":")},j=function(t){return t.callWS({type:"recorder/update_statistics_issues"})};n()}catch(I){n(I)}})},97372:function(t,e,i){i.a(t,async function(t,n){try{i.d(e,{Gs:function(){return A},JR:function(){return I},RR:function(){return O},TI:function(){return k},od:function(){return T},ok:function(){return D}});var r=i(47075),a=(i(28706),i(2008),i(46449),i(23418),i(23792),i(62062),i(44114),i(26910),i(54554),i(93514),i(18111),i(22489),i(7588),i(61701),i(36033),i(75376),i(2892),i(40150),i(69085),i(26099),i(31415),i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698),i(47764),i(11392),i(23500),i(62953),i(66708)),s=i(6946),o=i(57279),c=i(98487),u=i(33977),l=i(56434),d=i(49134),h=i(35660),_=i(81977),f=i(35932),g=i(92913),v=i(77972),y=i(20058),m=i(72487),p=i(30162),b=i(75428),S=t([m,p,y]);function A(t,e){var i=new Date(e);return t>2&&0===i.getHours()&&(i=(0,a.O)(i,1)),i.setMinutes(0,0,0),t>35&&i.setDate(1),t>2&&i.setHours(0),i.getTime()}function k(t){return t>35?"month":t>2?"day":"hour"}function E(t){var e;return function(i){var n=Math.max(1,-Math.floor(Math.log10(Math.abs(i-(null!=e?e:i)||1))));return e=i,(0,y.ZV)(i,t,{maximumFractionDigits:n})}}function T(t,e,i,n,r,a,o,c){var u=(0,s.c)(e,t),l=void 0!==a&&void 0!==o,d=l&&t.getFullYear()!==a.getFullYear();return{xAxis:{type:"time",min:t,max:A(u,e)},yAxis:{type:"value",name:r,nameGap:2,nameTextStyle:{align:"left"},axisLabel:{formatter:E(i)},splitLine:{show:!0}},grid:{top:15,bottom:0,left:1,right:1,containLabel:!0},tooltip:{trigger:"axis",formatter:function(t){if(Array.isArray(t)){var e=[],a=[];return t.forEach(function(t){var i;null!==(i=t.seriesId)&&void 0!==i&&i.startsWith("compare-")?a.push(t):e.push(t)}),[e,a].map(function(t){return x(t,i,n,u,l,d,r,c)}).filter(Boolean).join("<br><br>")}return x([t],i,n,u,l,d,r,c)}}}}function x(t,e,i,n,r,a,s,c){var u,l,d,h;if(null===(u=t[0])||void 0===u||!u.value)return"";var _,f=new Date(null!==(l=null===(d=t[0].value)||void 0===d?void 0:d[2])&&void 0!==l?l:null===(h=t[0].value)||void 0===h?void 0:h[0]);n>=89?_="".concat((0,m.fr)(f,e,i)):n>0?_="".concat((a?m.kz:m.sl)(f,e,i)):(_="".concat(r?"".concat((a?m.kz:m.sl)(f,e,i),": "):"").concat((0,p.fU)(f,e,i)),"bar"===t[0].componentSubType&&(_+=" – ".concat((0,p.fU)((0,o.L)(f,1),e,i))));var g='<h4 style="text-align: center; margin: 0;">'.concat(_,"</h4>"),v=0,S=0,w=0,A=0,k=t.map(function(t){var i,n=null===(i=t.value)||void 0===i?void 0:i[1],r=(0,y.ZV)(n,e,n<.1?{maximumFractionDigits:3}:void 0);return"0"!==r&&("bar"===t.componentSubType&&(n>0?(v+=n,S++):(w+=n,A++)),"".concat(t.marker," ").concat((0,b.D)(t.seriesName),': <div style="direction:ltr; display: inline;">').concat(r," ").concat(s,"</div>"))}).filter(Boolean),E="";return 0!==v&&S>1&&c&&(E+="<br><b>".concat(c(v),"</b>")),0!==w&&A>1&&c&&(E+="<br><b>".concat(c(w),"</b>")),k.length>0?"".concat(g).concat(k.join("<br>")).concat(E):""}function O(t){Array.from(new Set(t.map(function(t){return t.data.map(function(t){return Number(t[0])})}).flat())).sort(function(t,e){return t-e}).forEach(function(e,i){for(var n={},a={},s=t.length-1;s>=0;s--){var o,c,u,l,d,h,_=t[s].data[i],f=_&&"object"===(0,r.A)(_)&&"value"in _?_:{value:_},g=null===(o=f.value)||void 0===o?void 0:o[0],v=null!==(c=t[s].stack)&&void 0!==c?c:"";if(void 0!==g)if(Number(g)!==e)null===(h=t[s].data)||void 0===h||h.splice(i,0,{value:[e,0],itemStyle:{borderWidth:0}});else 0===(null===(u=f.value)||void 0===u?void 0:u[1])?t[s].data[i]=Object.assign(Object.assign({},f),{},{itemStyle:Object.assign(Object.assign({},f.itemStyle),{},{borderWidth:0})}):!n[v]&&(null===(l=f.value)||void 0===l?void 0:l[1])>0?(t[s].data[i]=Object.assign(Object.assign({},f),{},{itemStyle:Object.assign(Object.assign({},f.itemStyle),{},{borderRadius:[4,4,0,0]})}),n[v]=!0):!a[v]&&(null===(d=f.value)||void 0===d?void 0:d[1])<0&&(t[s].data[i]=Object.assign(Object.assign({},f),{},{itemStyle:Object.assign(Object.assign({},f.itemStyle),{},{borderRadius:[0,0,4,4]})}),a[v]=!0)}})}function j(t){var e,i=t&&"object"===(0,r.A)(t)&&"value"in t?t:{value:t};return Number(null===(e=i.value)||void 0===e?void 0:e[0])}function I(t){var e=Array.from(new Set(t.map(function(t){return t.data.map(function(t){return j(t)})}).flat())).sort(function(t,e){return t-e});return t.forEach(function(t){var i=new Map;t.data.forEach(function(t){var e=t&&"object"===(0,r.A)(t)&&"value"in t?t:{value:t},n=j(t);Number.isNaN(n)||i.set(n,e)}),t.data=e.map(function(t){var e;return null!==(e=i.get(t))&&void 0!==e?e:[t,0]})}),t}function D(t,e){if(!e)return function(t){return t};var i=(0,c.V)(t,e);if(0!==i&&t.getTime()===(0,u.D)(t).getTime())return function(t){return(0,l.e)(t,i)};var n=(0,d.W)(t,e);if(0!==n&&t.getTime()===(0,h.w)(t).getTime())return function(t){return(0,_.P)(t,n)};var r=(0,s.c)(t,e);if(0!==r&&t.getTime()===(0,f.o)(t).getTime())return function(t){return(0,g.f)(t,r)};var a=t.getTime()-e.getTime();return function(t){return(0,v.A)(t,a)}}[m,p,y]=S.then?(await S)():S,n()}catch(w){n(w)}})},3515:function(t,e,i){i.a(t,async function(t,n){try{i.r(e),i.d(e,{DEFAULT_DAYS_TO_SHOW:function(){return I},HuiStatisticsGraphCard:function(){return D}});var r,a,s,o=i(26520),c=i(72153),u=i(61397),l=i(50264),d=i(44734),h=i(43080),_=i(69683),f=i(6454),g=i(25460),v=(i(16280),i(28706),i(50113),i(23792),i(62062),i(18111),i(20116),i(7588),i(61701),i(26099),i(16034),i(3362),i(47764),i(23500),i(62953),i(40445)),y=i(6946),m=i(66708),p=i(96196),b=i(77845),S=i(94333),w=(i(76776),i(38114)),A=i(23528),k=i(37642),E=i(13632),T=i(784),x=i(20939),O=i(97372),j=t([w,O,A]);[w,O,A]=j.then?(await j)():j;var I=30,D=function(t){function e(){var t;(0,d.A)(this,e);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(t=(0,_.A)(this,e,[].concat(n)))._entities=[],t._entityIds=[],t._names={},t}return(0,f.A)(e,t),(0,h.A)(e,[{key:"disconnectedCallback",value:function(){(0,g.A)(e,"disconnectedCallback",this,3)([]),this._unsubscribeEnergy(),this._interval&&(clearInterval(this._interval),this._interval=void 0)}},{key:"connectedCallback",value:function(){var t;(0,g.A)(e,"connectedCallback",this,3)([]),this.hasUpdated&&(null!==(t=this._config)&&void 0!==t&&t.energy_date_selection?this._subscribeEnergy():void 0===this._interval&&this._setFetchStatisticsTimer(!0))}},{key:"_subscribeEnergy",value:function(){var t,e=this;this._energySub||(this._energySub=(0,w.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe(function(t){e._energyStart=t.start,e._energyEnd=t.end,e._getStatistics()}))}},{key:"_unsubscribeEnergy",value:function(){this._energySub&&(this._energySub(),this._energySub=void 0),this._energyStart=void 0,this._energyEnd=void 0}},{key:"getCardSize",value:function(){var t,e,i;return 5+(null!==(t=this._config)&&void 0!==t&&t.title?2:0)+(null!==(e=this._config)&&void 0!==e&&e.hide_legend?0:(null===(i=this._entities)||void 0===i?void 0:i.length)||0)}},{key:"getGridOptions",value:function(){return{columns:12,min_columns:6,min_rows:3}}},{key:"setConfig",value:function(t){if(!t.entities||!Array.isArray(t.entities))throw new Error("Entities need to be an array");if(!t.entities.length)throw new Error("You must include at least one entity");this._entities=t.entities?(0,x.L)(t.entities,!1):[],this._entityIds=this._entities.map(function(t){return t.entity}),"string"==typeof t.stat_types?this._statTypes=[t.stat_types]:t.stat_types?this._statTypes=t.stat_types:this._statTypes=["change","state","sum","min","max","mean"],this._config=t,this._computeNames()}},{key:"_computeNames",value:function(){var t=this;this.hass&&this._config&&(this._names={},this._entities.forEach(function(e){var i=t.hass.states[e.entity];t._names[e.entity]=(0,k.v)(t.hass,i,e.name)||e.entity}))}},{key:"shouldUpdate",value:function(t){return(0,T.pY)(this,t)||t.size>1||!t.has("hass")}},{key:"willUpdate",value:function(t){if((0,g.A)(e,"willUpdate",this,3)([t]),this._config&&t.has("_config")){var i=t.get("_config");if(this.hass){if(this._config.energy_date_selection&&!this._energySub)return void this._subscribeEnergy();if(!this._config.energy_date_selection&&this._energySub)return this._unsubscribeEnergy(),void this._setFetchStatisticsTimer();this._config.energy_date_selection&&this._energySub&&t.has("_config")&&(null==i?void 0:i.collection_key)!==this._config.collection_key&&(this._unsubscribeEnergy(),this._subscribeEnergy())}t.has("hass")&&this._computeNames(),t.has("_config")&&(null==i?void 0:i.entities)!==this._config.entities?this._setFetchStatisticsTimer(!0):!t.has("_config")||(null==i?void 0:i.stat_types)===this._config.stat_types&&(null==i?void 0:i.days_to_show)===this._config.days_to_show&&(null==i?void 0:i.period)===this._config.period&&(null==i?void 0:i.unit)===this._config.unit||this._setFetchStatisticsTimer()}}},{key:"_setFetchStatisticsTimer",value:(b=(0,l.A)((0,u.A)().m(function t(){var e,i,n=this,r=arguments;return(0,u.A)().w(function(t){for(;;)switch(t.n){case 0:if(i=r.length>0&&void 0!==r[0]&&r[0],clearInterval(this._interval),this._interval=0,!i){t.n=1;break}return t.n=1,this._getStatisticsMetaData(this._entityIds);case 1:return t.n=2,this._getStatistics();case 2:null!==(e=this._config)&&void 0!==e&&e.energy_date_selection||(this._interval=window.setInterval(function(){return n._getStatistics()},this._intervalTimeout));case 3:return t.a(2)}},t,this)})),function(){return b.apply(this,arguments)})},{key:"_period",get:function(){var t,e;return null!==(t=null===(e=this._config)||void 0===e?void 0:e.period)&&void 0!==t?t:this._energyStart&&this._energyEnd?(0,O.TI)((0,y.c)(this._energyEnd,this._energyStart)):void 0}},{key:"render",value:function(){var t,e;if(!this.hass||!this._config)return p.s6;var i="number"==typeof(null===(t=this._config.grid_options)||void 0===t?void 0:t.rows);return(0,p.qy)(r||(r=(0,c.A)([" <ha-card> ",' <div class="content ','"> <statistics-chart .hass="','" .isLoadingData="','" .statisticsData="','" .metadata="','" .period="','" .chartType="','" .statTypes="','" .names="','" .unit="','" .minYAxis="','" .maxYAxis="','" .startTime="','" .endTime="','" .fitYData="','" .hideLegend="','" .logarithmicScale="','" .daysToShow="','" .height="','" .expandLegend="','"></statistics-chart> </div> </ha-card> '])),this._config.title?(0,p.qy)(a||(a=(0,c.A)(['<h1 class="card-header">',"</h1>"])),this._config.title):p.s6,(0,S.H)({"has-header":!!this._config.title,"has-rows":!(null===(e=this._config.grid_options)||void 0===e||!e.rows)}),this.hass,!this._statistics,this._statistics,this._metadata,this._period,this._config.chart_type||"line",this._statTypes,this._names,this._unit,this._config.min_y_axis,this._config.max_y_axis,this._energyStart,this._energyEnd&&this._energyStart?(0,O.Gs)((0,y.c)(this._energyEnd,this._energyStart),this._energyEnd):void 0,this._config.fit_y_data||!1,this._config.hide_legend||!1,this._config.logarithmic_scale||!1,this._energyStart&&this._energyEnd?(0,y.c)(this._energyEnd,this._energyStart):this._config.days_to_show||I,i?"100%":void 0,this._config.expand_legend)}},{key:"_intervalTimeout",get:function(){var t;return 1e3*("5minute"===(null===(t=this._config)||void 0===t?void 0:t.period)?5:60)*60}},{key:"_getStatisticsMetaData",value:(v=(0,l.A)((0,u.A)().m(function t(e){var i,n;return(0,u.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,(0,A.Wr)(this.hass,e);case 1:i=t.v,n={},i.forEach(function(t){n[t.statistic_id]=t}),this._metadata=n;case 2:return t.a(2)}},t,this)})),function(t){return v.apply(this,arguments)})},{key:"_getStatistics",value:(s=(0,l.A)((0,u.A)().m(function t(){var e,i,n,r,a,s,c,l,d=this;return(0,u.A)().w(function(t){for(;;)switch(t.p=t.n){case 0:return i=null!==(e=this._energyStart)&&void 0!==e?e:(0,m.O)(new Date,24*(this._config.days_to_show||I)+1),n=this._energyEnd,t.p=1,this._config.unit&&this._metadata&&(a=Object.values(this._metadata).find(function(t){return(0,A.JE)(d.hass,null==t?void 0:t.statistic_id,t)===d._config.unit}))&&(r=a.unit_class,this._unit=this._config.unit),!r&&this._metadata&&(s=this._metadata[this._entityIds[0]],r=null==s?void 0:s.unit_class,this._unit=r&&(0,A.JE)(this.hass,s.statistic_id,s)||void 0),c=r?(0,o.A)({},r,this._unit):void 0,t.n=2,(0,A.sz)(this.hass,i,n,this._entityIds,this._period,c,this._statTypes);case 2:l=t.v,this._statistics={},this._entities.forEach(function(t){var e=t.entity;e in l&&(d._statistics[e]=l[e])}),t.n=4;break;case 3:t.p=3,t.v,this._statistics=void 0;case 4:return t.a(2)}},t,this,[[1,3]])})),function(){return s.apply(this,arguments)})}],[{key:"getConfigElement",value:(n=(0,l.A)((0,u.A)().m(function t(){return(0,u.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Promise.all([i.e("44533"),i.e("92769"),i.e("44966"),i.e("38919"),i.e("80445"),i.e("19260"),i.e("47413"),i.e("88537"),i.e("47104")]).then(i.bind(i,9562));case 1:return t.a(2,document.createElement("hui-statistics-graph-card-editor"))}},t)})),function(){return n.apply(this,arguments)})},{key:"getStubConfig",value:function(t,e,i){var n=(0,E.B)(t,1,e,i,["sensor"],function(t){return"state_class"in t.attributes});return{type:"statistics-graph",entities:n.length?[n[0]]:[]}}}]);var n,s,v,b}(p.WF);D.styles=(0,p.AH)(s||(s=(0,c.A)(["ha-card{display:flex;flex-direction:column;height:100%}.card-header{padding-bottom:0}.content{padding:16px;flex:1}.has-header{padding-top:0}statistics-chart{height:100%}.has-rows{--chart-max-height:100%}"]))),(0,v.__decorate)([(0,b.MZ)({attribute:!1})],D.prototype,"hass",void 0),(0,v.__decorate)([(0,b.wk)()],D.prototype,"_config",void 0),(0,v.__decorate)([(0,b.wk)()],D.prototype,"_statistics",void 0),(0,v.__decorate)([(0,b.wk)()],D.prototype,"_metadata",void 0),(0,v.__decorate)([(0,b.wk)()],D.prototype,"_unit",void 0),(0,v.__decorate)([(0,b.wk)()],D.prototype,"_energyStart",void 0),(0,v.__decorate)([(0,b.wk)()],D.prototype,"_energyEnd",void 0),D=(0,v.__decorate)([(0,b.EM)("hui-statistics-graph-card")],D),n()}catch(C){n(C)}})},49340:function(t){var e=Math.log,i=Math.LOG10E;t.exports=Math.log10||function(t){return e(t)*i}},75376:function(t,e,i){i(46518)({target:"Math",stat:!0},{log10:i(49340)})},13611:function(t,e,i){var n=i(46518),r=i(22195),a=i(62106),s=i(43724),o=TypeError,c=Object.defineProperty,u=r.self!==r;try{if(s){var l=Object.getOwnPropertyDescriptor(r,"self");!u&&l&&l.get&&l.enumerable||a(r,"self",{get:function(){return r},set:function(t){if(this!==r)throw new o("Illegal invocation");c(r,"self",{value:t,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else n({global:!0,simple:!0,forced:u},{self:r})}catch(d){}},56434:function(t,e,i){i.d(e,{e:function(){return r}});var n=i(81977);function r(t,e,i){return(0,n.P)(t,12*e,i)}},98487:function(t,e,i){i.d(e,{V:function(){return o}});var n=i(78261),r=i(74816),a=i(95785);function s(t,e,i){var a=(0,r.x)(null==i?void 0:i.in,t,e),s=(0,n.A)(a,2),o=s[0],c=s[1];return o.getFullYear()-c.getFullYear()}function o(t,e,i){var o=(0,r.x)(null==i?void 0:i.in,t,e),c=(0,n.A)(o,2),u=c[0],l=c[1],d=(0,a.z)(u,l),h=Math.abs(s(u,l));u.setFullYear(1584),l.setFullYear(1584);var _=d*(h-+((0,a.z)(u,l)===-d));return 0===_?0:_}}}]);
//# sourceMappingURL=6434.38b248cb6d68f657.js.map