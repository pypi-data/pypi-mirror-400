var L=Object.defineProperty;var n=(m,f)=>L(m,"name",{value:f,configurable:!0});import{defineComponent as R,ref as W,computed as g,watch as $,onUnmounted as B,openBlock as r,createElementBlock as d,Fragment as O,createElementVNode as t,toDisplayString as c,createCommentVNode as C,createVNode as u,unref as a,mergeProps as F}from"vue";import h from"primevue/button";import j from"primevue/select";import{c as P}from"./useWidgetValue-BBcazAQ2.js";import{u as E}from"./useTransformCompatOverlayProps-DkwHb7jz.js";const N={key:0,class:"relative -mx-2",style:{width:"calc(100% + 1rem)"}},A={class:"mb-2 flex items-center justify-between gap-4 px-2"},S={key:0,class:"text-secondary min-w-[4em] truncate text-xs"},T={class:"flex items-center gap-1"},D={class:"group relative"},K=["src","alt"],q={class:"absolute top-2 right-2 flex gap-1 opacity-0 transition-opacity duration-200 group-hover:opacity-100"},G=["aria-label"],H=["aria-label"],J={key:1,class:"relative -mx-2",style:{width:"calc(100% + 1rem)"}},M={class:"mb-2 flex items-center justify-between gap-4 px-2"},Q={key:0,class:"text-secondary min-w-[4em] truncate text-xs"},X={class:"flex items-center gap-1"},Y={class:"group relative px-2"},Z={class:"flex items-center gap-4 rounded-lg bg-charcoal-800 p-4",style:{border:"1px solid #262729"}},ee={class:"flex-1"},te={class:"mb-1 text-sm font-medium"},le={class:"text-xs opacity-60"},oe={class:"flex gap-1"},se=["aria-label"],ae={key:2,class:"flex w-full flex-col gap-1 rounded-lg border border-solid p-1",style:{borderColor:"#262729"}},ie={class:"rounded-md border border-dashed p-1 transition-colors duration-200 hover:border-slate-300",style:{borderColor:"#262729"}},ne={class:"flex w-full flex-col items-center gap-2 py-4"},re={class:"text-xs opacity-60"},de=["accept","aria-label"],ve=R({__name:"WidgetFileUpload",props:{widget:{},modelValue:{}},emits:["update:modelValue"],setup(m,{emit:f}){const z=f,{localValue:b,onChange:x}=P({widget:m.widget,modelValue:m.modelValue,defaultValue:null,emit:z}),w=E(),i=W(null),o=g(()=>{const e=b.value||[];return e.length>0?e[0]:null}),y=n(e=>{const l=e.type?.toLowerCase()||"",s=e.name?.toLowerCase()||"";return l.startsWith("image/")||s.match(/\.(jpg|jpeg|png|gif|webp|svg)$/)?"image":l.startsWith("video/")||s.match(/\.(mp4|webm|ogg|mov)$/)?"video":l.startsWith("audio/")||s.match(/\.(mp3|wav|ogg|flac)$/)?"audio":l==="application/pdf"||s.endsWith(".pdf")?"pdf":l.includes("zip")||s.match(/\.(zip|rar|7z|tar|gz)$/)?"archive":"file"},"detectFileType"),_=g(()=>o.value&&y(o.value)==="image"),U=g(()=>o.value&&y(o.value)==="audio"),p=g(()=>_.value&&o.value?URL.createObjectURL(o.value):"");$(p,(e,l)=>{l&&l!==e&&URL.revokeObjectURL(l)});const v=n(()=>{i.value?.click()},"triggerFileInput"),V=n(e=>{const l=e.target;if(l.files&&l.files.length>0){const s=l.files[0];x([s]),l.value=""}},"handleFileChange"),k=n(()=>{x(null),i.value&&(i.value.value="")},"clearFile"),I=n(()=>{},"handleEdit");return $(b,e=>{(!e||e.length===0)&&i.value&&(i.value.value="")}),B(()=>{p.value&&URL.revokeObjectURL(p.value)}),(e,l)=>(r(),d(O,null,[_.value?(r(),d("div",N,[t("div",A,[e.widget.name?(r(),d("label",S,c(e.widget.name),1)):C("",!0),t("div",T,[u(a(j),F({"model-value":o.value?.name,options:[o.value?.name||""],disabled:!0,"aria-label":`${e.$t("g.selectedFile")}: ${o.value?.name||e.$t("g.none")}`},a(w),{class:"max-w-[20em] min-w-[8em] text-xs",size:"small",pt:{option:"text-xs",dropdownIcon:"text-component-node-foreground-secondary"}}),null,16,["model-value","options","aria-label"]),u(a(h),{icon:"pi pi-folder",size:"small",class:"!h-8 !w-8",onClick:v})])]),t("div",D,[t("img",{src:p.value,alt:o.value?.name,class:"h-auto w-full"},null,8,K),l[2]||(l[2]=t("div",{class:"bg-opacity-0 group-hover:bg-opacity-20 pointer-events-none absolute inset-0 bg-black transition-all duration-200"},null,-1)),t("div",q,[t("button",{"aria-label":e.$t("g.editImage"),class:"flex h-6 w-6 items-center justify-center rounded border-none transition-all duration-150 focus:outline-none",style:{"background-color":"#262729"},onClick:I},l[0]||(l[0]=[t("i",{class:"pi pi-pencil text-xs text-white"},null,-1)]),8,G),t("button",{"aria-label":e.$t("g.deleteImage"),class:"flex h-6 w-6 items-center justify-center rounded border-none transition-all duration-150 focus:outline-none",style:{"background-color":"#262729"},onClick:k},l[1]||(l[1]=[t("i",{class:"pi pi-times text-xs text-white"},null,-1)]),8,H)])])])):U.value?(r(),d("div",J,[t("div",M,[e.widget.name?(r(),d("label",Q,c(e.widget.name),1)):C("",!0),t("div",X,[u(a(j),F({"model-value":o.value?.name,options:[o.value?.name||""],disabled:!0,"aria-label":`${e.$t("g.selectedFile")}: ${o.value?.name||e.$t("g.none")}`},a(w),{class:"max-w-[20em] min-w-[8em] text-xs",size:"small",pt:{option:"text-xs",dropdownIcon:"text-component-node-foreground-secondary"}}),null,16,["model-value","options","aria-label"]),u(a(h),{icon:"pi pi-folder",size:"small",class:"!h-8 !w-8",onClick:v})])]),t("div",Y,[t("div",Z,[l[4]||(l[4]=t("div",{class:"flex-shrink-0"},[t("i",{class:"pi pi-volume-up text-2xl opacity-60"})],-1)),t("div",ee,[t("div",te,c(o.value?.name),1),t("div",le,c(o.value?(o.value.size/1024).toFixed(1)+" KB":""),1)]),t("div",oe,[t("button",{"aria-label":e.$t("g.deleteAudioFile"),class:"flex h-8 w-8 items-center justify-center rounded border-none transition-all duration-150 hover:bg-charcoal-600 focus:outline-none",onClick:k},l[3]||(l[3]=[t("i",{class:"pi pi-times text-sm text-white"},null,-1)]),8,se)])])])])):(r(),d("div",ae,[t("div",ie,[t("div",ne,[t("span",re,c(e.$t("widgetFileUpload.dropPrompt")),1),t("div",null,[u(a(h),{label:e.$t("widgetFileUpload.browseFiles"),size:"small",severity:"secondary",class:"text-xs",onClick:v},null,8,["label"])])])])])),t("input",{ref_key:"fileInputRef",ref:i,type:"file",class:"hidden",accept:e.widget.options?.accept,"aria-label":`${e.$t("g.upload")} ${e.widget.name||e.$t("g.file")}`,multiple:!1,onChange:V},null,40,de)],64))}});export{ve as default};
//# sourceMappingURL=WidgetFileUpload-7oPJOFQQ.js.map
