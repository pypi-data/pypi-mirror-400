[build-system]
requires = ["poetry-core>=2.0.0,<3.0.0"]
build-backend = "poetry.core.masonry.api"

[project]
authors = [
    {name = "Clemens Burgstaller", email = "burgstaller@ift.at"},
    {name = "Christoph Mayer", email = "mayer@ift.at"},
    {name = "RenÃ© Schwaiger", email = "rene.schwaiger@ift.at"},
]
classifiers = [
    "Development Status :: 3 - Alpha",
    "Natural Language :: English",
    "Operating System :: MacOS",
    "Operating System :: POSIX :: Linux",
    "Operating System :: Microsoft :: Windows :: Windows 11",
    "Programming Language :: Python",
]

dependencies = [
  "bidict>=0.22.1,<2",
  # We install `blosc2` for Python/OS versions where no binary package
  # (wheel) of `tables` is available.
  "blosc2>=2.3.0",
  "dynaconf>=3.1.12,<4",
  "netaddr>=0.8.0,<2",
  "platformdirs>=3.5.0,<5",
  "python-can[pcan]>=4,<5",
  "tables>=3.10.1,<4",
  "tqdm>=4.65,<5",
  "semantic_version>=2.10,<3",
  "universal-startfile>=0.4",
]
description = """Control software for sensory tool holders (STH), \
                 sensor milling heads (SMH) and stationary transceiver units \
                 (STU)"""
keywords = [
    "smart-tool",
    "smh",
    "stu",
    "sth",
    "tool-holder",
]
name = "icotronic"
readme = "ReadMe.md"
requires-python = ">=3.12,<4"
version = "6.2.0"

[project.optional-dependencies]
dev = [
    "coverage>=7.8.2",
    "Flake8-pyproject>=1.2.3",
    "icolyzer>=1.5.0", # Require ICOlyzer for Prysk tests
    "mypy",
    "prysk[pytest-plugin]>=0.15.1",
    "pydoclint[flake8]>=0.6.6",
    "pylint>=3.3.1",
    "pytest-asyncio",
    "pytest-sphinx",
    "pytest-sugar>=1.1.1",
    "pytest-rerunfailures>=16.1",
    "sphinx>=9,<10",
    "sphinx_rtd_theme>=3.1.0rc1",
    "sphinx_toggleprompt>=0.6.0",
    "sphinx-autodoc-typehints>=3",
    "toml",
]

[project.scripts]
icon = "icotronic.scripts.icon:main"

[project.urls]
Documentation = "https://mytoolit.github.io/ICOtronic/"
Source = "https://github.com/mytoolit/ICOtronic/"

[tool.black]
line-length = 79
preview = true
unstable = true
enable-unstable-feature = ["string_processing"]

[tool.flake8]

ignore = [
  # Whitespace before colon
  "E203",
  # Module level import not at top of file
  "E402",
  # Line break before binary operator
  "W503",
  # Line break after binary operator
  "W504"
]
per-file-ignores = "__init__.py:F401"
exclude = [
  ".git",
  ".venv",
  "__pycache__",
  "._*",
  "Documentation",
]

[tool.mypy]
ignore_missing_imports = true

[tool.pylint]
ignore-paths = [ ".venv/.*$" ]

[tool.pytest.ini_options]
asyncio_mode = "auto"
# - Use doctests
# - Ignore macOS metadata files
# - Ignore Bookdown output
# - Verbose output
addopts = "--doctest-modules --ignore-glob='*._*.py' --ignore=Bookdown"
minversion = "6.0"
