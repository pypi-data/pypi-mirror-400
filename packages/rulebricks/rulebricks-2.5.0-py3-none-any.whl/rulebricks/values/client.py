# This file was auto-generated by Fern from our API Definition.

import typing

from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.request_options import RequestOptions
from ..types.dynamic_value_list_response import DynamicValueListResponse
from ..types.success_message import SuccessMessage
from .raw_client import AsyncRawValuesClient, RawValuesClient

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class ValuesClient:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawValuesClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawValuesClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawValuesClient
        """
        return self._raw_client

    def list(
        self,
        *,
        name: typing.Optional[str] = None,
        include: typing.Optional[str] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> DynamicValueListResponse:
        """
        Retrieve all dynamic values for the authenticated user. Use the 'include' parameter to control whether usage information is returned.

        Parameters
        ----------
        name : typing.Optional[str]
            Query all dynamic values containing a specific name

        include : typing.Optional[str]
            Comma-separated list of additional data to include. Use 'usage' to include which rules reference each value.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        DynamicValueListResponse
            Success

        Examples
        --------
        from rulebricks import Rulebricks

        client = Rulebricks(
            api_key="YOUR_API_KEY",
        )
        client.values.list(
            include="usage",
        )
        """
        _response = self._raw_client.list(name=name, include=include, request_options=request_options)
        return _response.data

    def update(
        self,
        *,
        values: typing.Dict[str, typing.Any],
        user_groups: typing.Optional[typing.Sequence[str]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> DynamicValueListResponse:
        """
        Update existing dynamic values or add new ones for the authenticated user. Supports both flat and nested object structures. Nested objects are automatically flattened using dot notation and keys are converted to readable format (e.g., 'user_name' becomes 'User Name', nested 'user.contact_info.email' becomes 'User.Contact Info.Email').

        Parameters
        ----------
        values : typing.Dict[str, typing.Any]
            A dictionary of keys and values to update or add. Supports both flat key-value pairs and nested objects. Nested objects will be automatically flattened using dot notation with readable key names (e.g., 'user.contact_info.email' becomes 'User.Contact Info.Email').

        user_groups : typing.Optional[typing.Sequence[str]]
            Optional array of user group names or IDs. If omitted and user belongs to user groups, values will be assigned to all user's user groups. Required if values should be restricted to specific user groups.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        DynamicValueListResponse
            Success

        Examples
        --------
        from rulebricks import Rulebricks

        client = Rulebricks(
            api_key="YOUR_API_KEY",
        )
        client.values.update(
            values={
                "Favorite Color": "blue",
                "Age": 30,
                "Is Student": False,
                "Hobbies": ["reading", "cycling"],
            },
            user_groups=["marketing", "developers"],
        )
        """
        _response = self._raw_client.update(values=values, user_groups=user_groups, request_options=request_options)
        return _response.data

    def delete(self, *, id: str, request_options: typing.Optional[RequestOptions] = None) -> SuccessMessage:
        """
        Delete a specific dynamic value for the authenticated user by its ID.

        Parameters
        ----------
        id : str
            ID of the dynamic value to delete

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        SuccessMessage
            Success

        Examples
        --------
        from rulebricks import Rulebricks

        client = Rulebricks(
            api_key="YOUR_API_KEY",
        )
        client.values.delete(
            id="id",
        )
        """
        _response = self._raw_client.delete(id=id, request_options=request_options)
        return _response.data


class AsyncValuesClient:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawValuesClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawValuesClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawValuesClient
        """
        return self._raw_client

    async def list(
        self,
        *,
        name: typing.Optional[str] = None,
        include: typing.Optional[str] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> DynamicValueListResponse:
        """
        Retrieve all dynamic values for the authenticated user. Use the 'include' parameter to control whether usage information is returned.

        Parameters
        ----------
        name : typing.Optional[str]
            Query all dynamic values containing a specific name

        include : typing.Optional[str]
            Comma-separated list of additional data to include. Use 'usage' to include which rules reference each value.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        DynamicValueListResponse
            Success

        Examples
        --------
        import asyncio

        from rulebricks import AsyncRulebricks

        client = AsyncRulebricks(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.values.list(
                include="usage",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.list(name=name, include=include, request_options=request_options)
        return _response.data

    async def update(
        self,
        *,
        values: typing.Dict[str, typing.Any],
        user_groups: typing.Optional[typing.Sequence[str]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> DynamicValueListResponse:
        """
        Update existing dynamic values or add new ones for the authenticated user. Supports both flat and nested object structures. Nested objects are automatically flattened using dot notation and keys are converted to readable format (e.g., 'user_name' becomes 'User Name', nested 'user.contact_info.email' becomes 'User.Contact Info.Email').

        Parameters
        ----------
        values : typing.Dict[str, typing.Any]
            A dictionary of keys and values to update or add. Supports both flat key-value pairs and nested objects. Nested objects will be automatically flattened using dot notation with readable key names (e.g., 'user.contact_info.email' becomes 'User.Contact Info.Email').

        user_groups : typing.Optional[typing.Sequence[str]]
            Optional array of user group names or IDs. If omitted and user belongs to user groups, values will be assigned to all user's user groups. Required if values should be restricted to specific user groups.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        DynamicValueListResponse
            Success

        Examples
        --------
        import asyncio

        from rulebricks import AsyncRulebricks

        client = AsyncRulebricks(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.values.update(
                values={
                    "Favorite Color": "blue",
                    "Age": 30,
                    "Is Student": False,
                    "Hobbies": ["reading", "cycling"],
                },
                user_groups=["marketing", "developers"],
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.update(
            values=values, user_groups=user_groups, request_options=request_options
        )
        return _response.data

    async def delete(self, *, id: str, request_options: typing.Optional[RequestOptions] = None) -> SuccessMessage:
        """
        Delete a specific dynamic value for the authenticated user by its ID.

        Parameters
        ----------
        id : str
            ID of the dynamic value to delete

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        SuccessMessage
            Success

        Examples
        --------
        import asyncio

        from rulebricks import AsyncRulebricks

        client = AsyncRulebricks(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.values.delete(
                id="id",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.delete(id=id, request_options=request_options)
        return _response.data
