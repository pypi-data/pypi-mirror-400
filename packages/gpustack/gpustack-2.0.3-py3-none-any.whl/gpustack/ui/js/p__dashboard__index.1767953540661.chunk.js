(self.webpackChunk=self.webpackChunk||[]).push([[4931],{85882:function(e,t,n){"use strict";var a,r=n(26068),o=n.n(r),i=n(48305),l=n.n(i),s=n(67825),u=n.n(s),c=n(53649),d=n.n(c),h=n(15409),m=n(68652),p=n(32699),f=n(75271),v=n(67585),g=n(3453),x=n(52676),b=["children","maxWidth","minWidth","ghost","title","showTitle","tooltipProps","radius","filled"],y=(0,v.ZP)(m.Z)(a||(a=d()(["\n  margin: 0;\n  &.tag-filled {\n    border: none;\n    background-color: var(--ant-color-fill-secondary);\n  }\n"]))),_=function(e){var t=e.children,n=e.maxWidth,a=void 0===n?"100%":n,r=e.minWidth,i=e.ghost,s=void 0!==i&&i,c=e.title,d=e.showTitle,m=void 0!==d&&d,v=e.tooltipProps,_=e.radius,k=void 0===_?12:_,w=e.filled,j=void 0!==w&&w,C=u()(e,b),D=(0,f.useRef)(null),Z=(0,f.useState)(!1),M=l()(Z,2),S=M[0],T=M[1],P=(0,f.useRef)(null),A=(0,f.useCallback)((function(){if(D.current){var e=D.current,t=e.scrollWidth,n=e.clientWidth;T(t>n)}}),[D.current]);(0,f.useEffect)((function(){var e,t,n=D.current;if(n)return null===(e=P.current)||void 0===e||e.disconnect(),P.current=new ResizeObserver((function(){A()})),null===(t=P.current)||void 0===t||t.observe(n),A(),function(){var e;null===(e=P.current)||void 0===e||e.disconnect(),P.current=null}}),[A]),(0,f.useEffect)((function(){var e=(0,p.throttle)(A,200);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e),e.cancel()}}),[A]),(0,f.useEffect)((function(){A()}),[t,A]);var I=(0,f.useMemo)((function(){return o()({maxWidth:a,minWidth:r,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},C.style)}),[a,C.style]);return(0,x.jsx)(g.$R,{toolTipProps:o()(o()({},v),{},{destroyOnHidden:!1}),title:!(!S&&!m)&&(c||t),children:s?(0,x.jsx)("div",{ref:D,style:I,"data-overflow":S,children:t}):(0,x.jsx)(y,o()(o()({},C),{},{className:"".concat(C.className||""," ").concat(j?"tag-filled":""),ref:D,style:o()({paddingInline:C.closable?"8px 22px":8,borderRadius:k},I),closeIcon:!!C.closable&&(0,x.jsx)(h.Z,{style:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)"}}),children:t}))})};t.Z=f.memo(_)},72742:function(e,t,n){"use strict";var a,r=n(26068),o=n.n(r),i=n(53649),l=n.n(i),s=n(53231),u=n(18843),c=n(79635),d=(n(75271),n(67585)),h=n(52676),m=d.ZP.div(a||(a=l()(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 20px;\n"])));t.Z=function(e){var t=e.onOk,n=e.onCancel,a=e.cancelText,r=e.okText,i=e.okBtnProps,l=e.cancelBtnProps,d=e.loading,p=e.htmlType,f=void 0===p?"button":p,v=e.style,g=e.showOkBtn,x=void 0===g||g,b=e.description,y=e.extra,_=e.showCancelBtn,k=void 0===_||_,w=(e.form,(0,s.useIntl)());return(0,h.jsxs)(m,{children:[(0,h.jsx)("div",{children:b}),(0,h.jsxs)(u.Z,{size:20,style:o()({},v),children:[k&&(0,h.jsx)(c.ZP,o()(o()({onClick:n,style:{width:"88px"}},l),{},{children:a||w.formatMessage({id:"common.button.cancel"})})),y,x&&(0,h.jsx)(c.ZP,o()(o()({type:"primary",onClick:t,style:{width:"88px"},loading:d,htmlType:f},i),{},{children:r||w.formatMessage({id:"common.button.save"})}))]})]})}},3453:function(e,t,n){"use strict";n.d(t,{$R:function(){return x},QR:function(){return g}});var a,r=n(67825),o=n.n(r),i=n(26068),l=n.n(i),s=n(53649),u=n.n(s),c=n(2825),d=n(25408),h=n(75271),m=n(67585),p=n(52676),f=["styles"],v=m.ZP.div(a||(a=u()(["\n  max-height: ",";\n  overflow-y: auto;\n  width: 100%;\n"])),(function(e){var t=e.$maxHeight;return"number"==typeof t?"".concat(t,"px"):t})),g=function(e){var t=e.children,n=e.maxHeight,a=e.scrollbars,r=e.oppositeTheme,o=e.style,i=e.onScroll,s=h.useRef(null),u=(0,c.Z)({options:{scrollbars:a,oppositeTheme:r}}).initialize;return h.useEffect((function(){s.current&&u(s.current)}),[]),(0,p.jsx)(v,{ref:s,"data-overlayscrollbars-initialize":!0,className:"overlay-scroller-wrapper",$maxHeight:n||200,hidden:!1,onWheel:i,style:l()({paddingInlineStart:8,paddingInlineEnd:8},o),children:t})},x=function(e){var t=e.children,n=e.maxHeight,a=e.title,r=e.toolTipProps,i=e.scrollbars,s=e.oppositeTheme,u=r||{},c=u.styles,h=o()(u,f);return(0,p.jsx)(d.Z,l()(l()({styles:l()(l()({},c),{},{body:l()({paddingInline:0},null==c?void 0:c.body)}),title:a&&(0,p.jsx)(g,{scrollbars:l()(l()({},i),{},{theme:"os-theme-light"}),maxHeight:n,oppositeTheme:s,children:a})},h),{},{children:t}))};t.ZP=g},3108:function(e,t,n){"use strict";n.d(t,{f:function(){return g},Z:function(){return x}});var a=n(91780),r=n(83843),o=n(17114),i=n(38913),l=n(67618),s=n(37565),u=n(53231),c=n(18843),d=n(79635),h=n(97014),m=n(75271),p=n(88256),f=n(52676),v=function(e){var t=e.left,n=e.right,a=e.marginBottom,r=void 0===a?0:a,o=e.marginTop,i=void 0===o?30:o,l=e.style,s=(0,m.useMemo)((function(){var e={};return e.marginBottom="".concat(r,"px"),e.marginTop="".concat(i,"px"),l&&Object.assign(e,l),e}),[r,i,l]);return(0,f.jsxs)("div",{className:"page-tools",style:s,children:[(0,f.jsx)("div",{className:"left",children:t}),(0,f.jsx)("div",{className:"right",children:n})]})},g=function(e){var t=e.handleInputChange,n=e.handleSelectChange,g=e.handleSearch,x=e.handleDeleteByBatch,b=void 0===x?null:x,y=e.handleClickPrimary,_=void 0===y?null:y,k=e.rowSelection,w=e.actionItems,j=void 0===w?[]:w,C=e.selectOptions,D=e.showSelect,Z=e.buttonText,M=e.buttonIcon,S=e.actionType,T=void 0===S?"button":S,P=e.marginBottom,A=void 0===P?10:P,I=(e.marginTop,e.inputHolder),L=e.selectHolder,E=e.right,R=(e.left,e.width),Y=(0,u.useIntl)(),z=(0,m.useMemo)((function(){var e,t,n,l;return _||b?(0,f.jsxs)(c.Z,{size:20,children:[_?"dropdown"===T?(0,f.jsx)(a.Z,{menu:{items:j,onClick:_},children:(0,f.jsx)(d.ZP,{icon:(0,f.jsx)(r.Z,{}),type:"primary",iconPosition:"end",children:Z})}):(0,f.jsx)(d.ZP,{icon:null!=M?M:(0,f.jsx)(o.Z,{}),type:"primary",onClick:_,children:Z}):null,b&&(0,f.jsx)(d.ZP,{icon:(0,f.jsx)(i.Z,{}),danger:!0,onClick:b,disabled:!(null!=k&&null!==(e=k.selectedRowKeys)&&void 0!==e&&e.length),children:(0,f.jsxs)("span",{children:[null==Y||null===(t=Y.formatMessage)||void 0===t?void 0:t.call(Y,{id:"common.button.delete"}),(null==k||null===(n=k.selectedRowKeys)||void 0===n?void 0:n.length)>0&&(0,f.jsxs)("span",{children:["(",null==k||null===(l=k.selectedRowKeys)||void 0===l?void 0:l.length,")"]})]})})]}):null}),[j,T,null==k?void 0:k.selectedRowKeys,_,Y]);return(0,f.jsx)(v,{marginBottom:A,marginTop:0,left:(0,f.jsxs)(c.Z,{children:[(0,f.jsx)(h.Z,{prefix:(0,f.jsx)(l.Z,{style:{color:"var(--ant-color-text-placeholder)"}}),placeholder:I||Y.formatMessage({id:"common.filter.name"}),style:{width:(null==R?void 0:R.input)||230},allowClear:!0,onChange:t}),D&&(0,f.jsx)(p.Z,{allowClear:!0,showSearch:!1,placeholder:L,style:{width:(null==R?void 0:R.select)||230},size:"large",onChange:n,options:C}),(0,f.jsx)(d.ZP,{type:"text",style:{color:"var(--ant-color-text-tertiary)"},onClick:g,icon:(0,f.jsx)(s.Z,{})})]}),right:E||z})},x=v},1503:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var a,r,o=n(26068),i=n.n(o),l=n(53649),s=n.n(l),u=n(21363),c=n(2825),d=n(950),h=n(75271),m=n(67585),p=(0,h.createContext)({scrollToBottom:function(){}}),f=n(52676),v=m.ZP.div(a||(a=s()(["\n  max-height: ",";\n  overflow-y: auto;\n  width: 100%;\n"])),(function(e){var t=e.$maxHeight;return"number"==typeof t?"".concat(t,"px"):t})),g=m.ZP.div(r||(r=s()(["\n  display: flex;\n  align-items: center;\n  max-width: 360px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n"]))),x=function(e){var t=h.useRef(null),n=(0,u.Z)(),a=n.saveScrollHeight,r=n.restoreScrollHeight,o=(0,c.Z)(),l=o.initialize,s=o.destroyInstance,m=o.scrollToBottom;return h.useEffect((function(){e.open?a():r()}),[e.open]),h.useEffect((function(){var n=null;return e.open&&(n=setTimeout((function(){t.current&&l(t.current)}),100)),function(){n&&clearTimeout(n),s()}}),[e.open,l]),(0,f.jsx)(d.Z,i()(i()({},e),{},{title:(0,f.jsx)(g,{children:e.title}),destroyOnHidden:!0,styles:{content:{padding:0},header:{padding:"var(--ant-modal-content-padding)",paddingBottom:"0"},body:{padding:"0",paddingBlockEnd:e.footer?"0":"24px"},footer:e.footer?{padding:"12px 24px 24px",margin:"0"}:{}},children:(0,f.jsx)(p.Provider,{value:{scrollToBottom:m},children:(0,f.jsx)(v,{ref:t,"data-overlayscrollbars-initialize":!0,className:"overlay-scroller-wrapper",$maxHeight:e.maxContentHeight||500,hidden:!1,style:{paddingInline:24,paddingBlockEnd:0},children:e.children})})}))}},91962:function(e,t){"use strict";t.Z={xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1600}},21363:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(75271);function r(){var e=a.useRef(0),t=a.useRef({}),n=a.useRef(null),r=a.useRef(null),o=a.useRef(null),i=function(){var e;n.current=null===(e=window.__GPUSTACK_BODY_SCROLLER__)||void 0===e||null===(e=e.elements())||void 0===e?void 0:e.scrollEventElement,r.current=window.__GPUSTACK_BODY_SCROLLER__},l=a.useCallback((function(){var a,o,l,s;n.current||i(),t.current=null===(a=r.current)||void 0===a?void 0:a.state();var u=null===(o=t.current)||void 0===o||null===(o=o.overflowAmount)||void 0===o?void 0:o.y;e.current=u,null===(l=r.current)||void 0===l||null===(s=l.options)||void 0===s||s.call(l,{overflow:{x:"hidden",y:"visible"}})}),[]),s=a.useCallback((function(){o.current&&clearTimeout(o.current),o.current=setTimeout((function(){var e,t;null===(e=r.current)||void 0===e||null===(t=e.options)||void 0===t||t.call(e,{overflow:{x:"hidden",y:"scroll"}})}),500)}),[]);return a.useEffect((function(){return i(),function(){n.current=null,r.current=null}}),[]),{saveScrollHeight:l,restoreScrollHeight:s,bodyScroller:n.current}}},4144:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var a=n(48305),r=n.n(a),o=n(91962),i=n(32699),l=n.n(i),s=n(75271);function u(){var e=(0,s.useState)({width:window.innerWidth,height:window.innerHeight}),t=r()(e,2),n=t[0],a=t[1],i=(0,s.useState)(!1),u=r()(i,2),c=u[0],d=u[1],h=(0,s.useState)(!1),m=r()(h,2),p=m[0],f=m[1],v=(0,s.useState)(!1),g=r()(v,2),x=g[0],b=g[1],y=(0,s.useState)(""),_=r()(y,2),k=_[0],w=_[1],j=(0,s.useCallback)((function(e){return e<o.Z.sm?(d(!0),f(!1),b(!1),void w("sm")):e<o.Z.md?(d(!1),f(!0),b(!1),void w("md")):e<o.Z.lg?(d(!1),f(!1),b(!0),void w("lg")):(d(!1),f(!1),b(!0),void w("xl"))}),[]),C=(0,s.useCallback)(l().throttle((function(){a({width:window.innerWidth,height:window.innerHeight})}),200),[]);return(0,s.useEffect)((function(){return window.addEventListener("resize",C),function(){window.removeEventListener("resize",C)}}),[C]),(0,s.useEffect)((function(){j(n.width)}),[n.width,j]),{size:n,isMobile:c,isTablet:p,isDesktop:x,currentPoint:k}}},90330:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return mt}});var a=n(90228),r=n.n(a),o=n(26068),i=n.n(o),l=n(87999),s=n.n(l),u=n(48305),c=n.n(u),d=n(25383),h=n(3246),m=n(32699),p=n.n(m),f=n(75271),v=n(94213),g=n(52064),x=n(85882),b=n(3108),y=n(67996),_=n(48075),k=n(53231),w=n(27441),j=n(77634),C=n(92665),D=(0,f.createContext)({}),Z=D,M=n(52676),S=[y.Us.llm,y.Us.embedding,y.Us.reranker],T=function(){var e=(0,k.useIntl)(),t=(0,f.useContext)(D).active_models||[],n=[{title:e.formatMessage({id:"common.table.name"}),dataIndex:"name",key:"name",ellipsis:!0,render:function(e,t){return(0,M.jsx)(x.Z,{ghost:!0,children:(0,M.jsx)("span",{children:e})})}},{title:e.formatMessage({id:"dashboard.allocatevram"}),dataIndex:"resource_claim.memory",key:"vram",ellipsis:!0,render:function(e,t){var n,a;return(0,M.jsxs)(x.Z,{ghost:!0,children:[(0,_.hy)((null===(n=t.resource_claim)||void 0===n?void 0:n.vram)||0)," /"," ",(0,_.hy)((null===(a=t.resource_claim)||void 0===a?void 0:a.ram)||0)]})}},{title:e.formatMessage({id:"models.form.replicas"}),dataIndex:"instance_count",key:"instance_count"},{title:e.formatMessage({id:"dashboard.tokens"}),dataIndex:"token_count",key:"token_count",ellipsis:!0,render:function(e,t){var n,a=e;e||(a=S.includes(null===(n=t.categories)||void 0===n?void 0:n[0])?0:"N/A");return(0,M.jsx)(x.Z,{ghost:!0,children:(0,M.jsx)("span",{children:a})})}}];return(0,M.jsx)(w.Z,{gutter:[20,0],children:(0,M.jsxs)(j.Z,{xs:24,sm:24,md:24,lg:24,xl:24,children:[(0,M.jsx)(b.Z,{style:{margin:"26px 0px"},left:(0,M.jsx)("span",{style:{fontWeight:"var(--font-weight-bold)"},children:e.formatMessage({id:"dashboard.activeModels"})}),right:!1}),(0,M.jsx)("div",{children:(0,M.jsx)(C.Z,{columns:n,dataSource:t,pagination:!1,rowKey:"id"})})]})})},P=n(48721),A=[{key:"cluster_count",label:"dashboard.clusters",backgroundColor:"var(--color-white-1)"},{key:"worker_count",label:"dashboard.workers",backgroundColor:"var(--color-white-1)"},{key:"gpu_count",label:"dashboard.totalgpus",backgroundColor:"var(--color-white-1)"},{key:"model_count",label:"dashboard.models",backgroundColor:"var(--color-white-1)"},{key:"model_instance_count",label:"models.form.replicas",backgroundColor:"var(--color-white-1)"}],I="rgba(0,85,255,0.8)",L="rgb(102, 214, 224)",E="rgba(85,167,255,0.8)",R="card-body___by6gK",Y="row___aaW9s",z="content___L6aNm",q=function(e){var t=e.label,n=e.value;e.bgColor;return(0,M.jsx)(P.Z,{variant:"borderless",style:{background:"var(--color-white-1)"},className:R,children:(0,M.jsxs)("div",{className:z,children:[(0,M.jsx)("div",{className:"label text-secondary",children:t}),(0,M.jsx)("div",{className:"value font-600 font-size-16",children:n})]})})},B=function(){var e=(0,k.useIntl)(),t=(0,f.useContext)(D).resource_counts||{};return(0,M.jsx)("div",{children:(0,M.jsx)(w.Z,{gutter:[20,20],className:Y,children:A.map((function(n,a){return(0,M.jsx)(j.Z,{xs:{flex:"100%"},sm:{flex:"50%"},md:{flex:"50%"},lg:{flex:"20%"},xl:{flex:"20%"},children:q({label:e.formatMessage({id:n.label}),value:p().get(t,n.key,0),bgColor:n.backgroundColor})},n.key)}))})})},U="cardWrapper___Q41EU",N=function(e){var t=e.children,n=e.style;return(0,M.jsx)("div",{className:U,style:i()({},n),children:t})},H=n(61163),O=n(88256),W=n(92047),G=n(27220),F=n(71656),K=n.n(F),$={cpu:{label:"CPU",type:"CPU",intl:!1,color:"rgba(250, 173, 20,.8)"},ram:{label:"dashboard.memory",type:"Memory",intl:!0,color:"rgba(114, 46, 209,.8)"},gpu:{label:"GPU",type:"GPU",intl:!1,color:"rgba(84, 204, 152,.8)"},vram:{label:"dashboard.vram",type:"VRAM",intl:!0,color:"rgba(255, 107, 179, 80%)"}},V=function(e){var t=e.data,n=(0,k.useIntl)(),a=["gpu","cpu","ram","vram"],r=(0,f.useMemo)((function(){var e=[],r=[];return{seriesData:p().map(a,(function(a){var o=p().get($,a,{}),i=o.intl?n.formatMessage({id:o.label}):o.label;e.push(i);var l=p().get(t,a,[]);return{name:i,color:o.color,data:p().map(l,(function(e){var t=K()(1e3*e.timestamp).format("HH:mm:ss");return r.push(t),{time:e,value:p().round(p().get(e,"value",0),1)}}))}})),legendData:e,xAxisData:p().uniq(r)}}),[t,n]);return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(G.Z,{height:390,seriesData:r.seriesData,legendData:r.legendData,xAxisData:r.xAxisData,tooltipValueFormatter:function(e){return e?"".concat(e,"%"):e},smooth:!0,width:"100%",yAxisName:"(%)"})})},X=190,Q=function(){var e=(0,k.useIntl)(),t=(0,f.useContext)(D),n=t.system_load,a=t.fetchData,o=(0,f.useState)(n||{}),i=c()(o,2),l=i[0],u=i[1],d=(0,f.useState)([]),h=c()(d,2),m=h[0],v=h[1],g=(0,f.useMemo)((function(){var e=(null==l?void 0:l.current)||{};return{gpu:{data:p().round(e.gpu||0,1)},vram:{data:p().round(e.vram||0,1)},cpu:{data:p().round(e.cpu||0,1)},ram:{data:p().round(e.ram||0,1)}}}),[null==l?void 0:l.current]);(0,f.useEffect)((function(){u(n||{})}),[n]);var x=function(){var e=s()(r()().mark((function e(t){var n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a({cluster_id:t});case 3:n=e.sent,u(n.system_load||{}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),u({});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){var e=function(){var e=s()(r()().mark((function e(){var t,n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,W.ax)({page:-1});case 3:t=e.sent,n=t.items.map((function(e){return{label:e.name,value:e.id}})),v(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),v([]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,M.jsx)("div",{children:(0,M.jsxs)("div",{className:"system-load",children:[(0,M.jsx)(b.Z,{style:{margin:"26px 0px"},left:(0,M.jsx)("span",{className:"font-700",children:e.formatMessage({id:"dashboard.systemload"})}),right:(0,M.jsx)(O.Z,{allowClear:!0,onChange:x,style:{width:360},options:m,placeholder:e.formatMessage({id:"clusters.filterBy.cluster"})})}),(0,M.jsxs)(w.Z,{gutter:[20,20],children:[(0,M.jsx)(j.Z,{xs:24,sm:24,md:24,lg:24,xl:16,children:(0,M.jsx)(N,{style:{height:400},children:(0,M.jsx)(V,{data:null==l?void 0:l.history})})}),(0,M.jsx)(j.Z,{xs:24,sm:24,md:24,lg:24,xl:8,children:(0,M.jsx)(N,{style:{height:400},children:(0,M.jsxs)(w.Z,{style:{height:400},children:[(0,M.jsx)(j.Z,{span:12,style:{height:X},children:(0,M.jsx)(H.Z,{height:X,value:g.gpu.data,title:e.formatMessage({id:"dashboard.gpuutilization"})})}),(0,M.jsx)(j.Z,{span:12,style:{height:X},children:(0,M.jsx)(H.Z,{title:e.formatMessage({id:"dashboard.vramutilization"}),height:X,value:g.vram.data})}),(0,M.jsx)(j.Z,{span:12,style:{height:X},children:(0,M.jsx)(H.Z,{title:e.formatMessage({id:"dashboard.cpuutilization"}),height:X,value:g.cpu.data})}),(0,M.jsx)(j.Z,{span:12,style:{height:X},children:(0,M.jsx)(H.Z,{title:e.formatMessage({id:"dashboard.memoryutilization"}),height:X,value:g.ram.data})})]})})})]})]})})},J=n(91962),ee=n(4144),te=n(15558),ne=n.n(te),ae=n(53649),re=n.n(ae),oe=n(67585),ie=n(72742),le=n(1503),se=n(335),ue=n.n(se),ce=n(11227),de=n(28667);var he,me,pe,fe,ve,ge=n(67825),xe=n.n(ge),be=n(68652),ye=n(72567),_e=["options","showTags"],ke=oe.ZP.div(he||(he=re()(["\n  display: flex;\n  align-items: center;\n  gap: 8px;\n"]))),we=oe.ZP.div(me||(me=re()(["\n  .ant-select-item {\n    padding-inline-start: 8px;\n    &:hover {\n      background-color: var(--ant-select-option-active-bg);\n    }\n  }\n  .ant-select-item-option-selected:not(.ant-select-item-option-disabled) {\n    background-color: unset;\n    font-weight: unset;\n    &:hover {\n      background-color: var(--ant-select-option-active-bg);\n    }\n  }\n"]))),je=oe.ZP.div(pe||(pe=re()(["\n  margin-bottom: 10px;\n  padding: 5px 8px;\n  font-size: 12px;\n  border-bottom: 1px solid var(--ant-color-split);\n  .ant-checkbox-wrapper {\n    color: var(--ant-color-text-tertiary);\n  }\n"]))),Ce=(0,oe.ZP)(be.Z)(fe||(fe=re()(["\n  border-radius: 12px;\n"]))),De=(0,f.forwardRef)((function(e,t){var n=(0,k.useIntl)(),a=e.options,r=void 0===a?[]:a,o=e.showTags,l=xe()(e,_e),s=f.useState({checked:!1,indeterminate:!1}),u=c()(s,2),d=u[0],h=u[1],m=f.useState(r||[]),p=c()(m,2),v=p[0],g=p[1],b=f.useRef(null),y=f.useRef(null);(0,f.useEffect)((function(){g(r||[])}),[r]);var _=function(e){var t,n=e.target.checked,a=(null==v?void 0:v.map((function(e){return e.value})))||[];h({checked:n,indeterminate:!1});var r=ne()(l.value||[]);r=n?Array.from(new Set([].concat(ne()(r),ne()(a)))):r.filter((function(e){return!a.includes(e)})),null===(t=l.onChange)||void 0===t||t.call(l,r,v||[])},w=function(e){if(l.value&&Array.isArray(l.value)&&0!==e.length){var t=new Set(l.value),n=(null==e?void 0:e.map((function(e){return e.value})))||[],a=n.every((function(e){return t.has(e)})),r=n.some((function(e){return t.has(e)}));h({checked:a,indeterminate:r&&!a})}else h({checked:!1,indeterminate:!1})};return(0,f.useEffect)((function(){var e,t,n=null===(e=b.current)||void 0===e||null===(t=e.querySelector)||void 0===t?void 0:t.call(e,"input");if(n){var a=function(e){"Backspace"===e.key&&""===n.value&&(e.stopPropagation(),e.preventDefault())};return n.addEventListener("keydown",a),function(){n.removeEventListener("keydown",a)}}}),[b.current]),(0,f.useImperativeHandle)(t,(function(){return{focus:function(){var e;null===(e=y.current)||void 0===e||e.focus()},blur:function(){var e;null===(e=y.current)||void 0===e||e.blur()}}})),(0,M.jsx)("div",{ref:b,style:{width:"inherit"},children:(0,M.jsx)(O.Z,i()(i()({},l),{},{ref:y,options:v,maxTagCount:l.maxTagCount||0,defaultActiveFirstOption:!1,popupRender:function(e){return(0,M.jsxs)(we,{children:["multiple"===l.mode&&(0,M.jsx)(je,{children:(0,M.jsx)(ye.Z,{checked:d.checked,indeterminate:d.indeterminate,onChange:_,children:n.formatMessage({id:"common.checbox.all"})})}),e]})},optionRender:function(e,t){var n,a,r=e.value,o=e.label;return(0,M.jsxs)(ke,{children:[null!==(n=l.value)&&void 0!==n&&null!==(a=n.includes)&&void 0!==a&&a.call(n,r)?(0,M.jsx)(ye.Z,{checked:!0}):(0,M.jsx)(ye.Z,{}),(0,M.jsx)(x.Z,{ghost:!0,children:o})]})},menuItemSelectedIcon:!1,onChange:function(e,t){var n,a=Array.isArray(e)?e:[e],r=(null==v?void 0:v.map((function(e){return e.value})))||[],o=a.length===(null==r?void 0:r.length);h({checked:o,indeterminate:!o&&a.length>0}),null===(n=l.onChange)||void 0===n||n.call(l,a,t)},tagRender:function(e){var t=e.label,a=e.isMaxTag?t.slice(0,-3).slice(1):t;return(0,M.jsx)(Ce,{bordered:!1,closable:e.closable,onClose:e.onClose,style:{height:24,backgroundColor:"var(--ant-color-fill-tertiary)",fontSize:"var(--ant-font-size)"},className:"flex-center",children:o?t:n.formatMessage({id:"common.select.count"},{count:a})})},onBlur:function(e){var t;null===(t=l.onBlur)||void 0===t||t.call(l,e)},onFocus:function(e){var t;null===(t=l.onFocus)||void 0===t||t.call(l,e)},onSearch:function(e){if(l.onSearch)l.onSearch(e);else{var t=null==r?void 0:r.filter((function(t){return t.label.toLowerCase().includes(e.toLowerCase())}));g(t||[]),w(t||[])}},filterOption:function(e,t){return!(!t||!t.label)&&t.label.toLowerCase().includes(e.toLowerCase())},onOpenChange:function(e){e||(w(r),g(r||[]))},children:e.children}))})})),Ze=n(86422),Me=n(36618),Se=n(25408),Te=n(79635);var Pe=60,Ae=29,Ie=oe.ZP.div(ve||(ve=re()(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0px;\n  .selection {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n  }\n  .ant-select-selection-overflow-item > span {\n    height: 24px;\n  }\n"]))),Le=function(e){var t=e.query,n=e.userList,a=e.modelList,r=e.handleDateChange,o=e.handleUsersChange,i=e.handleModelsChange,l=e.handleExport,s=e.url,u=e.disabledDate,c=function(e){var t=e||{},n=t.range,a=void 0===n?60:n,r=t.disabledDate,o=(0,k.useIntl)(),i=function(e){return 12*e.year()+e.month()};return{disabledRangeDaysDate:function(e,t){var n=t.from,o=t.type;if(!r)return!1;if(n){var l=n.add(1-a,"days"),s=n.add(a-1,"days");switch(o){case"year":return e.year()<l.year()||e.year()>s.year();case"month":return i(e)<i(l)||i(e)>i(s);default:return e.isBefore(l)||e.isAfter(s)}}return!1},rangePresets:[{label:o.formatMessage({id:"dashboard.usage.datePicker.last7days"}),value:[K()().add(-6,"d"),K()()]},{label:o.formatMessage({id:"dashboard.usage.datePicker.last30days"}),value:[K()().add(-29,"d"),K()()]},{label:o.formatMessage({id:"dashboard.usage.datePicker.last60days"}),value:[K()().add(-59,"d"),K()()]}],range:a}}({range:Pe,disabledDate:u}),d=c.disabledRangeDaysDate,h=c.rangePresets,m=(0,k.useIntl)();return(0,M.jsx)(Ie,{children:(0,M.jsxs)("div",{className:"selection",children:[(0,M.jsx)(Me.Z.RangePicker,{maxDate:K()(),defaultValue:[K()().add(-Ae,"d"),K()()],disabledDate:d,presets:h,allowClear:!1,style:{width:220},value:[K()(t.start_date),K()(t.end_date)],onChange:r}),(0,M.jsx)(De,{allowClear:!0,showSearch:!0,mode:"multiple",options:n,maxTagCount:0,placeholder:m.formatMessage({id:"dashboard.usage.selectuser"}),style:{maxWidth:200,minWidth:160},value:t.user_ids,onChange:o}),(0,M.jsx)(De,{allowClear:!0,showSearch:!0,mode:"multiple",options:a,maxTagCount:0,placeholder:m.formatMessage({id:"dashboard.usage.selectmodel"}),value:t.model_ids,style:{maxWidth:200,minWidth:160},onChange:i}),s===g._b&&(0,M.jsx)(Se.Z,{title:m.formatMessage({id:"common.button.export"}),children:(0,M.jsx)(Te.ZP,{icon:(0,M.jsx)(Ze.Z,{}),onClick:l})})]})})},Ee=n(82243),Re=n(88132),Ye=29,ze=function(e){return new Map(e.map((function(e){return[K()(1e3*e.timestamp).format("YYYY-MM-DD"),e.value]})))},qe=function(e,t){return e.map((function(e,n){return{time:e,value:t.get(e)||0}}))};function Be(e){var t=e||{},n=t.url,a=t.defaultData,o=(0,f.useState)(!1),l=c()(o,2),u=l[0],d=l[1],h=(0,f.useState)({start_date:K()().subtract(Ye,"days").format("YYYY-MM-DD"),end_date:K()().format("YYYY-MM-DD"),data:a}),m=c()(h,2),v=m[0],x=m[1],b=(0,f.useState)({start_date:K()().subtract(Ye,"days").format("YYYY-MM-DD"),end_date:K()().format("YYYY-MM-DD"),model_ids:[],user_ids:[]}),y=c()(b,2),_=y[0],k=y[1],w=(0,f.useState)([]),j=c()(w,2),C=j[0],D=j[1],Z=(0,f.useState)([]),M=c()(Z,2),S=M[0],T=M[1],P=(0,f.useState)(!1),A=c()(P,2),R=A[0],Y=A[1],z=(0,f.useMemo)((function(){if(n===g.HY)return{requestTokenData:{requestData:[],tokenData:[],xAxisData:[]}};var e=v,t=e.start_date,a=e.end_date,r=e.data,o=t&&a?function(e,t){for(var n=K()(e),a=K()(t),r=[],o=n;o.isBefore(a)||o.isSame(a,"day");o=o.add(1,"day"))r.push(o.format("YYYY-MM-DD"));return r}(t,a):function(){for(var e=[],t=29;t>=0;t--){var n=K()().subtract(t,"day").format("YYYY-MM-DD");e.push(n)}return e}(),l=(null==r?void 0:r.completion_token_history)||[],s=(null==r?void 0:r.prompt_token_history)||[],u=(null==r?void 0:r.api_request_history)||[];if(!l.length)return{requestTokenData:{requestData:[],tokenData:[],xAxisData:[]}};var c={name:"API requests",areaStyle:{color:"rgba(13,171,219,0.15)"},color:L,data:qe(o,ze(u))},d=qe(o,ze(l)),h=qe(o,ze(s));return{requestTokenData:{requestData:[c],tokenData:[{name:"Completion tokens",color:I,data:d.map((function(e,t){return i()(i()({},e),{},{itemStyle:{borderRadius:h[t].value?[0,0,0,0]:[2,2,0,0]}})}))},{name:"Prompt tokens",color:E,data:h.map((function(e,t){return i()(i()({},e),{},{itemStyle:{borderRadius:[2,2,0,0]}})}))}],xAxisData:o}}}),[v,n]),q=function(){var e=s()(r()().mark((function e(){var t,n,a;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={page:-1},e.next=4,(0,Ee.nb)(t);case 4:n=e.sent,a=p().map(n.items||[],(function(e){return{label:e.name,value:e.id}})),D(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),D([]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=s()(r()().mark((function e(){var t,n,a;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={page:-1},e.next=4,(0,Re.YX)(t);case 4:n=e.sent,a=p().map(n.items||[],(function(e){return{label:e.username,value:e.id}})),T(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),T([]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=s()(r()().mark((function e(t){var a;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Y(!0),e.next=4,(0,g.Xv)(t,{url:n});case 4:a=e.sent,x({start_date:t.start_date,end_date:t.end_date,data:a}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),x({start_date:t.start_date,end_date:t.end_date,data:{}});case 11:return e.prev=11,Y(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}();return{usageData:z,result:v,open:u,loading:R,userList:S,modelList:C,query:_,setQuery:k,init:function(){U(_),q(),B()},setResult:x,handleOnCancel:function(){d(!1)},handleExport:function(){d(!0)},handleDateChange:function(e,t){k((function(e){return i()(i()({},e),{},{start_date:t[0],end_date:t[1]})})),U(i()(i()({},_),{},{start_date:t[0],end_date:t[1]}))},handleUsersChange:function(e){k((function(t){return i()(i()({},t),{},{user_ids:e})})),U(i()(i()({},_),{},{user_ids:e}))},handleModelsChange:function(e){k((function(t){return i()(i()({},t),{},{model_ids:e})})),U(i()(i()({},_),{},{model_ids:e}))}}}var Ue,Ne,He,Oe,We,Ge=function(e){var t,n=e||{},a=n.open,r=n.onCancel,o=(0,k.useIntl)(),i=Be({url:g.HY,disabledDate:!1}),l=i.init,s=i.setResult,u=i.loading,c=i.result,d=i.userList,h=i.modelList,m=i.query,p=i.setQuery,v=(i.handleExport,i.handleDateChange),b=i.handleUsersChange,y=i.handleModelsChange,_=[{title:o.formatMessage({id:"resources.table.index"}),width:80,render:function(e,t,n){return n+1}},{title:o.formatMessage({id:"dashboard.usage.export.date"}),dataIndex:"date"},{title:o.formatMessage({id:"dashboard.usage.export.user"}),dataIndex:"user_id",render:function(e){var t;return(0,M.jsx)(x.Z,{ghost:!0,children:null===(t=d.find((function(t){return t.value===e})))||void 0===t?void 0:t.label})}},{title:o.formatMessage({id:"dashboard.usage.export.model"}),dataIndex:"model_id",render:function(e){var t;return(0,M.jsx)(x.Z,{ghost:!0,children:(null===(t=h.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||e})}},{title:"Completion Tokens",dataIndex:"completion_token_count",width:170,align:"right"},{title:"Prompt Tokens",dataIndex:"prompt_token_count",align:"right",width:150},{title:"API Requests",dataIndex:"request_count",align:"right",width:150}];return(0,f.useEffect)((function(){a?l():(p({start_date:K()().subtract(29,"days").format("YYYY-MM-DD"),end_date:K()().format("YYYY-MM-DD"),model_ids:[],user_ids:[]}),s({start_date:"",end_date:"",data:{items:[]}}))}),[a]),(0,M.jsxs)(le.Z,{title:o.formatMessage({id:"dashboard.usage.export"}),open:a,centered:!1,onCancel:r,destroyOnHidden:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:1e3,style:{top:"10%"},footer:(0,M.jsx)(ie.Z,{onOk:function(){var e,t="usage-data_".concat(m.start_date||"","_").concat(m.end_date||"",".xlsx");!function(e){var t=e.jsonData,n=e.fields,a=e.fieldLabels,r=e.formatMap,o=e.fileName,i=void 0===o?"data.xlsx":o,l=t.map((function(e){var t,a={},o=ue()(n);try{for(o.s();!(t=o.n()).done;){var i=t.value,l=e[i],s=null==r?void 0:r[i];a[i]=s?s(l,e):l}}catch(e){o.e(e)}finally{o.f()}return a})),s=de.ZP.utils.json_to_sheet(l,{header:n});if(a){var u=n.map((function(e){return a[e]||e}));de.ZP.utils.sheet_add_aoa(s,[u],{origin:"A1"})}var c=de.ZP.utils.book_new();de.ZP.utils.book_append_sheet(c,s,"Sheet1");var d=de.ZP.write(c,{bookType:"xlsx",type:"array"}),h=new Blob([d],{type:"application/octet-stream"});(0,ce.saveAs)(h,i)}({jsonData:(null===(e=c.data)||void 0===e?void 0:e.items)||[],fileName:t,fields:_.map((function(e){return e.dataIndex})).filter(Boolean),fieldLabels:{user_id:"User",model_id:"Model",date:"Date",prompt_token_count:"Prompt Tokens",completion_token_count:"Completion Tokens",request_count:"API Requests"},formatMap:{user_id:function(e){var t;return(null===(t=d.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||e},model_id:function(e){var t;return(null===(t=h.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||e}}})},onCancel:r,okText:o.formatMessage({id:"common.button.export"})}),children:[(0,M.jsx)(Le,{disabledDate:!1,url:g.HY,query:m,userList:d,modelList:h,handleDateChange:v,handleUsersChange:b,handleModelsChange:y}),(0,M.jsx)(C.Z,{columns:_,tableLayout:"auto",style:{width:"100%",marginTop:"16px"},dataSource:(null===(t=c.data)||void 0===t?void 0:t.items)||[],loading:u,rowKey:"id",virtual:!0,scroll:{y:400},pagination:!1})]})},Fe=n(58281),Ke=oe.ZP.div(Ue||(Ue=re()(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  gap: 16px;\n"]))),$e=(0,Fe.kc)((function(e){var t=e.css,n=e.token;return{wrapper:t(Ne||(Ne=re()(["\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    background: ",";\n    border-radius: ","px;\n    padding: ","px;\n    justify-content: center;\n    align-items: center;\n    gap: ","px;\n    &.bordered {\n      border: 1px solid ",";\n    }\n    .title {\n      font-size: ","px;\n      font-weight: var(--font-weight-medium);\n    }\n    .content {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      font-size: ","px;\n      color: ",";\n      gap: 8px;\n      .icon {\n        display: inline-block;\n        width: 10px;\n        height: 10px;\n        gap: 10px;\n        &.roundRect {\n          border-radius: 2px;\n        }\n        &.circle {\n          border-radius: 50%;\n        }\n      }\n    }\n  "])),n.colorBgContainer,n.borderRadius,n.padding,n.padding,n.colorBorder,n.fontSize,n.fontSize,n.colorTextSecondary)}})),Ve=function(e){var t=$e(),n=t.styles,a=t.cx,r=e.title,o=e.content,i=e.style,l=e.bordered,s=e.iconType,u=e.color;return(0,M.jsxs)("div",{className:a({bordered:l},n.wrapper),style:i,children:[(0,M.jsx)("div",{className:"title",children:r}),(0,M.jsxs)("div",{className:"content",children:[(0,M.jsx)("span",{className:a([s],"icon"),style:{backgroundColor:u||"transparent"}}),(0,M.jsx)("span",{children:o})]})]})},Xe=function(e){var t=e.dataList,n=e.bordered;return(0,M.jsx)(Ke,{style:{height:e.height||"100%"},children:t.map((function(e,t){return(0,M.jsx)(Ve,{title:e.label,content:e.value,bordered:n,color:e.color,iconType:e.iconType},t)}))})},Qe=n(82487),Je=n(90064),et=n(51461),tt=(n(6745).Z.graphic.LinearGradient,function(e){var t=e.seriesData,n=e.xAxisData,a=e.yAxisName,r=e.height,o=e.width,l=e.labelFormatter,s=e.tooltipValueFormatter,u=void 0===s?null:s,c=e.legendData,d=void 0===c?[]:c,h=e.smooth,m=e.title,v=e.chartData,g=(0,Je.Z)(),x=g.grid,b=g.legend,y=g.lineItemConfig,k=g.barItemConfig,w=g.title,j=g.tooltip,C=g.xAxis,D=g.yAxis,Z=v.line,S=v.bar,T={title:{text:""},grid:i()(i()({},x),{},{right:0,top:20,bottom:10}),tooltip:i()(i()({},j),{},{formatter:function(e){return u?j.formatter(e,u):j.formatter(e)}}),xAxis:i()(i()({},C),{},{axisLabel:i()(i()({},C.axisLabel),{},{formatter:l})}),yAxis:D,legend:i()(i()({},b),{},{data:d,itemGap:20,bottom:5,show:!1}),series:[]},P=(0,f.useMemo)((function(){var e=p().map(Z,(function(e){(0,_.jP)({color:e.color,alpha1:.5,alpha2:.1});return i()(i()(i()({},e),y),{},{smooth:h,itemStyle:i()(i()({},y.itemStyle),{},{color:e.color}),yAxisIndex:1,lineStyle:i()(i()({},y.lineStyle),{},{color:e.color})})})),t=p().map(S,(function(e){return i()(i()(i()({},e),k),{},{stack:"total",yAxisIndex:0,itemStyle:i()(i()({},e.itemStyle),{},{color:e.color})})}));return i()(i()({},T),{},{animation:!1,title:i()(i()({},w),{},{text:m}),yAxis:[i()({},T.yAxis),i()(i()({},T.yAxis),{},{nameTextStyle:{fontSize:12,align:"right"}})],xAxis:i()(i()({},T.xAxis),{},{data:n}),series:[].concat(ne()(t),ne()(e))})}),[t,n,a,m,h,d,T]);return(0,M.jsx)(M.Fragment,{children:Z.length||S.length?(0,M.jsx)(Qe.Z,{height:r,options:P,width:o||"100%"}):(0,M.jsx)(et.Z,{height:r,title:p().get(m,"text",m||"")})})}),nt=((0,oe.ZP)(Te.ZP).attrs({className:"download-button"})(He||(He=re()(["\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  z-index: 10;\n  display: none;\n"]))),oe.ZP.div(Oe||(Oe=re()(["\n  &:hover {\n    .download-button {\n      display: flex;\n    }\n  }\n"])))),at=function(e){return K()(e).format("MM-DD")},rt=[{label:"0",value:"Completion Tokens",key:"completionCount",iconType:"roundRect",color:I},{label:"0",value:"Prompt Tokens",key:"promptCount",iconType:"roundRect",color:E},{label:"0",value:"API Requests",key:"requestCount",iconType:"circle",color:L}],ot=[{name:"Completion tokens",icon:"roundRect"},{name:"Prompt tokens",icon:"roundRect"},{name:"API requests",icon:"circle"}],it=function(e){var t=e.requestData,n=e.tokenData,a=e.xAxisData,r=(0,f.useMemo)((function(){var e,a,r,o={requestCount:(null===(e=t[0])||void 0===e?void 0:e.data.reduce((function(e,t){return e+t.value}),0))||0,completionCount:(null===(a=n[0])||void 0===a?void 0:a.data.reduce((function(e,t){return e+t.value}),0))||0,promptCount:(null===(r=n[1])||void 0===r?void 0:r.data.reduce((function(e,t){return e+t.value}),0))||0};return rt.map((function(e){return i()(i()({},e),{},{label:(0,_.HN)(o[e.key]||0)})}))}),[t,n]);return(0,M.jsx)(nt,{children:(0,M.jsxs)(N,{style:{width:"100%",position:"relative"},children:[(0,M.jsx)(Xe,{dataList:r,height:80}),(0,M.jsx)(tt,{chartData:{line:t,bar:n},seriesData:[],xAxisData:a,height:360,smooth:!1,legendData:ot,labelFormatter:at})]})})},lt=function(e){var t=e.seriesData,n=e.xAxisData,a=e.height,r=e.width,o=e.labelFormatter,l=(e.legendData,e.maxItems),s=e.title,u=(0,Je.Z)(),c=u.token,d=u.grid,h=u.legend,m=u.title,v=u.tooltip,g=u.xAxis,x=u.yAxis,b=(0,f.useMemo)((function(){var e={title:i()(i()({},m),{},{left:"start"}),grid:i()(i()({},d),{},{top:0,bottom:l?"".concat(1/l*(l-n.length)*100,"%"):0}),tooltip:i()({},v),xAxis:i()(i()({},g),{},{axisLabel:i()({},g.axisLabel)}),yAxis:i()(i()({},x),{},{axisLabel:i()(i()({},x.axisLabel),{},{show:!0,overflow:"truncate",width:75,ellipsis:"..."})}),legend:i()(i()({},h),{},{data:[]}),series:[]},a=p().map(t,(function(e){return i()(i()({},e),{},{type:"bar",barWidth:20,stack:"Ad",barGap:"30%",label:{show:!1,formatter:function(e){return 0===e.seriesIndex?"{value|".concat(e.name,"}"):""},position:"left",align:"left",offset:[5,18],rich:{value:{textBorderWidth:0,fontSize:11,color:null==c?void 0:c.colorTextTertiary}}},itemStyle:{color:e.color}})}));return i()(i()({},e),{},{animation:!1,title:i()(i()({},e.title),{},{text:s}),yAxis:i()(i()({},e.yAxis),{},{inverse:!0,type:"category",splitLine:{show:!1},data:n,axisLine:{show:!1},axisTick:{show:!1}}),xAxis:i()(i()({},e.xAxis),{},{type:"value",splitLine:{show:!1},axisLabel:{show:!1},axisTick:{show:!1}}),series:a})}),[t,n,s,o,v,d,g,x,h]),y=(0,f.useMemo)((function(){var e;return null==t||null===(e=t.every)||void 0===e?void 0:e.call(t,(function(e){var t;return!(null!=e&&null!==(t=e.data)&&void 0!==t&&t.length)}))}),[t]);return(0,M.jsx)(M.Fragment,{children:y?(0,M.jsx)(et.Z,{height:a,title:p().get(s,"text",s||"")}):(0,M.jsx)(Qe.Z,{height:a,options:b,width:r||"100%"})})},st=function(e){var t=e.userData,n=e.topUserList;return(0,M.jsx)(N,{children:(0,M.jsx)(lt,{seriesData:t,xAxisData:n,height:440,maxItems:10})})},ut=oe.ZP.div(We||(We=re()(["\n  margin: 0;\n  font-weight: 700;\n"]))),ct=function(e){var t=e.maxWidth,n=(0,k.useIntl)(),a=(0,f.useContext)(D).model_usage,r=Be({url:g._b,disabledDate:!0,defaultData:{api_request_history:[],completion_token_history:[],prompt_token_history:[]}}),o=r.usageData,i=r.query,l=r.userList,s=r.modelList,u=r.handleOnCancel,c=r.init,d=r.handleExport,h=r.handleDateChange,m=r.handleUsersChange,p=r.handleModelsChange,v=r.open,x=(0,f.useMemo)((function(){var e,t=(null==a||null===(e=a.top_users)||void 0===e?void 0:e.slice(0,10))||[],n={name:"Prompt tokens",color:E,data:[]},r={name:"Completion tokens",color:I,data:[]},o=t.map((function(e){return n.data.push({name:e.username,value:e.prompt_token_count,itemStyle:{borderRadius:e.completion_token_count?[0,2,2,0]:[2,2,2,2]}}),r.data.push({name:e.username,value:e.completion_token_count,itemStyle:{borderRadius:e.prompt_token_count?[2,0,0,2]:[2,2,2,2]}}),e.username}));return{userData:[r,n],topUserList:ne()(new Set(o))}}),[null==a?void 0:a.top_users]);return(0,f.useEffect)((function(){c()}),[]),(0,M.jsxs)("div",{children:[(0,M.jsxs)(w.Z,{gutter:t<J.Z.xl?[0,0]:[20,20],children:[(0,M.jsxs)(j.Z,{xs:24,sm:24,md:24,lg:24,xl:16,children:[(0,M.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"20px 0 "},children:[(0,M.jsx)(ut,{children:n.formatMessage({id:"dashboard.usage"})}),(0,M.jsx)(Le,{url:g._b,query:i,userList:l,modelList:s,disabledDate:!0,handleDateChange:h,handleUsersChange:m,handleModelsChange:p,handleExport:d})]}),(0,M.jsx)(it,{requestData:null==o?void 0:o.requestTokenData.requestData,xAxisData:null==o?void 0:o.requestTokenData.xAxisData,tokenData:null==o?void 0:o.requestTokenData.tokenData})]}),(0,M.jsxs)(j.Z,{xs:24,sm:24,md:24,lg:24,xl:8,style:{margin:0},children:[(0,M.jsx)("div",{style:{margin:t<J.Z.xl?"26px 0":"32px 0"},children:(0,M.jsx)(ut,{children:n.formatMessage({id:"dashboard.topusers"})})}),(0,M.jsx)(st,{userData:x.userData,topUserList:x.topUserList})]})]}),(0,M.jsx)(Ge,{open:v,onCancel:u})]})},dt=function(){var e=(0,ee.Z)().size.width,t=(0,f.useState)(J.Z.xl),n=c()(t,2),a=n[0],r=n[1];return(0,f.useEffect)((function(){r(e)}),[e]),(0,M.jsx)(ct,{maxWidth:a})},ht=function(){return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(B,{}),(0,M.jsx)(Q,{}),(0,M.jsx)(dt,{}),(0,M.jsx)(T,{})]})},mt=function(){var e=(0,f.useState)({}),t=c()(e,2),n=t[0],a=t[1],o=(0,f.useState)(!1),l=c()(o,2),u=l[0],p=l[1],x=(0,d.Z)(function(){var e=s()(r()().mark((function e(t){var n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,p(!0),e.next=4,(0,g.mt)(t);case 4:n=e.sent,a((function(e){return null!=t&&t.cluster_id?i()(i()({},(0,m.omit)(e,["system_load"])),{},{system_load:n.system_load}):n})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a({});case 11:return e.prev=11,p(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}());return(0,f.useEffect)((function(){x()}),[]),(0,M.jsx)(Z.Provider,{value:i()(i()({},n),{},{fetchData:x}),children:(0,M.jsx)(v.Z,{children:(0,M.jsx)(h.Z,{spinning:u,style:{minHeight:300},children:(0,M.jsx)(ht,{})})})})}},67996:function(e,t,n){"use strict";n.d(t,{$i:function(){return R},Ae:function(){return Z},Cz:function(){return A},Db:function(){return E},G:function(){return u},OI:function(){return T},TM:function(){return x},Tx:function(){return h},UM:function(){return m},Uf:function(){return b},Us:function(){return S},V6:function(){return M},WA:function(){return _},XI:function(){return s},Xl:function(){return f},YB:function(){return v},YK:function(){return g},ZT:function(){return c},_3:function(){return P},bI:function(){return p},bn:function(){return I},dY:function(){return j},fx:function(){return L},hg:function(){return d},i7:function(){return y},mW:function(){return C},pw:function(){return w},s0:function(){return k},tn:function(){return D}});n(48305);var a=n(82092),r=n.n(a),o=n(91315),i=n(13554),l=n(40562),s=[{title:l.sk.vllm,tips:"models.form.backend.vllm"},{title:l.sk.SGLang,tips:"models.form.backend.sglang"},{title:l.sk.ascendMindie,tips:"models.form.backend.mindie"},{title:l.sk.voxBox,tips:"models.form.backend.voxbox"}],u=[{title:{text:"models.localpath.gguf.tips.title",locale:!0},tips:"models.localpath.gguf.tips"},{title:{text:"models.localpath.shared.tips.title",locale:!0},tips:"models.localpath.chunks.tips"},{title:{text:"models.localpat.safe.tips.title",locale:!0},tips:"models.localpath.safe.tips"}],c=(r()(r()(r()(r()(r()({},l.sk.llamaBox,"llama-box"),l.sk.vllm,"vLLM"),l.sk.voxBox,"vox-box"),l.sk.ascendMindie,"Ascend MindIE"),l.sk.custom,"Custom"),r()(r()(r()(r()({},l.sk.llamaBox,{holder:"models.form.backend_parameters.llamabox.placeholder",tooltip:"models.form.backend_parameters.vllm.tips"}),l.sk.vllm,{holder:"models.form.backend_parameters.vllm.placeholder",tooltip:"models.form.backend_parameters.vllm.tips"}),l.sk.SGLang,{holder:"models.form.backend_parameters.sglang.placeholder",tooltip:""}),l.sk.voxBox,null)),d={textToSpeech:"text-to-speech",speechToText:"speech-to-text",textToText:"text-to-text",textToImage:"text-to-image",audio:"audio",image:"image"},h=r()(r()(r()(r()(r()({},d.textToSpeech,"text-to-speech"),d.speechToText,"auto-speech-recognition"),d.textToText,"TextToText"),d.textToImage,"text-to-image"),"audio",["text-to-speech","auto-speech-recognition"]),m=r()(r()(r()(r()(r()({},d.textToSpeech,"text-to-speech"),d.speechToText,"automatic-speech-recognition"),d.textToText,"text-2-text"),d.textToImage,"text-to-image"),"audio",["text-to-speech","automatic-speech-recognition"]),p={huggingface:"Hugging Face",huggingface_value:"huggingface",ollama_library:"Ollama Library",ollama_library_value:"ollama_library",modelScope:"ModelScope",modelscope_value:"model_scope",model_scope:"ModelScope",local_path:"Local Path",local_path_value:"local_path"},f=r()(r()(r()(r()({},p.huggingface_value,p.huggingface),p.ollama_library_value,p.ollama_library),p.modelscope_value,p.modelScope),p.local_path_value,p.local_path),v=[{label:"Hugging Face",value:p.huggingface_value,key:"huggingface"},{label:"ModelScope",value:p.modelscope_value,key:"model_scope"},{label:"models.form.localPath",locale:!0,value:p.local_path_value,key:"local_path"}],g={Initializing:"initializing",Starting:"starting",Pending:"pending",Running:"running",Scheduled:"scheduled",Error:"error",Downloading:"downloading",Unknown:"unknown",Analyzing:"analyzing",Unreachable:"unreachable"},x=[g.Downloading,g.Initializing,g.Starting],b=r()(r()(r()(r()(r()(r()(r()(r()(r()(r()({},g.Initializing,"Initializing"),g.Pending,"Pending"),g.Running,"Running"),g.Scheduled,"Scheduled"),g.Error,"Error"),g.Downloading,"Downloading"),g.Unknown,"Unknown"),g.Analyzing,"Analyzing"),g.Starting,"Starting"),g.Unreachable,"Unreachable"),y=r()(r()(r()(r()(r()(r()(r()(r()(r()(r()({},g.Running,o.iE.success),g.Pending,o.iE.transitioning),g.Initializing,o.iE.transitioning),g.Scheduled,o.iE.transitioning),g.Error,o.iE.error),g.Downloading,o.iE.transitioning),g.Unknown,o.iE.inactive),g.Analyzing,o.iE.transitioning),g.Starting,o.iE.transitioning),g.Unreachable,o.iE.error),_={Inactive:"stopped",Degrade:"not_ready",Active:"ready"},k=r()(r()(r()({},_.Inactive,o.iE.inactive),_.Degrade,o.iE.error),_.Active,o.iE.success),w=r()(r()(r()({},_.Inactive,"models.mymodels.status.inactive"),_.Degrade,"models.mymodels.status.degrade"),_.Active,"models.mymodels.status.active"),j={Auto:"auto",Manual:"manual",SpecificGPUType:"specific_gpu_type"},C=[{label:"models.form.scheduletype.auto",locale:!0,value:j.Auto},{label:"models.form.scheduletype.manual",value:j.Manual,locale:!0}],D=(i.Z,i.Z,i.Z,{trendingScore:"trendingScore",likes:"likes",downloads:"downloads",lastModified:"lastModified"}),Z=r()(r()(r()(r()({},D.trendingScore,"Default"),D.likes,"StarsCount"),D.downloads,"DownloadsCount"),D.lastModified,"GmtModified"),M=[{label:"Spread",value:"spread"},{label:"Binpack",value:"binpack"}],S={image:"image",text_to_speech:"text_to_speech",speech_to_text:"speech_to_text",embedding:"embedding",reranker:"reranker",llm:"llm"},T=[{label:"LLM",value:S.llm},{label:"Embedding",value:S.embedding},{label:"Reranker",value:S.reranker},{label:"Image",value:S.image},{label:"Text-to-Speech",value:S.text_to_speech},{label:"Speech-to-Text",value:S.speech_to_text}],P=[{label:"common.options.auto",value:null,locale:!0}].concat(T),A=["model_scope_model_id","huggingface_repo_id","huggingface_filename","model_scope_file_path","name","description","env","source","cluster_id","quantization","size","restart_on_error","worker_selector","backend_parameters","local_path","backend_version","ollama_library_model_name","scheduleType","placement_strategy","backend","gpu_selector.gpu_ids","run_command","image_name","extended_kv_cache.enabled","extended_kv_cache.ram_size","speculative_config.enabled","speculative_config.draft_model"],I=["categories","replicas","description"],L={replicas:1,description:"",categories:null,env:{},scheduleType:j.Auto,placement_strategy:"spread",gpu_ids:null,gpu_selector:{},worker_selector:{},backend_parameters:[],backend_version:null},E=function(e){return e===l.sk.llamaBox?{backend:"llama-box",releases:"https://github.com/gpustack/llama-box/releases",link:"https://github.com/gpustack/llama-box?tab=readme-ov-file#usage",version:"v0.0.140"}:e===l.sk.vllm?{backend:"vLLM",releases:"https://github.com/vllm-project/vllm/releases",link:"https://docs.vllm.ai/en/stable/cli/serve.html",version:"v0.8.5"}:e===l.sk.ascendMindie?{backend:"Ascend MindIE",releases:"",link:"http://docs.gpustack.ai/latest/user-guide/inference-backends/#parameters-reference_2",version:"1.0.0"}:e===l.sk.SGLang?{backend:"SGLang",releases:"",link:"https://docs.sglang.ai/advanced_features/server_arguments.html",version:"v0.5.4"}:{backend:"vox-box",releases:"https://github.com/gpustack/vox-box/releases",link:"",version:"v0.0.13"}},R=function(e){return e.DEPLOYMENT="deployment",e.CATALOG="catalog",e}({})},88132:function(e,t,n){"use strict";n.d(t,{Nq:function(){return m},OL:function(){return g},YX:function(){return u},h8:function(){return f},r4:function(){return d}});var a=n(90228),r=n.n(a),o=n(87999),i=n.n(o),l=n(53231),s="/users";function u(e){return c.apply(this,arguments)}function c(){return(c=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s),{method:"GET",params:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return h.apply(this,arguments)}function h(){return(h=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s),{method:"POST",data:t.data}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return(p=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s,"/").concat(t.data.id),{method:"PUT",data:t.data}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return v.apply(this,arguments)}function v(){return(v=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s,"/").concat(t),{method:"DELETE"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return x.apply(this,arguments)}function x(){return(x=i()(r()().mark((function e(t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s,"/").concat(t.id,"/activation"),{method:"PATCH",data:t.data}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},99168:function(){}}]);