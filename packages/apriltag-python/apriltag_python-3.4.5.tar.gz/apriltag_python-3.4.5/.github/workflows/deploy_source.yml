name: PyPI manylinux_aarch64 deployer
on:
  push:
    tags:
      - 'v*'

jobs:
    # Build and deploy source distribution
    source-deploy:
        runs-on: ubuntu-latest
        steps:
        - name: Check out repository
          uses: actions/checkout@v6
          with:
                submodules: recursive
        - name: Install Python 3.12
          uses: actions/setup-python@v6
          with:
            python-version: 3.12
        - name: Build source distribution
          run: |
            python -m pip install --upgrade build
            python -m build --sdist
        - name: Upload source package to PyPI
          env:
            TWINE_USERNAME: ${{ secrets.TWINE_USERNAME }}
            TWINE_PASSWORD: ${{ secrets.TWINE_PASSWORD }}
          run: |
            pip install twine
            twine upload dist/*