name: Package publishing

on:
  push:
    branches: [main]

jobs:
  publish-new-mlip-release:
    runs-on: ubuntu-latest

    container:
       image: python:3.12-slim-bullseye

    steps:
      - name: checkout
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: setup
        run: apt-get update && apt-get install -y coreutils

      - name: install uv
        uses: astral-sh/setup-uv@v6

      - name: build and publish
        run: |
          uv build
          uv publish --token ${{secrets.POETRY_PYPI_TOKEN}}
