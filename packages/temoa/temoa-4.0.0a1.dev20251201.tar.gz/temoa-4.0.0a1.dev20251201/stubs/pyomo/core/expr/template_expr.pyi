import types

from _typeshed import Incomplete
from pyomo.common.collections import MutableMapping as MutableMapping
from pyomo.common.errors import TemplateExpressionError as TemplateExpressionError
from pyomo.common.gc_manager import PauseGC as PauseGC
from pyomo.core.expr.base import ExpressionArgs_Mixin as ExpressionArgs_Mixin
from pyomo.core.expr.base import ExpressionBase as ExpressionBase
from pyomo.core.expr.base import NPV_Mixin as NPV_Mixin
from pyomo.core.expr.logical_expr import BooleanExpression as BooleanExpression
from pyomo.core.expr.numeric_expr import ARG_TYPE as ARG_TYPE
from pyomo.core.expr.numeric_expr import Numeric_NPV_Mixin as Numeric_NPV_Mixin
from pyomo.core.expr.numeric_expr import NumericExpression as NumericExpression
from pyomo.core.expr.numeric_expr import SumExpression as SumExpression
from pyomo.core.expr.numeric_expr import mutable_expression as mutable_expression
from pyomo.core.expr.numeric_expr import register_arg_type as register_arg_type
from pyomo.core.expr.numvalue import NumericValue as NumericValue
from pyomo.core.expr.numvalue import as_numeric as as_numeric
from pyomo.core.expr.numvalue import is_constant as is_constant
from pyomo.core.expr.numvalue import native_types as native_types
from pyomo.core.expr.numvalue import nonpyomo_leaf_types as nonpyomo_leaf_types
from pyomo.core.expr.numvalue import value as value
from pyomo.core.expr.relational_expr import tuple_to_relational_expr as tuple_to_relational_expr
from pyomo.core.expr.visitor import ExpressionReplacementVisitor as ExpressionReplacementVisitor
from pyomo.core.expr.visitor import StreamBasedExpressionVisitor as StreamBasedExpressionVisitor
from pyomo.core.expr.visitor import expression_to_string as expression_to_string

logger: Incomplete

class _NotSpecified: ...

class GetItemExpression(ExpressionBase):
    PRECEDENCE: int
    def __new__(cls, args=()): ...
    def __getattr__(self, attr): ...
    def __iter__(self): ...
    def __len__(self) -> int: ...
    def getname(self, *args, **kwds): ...
    def nargs(self): ...

class Numeric_GetItemExpression(GetItemExpression, NumericExpression):
    def nargs(self): ...

class NPV_Numeric_GetItemExpression(Numeric_NPV_Mixin, Numeric_GetItemExpression): ...
class Boolean_GetItemExpression(GetItemExpression, BooleanExpression): ...
class NPV_Boolean_GetItemExpression(NPV_Mixin, Boolean_GetItemExpression): ...
class Structural_GetItemExpression(ExpressionArgs_Mixin, GetItemExpression): ...
class NPV_Structural_GetItemExpression(NPV_Mixin, Structural_GetItemExpression): ...

class GetAttrExpression(ExpressionBase):
    PRECEDENCE: int
    def __new__(cls, args=()): ...
    def __getattr__(self, attr): ...
    def __getitem__(self, *idx): ...
    def __iter__(self): ...
    def __len__(self) -> int: ...
    def __call__(self, *args, **kwargs): ...
    def getname(self, *args, **kwds): ...
    def nargs(self): ...

class Numeric_GetAttrExpression(GetAttrExpression, NumericExpression): ...
class NPV_Numeric_GetAttrExpression(Numeric_NPV_Mixin, Numeric_GetAttrExpression): ...
class Boolean_GetAttrExpression(GetAttrExpression, BooleanExpression): ...
class NPV_Boolean_GetAttrExpression(NPV_Mixin, Boolean_GetAttrExpression): ...
class Structural_GetAttrExpression(ExpressionArgs_Mixin, GetAttrExpression): ...
class NPV_Structural_GetAttrExpression(NPV_Mixin, Structural_GetAttrExpression): ...

class CallExpression(NumericExpression):
    PRECEDENCE: Incomplete
    def __init__(self, args, kwargs) -> None: ...
    def nargs(self): ...
    def __getattr__(self, attr): ...
    def __getitem__(self, *idx): ...
    def __iter__(self): ...
    def __len__(self) -> int: ...
    def getname(self, *args, **kwds): ...

class _TemplateSumExpression_argList:
    def __init__(self, TSE) -> None: ...
    def __len__(self) -> int: ...
    def __getitem__(self, i): ...
    def __enter__(self) -> None: ...
    def __exit__(
        self,
        exc_type: type[BaseException] | None,
        exc_value: BaseException | None,
        tb: types.TracebackType | None,
    ) -> None: ...

class TemplateSumExpression(NumericExpression):
    PRECEDENCE: int
    def __init__(self, args, _iters) -> None: ...
    def nargs(self): ...
    @property
    def args(self): ...
    def template_args(self): ...
    def template_iters(self): ...
    def create_node_with_local_data(self, args): ...
    def getname(self, *args, **kwds): ...
    def is_potentially_variable(self): ...
    def to_string(self, verbose=None, smap=None): ...

class IndexTemplate(NumericValue):
    def __init__(self, _set, index: int = 0, _id=None, _group=None) -> None: ...
    def __deepcopy__(self, memo): ...
    def __call__(self, exception: bool = True): ...
    def is_fixed(self): ...
    def is_potentially_variable(self): ...
    def getname(self, fully_qualified: bool = False, name_buffer=None, relative_to=None): ...
    def set_value(self, values=..., lock=None) -> None: ...
    def lock(self, lock): ...
    def unlock(self, lock) -> None: ...

class _TemplateResolver(StreamBasedExpressionVisitor):
    def beforeChild(self, node, child, child_idx): ...
    def exitNode(self, node, args): ...
    def initializeWalker(self, expr): ...

def resolve_template(expr): ...

class _wildcard_info:
    source: Incomplete
    original_value: Incomplete
    objects: Incomplete
    def __init__(self, src, obj) -> None: ...
    value: Incomplete
    def advance(self) -> None: ...
    iter: Incomplete
    def reset(self) -> None: ...
    def restore(self) -> None: ...

class ReplaceTemplateExpression(ExpressionReplacementVisitor):
    template_types: Incomplete
    substituter: Incomplete
    substituter_args: Incomplete
    def __init__(self, substituter, *args, **kwargs) -> None: ...
    def beforeChild(self, node, child, child_idx): ...

def substitute_template_expression(expr, substituter, *args, **kwargs): ...

class _GetItemIndexer:
    def __init__(self, expr) -> None: ...
    def nargs(self): ...
    def arg(self, i): ...
    @property
    def base(self): ...
    @property
    def args(self): ...
    def __hash__(self): ...
    def __eq__(self, other): ...

def substitute_getitem_with_param(expr, _map): ...
def substitute_template_with_value(expr): ...

class _set_iterator_template_generator:
    context: Incomplete
    def __init__(self, _set, context) -> None: ...
    def __iter__(self): ...
    def __next__(self): ...
    next = __next__

class _template_iter_context:
    cache: Incomplete
    def __init__(self) -> None: ...
    def get_iter(self, _set): ...
    def npop_cache(self, n): ...
    def next_id(self): ...
    def next_group(self): ...
    def sum_template(self, generator): ...

class _template_iter_manager:
    class _iter_wrapper:
        def __init__(self, cls, context) -> None: ...
        def acquire(self) -> None: ...
        def release(self) -> None: ...

    class _pause_template_iter_manager:
        iter_manager: Incomplete
        def __init__(self, iter_manager) -> None: ...
        def __enter__(self): ...
        def __exit__(
            self,
            et: type[BaseException] | None,
            ev: BaseException | None,
            tb: types.TracebackType | None,
        ) -> None: ...

    paused: bool
    context: Incomplete
    iters: Incomplete
    builtin_sum: Incomplete
    def __init__(self) -> None: ...
    def init(self, context, *iter_fcns): ...
    def acquire(self) -> None: ...
    def release(self) -> None: ...
    def __enter__(self): ...
    def __exit__(
        self,
        et: type[BaseException] | None,
        ev: BaseException | None,
        tb: types.TracebackType | None,
    ) -> None: ...
    def pause(self): ...

def templatize_rule(block, rule, index_set): ...
def templatize_constraint(con): ...
