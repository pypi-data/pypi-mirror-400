# ============================================================================
# TRECO Feature Example: Complete Extractors Guide
# ============================================================================
#
# Demonstrates all available extractors:
# - regex: Regular expression matching
# - jpath: JSONPath for JSON responses
# - xpath: XPath for HTML/XML responses
# - cookie: Extract cookies from Set-Cookie headers
# - header: Extract response headers
# - jinja2: Custom extraction with Jinja2 templates
#
# Usage:
#   treco examples/features/extractors-complete.yaml
#
# ============================================================================

metadata:
  name: "Complete Extractors Guide"
  version: "1.0"
  author: "TRECO Team"
  vulnerability: "N/A - Feature Demo"
  description: |
    Comprehensive demonstration of all extractor types available in TRECO
    for parsing HTTP responses and extracting data.

target:
  host: "httpbin.org"
  port: 443
  tls:
    enabled: true

entrypoint:
  state: regex_extractor_demo

states:
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # Extractor 1: REGEX (Regular Expressions)
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  regex_extractor_demo:
    description: "Demonstrate regex extraction"
    
    request: |
      GET /html HTTP/1.1
      Host: {{ target.host }}
    
    extract:
      # Simple capture group
      title:
        type: regex
        pattern: '<title>(.*?)</title>'
      
      # Named capture group
      author:
        type: regex
        pattern: 'Herman Melville'
      
      # Extract all matches (first one used)
      all_paragraphs:
        type: regex
        pattern: '<p>(.*?)</p>'
    
    logger:
      on_state_enter: |
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  Extractor: REGEX - Regular Expression Matching                              â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘  Use Case: Extract patterns from HTML, text, or any response body            â•‘
        â•‘  Features: Capture groups, lookaheads, case-insensitive matching             â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      
      on_state_leave: |
        âœ… Regex Extraction Results:
        â€¢ Title: {{ regex_extractor_demo.title }}
        â€¢ Author: {{ regex_extractor_demo.author }}
        â€¢ First Paragraph: {{ regex_extractor_demo.all_paragraphs[:50] }}...
        
        ğŸ’¡ Regex Tips:
        â€¢ Use (.*?) for non-greedy capture
        â€¢ \\d+ for numbers, \\w+ for words
        â€¢ (?i) for case-insensitive
        â€¢ | for alternatives
    
    next:
      - goto: jpath_extractor_demo

  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # Extractor 2: JPATH (JSONPath)
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  jpath_extractor_demo:
    description: "Demonstrate JSONPath extraction"
    
    request: |
      GET /json HTTP/1.1
      Host: {{ target.host }}
    
    extract:
      # Root level field
      slideshow_author:
        type: jpath
        pattern: "$.slideshow.author"
      
      # Array access
      first_slide_title:
        type: jpath
        pattern: "$.slideshow.slides[0].title"
      
      # Nested navigation
      slide_count:
        type: jpath
        pattern: "$.slideshow.slides[*]"
      
      # Complex path
      all_slide_titles:
        type: jpath
        pattern: "$.slideshow.slides[*].title"
    
    logger:
      on_state_enter: |
        
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  Extractor: JPATH - JSONPath for JSON Responses                              â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘  Use Case: Extract data from JSON APIs                                       â•‘
        â•‘  Features: Nested objects, arrays, filters, wildcards                        â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      
      on_state_leave: |
        âœ… JSONPath Extraction Results:
        â€¢ Author: {{ jpath_extractor_demo.slideshow_author }}
        â€¢ First Slide: {{ jpath_extractor_demo.first_slide_title }}
        â€¢ Slide Count: {{ jpath_extractor_demo.slide_count | length }}
        
        ğŸ’¡ JSONPath Syntax:
        â€¢ $ = root
        â€¢ . = child operator
        â€¢ [] = subscript operator
        â€¢ [*] = wildcard (all elements)
        â€¢ [?(@.field)] = filter expressions
    
    next:
      - goto: xpath_extractor_demo

  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # Extractor 3: XPATH (XPath for HTML/XML)
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  xpath_extractor_demo:
    description: "Demonstrate XPath extraction"
    
    request: |
      GET /forms/post HTTP/1.1
      Host: {{ target.host }}
    
    extract:
      # Extract attribute value
      form_action:
        type: xpath
        pattern: '//form/@action'
      
      # Extract element text
      submit_button_text:
        type: xpath
        pattern: '//button[@type="submit"]/text()'
      
      # Extract input names
      first_input_name:
        type: xpath
        pattern: '//input[1]/@name'
      
      # Complex XPath with predicates
      text_input_name:
        type: xpath
        pattern: '//input[@type="text"]/@name'
    
    logger:
      on_state_enter: |
        
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  Extractor: XPATH - XPath for HTML/XML Parsing                               â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘  Use Case: Extract data from HTML forms, pages, XML responses                â•‘
        â•‘  Features: Element selection, attributes, predicates, text nodes             â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      
      on_state_leave: |
        âœ… XPath Extraction Results:
        â€¢ Form Action: {{ xpath_extractor_demo.form_action }}
        â€¢ Button Text: {{ xpath_extractor_demo.submit_button_text }}
        â€¢ First Input: {{ xpath_extractor_demo.first_input_name }}
        â€¢ Text Input: {{ xpath_extractor_demo.text_input_name }}
        
        ğŸ’¡ XPath Syntax:
        â€¢ // = descendant selector
        â€¢ / = child selector
        â€¢ @ = attribute selector
        â€¢ [@attr='value'] = predicate filter
        â€¢ text() = text node
        â€¢ [1] = first element (1-indexed!)
    
    next:
      - goto: cookie_extractor_demo

  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # Extractor 4: COOKIE (Extract Cookies)
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  cookie_extractor_demo:
    description: "Demonstrate cookie extraction"
    
    request: |
      GET /cookies/set?session=abc123&user=john HTTP/1.1
      Host: {{ target.host }}
    
    extract:
      # Extract specific cookie
      session_cookie:
        type: cookie
        pattern: session
      
      # Extract another cookie
      user_cookie:
        type: cookie
        pattern: user
    
    logger:
      on_state_enter: |
        
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  Extractor: COOKIE - Extract HTTP Cookies                                    â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘  Use Case: Capture session tokens, CSRF tokens, auth cookies                 â•‘
        â•‘  Features: Automatic Set-Cookie parsing                                      â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      
      on_state_leave: |
        âœ… Cookie Extraction Results:
        â€¢ Session: {{ cookie_extractor_demo.session_cookie }}
        â€¢ User: {{ cookie_extractor_demo.user_cookie }}
        
        ğŸ’¡ Cookie Extractor:
        â€¢ Automatically parses Set-Cookie headers
        â€¢ Extracts cookie value only (not attributes)
        â€¢ Use in subsequent requests: Cookie: name={{ state.cookie }}
    
    next:
      - goto: header_extractor_demo

  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # Extractor 5: HEADER (Extract Response Headers)
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  header_extractor_demo:
    description: "Demonstrate header extraction"
    
    request: |
      GET /response-headers?X-Custom-Token=secret123&X-Rate-Limit=100 HTTP/1.1
      Host: {{ target.host }}
    
    extract:
      # Extract custom header
      custom_token:
        type: header
        pattern: X-Custom-Token
      
      # Extract rate limit
      rate_limit:
        type: header
        pattern: X-Rate-Limit
      
      # Extract standard header
      content_type:
        type: header
        pattern: Content-Type
    
    logger:
      on_state_enter: |
        
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  Extractor: HEADER - Extract HTTP Response Headers                           â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘  Use Case: Capture tokens, rate limits, API metadata                         â•‘
        â•‘  Features: Case-insensitive header matching                                  â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      
      on_state_leave: |
        âœ… Header Extraction Results:
        â€¢ Custom Token: {{ header_extractor_demo.custom_token }}
        â€¢ Rate Limit: {{ header_extractor_demo.rate_limit }}
        â€¢ Content-Type: {{ header_extractor_demo.content_type }}
        
        ğŸ’¡ Header Extractor:
        â€¢ Case-insensitive matching
        â€¢ Extracts header value as-is
        â€¢ Common headers: Location, ETag, X-CSRF-Token
    
    next:
      - goto: jinja2_extractor_demo

  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # Extractor 6: JINJA2 (Custom Template Extraction)
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  jinja2_extractor_demo:
    description: "Demonstrate Jinja2 template extraction"
    
    request: |
      GET /json HTTP/1.1
      Host: {{ target.host }}
    
    extract:
      # Custom computation using Jinja2
      computed_value:
        type: jinja2
        pattern: "{{ response.text | length }}"
      
      # Extract and transform
      uppercase_author:
        type: jinja2
        pattern: "{{ (response.json().slideshow.author | default('Unknown')) | upper }}"
      
      # Conditional extraction
      has_slides:
        type: jinja2
        pattern: "{{ 'YES' if 'slides' in response.json().slideshow else 'NO' }}"
      
      # Complex transformation
      slide_summary:
        type: jinja2
        pattern: "Author: {{ response.json().slideshow.author }}, Slides: {{ response.json().slideshow.slides | length }}"
    
    logger:
      on_state_enter: |
        
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  Extractor: JINJA2 - Custom Template-Based Extraction                        â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘  Use Case: Complex transformations, computations, conditional extraction     â•‘
        â•‘  Features: Full Jinja2 syntax, filters, conditionals, custom logic           â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      
      on_state_leave: |
        âœ… Jinja2 Extraction Results:
        â€¢ Computed Value: {{ jinja2_extractor_demo.computed_value }}
        â€¢ Uppercase Author: {{ jinja2_extractor_demo.uppercase_author }}
        â€¢ Has Slides: {{ jinja2_extractor_demo.has_slides }}
        â€¢ Slide Summary: {{ jinja2_extractor_demo.slide_summary }}
        
        ğŸ’¡ Jinja2 Extractor:
        â€¢ Access: response.text, response.json(), response.status_code
        â€¢ Filters: | upper, | lower, | length, | default
        â€¢ Logic: if/else, loops, string operations
        â€¢ Use for: Complex data transformations
    
    next:
      - goto: summary_state

  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  # Summary: When to use each extractor
  # â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  summary_state:
    description: "Summary of extractors"
    
    request: |
      GET /get HTTP/1.1
      Host: {{ target.host }}
    
    logger:
      on_state_enter: |
        
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  ğŸ“Š Extractors Comparison                                                    â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘                                                                              â•‘
        â•‘  REGEX                                                                       â•‘
        â•‘  â€¢ Best for: Pattern matching in any text                                    â•‘
        â•‘  â€¢ Use when: No structured format (HTML without valid markup)                â•‘
        â•‘  â€¢ Example: <input name="csrf" value="([^"]+)">                              â•‘
        â•‘                                                                              â•‘
        â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
        â•‘                                                                              â•‘
        â•‘  JPATH (JSONPath)                                                            â•‘
        â•‘  â€¢ Best for: JSON APIs                                                       â•‘
        â•‘  â€¢ Use when: Response is JSON                                                â•‘
        â•‘  â€¢ Example: $.user.token                                                     â•‘
        â•‘                                                                              â•‘
        â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
        â•‘                                                                              â•‘
        â•‘  XPATH                                                                       â•‘
        â•‘  â€¢ Best for: HTML/XML documents                                              â•‘
        â•‘  â€¢ Use when: Valid HTML structure                                            â•‘
        â•‘  â€¢ Example: //input[@name="csrf"]/@value                                     â•‘
        â•‘                                                                              â•‘
        â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
        â•‘                                                                              â•‘
        â•‘  COOKIE                                                                      â•‘
        â•‘  â€¢ Best for: Session tokens, auth cookies                                    â•‘
        â•‘  â€¢ Use when: Extracting from Set-Cookie                                      â•‘
        â•‘  â€¢ Example: session                                                          â•‘
        â•‘                                                                              â•‘
        â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
        â•‘                                                                              â•‘
        â•‘  HEADER                                                                      â•‘
        â•‘  â€¢ Best for: Response metadata, rate limits                                  â•‘
        â•‘  â€¢ Use when: Data in HTTP headers                                            â•‘
        â•‘  â€¢ Example: X-CSRF-Token                                                     â•‘
        â•‘                                                                              â•‘
        â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘
        â•‘                                                                              â•‘
        â•‘  JINJA2                                                                      â•‘
        â•‘  â€¢ Best for: Complex transformations                                         â•‘
        â•‘  â€¢ Use when: Need computation or logic                                       â•‘
        â•‘  â€¢ Example: {{ response.json().data | length }}                              â•‘
        â•‘                                                                              â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        ğŸ¯ Quick Decision Guide:
        
        Q: Extracting from JSON?
        â†’ Use JPATH
        
        Q: Extracting from HTML form?
        â†’ Use XPATH (faster) or REGEX (more flexible)
        
        Q: Need a cookie value?
        â†’ Use COOKIE
        
        Q: Need a header value?
        â†’ Use HEADER
        
        Q: Need transformation or computation?
        â†’ Use JINJA2
        
        Q: Unstructured text?
        â†’ Use REGEX
        
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  âœ… Extractors Demo Complete!                                                â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•