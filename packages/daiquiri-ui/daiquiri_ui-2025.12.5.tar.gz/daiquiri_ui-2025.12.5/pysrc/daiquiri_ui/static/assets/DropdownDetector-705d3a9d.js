import{u as M,c as L,a as b,L as C,S as z,b as A,d as S}from"./AutoscaleOption-e2ee098d.js";import{r as j,bP as T,aL as P,aZ as F,j as t,ay as I,g as R,R as i,aj as u,C as d,B as f}from"./index-4cf586ed.js";import{A as m}from"./colormap-0981f7dc.js";import{a as N}from"./index-19c84627.js";function $(e,o,s,n=!1){const a=j.useRef(),c=j.useRef();return T(()=>{a.current&&clearTimeout(a.current)}),j.useMemo(()=>{const w=(h,g)=>{c.current=void 0,e.apply(h,g),a.current=setTimeout(()=>{a.current=void 0,!n&&c.current&&(w(c.current.this,c.current.args),c.current=void 0)},s)},x=function(...h){if(a.current){c.current={args:h,this:this};return}w(this,h)};return Object.defineProperties(x,{length:{value:e.length},name:{value:`${e.name||"anonymous"}__throttled__${s}`}}),x},[s,n,...o])}function q(){return{...M({name:"tomo/defaultcolormap"})}}P("daiquiri.components.tomo.utils.TomoDetector");function G(e){const o=F();return j.useMemo(()=>{function s(){var a;if(e.sampleStage){const{detector:c}=e.sampleStage;return c?c.id:""}return((a=e.sampleStageRefs)==null?void 0:a.detector)??""}const n=s();return o[n]},[e.sampleStage,o])}function V(e){const[o,s]=L(),n=$(s,[e.minRefreshPeriod,s],e.minRefreshPeriod*1e3,!0);j.useEffect(()=>{e.profile!=="u8"&&e.enabled&&e.detector&&n({detector:e.detector,lut:"Cividis",autoscale:m.StdDev3,normalization:N.Linear,process:e.processing??b.Flatfield,profiles:[e.profile],histogram:e.histogram})},[e.detector,n,e.enabled,e.profile,e.processing,e.histogram]);function a(){return e.autoscale&&e.autoscaleMode!==m.None?{autoscale:e.autoscaleMode}:{vmin:e.domain[0],vmax:e.domain[1],autoscale:m.None}}return j.useEffect(()=>{e.profile==="u8"&&e.enabled&&e.detector&&n({detector:e.detector,lut:"Cividis",normalization:e.normalization,process:e.processing??b.Flatfield,profiles:[e.profile],histogram:e.histogram,...a()})},[e.detector,n,e.enabled,e.profile,e.processing,e.autoscale,e.autoscaleMode,e.normalization,e.domain[0],e.domain[1],e.histogram]),o}function B(e){if(!e.array||!e.array.info)return t.jsx(t.Fragment,{});function o(a){return a<1e3?`${a} B`:a<1e5?`${(a/1e3).toFixed(1)} KB`:`${(a/1e6).toFixed(1)} MB`}function s(a){return a.map(c=>`${c}`).join(" × ")}const n=e.array.info;return t.jsxs(t.Fragment,{children:[t.jsx(i,{children:t.jsx("h6",{className:"flex-grow-1 text-center",children:"Info"})}),t.jsxs(i,{children:[t.jsx(d,{children:t.jsx("h6",{children:"Shape"})}),t.jsx(d,{children:s(e.array.array.shape)})]}),t.jsxs(i,{children:[t.jsx(d,{children:t.jsx("h6",{children:"Profile"})}),t.jsx(d,{children:n.profile})]}),t.jsxs(i,{children:[t.jsx(d,{children:t.jsx("h6",{children:"Size"})}),t.jsx(d,{children:o(n.byteLength)})]}),t.jsxs(i,{children:[t.jsx(d,{children:t.jsx("h6",{title:"Data type of the source",children:"Type"})}),t.jsx(d,{children:n.dtype})]})]})}function H(e){const{as:o=void 0,showDisplayed:s=!0}=e;function n(r,l){const y=e.lut===r?"primary":"secondary";return t.jsx(f,{variant:y,onClick:()=>{e.onSelectLut(r)},className:"text-nowrap",title:l,size:"sm",children:t.jsx(C,{name:r})})}function a(r){const l=e.autoscaleMode===r,v=l&&e.autoscale?"primary":l?"warning":"secondary",D={[m.Minmax]:"Minmax",[m.StdDev3]:"3×std",[m.None]:"Manual"}[r];return t.jsx(f,{variant:v,onClick:()=>{e.onSelectAutoscaleMode(r),e.onSelectAutoscale(!0)},size:"sm",children:D})}function c(){const r=e.autoscale?"primary":"secondary";return t.jsxs(f,{variant:r,onClick:()=>{e.onSelectAutoscale(!e.autoscale)},size:"sm",children:[t.jsx("i",{className:"fa-solid fa-circle-half-stroke fa-fw fa-lg"})," Auto scale enabled"]})}function w(){const r=e.isInverted?"primary":"secondary";return t.jsxs(f,{variant:r,onClick:()=>{e.onSelectInvertion(!e.isInverted)},size:"sm",children:[t.jsx("i",{className:"fa fa-fw fa-arrows-alt-v"})," Inverted LUT"]})}function x(r,l){const y=e.norm===r?"primary":"secondary";return t.jsx(f,{variant:y,onClick:()=>{e.onSelectNorm(r)},size:"sm",children:l})}function h(){const r=e.isDisplayed?"primary":"secondary";return t.jsx(f,{variant:r,onClick:()=>{e.onSelectDisplayed(!e.isDisplayed)},size:"sm",children:"Display detector data"})}function g(r,l,v){const D=e.profile===r?"primary":"secondary";return t.jsx(f,{variant:D,onClick:()=>{e.onSelectProfile(r)},size:"sm",title:v,children:l})}return t.jsxs(I,{as:o,className:`${e.dropDirection==="up"?"dropup":""}`,children:[t.jsxs(I.Toggle,{id:"dropdown-basic",variant:e.variant,className:"d-flex align-items-center",children:[t.jsx("i",{className:"fa fam-hardware-camera fa-lg me-1"}),e.isDisplayed&&t.jsxs(t.Fragment,{children:[t.jsx(C,{name:e.lut}),t.jsx(z,{scale:e.norm}),e.autoscale&&t.jsx(A,{autoscale:e.autoscaleMode})]})]}),t.jsx(I.Menu,{className:"dropdown-menu-center",children:t.jsx("div",{className:"ms-1 me-1",children:t.jsxs(R,{children:[s&&t.jsxs(t.Fragment,{children:[t.jsx(i,{children:t.jsx("h6",{className:"flex-grow-1 text-center",children:"Detector"})}),t.jsx(i,{children:t.jsx(u,{className:"flex-grow-1 mt-1 mb-2",children:h()})})]}),t.jsx(i,{children:t.jsx("h6",{className:"flex-grow-1 text-center",children:"Lookup table"})}),t.jsx(i,{children:t.jsxs(u,{className:"flex-grow-1",children:[n("Greys","Gray"),n("Viridis","Viridis"),n("Cividis","Cividis"),n("Magma","Magma"),n("Inferno","Inferno"),n("Plasma","Plasma")]})}),t.jsx(i,{children:t.jsx(u,{className:"flex-grow-1 mt-1 mb-2",children:w()})}),t.jsx(i,{children:t.jsx("h6",{className:"flex-grow-1 text-center",children:"Auto scale"})}),t.jsx(i,{children:t.jsxs(u,{className:"flex-grow-1 mt-1",children:[a(m.Minmax),a(m.StdDev3)]})}),t.jsx(i,{children:t.jsx(u,{className:"flex-grow-1 mt-1 mb-2",children:c()})}),t.jsx(i,{children:t.jsx("h6",{className:"flex-grow-1 text-center",children:"Normalization"})}),t.jsx(i,{children:t.jsxs(u,{className:"flex-grow-1 mt-1 mb-2",children:[x(N.Linear,"Linear"),x(N.Log,"Log"),x(N.SymLog,"SymLog")]})}),t.jsx(i,{children:t.jsx("h6",{className:"flex-grow-1 text-center",title:"How to transfer the data",children:"Profile"})}),t.jsx(i,{children:t.jsxs(u,{className:"flex-grow-1 mt-1 mb-2",children:[g(S.Raw,"Raw","Transfer data as it is provided by the detector or the processing"),g(S.F16,"Float 16b","Transfer data as float 16-bits"),g(S.U8,"8-bits","Transfer data as 8-bits")]})}),t.jsx(B,{array:e.array})]})})})]})}export{H as D,G as a,V as b,q as u};
