"""
Exploit Simulation Engine (SAFE)

This module simulates exploitation impact without payloads,
shells, or bypass instructions. It is designed for authorized
testing, learning, and professional reporting.
"""

SIMULATIONS = {
    "missing_x_frame_options": {
        "name": "Clickjacking (Simulated)",
        "description": (
            "The application can be embedded in an iframe, allowing "
            "UI redressing attacks where users may unknowingly perform actions."
        ),
        "likelihood": "Medium",
        "impact": "High",
        "proof": [
            "X-Frame-Options header is absent",
            "Browser allows iframe embedding",
            "User interaction can be visually manipulated"
        ],
        "detection": [
            "CSP / frame-ancestors violations (if CSP exists)",
            "Unusual user interaction patterns",
            "Referrer anomalies"
        ],
        "remediation": [
            "Set X-Frame-Options: DENY or SAMEORIGIN",
            "Use CSP frame-ancestors directive"
        ],
        "mitre": "T1185",
        "owasp": "A05:2021"
    },

    "missing_x_content_type_options": {
        "name": "MIME Sniffing (Simulated)",
        "description": (
            "Browsers may incorrectly interpret file types, "
            "leading to script execution in unexpected contexts."
        ),
        "likelihood": "Low",
        "impact": "Medium",
        "proof": [
            "X-Content-Type-Options header is absent",
            "Browser may perform MIME sniffing"
        ],
        "detection": [
            "Unexpected content execution",
            "Browser console warnings"
        ],
        "remediation": [
            "Set X-Content-Type-Options: nosniff"
        ],
        "mitre": "T1059",
        "owasp": "A05:2021"
    }
}


def simulate(vuln_key: str):
    """
    Run a safe exploit simulation for a given vulnerability key.
    """
    if vuln_key not in SIMULATIONS:
        print(f"[!] No simulation available for: {vuln_key}")
        print("[+] Available simulations:")
        for key in SIMULATIONS:
            print(f"    - {key}")
        return

    sim = SIMULATIONS[vuln_key]

    print("\n--- Exploit Simulation (SAFE) ---\n")
    print(f"Vulnerability : {sim['name']}")
    print(f"Description   : {sim['description']}\n")

    print(f"Likelihood    : {sim['likelihood']}")
    print(f"Impact        : {sim['impact']}\n")

    print("[+] Proof of Impact:")
    for item in sim["proof"]:
        print(f"    - {item}")

    print("\n[+] Blue Team Detection:")
    for item in sim["detection"]:
        print(f"    - {item}")

    print("\n[+] Remediation:")
    for item in sim["remediation"]:
        print(f"    - {item}")

    print("\n[+] Framework Mapping:")
    print(f"    MITRE ATT&CK : {sim['mitre']}")
    print(f"    OWASP       : {sim['owasp']}")

    print("\n[+] Simulation complete (no exploitation performed).")
