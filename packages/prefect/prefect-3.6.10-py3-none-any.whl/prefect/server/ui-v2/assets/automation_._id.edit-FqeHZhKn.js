import{j as t,s as b,r as w,G as x}from"./vendor-tanstack-BVzzyDEt.js";import{D as _,B as A,a as j,b as d,bq as v,bz as k,bB as S,db as g,dX as E,w as p,dY as N}from"./index-BJkJ93Lr.js";import{A as q}from"./automation-wizard-DYQKHgDR.js";import{U as n}from"./automation-schema-CK40VptI.js";import"./vendor-react-Bce9NwRC.js";import"./vendor-radix-CTAic6HB.js";import"./vendor-recharts-Mwm2qLZp.js";import"./vendor-forms-BN3tpxM2.js";import"./vendor-date-2jFo9aCm.js";import"./use-stepper-D5a6mnYn.js";import"./index-BCjE1NvU.js";import"./textarea-BWNxlLo9.js";import"./radio-group-Bp8yWMIB.js";import"./collapsible-B_Qn5IIc.js";const I=()=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(T,{}),t.jsx(_,{label:"Documentation",id:"automations-guide"})]}),T=()=>t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(A,{children:t.jsxs(j,{children:[t.jsx(d,{children:t.jsx(v,{to:"/automations",className:"text-xl font-semibold",children:"Automations"})}),t.jsx(k,{}),t.jsx(d,{className:"text-xl font-semibold",children:t.jsx(S,{children:"Edit Automation"})})]})})});function B(e){switch(e.type){case"run-deployment":return{type:"run-deployment",deployment_id:e.deployment_id??n,parameters:e.parameters??void 0,job_variables:e.job_variables??void 0};case"pause-deployment":case"resume-deployment":return{type:e.type,deployment_id:e.deployment_id??n};case"pause-work-queue":case"resume-work-queue":return{type:e.type,work_queue_id:e.work_queue_id??n};case"pause-work-pool":case"resume-work-pool":return{type:e.type,work_pool_id:e.work_pool_id??n};case"pause-automation":case"resume-automation":return{type:e.type,automation_id:e.automation_id??n};case"cancel-flow-run":case"suspend-flow-run":case"resume-flow-run":return{type:e.type};case"change-flow-run-state":return{type:"change-flow-run-state",state:e.state,name:e.name??void 0,message:e.message??void 0};case"send-notification":return{type:"send-notification",block_document_id:e.block_document_id,body:e.body,subject:e.subject};case"do-nothing":return{type:"do-nothing"};case"call-webhook":return{type:"do-nothing"};default:return{type:"do-nothing"}}}function c(e){switch(e.type){case"event":return{type:"event",posture:e.posture,threshold:e.threshold,within:e.within,match:e.match,match_related:Array.isArray(e.match_related)?e.match_related[0]:e.match_related,for_each:e.for_each,after:e.after,expect:e.expect};case"compound":return{type:"compound",triggers:e.triggers.map(c),require:e.require,within:e.within??void 0};case"sequence":return{type:"sequence",triggers:e.triggers.map(c),within:e.within??void 0};default:return{type:"event",posture:"Reactive",threshold:1,within:0}}}function V(e){if(e.type!=="event")return"custom";const o=e.match?.["prefect.resource.id"];if(!o)return"custom";const r=Array.isArray(o)?o[0]:o;return r?.startsWith("prefect.flow-run.")?"flow-run-state":r?.startsWith("prefect.deployment.")?"deployment-status":r?.startsWith("prefect.work-pool.")?"work-pool-status":r?.startsWith("prefect.work-queue.")?"work-queue-status":"custom"}function F(e){return{name:e.name,description:e.description||void 0,triggerTemplate:V(e.trigger),trigger:c(e.trigger),actions:e.actions.map(B)}}function P(e){return{name:e.name,description:e.description??"",trigger:e.trigger,actions:e.actions}}const L=e=>{const{automationId:o,onSuccess:r,onError:u}=e,{data:s,isLoading:i}=b(g(o)),a=w.useMemo(()=>{if(s)return F(s)},[s]),{replaceAutomation:l,isPending:f}=E();return{defaultValues:a,isLoading:i,updateAutomation:h=>{const y=P(h);l({id:o,enabled:s?.enabled??!0,...y},{onSuccess:()=>{r?.()},onError:m=>{u?.(m instanceof Error?m:new Error(String(m)))}})},isPending:f}},R=({id:e})=>{const o=x(),{defaultValues:r,updateAutomation:u,isPending:s}=L({automationId:e,onSuccess:()=>{p.success("Automation updated successfully"),o({to:"/automations"})},onError:a=>{p.error(`Failed to update automation: ${a.message}`,{duration:Number.POSITIVE_INFINITY})}}),i=a=>{u(a)};return t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsx(I,{}),t.jsx(q,{defaultValues:r,onSubmit:i,submitLabel:"Save",isSubmitting:s})]})};function Z(){const{id:e}=N.useParams();return t.jsx(R,{id:e})}export{Z as component};
//# sourceMappingURL=automation_._id.edit-FqeHZhKn.js.map
