use super::{AdlerZero, FixedKMatrix};
use laddu_core::{
    amplitudes::{Amplitude, AmplitudeID, Expression, ParameterLike},
    data::{DatasetMetadata, EventData},
    resources::{Cache, ComplexVectorID, MatrixID, ParameterID, Parameters, Resources},
    utils::variables::{Mass, Variable},
    LadduResult,
};
#[cfg(feature = "python")]
use laddu_python::{
    amplitudes::{PyExpression, PyParameterLike},
    utils::variables::PyMass,
};
use nalgebra::{matrix, vector, DVector, SMatrix, SVector};
use num::complex::Complex64;
#[cfg(feature = "python")]
use pyo3::prelude::*;
use serde::{Deserialize, Serialize};
use std::array;

const G_F0: SMatrix<f64, 5, 5> = matrix![
     0.74987,  0.06401, -0.23417,  0.01270, -0.14242;
    -0.01257,  0.00204, -0.01032,  0.26700,  0.22780;
     0.27536,  0.77413,  0.72283,  0.09214,  0.15981;
    -0.15102,  0.50999,  0.11934,  0.02742,  0.16272;
     0.36103,  0.13112,  0.36792, -0.04025, -0.17397

];

const C_F0: SMatrix<f64, 5, 5> = matrix![
     0.03728,  0.00000, -0.01398, -0.02203,  0.01397;
     0.00000,  0.00000,  0.00000,  0.00000,  0.00000;
    -0.01398,  0.00000,  0.02349,  0.03101, -0.04003;
    -0.02203,  0.00000,  0.03101, -0.13769, -0.06722;
     0.01397,  0.00000, -0.04003, -0.06722, -0.28401
];

const M_F0: SVector<f64, 5> = vector![0.51461, 0.90630, 1.23089, 1.46104, 1.69611];

const COV_F0: SMatrix<f64, 56, 56> = matrix![
    0.00000038416474, 0.00000012086319, -0.00000010541500, 0.00000004959305, -0.00000073172518, 0.00000025025714, 0.00000013624292, 0.00000202404758, 0.00000045926249, -0.00000196272743, 0.00000007375962, 0.00000028551897, -0.00000145150879, -0.00000495790389, -0.00000815350869, 0.00000001880270, -0.00000481241122, -0.00000014978926, -0.00000097212786, -0.00000377785952, -0.00000011084391, -0.00000033529623, -0.00000440050298, -0.00000372468270, -0.00000819641669, -0.00000008756379, 0.00000000000000, 0.00000028492152, -0.00000007080032, -0.00000003525862, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000570019211, 0.00000140788070, 0.00000146602158, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000062044013, -0.00000019322965, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000035807549, 0.00000011875204, 0.00000095343854, -0.00000007983344, 0.00000015381278, -0.00000069358975, 0.00000000000000;
    0.00000012086319, 0.00001069325660, 0.00000211914246, 0.00000072323919, -0.00000270504921, 0.00000068479547, 0.00000172831841, 0.00000137727633, 0.00000292013189, -0.00000262794267, 0.00000048899246, 0.00008637965994, 0.00000107520747, 0.00000307995603, -0.00000596422190, -0.00000010332802, -0.00000662351527, 0.00001010606483, -0.00000090309163, 0.00001663652053, 0.00000667079324, -0.00000166687183, 0.00005870423300, -0.00000071964844, 0.00001659461117, 0.00000034050562, 0.00000000000000, 0.00000031832625, 0.00000111863323, -0.00000265717702, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001910049731, 0.00000245452286, 0.00000126864916, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000728498662, -0.00000510346017, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000260673242, -0.00000015380664, 0.00000190258872, 0.00000408626531, -0.00000514298417, -0.00000001558411, 0.00000000000000;
    -0.00000010541500, 0.00000211914246, 0.00006308106660, 0.00000448671629, 0.00000886844753, 0.00000075902835, -0.00000016309621, -0.00001555533691, 0.00001617113083, -0.00001921084683, 0.00001048242987, -0.00000901630365, -0.00007623081931, -0.00001499472983, 0.00003125819056, -0.00000114325313, 0.00013958512218, 0.00015158456292, -0.00000703506370, 0.00004961864552, 0.00000635761943, 0.00000313225116, -0.00001426690715, 0.00002140121117, -0.00000438952594, -0.00000752965693, 0.00000000000000, 0.00000801475465, -0.00000768035596, 0.00000410384199, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000364962847, -0.00000598404380, -0.00003162924824, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00002474994945, 0.00000139914020, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000143036718, -0.00000421013823, -0.00003044583945, 0.00002636829049, 0.00000765687029, 0.00003347499894, -0.00000000000000;
    0.00000004959305, 0.00000072323919, 0.00000448671629, 0.00001732561411, 0.00000484693692, 0.00000806870709, 0.00000209704873, 0.00002058483270, 0.00004019477265, -0.00002044580555, 0.00000059139418, 0.00000509428740, -0.00002980132014, -0.00005701098319, -0.00000738378675, 0.00000000980323, 0.00004230552584, 0.00002306466404, -0.00000367333902, 0.00000306690324, 0.00000045641660, 0.00000154451569, 0.00000551088452, -0.00001215272212, -0.00000890881244, -0.00000062218702, 0.00000000000000, 0.00000107411418, -0.00000210136912, 0.00000047635164, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000330767612, 0.00000002246225, -0.00000813971898, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000754891426, 0.00000262558057, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000006319895, -0.00000064512347, -0.00000852638932, -0.00000528775541, -0.00001108576507, 0.00002182499606, -0.00000000000000;
    -0.00000073172518, -0.00000270504921, 0.00000886844753, 0.00000484693692, 0.00002928811851, 0.00001079925311, -0.00000135390182, -0.00009327500529, -0.00000895978788, -0.00000666263861, -0.00000464912410, 0.00006534545345, 0.00002957260129, 0.00004513463722, 0.00011675817783, 0.00000016904393, 0.00012246592592, 0.00006877707840, 0.00003573370385, 0.00002648748279, -0.00000048644988, 0.00000253207524, 0.00007057567365, 0.00006898155904, 0.00012768343331, 0.00000142293335, 0.00000000000000, -0.00000426065489, -0.00001056327125, 0.00000301763995, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00005875699756, -0.00000724572672, -0.00002645154547, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00001835243838, 0.00000280293733, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000355132302, -0.00000107067592, -0.00002440560676, -0.00000688940469, 0.00001193219291, 0.00004445070515, 0.00000000000000;
    0.00000025025714, 0.00000068479547, 0.00000075902835, 0.00000806870709, 0.00001079925311, 0.00003034155260, 0.00000388955052, -0.00000955557275, 0.00001133613650, -0.00002674251355, -0.00000305877637, 0.00004104166973, -0.00001346712025, -0.00002618132367, -0.00000152831019, -0.00000052239791, 0.00003789693348, 0.00003645535960, 0.00001058984313, -0.00000012772064, 0.00000280657802, -0.00000446784008, 0.00003038866256, 0.00003452000830, 0.00002051463363, 0.00000069823845, 0.00000000000000, -0.00000121045272, -0.00000486228862, 0.00000098652555, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001023762597, 0.00000414027799, -0.00000866921457, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000870622420, -0.00000073422504, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000001194887, -0.00000038247065, -0.00000625575424, -0.00000540401832, 0.00000450557217, 0.00002839537607, -0.00000000000000;
    0.00000013624292, 0.00000172831841, -0.00000016309621, 0.00000209704873, -0.00000135390182, 0.00000388955052, 0.00000802949687, 0.00003051403997, 0.00000351609343, 0.00000488597839, 0.00000023905688, 0.00001384761408, 0.00000473010853, -0.00002288392956, -0.00000204718756, -0.00000024108368, 0.00000959437556, 0.00000256238287, -0.00000846684431, 0.00000259189645, -0.00000002060395, -0.00000006395765, -0.00000417724794, -0.00001895963945, -0.00001137476788, 0.00000011342831, 0.00000000000000, -0.00000037464064, 0.00000062782717, -0.00000052300193, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000436261216, 0.00000012558404, 0.00000362703454, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000072505189, 0.00000119851785, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000171159723, 0.00000006776880, -0.00000209532570, 0.00000053529109, -0.00000332621718, -0.00000323885619, 0.00000000000000;
    0.00000202404758, 0.00000137727633, -0.00001555533691, 0.00002058483270, -0.00009327500529, -0.00000955557275, 0.00003051403997, 0.00064539175053, 0.00010838473709, 0.00003484676560, 0.00001523281868, -0.00044270575544, -0.00017623707101, -0.00036731905180, -0.00049714177781, -0.00000244041871, -0.00043877928684, -0.00032702657831, -0.00017877185363, -0.00006533077508, -0.00000562690934, -0.00001649264971, -0.00050172589396, -0.00046469938359, -0.00056986330053, -0.00000990083751, 0.00000000000000, 0.00002216999791, 0.00004544499295, -0.00000638416025, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00018107374647, 0.00001858584996, 0.00011648527271, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00002003190278, 0.00000877534557, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001901797303, 0.00000271758727, 0.00007591528640, 0.00002030449073, -0.00006886585493, -0.00017913088239, -0.00000000000000;
    0.00000045926249, 0.00000292013189, 0.00001617113083, 0.00004019477265, -0.00000895978788, 0.00001133613650, 0.00000351609343, 0.00010838473709, 0.00024368622913, -0.00006813302251, 0.00000372394466, 0.00003372181760, -0.00005695700857, -0.00034396828004, 0.00003481879193, -0.00000088101280, 0.00012536980032, 0.00011908652304, -0.00003442154015, 0.00000501323184, -0.00000764323727, 0.00000648047117, 0.00006255746925, 0.00002898420528, -0.00006871349014, -0.00000217879398, 0.00000000000000, 0.00000362122209, -0.00000932536666, -0.00000195518254, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00002263231925, -0.00001447608148, -0.00003285629277, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00001507521778, 0.00000759840056, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000671950207, -0.00000101525232, -0.00002188013983, -0.00001193459838, -0.00014381500539, 0.00004906561841, -0.00000000000000;
    -0.00000196272743, -0.00000262794267, -0.00001921084683, -0.00002044580555, -0.00000666263861, -0.00002674251355, 0.00000488597839, 0.00003484676560, -0.00006813302251, 0.00012165769156, -0.00000272393945, -0.00000838667580, 0.00014924688764, 0.00015637882148, 0.00014220425227, -0.00000116740587, -0.00011828381265, -0.00011865496581, 0.00002666846984, 0.00006478253307, 0.00000020840244, -0.00000120158736, -0.00004629576057, -0.00007917730163, 0.00008137518089, 0.00000341042875, 0.00000000000000, -0.00000738345358, 0.00000989274671, -0.00000273602610, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00007727646808, -0.00002559655685, 0.00004112215389, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000436027638, -0.00000031685088, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000035984226, 0.00000170375009, 0.00001737305991, 0.00000867473378, 0.00000768845221, -0.00005049421412, 0.00000000000000;
    0.00000007375962, 0.00000048899246, 0.00001048242987, 0.00000059139418, -0.00000464912410, -0.00000305877637, 0.00000023905688, 0.00001523281868, 0.00000372394466, -0.00000272393945, 0.00002329702591, -0.00004211195666, -0.00005251923165, 0.00000631277682, -0.00004566053502, -0.00000187817102, 0.00000403568121, 0.00000693900115, -0.00000660894587, -0.00000046221655, -0.00000196287123, -0.00000155449065, -0.00004314474044, -0.00001252647897, -0.00005280810117, -0.00000239798805, 0.00000000000000, 0.00000519725021, 0.00000154353398, -0.00000009462799, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00002006297038, -0.00000205517348, 0.00000529786430, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000244868243, 0.00000133735584, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000240841779, -0.00000162513242, -0.00000044060710, -0.00000054609067, -0.00000057994248, -0.00000566143084, -0.00000000000000;
    0.00000028551897, 0.00008637965994, -0.00000901630365, 0.00000509428740, 0.00006534545345, 0.00004104166973, 0.00001384761408, -0.00044270575544, 0.00003372181760, -0.00000838667580, -0.00004211195666, 0.00345433741939, 0.00054870289734, -0.00023536058377, 0.00087429720194, 0.00000829421251, 0.00068426302250, 0.00115069808075, 0.00023169539180, 0.00050726123274, 0.00022722811242, 0.00013292841865, 0.00221090409928, 0.00032075189373, 0.00097968136040, 0.00003152142681, 0.00000000000000, -0.00004564385728, -0.00008480581342, -0.00006004372317, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00013265000864, 0.00004358141155, -0.00005158704555, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00024754525830, -0.00014047108064, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00014340839111, -0.00000922266872, -0.00015083831839, 0.00000525746179, -0.00014722594906, 0.00017580416038, -0.00000000000000;
    -0.00000145150879, 0.00000107520747, -0.00007623081931, -0.00002980132014, 0.00002957260129, -0.00001346712025, 0.00000473010853, -0.00017623707101, -0.00005695700857, 0.00014924688764, -0.00005251923165, 0.00054870289734, 0.00154904189935, 0.00002041937412, 0.00134936030006, 0.00000775754559, -0.00020800533287, 0.00012715366496, 0.00016982002165, 0.00036033664503, -0.00004141442668, -0.00001036779068, 0.00045839121313, 0.00032316491564, 0.00086204920873, 0.00003509444701, 0.00000000000000, -0.00009739888516, -0.00002199368128, -0.00001906942899, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00026281311003, -0.00007126297136, 0.00005059612581, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000132999686, -0.00003278930888, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000068787444, 0.00001997874534, 0.00005487051709, 0.00018068834972, -0.00009803275002, 0.00004619418996, -0.00000000000000;
    -0.00000495790389, 0.00000307995603, -0.00001499472983, -0.00005701098319, 0.00004513463722, -0.00002618132367, -0.00002288392956, -0.00036731905180, -0.00034396828004, 0.00015637882148, 0.00000631277682, -0.00023536058377, 0.00002041937412, 0.00172404407559, 0.00000095110700, -0.00000333176230, -0.00012829194745, -0.00021578904112, 0.00008873898348, 0.00040506952458, -0.00000041281797, -0.00002893693910, -0.00030353080778, 0.00007585771277, 0.00038124994838, 0.00000239416599, 0.00000000000000, 0.00000073624130, 0.00004647585557, 0.00000485850256, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00002349231122, -0.00002146693900, 0.00007752849480, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00010163356985, 0.00000587908794, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00005111215942, 0.00000128682866, 0.00000687947149, 0.00004726717532, 0.00032944311661, 0.00004320503487, -0.00000000000000;
    -0.00000815350869, -0.00000596422190, 0.00003125819056, -0.00000738378675, 0.00011675817783, -0.00000152831019, -0.00000204718756, -0.00049714177781, 0.00003481879193, 0.00014220425227, -0.00004566053502, 0.00087429720194, 0.00134936030006, 0.00000095110700, 0.00218119248361, 0.00000219320003, 0.00053661997287, 0.00065830174878, 0.00028637955920, 0.00064295961372, -0.00003529944813, 0.00001917026370, 0.00091036587180, 0.00068979446968, 0.00132656050271, 0.00003324874566, 0.00000000000000, -0.00009680768612, -0.00007218542584, -0.00001076125746, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00064031461559, -0.00019611024825, -0.00011238777188, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00002952239224, -0.00000874867266, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00003784843874, 0.00000805092747, -0.00008603511610, 0.00012559116174, -0.00019282634923, 0.00026897645723, -0.00000000000000;
    0.00000001880270, -0.00000010332802, -0.00000114325313, 0.00000000980323, 0.00000016904393, -0.00000052239791, -0.00000024108368, -0.00000244041871, -0.00000088101280, -0.00000116740587, -0.00000187817102, 0.00000829421251, 0.00000775754559, -0.00000333176230, 0.00000219320003, 0.00000178729722, -0.00000407629273, 0.00000361283275, -0.00000034101721, -0.00000196771980, 0.00000070194950, -0.00000024780757, 0.00000534480201, -0.00000197002359, -0.00000141626098, 0.00000021011789, 0.00000000000000, -0.00000056705670, -0.00000028779386, -0.00000008799951, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000162411046, 0.00000076482928, 0.00000025722456, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000040223656, -0.00000050728615, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000064549412, 0.00000023269380, 0.00000089444518, 0.00000064493809, -0.00000038582544, 0.00000003619848, -0.00000000000000;
    -0.00000481241122, -0.00000662351527, 0.00013958512218, 0.00004230552584, 0.00012246592592, 0.00003789693348, 0.00000959437556, -0.00043877928684, 0.00012536980032, -0.00011828381265, 0.00000403568121, 0.00068426302250, -0.00020800533287, -0.00012829194745, 0.00053661997287, -0.00000407629273, 0.00235583430333, 0.00104710622384, 0.00009611748399, 0.00016233929097, -0.00007892979280, 0.00011463950530, 0.00078075134177, 0.00061975048129, 0.00072917825958, -0.00000917672661, 0.00000000000000, 0.00000843605744, -0.00007718957811, 0.00001424783200, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00042832071433, 0.00004318161561, -0.00041783294542, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00006944715842, 0.00007179181308, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00004880848682, -0.00001412911703, -0.00045566286595, -0.00006077169181, -0.00000814188280, 0.00024617393851, -0.00000000000000;
    -0.00000014978926, 0.00001010606483, 0.00015158456292, 0.00002306466404, 0.00006877707840, 0.00003645535960, 0.00000256238287, -0.00032702657831, 0.00011908652304, -0.00011865496581, 0.00000693900115, 0.00115069808075, 0.00012715366496, -0.00021578904112, 0.00065830174878, 0.00000361283275, 0.00104710622384, 0.00146536655587, 0.00008298226490, 0.00028974911307, 0.00008139109423, 0.00003467222547, 0.00071235187659, 0.00038653740432, 0.00032759665087, -0.00000402513594, 0.00000000000000, -0.00001032199176, -0.00009424562659, -0.00000337475725, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00004496367126, -0.00005781906797, -0.00014622590970, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00006213695172, -0.00001489793212, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00002580651745, -0.00001438820299, -0.00017291672136, 0.00003820702009, -0.00006129892683, 0.00022945644885, 0.00000000000000;
    -0.00000097212786, -0.00000090309163, -0.00000703506370, -0.00000367333902, 0.00003573370385, 0.00001058984313, -0.00000846684431, -0.00017877185363, -0.00003442154015, 0.00002666846984, -0.00000660894587, 0.00023169539180, 0.00016982002165, 0.00008873898348, 0.00028637955920, -0.00000034101721, 0.00009611748399, 0.00008298226490, 0.00015805985184, 0.00008916594053, 0.00000332432361, 0.00000673839117, 0.00023274319503, 0.00016572410770, 0.00027435382863, 0.00000640385395, 0.00000000000000, -0.00001370809995, -0.00001707916274, -0.00000190398093, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00009716982173, -0.00002421444380, -0.00003134406636, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00003687034073, -0.00001114829898, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000272760391, 0.00000042210242, -0.00002056845046, -0.00000329768287, 0.00000366605471, 0.00005681928796, 0.00000000000000;
    -0.00000377785952, 0.00001663652053, 0.00004961864552, 0.00000306690324, 0.00002648748279, -0.00000012772064, 0.00000259189645, -0.00006533077508, 0.00000501323184, 0.00006478253307, -0.00000046221655, 0.00050726123274, 0.00036033664503, 0.00040506952458, 0.00064295961372, -0.00000196771980, 0.00016233929097, 0.00028974911307, 0.00008916594053, 0.00071244702144, 0.00000886424830, -0.00000250550563, 0.00024933524181, 0.00016908852934, 0.00048135950506, 0.00000491292152, 0.00000000000000, -0.00002023137871, 0.00000044929358, -0.00001191127609, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00007040398010, -0.00007251179590, 0.00000132042804, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00023052340722, -0.00001596721332, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000120174469, 0.00000110468990, -0.00005704896508, 0.00008945270996, -0.00000707285781, 0.00012098223660, -0.00000000000000;
    -0.00000011084391, 0.00000667079324, 0.00000635761943, 0.00000045641660, -0.00000048644988, 0.00000280657802, -0.00000002060395, -0.00000562690934, -0.00000764323727, 0.00000020840244, -0.00000196287123, 0.00022722811242, -0.00004141442668, -0.00000041281797, -0.00003529944813, 0.00000070194950, -0.00007892979280, 0.00008139109423, 0.00000332432361, 0.00000886424830, 0.00004540018272, 0.00000291038147, 0.00008023935034, -0.00005188379719, -0.00002609243714, -0.00000043364735, 0.00000000000000, 0.00000267601238, -0.00000426885324, -0.00000302866699, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00006738180716, -0.00000010332766, 0.00002683440740, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00002753473940, -0.00001534496300, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000185894496, -0.00000338911574, 0.00001456694716, -0.00000645333027, -0.00000147693542, -0.00000004599559, 0.00000000000000;
    -0.00000033529623, -0.00000166687183, 0.00000313225116, 0.00000154451569, 0.00000253207524, -0.00000446784008, -0.00000006395765, -0.00001649264971, 0.00000648047117, -0.00000120158736, -0.00000155449065, 0.00013292841865, -0.00001036779068, -0.00002893693910, 0.00001917026370, -0.00000024780757, 0.00011463950530, 0.00003467222547, 0.00000673839117, -0.00000250550563, 0.00000291038147, 0.00003070130224, 0.00012454902217, 0.00000816094635, 0.00003870806320, 0.00000022454847, 0.00000000000000, 0.00000077424270, -0.00000226875066, -0.00000196368281, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00002064661986, 0.00001009886023, -0.00002261151588, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001302065754, 0.00000083968470, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00001255815963, -0.00000090631349, -0.00002657649541, 0.00000046011623, -0.00000073581097, 0.00000454250688, 0.00000000000000;
    -0.00000440050298, 0.00005870423300, -0.00001426690715, 0.00000551088452, 0.00007057567365, 0.00003038866256, -0.00000417724794, -0.00050172589396, 0.00006255746925, -0.00004629576057, -0.00004314474044, 0.00221090409928, 0.00045839121313, -0.00030353080778, 0.00091036587180, 0.00000534480201, 0.00078075134177, 0.00071235187659, 0.00023274319503, 0.00024933524181, 0.00008023935034, 0.00012454902217, 0.00205004410456, 0.00059317065121, 0.00112396691266, 0.00002927609119, 0.00000000000000, -0.00004629745064, -0.00006674621548, -0.00003936802042, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00023426478941, 0.00001477927531, -0.00024881522896, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00001141670868, -0.00011232699577, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00012200164681, -0.00000330287100, -0.00014944395833, 0.00002180039850, -0.00012615164412, 0.00016941080216, -0.00000000000000;
    -0.00000372468270, -0.00000071964844, 0.00002140121117, -0.00001215272212, 0.00006898155904, 0.00003452000830, -0.00001895963945, -0.00046469938359, 0.00002898420528, -0.00007917730163, -0.00001252647897, 0.00032075189373, 0.00032316491564, 0.00007585771277, 0.00068979446968, -0.00000197002359, 0.00061975048129, 0.00038653740432, 0.00016572410770, 0.00016908852934, -0.00005188379719, 0.00000816094635, 0.00059317065121, 0.00106824611636, 0.00070006842830, 0.00001156120677, 0.00000000000000, -0.00003369412695, -0.00004735523377, 0.00000083706543, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00029530038405, -0.00004480479298, -0.00018998665335, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00003037149005, -0.00000949747899, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000086265391, 0.00000193011819, -0.00010394204324, 0.00000792525076, -0.00001901193052, 0.00015908171909, 0.00000000000000;
    -0.00000819641669, 0.00001659461117, -0.00000438952594, -0.00000890881244, 0.00012768343331, 0.00002051463363, -0.00001137476788, -0.00056986330053, -0.00006871349014, 0.00008137518089, -0.00005280810117, 0.00097968136040, 0.00086204920873, 0.00038124994838, 0.00132656050271, -0.00000141626098, 0.00072917825958, 0.00032759665087, 0.00027435382863, 0.00048135950506, -0.00002609243714, 0.00003870806320, 0.00112396691266, 0.00070006842830, 0.00155477715264, 0.00002716814691, 0.00000000000000, -0.00006624826406, -0.00004379880169, -0.00001033882493, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00054274051114, -0.00006074252116, -0.00021914308945, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00006749196645, -0.00005421838836, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00001860414298, 0.00000423884948, -0.00014685377112, 0.00005382786299, -0.00002015142717, 0.00019770721203, -0.00000000000000;
    -0.00000008756379, 0.00000034050562, -0.00000752965693, -0.00000062218702, 0.00000142293335, 0.00000069823845, 0.00000011342831, -0.00000990083751, -0.00000217879398, 0.00000341042875, -0.00000239798805, 0.00003152142681, 0.00003509444701, 0.00000239416599, 0.00003324874566, 0.00000021011789, -0.00000917672661, -0.00000402513594, 0.00000640385395, 0.00000491292152, -0.00000043364735, 0.00000022454847, 0.00002927609119, 0.00001156120677, 0.00002716814691, 0.00000176389234, 0.00000000000000, -0.00000304220465, -0.00000056976176, -0.00000100469401, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000756585865, -0.00000166388053, 0.00000194558392, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000209519072, -0.00000115722378, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000168070738, 0.00000067531050, 0.00000262144090, -0.00000004995812, -0.00000347965094, 0.00000151148422, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000028492152, 0.00000031832625, 0.00000801475465, 0.00000107411418, -0.00000426065489, -0.00000121045272, -0.00000037464064, 0.00002216999791, 0.00000362122209, -0.00000738345358, 0.00000519725021, -0.00004564385728, -0.00009739888516, 0.00000073624130, -0.00009680768612, -0.00000056705670, 0.00000843605744, -0.00001032199176, -0.00001370809995, -0.00002023137871, 0.00000267601238, 0.00000077424270, -0.00004629745064, -0.00003369412695, -0.00006624826406, -0.00000304220465, 0.00000000000000, 0.00000759623215, 0.00000250903451, 0.00000132324956, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00002039211013, 0.00000599749409, -0.00000103752981, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000236510699, 0.00000206774918, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000105236221, -0.00000141131523, -0.00000342893053, -0.00000788072649, 0.00000656828445, -0.00000803375534, -0.00000000000000;
    -0.00000007080032, 0.00000111863323, -0.00000768035596, -0.00000210136912, -0.00001056327125, -0.00000486228862, 0.00000062782717, 0.00004544499295, -0.00000932536666, 0.00000989274671, 0.00000154353398, -0.00008480581342, -0.00002199368128, 0.00004647585557, -0.00007218542584, -0.00000028779386, -0.00007718957811, -0.00009424562659, -0.00001707916274, 0.00000044929358, -0.00000426885324, -0.00000226875066, -0.00006674621548, -0.00004735523377, -0.00004379880169, -0.00000056976176, 0.00000000000000, 0.00000250903451, 0.00001029046691, -0.00000048125051, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001715301540, 0.00000440535383, 0.00001526658127, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000401347634, 0.00000089794491, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000313686698, 0.00000087978279, 0.00001236754973, 0.00000437647201, 0.00001028913718, -0.00002232699937, 0.00000000000000;
    -0.00000003525862, -0.00000265717702, 0.00000410384199, 0.00000047635164, 0.00000301763995, 0.00000098652555, -0.00000052300193, -0.00000638416025, -0.00000195518254, -0.00000273602610, -0.00000009462799, -0.00006004372317, -0.00001906942899, 0.00000485850256, -0.00001076125746, -0.00000008799951, 0.00001424783200, -0.00000337475725, -0.00000190398093, -0.00001191127609, -0.00000302866699, -0.00000196368281, -0.00003936802042, 0.00000083706543, -0.00001033882493, -0.00000100469401, 0.00000000000000, 0.00000132324956, -0.00000048125051, 0.00000242682196, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000929718554, -0.00000075764966, -0.00000430824974, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000234248648, 0.00000362079653, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000145115887, -0.00000038242713, -0.00000271324246, -0.00000211953307, 0.00000569080227, 0.00000342976835, -0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000570019211, 0.00001910049731, -0.00000364962847, 0.00000330767612, -0.00005875699756, 0.00001023762597, 0.00000436261216, 0.00018107374647, -0.00002263231925, -0.00007727646808, 0.00002006297038, 0.00013265000864, -0.00026281311003, 0.00002349231122, -0.00064031461559, 0.00000162411046, -0.00042832071433, 0.00004496367126, -0.00009716982173, -0.00007040398010, 0.00006738180716, -0.00002064661986, -0.00023426478941, -0.00029530038405, -0.00054274051114, -0.00000756585865, 0.00000000000000, 0.00002039211013, 0.00001715301540, -0.00000929718554, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00047103737276, 0.00005718664727, 0.00013643737438, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00005099245016, -0.00002229230215, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001950768219, -0.00000145232392, 0.00008507448766, 0.00000935981157, 0.00006280627118, -0.00006156681161, 0.00000000000000;
    0.00000140788070, 0.00000245452286, -0.00000598404380, 0.00000002246225, -0.00000724572672, 0.00000414027799, 0.00000012558404, 0.00001858584996, -0.00001447608148, -0.00002559655685, -0.00000205517348, 0.00004358141155, -0.00007126297136, -0.00002146693900, -0.00019611024825, 0.00000076482928, 0.00004318161561, -0.00005781906797, -0.00002421444380, -0.00007251179590, -0.00000010332766, 0.00001009886023, 0.00001477927531, -0.00004480479298, -0.00006074252116, -0.00000166388053, 0.00000000000000, 0.00000599749409, 0.00000440535383, -0.00000075764966, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00005718664727, 0.00004855822156, -0.00000748362960, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000752565840, -0.00000218002732, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000350233517, 0.00000006923317, -0.00001269992701, -0.00000232696628, 0.00002463451329, -0.00002136365525, 0.00000000000000;
    0.00000146602158, 0.00000126864916, -0.00003162924824, -0.00000813971898, -0.00002645154547, -0.00000866921457, 0.00000362703454, 0.00011648527271, -0.00003285629277, 0.00004112215389, 0.00000529786430, -0.00005158704555, 0.00005059612581, 0.00007752849480, -0.00011238777188, 0.00000025722456, -0.00041783294542, -0.00014622590970, -0.00003134406636, 0.00000132042804, 0.00002683440740, -0.00002261151588, -0.00024881522896, -0.00018998665335, -0.00021914308945, 0.00000194558392, 0.00000000000000, -0.00000103752981, 0.00001526658127, -0.00000430824974, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00013643737438, -0.00000748362960, 0.00012962102638, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00002773408326, 0.00000173489062, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001127902766, 0.00000219857634, 0.00008058208843, 0.00000394989606, 0.00000120630030, -0.00005387059834, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    -0.00000062044013, -0.00000728498662, -0.00002474994945, -0.00000754891426, -0.00001835243838, -0.00000870622420, 0.00000072505189, 0.00002003190278, -0.00001507521778, -0.00000436027638, 0.00000244868243, -0.00024754525830, -0.00000132999686, -0.00010163356985, -0.00002952239224, -0.00000040223656, 0.00006944715842, -0.00006213695172, -0.00003687034073, -0.00023052340722, -0.00002753473940, 0.00001302065754, -0.00001141670868, 0.00003037149005, -0.00006749196645, 0.00000209519072, 0.00000000000000, -0.00000236510699, 0.00000401347634, 0.00000234248648, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00005099245016, 0.00000752565840, -0.00002773408326, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00019518175759, 0.00001440163351, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000210133536, 0.00000152074079, 0.00000913568645, -0.00000499067436, -0.00000342107792, -0.00005084484244, -0.00000000000000;
    -0.00000019322965, -0.00000510346017, 0.00000139914020, 0.00000262558057, 0.00000280293733, -0.00000073422504, 0.00000119851785, 0.00000877534557, 0.00000759840056, -0.00000031685088, 0.00000133735584, -0.00014047108064, -0.00003278930888, 0.00000587908794, -0.00000874867266, -0.00000050728615, 0.00007179181308, -0.00001489793212, -0.00001114829898, -0.00001596721332, -0.00001534496300, 0.00000083968470, -0.00011232699577, -0.00000949747899, -0.00005421838836, -0.00000115722378, 0.00000000000000, 0.00000206774918, 0.00000089794491, 0.00000362079653, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00002229230215, -0.00000218002732, 0.00000173489062, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001440163351, 0.00002275113710, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000083071835, 0.00000017490572, -0.00001251575024, -0.00000694832419, 0.00000144459153, 0.00000513386059, -0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000;
    0.00000035807549, -0.00000260673242, 0.00000143036718, -0.00000006319895, -0.00000355132302, 0.00000001194887, -0.00000171159723, 0.00001901797303, -0.00000671950207, 0.00000035984226, 0.00000240841779, -0.00014340839111, 0.00000068787444, 0.00005111215942, -0.00003784843874, -0.00000064549412, -0.00004880848682, -0.00002580651745, -0.00000272760391, 0.00000120174469, -0.00000185894496, -0.00001255815963, -0.00012200164681, -0.00000086265391, -0.00001860414298, -0.00000168070738, 0.00000000000000, 0.00000105236221, 0.00000313686698, 0.00000145115887, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001950768219, -0.00000350233517, 0.00001127902766, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000210133536, 0.00000083071835, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00002363026173, 0.00000024695916, 0.00001170245220, 0.00000012742185, 0.00001287039515, -0.00000842629488, 0.00000000000000;
    0.00000011875204, -0.00000015380664, -0.00000421013823, -0.00000064512347, -0.00000107067592, -0.00000038247065, 0.00000006776880, 0.00000271758727, -0.00000101525232, 0.00000170375009, -0.00000162513242, -0.00000922266872, 0.00001997874534, 0.00000128682866, 0.00000805092747, 0.00000023269380, -0.00001412911703, -0.00001438820299, 0.00000042210242, 0.00000110468990, -0.00000338911574, -0.00000090631349, -0.00000330287100, 0.00000193011819, 0.00000423884948, 0.00000067531050, 0.00000000000000, -0.00000141131523, 0.00000087978279, -0.00000038242713, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000145232392, 0.00000006923317, 0.00000219857634, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000152074079, 0.00000017490572, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000024695916, 0.00000078835047, 0.00000292652703, 0.00000180691230, -0.00000055389065, -0.00000187597413, -0.00000000000000;
    0.00000095343854, 0.00000190258872, -0.00003044583945, -0.00000852638932, -0.00002440560676, -0.00000625575424, -0.00000209532570, 0.00007591528640, -0.00002188013983, 0.00001737305991, -0.00000044060710, -0.00015083831839, 0.00005487051709, 0.00000687947149, -0.00008603511610, 0.00000089444518, -0.00045566286595, -0.00017291672136, -0.00002056845046, -0.00005704896508, 0.00001456694716, -0.00002657649541, -0.00014944395833, -0.00010394204324, -0.00014685377112, 0.00000262144090, 0.00000000000000, -0.00000342893053, 0.00001236754973, -0.00000271324246, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00008507448766, -0.00001269992701, 0.00008058208843, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000913568645, -0.00001251575024, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001170245220, 0.00000292652703, 0.00009494348920, 0.00000943511245, -0.00000418264767, -0.00004685764723, -0.00000000000000;
    -0.00000007983344, 0.00000408626531, 0.00002636829049, -0.00000528775541, -0.00000688940469, -0.00000540401832, 0.00000053529109, 0.00002030449073, -0.00001193459838, 0.00000867473378, -0.00000054609067, 0.00000525746179, 0.00018068834972, 0.00004726717532, 0.00012559116174, 0.00000064493809, -0.00006077169181, 0.00003820702009, -0.00000329768287, 0.00008945270996, -0.00000645333027, 0.00000046011623, 0.00002180039850, 0.00000792525076, 0.00005382786299, -0.00000004995812, 0.00000000000000, -0.00000788072649, 0.00000437647201, -0.00000211953307, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000935981157, -0.00000232696628, 0.00000394989606, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000499067436, -0.00000694832419, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000012742185, 0.00000180691230, 0.00000943511245, 0.00007705745211, 0.00001382775846, 0.00000341408100, 0.00000000000000;
    0.00000015381278, -0.00000514298417, 0.00000765687029, -0.00001108576507, 0.00001193219291, 0.00000450557217, -0.00000332621718, -0.00006886585493, -0.00014381500539, 0.00000768845221, -0.00000057994248, -0.00014722594906, -0.00009803275002, 0.00032944311661, -0.00019282634923, -0.00000038582544, -0.00000814188280, -0.00006129892683, 0.00000366605471, -0.00000707285781, -0.00000147693542, -0.00000073581097, -0.00012615164412, -0.00001901193052, -0.00002015142717, -0.00000347965094, 0.00000000000000, 0.00000656828445, 0.00001028913718, 0.00000569080227, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00006280627118, 0.00002463451329, 0.00000120630030, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000342107792, 0.00000144459153, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00001287039515, -0.00000055389065, -0.00000418264767, 0.00001382775846, 0.00016815245025, -0.00000226419723, -0.00000000000000;
    -0.00000069358975, -0.00000001558411, 0.00003347499894, 0.00002182499606, 0.00004445070515, 0.00002839537607, -0.00000323885619, -0.00017913088239, 0.00004906561841, -0.00005049421412, -0.00000566143084, 0.00017580416038, 0.00004619418996, 0.00004320503487, 0.00026897645723, 0.00000003619848, 0.00024617393851, 0.00022945644885, 0.00005681928796, 0.00012098223660, -0.00000004599559, 0.00000454250688, 0.00016941080216, 0.00015908171909, 0.00019770721203, 0.00000151148422, 0.00000000000000, -0.00000803375534, -0.00002232699937, 0.00000342976835, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00006156681161, -0.00002136365525, -0.00005387059834, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00005084484244, 0.00000513386059, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000842629488, -0.00000187597413, -0.00004685764723, 0.00000341408100, -0.00000226419723, 0.00013375992284, -0.00000000000000;
    0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000;
];

/// A K-matrix parameterization for $`f_0`$ particles described by Kopf et al.[^1] with fixed couplings and mass poles
/// (free production couplings only).
///
/// [^1]: Kopf, B., Albrecht, M., Koch, H., Kner, M., Pychy, J., Qin, X., & Wiedner, U. (2021). Investigation of the lightest hybrid meson candidate with a coupled-channel analysis of $`\bar{p}p`$-, $`\pi^- p`$- and $`\pi \pi`$-Data. The European Physical Journal C, 81(12). [doi:10.1140/epjc/s10052-021-09821-2](https://doi.org/10.1140/epjc/s10052-021-09821-2)
#[derive(Clone, Serialize, Deserialize)]
pub struct KopfKMatrixF0 {
    name: String,
    channel: usize,
    mass: Mass,
    constants: super::FixedKMatrix<5, 5>,
    couplings_real: [ParameterLike; 5],
    couplings_imag: [ParameterLike; 5],
    couplings_indices_real: [ParameterID; 5],
    couplings_indices_imag: [ParameterID; 5],
    ikc_cache_index: ComplexVectorID<5>,
    p_vec_cache_index: MatrixID<5, 5>,
}

impl KopfKMatrixF0 {
    /// Construct a new [`KopfKMatrixF0`] with the given name, production couplings, channel,
    /// and input mass.
    ///
    /// | Channel index | Channel |
    /// | ------------- | ------- |
    /// | 0             | $`\pi\pi`$ |
    /// | 1             | $`2\pi 2\pi`$ |
    /// | 2             | $`K\bar{K}`$ |
    /// | 3             | $`\eta\eta`$ |
    /// | 4             | $`\eta\eta'`$ |
    ///
    /// | Pole names |
    /// | ---------- |
    /// | $`f_0(500)`$ |
    /// | $`f_0(980)`$ |
    /// | $`f_0(1370)`$ |
    /// | $`f_0(1500)`$ |
    /// | $`f_0(1710)`$ |
    pub fn new(
        name: &str,
        couplings: [[ParameterLike; 2]; 5],
        channel: usize,
        mass: &Mass,
        seed: Option<usize>,
    ) -> LadduResult<Expression> {
        let mut couplings_real: [ParameterLike; 5] = array::from_fn(|_| ParameterLike::default());
        let mut couplings_imag: [ParameterLike; 5] = array::from_fn(|_| ParameterLike::default());
        for i in 0..5 {
            couplings_real[i] = couplings[i][0].clone();
            couplings_imag[i] = couplings[i][1].clone();
        }
        Self {
            name: name.to_string(),
            channel,
            mass: mass.clone(),
            constants: FixedKMatrix::new(
                G_F0,
                C_F0,
                vector![0.1349768, 2.0 * 0.1349768, 0.493677, 0.547862, 0.547862],
                vector![0.1349768, 2.0 * 0.1349768, 0.497611, 0.547862, 0.95778],
                M_F0,
                Some(AdlerZero {
                    s_0: 0.0091125,
                    s_norm: 1.0,
                }),
                0,
                COV_F0,
                seed,
            ),
            couplings_real,
            couplings_imag,
            couplings_indices_real: [ParameterID::default(); 5],
            couplings_indices_imag: [ParameterID::default(); 5],
            ikc_cache_index: ComplexVectorID::default(),
            p_vec_cache_index: MatrixID::default(),
        }
        .into_expression()
    }
}

#[typetag::serde]
impl Amplitude for KopfKMatrixF0 {
    fn register(&mut self, resources: &mut Resources) -> LadduResult<AmplitudeID> {
        for i in 0..self.couplings_indices_real.len() {
            self.couplings_indices_real[i] =
                resources.register_parameter(&self.couplings_real[i])?;
            self.couplings_indices_imag[i] =
                resources.register_parameter(&self.couplings_imag[i])?;
        }
        self.ikc_cache_index = resources
            .register_complex_vector(Some(&format!("KopfKMatrixF0<{}> ikc_vec", self.name)));
        self.p_vec_cache_index =
            resources.register_matrix(Some(&format!("KopfKMatrixF0<{}> p_vec", self.name)));
        resources.register_amplitude(&self.name)
    }

    fn bind(&mut self, metadata: &DatasetMetadata) -> LadduResult<()> {
        self.mass.bind(metadata)?;
        Ok(())
    }

    fn precompute(&self, event: &EventData, cache: &mut Cache) {
        let s = self.mass.value(event).powi(2);
        cache.store_complex_vector(
            self.ikc_cache_index,
            self.constants.ikc_inv_vec(s, self.channel),
        );
        cache.store_matrix(self.p_vec_cache_index, self.constants.p_vec_constants(s));
    }

    fn compute(&self, parameters: &Parameters, _event: &EventData, cache: &Cache) -> Complex64 {
        let betas = SVector::from_fn(|i, _| {
            Complex64::new(
                parameters.get(self.couplings_indices_real[i]),
                parameters.get(self.couplings_indices_imag[i]),
            )
        });
        let ikc_inv_vec = cache.get_complex_vector(self.ikc_cache_index);
        let p_vec_constants = cache.get_matrix(self.p_vec_cache_index);
        FixedKMatrix::compute(&betas, &ikc_inv_vec, &p_vec_constants)
    }

    fn compute_gradient(
        &self,
        _parameters: &Parameters,
        _event: &EventData,
        cache: &Cache,
        gradient: &mut DVector<Complex64>,
    ) {
        let ikc_inv_vec = cache.get_complex_vector(self.ikc_cache_index);
        let p_vec_constants = cache.get_matrix(self.p_vec_cache_index);
        let internal_gradient = FixedKMatrix::compute_gradient(&ikc_inv_vec, &p_vec_constants);
        for i in 0..5 {
            if let ParameterID::Parameter(index) = self.couplings_indices_real[i] {
                gradient[index] = internal_gradient[i];
            }
            if let ParameterID::Parameter(index) = self.couplings_indices_imag[i] {
                gradient[index] = Complex64::I * internal_gradient[i];
            }
        }
    }
}

/// A fixed K-Matrix Amplitude for :math:`f_0` mesons
///
/// Parameters
/// ----------
/// name : str
///     The Amplitude name
/// couplings : list of list of laddu.ParameterLike
///     Each initial-state coupling (as a list of pairs of real and imaginary parts)
/// channel : int
///     The channel onto which the K-Matrix is projected
/// mass: laddu.Mass
///     The total mass of the resonance
/// seed: int, optional
///     Seed used to resample fixed K-matrix components according to their covariance
///     No resampling is done if seed is None
///
/// Returns
/// -------
/// laddu.Amplitude
///     An Amplitude which can be registered by a laddu.Manager
///
/// See Also
/// --------
/// laddu.Manager
///
/// Notes
/// -----
/// This Amplitude follows the prescription of [Kopf]_ and fixes the K-Matrix to data
/// from that paper, leaving the couplings to the initial state free
///
/// +---------------+-------------------+
/// | Channel index | Channel           |
/// +===============+===================+
/// | 0             | :math:`\pi\pi`    |
/// +---------------+-------------------+
/// | 1             | :math:`2\pi 2\pi` |
/// +---------------+-------------------+
/// | 2             | :math:`K\bar{K}`  |
/// +---------------+-------------------+
/// | 3             | :math:`\eta\eta`  |
/// +---------------+-------------------+
/// | 4             | :math:`\eta\eta'` |
/// +---------------+-------------------+
///
/// +-------------------+
/// | Pole names        |
/// +===================+
/// | :math:`f_0(500)`  |
/// +-------------------+
/// | :math:`f_0(980)`  |
/// +-------------------+
/// | :math:`f_0(1370)` |
/// +-------------------+
/// | :math:`f_0(1500)` |
/// +-------------------+
/// | :math:`f_0(1710)` |
/// +-------------------+
///
/// .. [Kopf] Kopf, B., Albrecht, M., Koch, H., Kner, M., Pychy, J., Qin, X., & Wiedner, U. (2021). Investigation of the lightest hybrid meson candidate with a coupled-channel analysis of :math:`\bar{p}p`-, :math:`\pi^- p`- and :math:`\pi \pi`-Data. The European Physical Journal C, 81(12). `doi:10.1140/epjc/s10052-021-09821-2 <https://doi.org/10.1140/epjc/s10052-021-09821-2>`__
///
#[cfg(feature = "python")]
#[pyfunction(name = "KopfKMatrixF0", signature = (name, couplings, channel, mass, seed = None))]
pub fn py_kopf_kmatrix_f0(
    name: &str,
    couplings: [[PyParameterLike; 2]; 5],
    channel: usize,
    mass: PyMass,
    seed: Option<usize>,
) -> PyResult<PyExpression> {
    Ok(PyExpression(KopfKMatrixF0::new(
        name,
        array::from_fn(|i| array::from_fn(|j| couplings[i][j].clone().0)),
        channel,
        &mass.0,
        seed,
    )?))
}

#[cfg(test)]
mod tests {
    // Note: These tests are not exhaustive, they only check one channel
    use std::sync::Arc;

    use super::*;
    use approx::assert_relative_eq;
    use laddu_core::{data::test_dataset, parameter, Mass};

    #[test]
    fn test_f0_evaluation() {
        let dataset = Arc::new(test_dataset());
        let res_mass = Mass::new(["kshort1", "kshort2"]);
        let expr = KopfKMatrixF0::new(
            "f0",
            [
                [parameter("p0"), parameter("p1")],
                [parameter("p2"), parameter("p3")],
                [parameter("p4"), parameter("p5")],
                [parameter("p6"), parameter("p7")],
                [parameter("p8"), parameter("p9")],
            ],
            1,
            &res_mass,
            None,
        )
        .unwrap();
        let evaluator = expr.load(&dataset).unwrap();

        let result = evaluator.evaluate(&[0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]);

        assert_relative_eq!(result[0].re, 0.2674945594859745);
        assert_relative_eq!(result[0].im, 0.7289451151846622);
    }

    #[test]
    fn test_f0_gradient() {
        let dataset = Arc::new(test_dataset());
        let res_mass = Mass::new(["kshort1", "kshort2"]);
        let expr = KopfKMatrixF0::new(
            "f0",
            [
                [parameter("p0"), parameter("p1")],
                [parameter("p2"), parameter("p3")],
                [parameter("p4"), parameter("p5")],
                [parameter("p6"), parameter("p7")],
                [parameter("p8"), parameter("p9")],
            ],
            1,
            &res_mass,
            None,
        )
        .unwrap();
        let evaluator = expr.load(&dataset).unwrap();

        let result =
            evaluator.evaluate_gradient(&[0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]);

        assert_relative_eq!(result[0][0].re, -0.032491219879072594);
        assert_relative_eq!(result[0][0].im, -0.011073489047324615);
        assert_relative_eq!(result[0][1].re, -result[0][0].im);
        assert_relative_eq!(result[0][1].im, result[0][0].re);
        assert_relative_eq!(result[0][2].re, 0.02410530896582612);
        assert_relative_eq!(result[0][2].im, 0.007918499653925656);
        assert_relative_eq!(result[0][3].re, -result[0][2].im);
        assert_relative_eq!(result[0][3].im, result[0][2].re);
        assert_relative_eq!(result[0][4].re, -0.031634528397387424);
        assert_relative_eq!(result[0][4].im, 0.01491556758888564);
        assert_relative_eq!(result[0][5].re, -result[0][4].im);
        assert_relative_eq!(result[0][5].im, result[0][4].re);
        assert_relative_eq!(result[0][6].re, 0.5838982754419436);
        assert_relative_eq!(result[0][6].im, 0.20716175256804892);
        assert_relative_eq!(result[0][7].re, -result[0][6].im);
        assert_relative_eq!(result[0][7].im, result[0][6].re);
        assert_relative_eq!(result[0][8].re, 0.09145465471022667);
        assert_relative_eq!(result[0][8].im, 0.03607718440586096);
        assert_relative_eq!(result[0][9].re, -result[0][8].im);
        assert_relative_eq!(result[0][9].im, result[0][8].re);
    }
    #[test]
    fn test_f0_resample() {
        let res_mass = Mass::new(["kshort1", "kshort2"]);
        let _amp = KopfKMatrixF0::new(
            "f0",
            [
                [parameter("p0"), parameter("p1")],
                [parameter("p2"), parameter("p3")],
                [parameter("p4"), parameter("p5")],
                [parameter("p6"), parameter("p7")],
                [parameter("p8"), parameter("p9")],
            ],
            1,
            &res_mass,
            Some(1),
        )
        .unwrap();
    }
}
