import{j as e,L as h,r as d,l as v,m as D,h as N,s as S,t as T}from"./vendor-tanstack-BVzzyDEt.js";import{a3 as p,aQ as w,a2 as f,bk as I,V as R,X as _,bl as z,Y as E,Z as M,$ as P,_ as A,a0 as L,a1 as F,q as j,I as k,O as Q,E as V,m as $,n as H,o as q,p as O,D as G,B as U,b as X,P as Y,bm as Z,bn as J,bo as x}from"./index-BJkJ93Lr.js";import{u as C,B as K}from"./use-delete-block-document-confirmation-dialog-JH26BNz8.js";import{D as y}from"./delete-confirmation-dialog-Baib9xiM.js";import{B as W}from"./block-type-logo-ESEG5U5y.js";import"./vendor-react-Bce9NwRC.js";import"./vendor-radix-CTAic6HB.js";import"./vendor-recharts-Mwm2qLZp.js";import"./vendor-forms-BN3tpxM2.js";import"./vendor-date-2jFo9aCm.js";import"./use-delete-confirmation-dialog-DDTCxOIv.js";const ee=({blockDocument:a})=>{const{id:o,name:s,block_type:l,block_type_name:t}=a;return e.jsxs("div",{className:"flex gap-4 items-center",children:[l&&t&&e.jsx(W,{size:"sm",logoUrl:l.logo_url,alt:`${t} logo`}),e.jsxs("div",{className:"flex flex-col",children:[s&&e.jsx(h,{to:"/blocks/block/$id",params:{id:o},children:e.jsx(p,{className:"font-semibold",children:s})}),t&&a.block_type?.slug&&e.jsx(h,{to:"/blocks/catalog/$slug",params:{slug:a.block_type.slug},children:e.jsx(p,{variant:"bodySmall",className:"text-muted-foreground",children:t})})]})]})},b=N(),se=({onDelete:a})=>[b.display({size:20,id:"select",header:({table:o})=>{let s=!1;return o.getIsAllRowsSelected()?s=!0:o.getIsSomePageRowsSelected()&&(s="indeterminate"),e.jsx(f,{checked:s,onCheckedChange:l=>o.toggleAllPageRowsSelected(!!l),"aria-label":"Select all"})},cell:({row:o})=>e.jsx(f,{checked:o.getIsSelected(),onCheckedChange:s=>o.toggleSelected(!!s),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1}),b.display({id:"block",header:"Block",cell:({row:o})=>e.jsx(ee,{blockDocument:o.original})}),b.display({id:"actions",cell:o=>{const s=o.row.original;return e.jsx("div",{className:"flex justify-end",children:e.jsx(K,{blockDocument:s,onDelete:()=>a(s)})})}})],oe=({blockDocuments:a,blockDocumentsCount:o,onPaginationChange:s,pagination:l,rowSelection:t,setRowSelection:i})=>{const[r,m]=C(),u=d.useCallback(c=>{let g=l;typeof c=="function"?g=c(l):g=c,s(g)},[l,s]),n=v({columns:se({onDelete:m}),data:a,defaultColumn:{maxSize:300},getCoreRowModel:D(),manualPagination:!0,onPaginationChange:u,rowCount:o,getRowId:c=>c.id,onRowSelectionChange:i,state:{pagination:l,rowSelection:t}});return e.jsxs(e.Fragment,{children:[e.jsx(w,{table:n}),e.jsx(y,{...r})]})};function ae({selectedBlockTypesSlugs:a,onToggleBlockTypeSlug:o,onRemoveBlockTypeSlug:s}){return e.jsx(d.Suspense,{children:e.jsx(le,{selectedBlockTypesSlugs:a,onToggleBlockTypeSlug:o,onRemoveBlockTypeSlug:s})})}function le({selectedBlockTypesSlugs:a,onToggleBlockTypeSlug:o,onRemoveBlockTypeSlug:s}){const[l,t]=d.useState(""),i=d.useDeferredValue(l),{data:r}=S(I()),m=d.useMemo(()=>a.map(n=>r.find(c=>c.slug===n)).filter(Boolean),[r,a]),u=d.useMemo(()=>r.filter(n=>n.name.toLowerCase().includes(i.toLowerCase())),[r,i]);return e.jsxs(R,{children:[e.jsx(_,{selected:a.length>0,children:e.jsx("div",{className:"flex gap-1",children:a.length>0?m.map(n=>e.jsx(z,{tag:n.name,onRemove:()=>s(n.slug)},n.id)):"Select blocks"})}),e.jsxs(E,{children:[e.jsx(M,{value:l,onValueChange:t,placeholder:"Search for a block type..."}),e.jsx(P,{children:"No block type found"}),e.jsx(A,{children:e.jsx(L,{children:u.map(n=>e.jsx(F,{selected:a.includes(n.slug),onSelect:c=>{o(c),t("")},value:n.slug,children:n.name},n.id))})})]})]})}const te=({count:a,rowSelection:o,setRowSelection:s})=>{const[l,t]=C(),i=d.useMemo(()=>Object.keys(o),[o]);return i.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(p,{variant:"bodySmall",className:"text-muted-foreground",children:[i.length," selected"]}),e.jsx(j,{"aria-label":"Delete rows",size:"icon",variant:"secondary",onClick:()=>{t(i,{onSuccess:()=>s({})})},children:e.jsx(k,{id:"Trash2",className:"size-4"})})]}),e.jsx(y,{...l})]}):e.jsxs(p,{variant:"bodySmall",className:"text-muted-foreground",children:[a," ",Q(a,"Block")]})},ne=()=>e.jsxs(V,{children:[e.jsx($,{id:"Box"}),e.jsx(H,{children:"Add a block to get started"}),e.jsx(q,{children:"Blocks securely store credentials and configuration to easily manage connections to external systems."}),e.jsxs(O,{children:[e.jsx(h,{to:"/blocks/catalog",children:e.jsxs(j,{children:["Add Block ",e.jsx(k,{id:"Plus",className:"size-4 ml-2"})]})}),e.jsx(G,{id:"blocks-guide"})]})]}),ce=({allCount:a,blockDocuments:o=[],onSearch:s,search:l,blockTypeSlugsFilter:t,onToggleBlockTypeSlug:i,onRemoveBlockTypeSlug:r,pagination:m,onPaginationChange:u})=>{const[n,c]=d.useState({});return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{children:e.jsx(X,{className:"text-xl font-semibold",children:"Blocks"})}),e.jsx(j,{size:"icon",className:"size-7",variant:"outline",children:e.jsx(h,{to:"/blocks/catalog",children:e.jsx(k,{id:"Plus",className:"size-4"})})})]}),a===0?e.jsx(ne,{}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(te,{rowSelection:n,setRowSelection:c,count:a}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{selectedBlockTypesSlugs:t,onToggleBlockTypeSlug:i,onRemoveBlockTypeSlug:r}),e.jsx("div",{className:"min-w-56",children:e.jsx(Y,{"aria-label":"search blocks",placeholder:"Search blocks",value:l,onChange:g=>s(g.target.value)})})]})]}),e.jsx(oe,{blockDocuments:o,rowSelection:n,setRowSelection:c,blockDocumentsCount:a,pagination:m,onPaginationChange:u})]})]})};function Ce(){const[a,o]=ie(),[s,l]=re(),[t,i]=de(),{data:r}=S(Z()),{data:m}=T(J({sort:"NAME_ASC",include_secrets:!1,block_documents:{name:{like_:a},operator:"and_",is_anonymous:{eq_:!1}},block_types:{slug:{any_:s.length>0?s:void 0}},offset:t.pageIndex*t.pageSize,limit:t.pageSize})),u=c=>{const g=s.filter(B=>B!==c);l(g)},n=c=>{if(s.includes(c))return u(c);l([...s,c])};return e.jsx(ce,{allCount:r,blockDocuments:m,onSearch:o,search:a,blockTypeSlugsFilter:s,onRemoveBlockTypeSlug:u,onToggleBlockTypeSlug:n,pagination:t,onPaginationChange:i})}function ie(){const{blockName:a}=x.useSearch(),o=x.useNavigate(),s=d.useCallback(t=>{o({to:".",search:i=>({...i,blockName:t}),replace:!0})},[o]);return[d.useMemo(()=>a??"",[a]),s]}function re(){const{blockTypes:a=[]}=x.useSearch(),o=x.useNavigate(),s=d.useCallback(l=>{o({to:".",search:t=>({...t,blockTypes:l}),replace:!0})},[o]);return[a,s]}function de(){const a=x.useSearch(),o=x.useNavigate(),s=(a.page??1)-1,l=a.limit??10,t=d.useMemo(()=>({pageIndex:s,pageSize:l}),[s,l]),i=d.useCallback(r=>{o({to:".",search:m=>({...m,page:r.pageIndex+1,limit:r.pageSize}),replace:!0})},[o]);return[t,i]}export{Ce as component};
//# sourceMappingURL=index-B-LzGb8i.js.map
